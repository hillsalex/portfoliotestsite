function defineClass(e,t,i){function r(){}if(e&&(r.prototype=e.prototype,t.prototype=new r,t.prototype.constructor=t,t.superClass=e),i)for(var n in i)t.prototype[n]=i[n];return t}function array_to_object(e){for(var t={},i=0;i<e.length;i++)t[e[i]]="";return t}function setNamespace(e,t,i){t instanceof Element&&(t.hasAttribute("id")?t.setAttribute("id",e.toString().replace(" ","")+"__"+t.getAttribute("id")):t.hasAttribute("DEF")&&i&&t.setAttribute("id",e.toString().replace(" ","")+"__"+t.getAttribute("DEF"))),t.hasChildNodes()&&Array.forEach(t.childNodes,function(t){setNamespace(e,t,i)})}var Handlebars={};!function(e,t){e.VERSION="1.0.0",e.COMPILER_REVISION=4,e.REVISION_CHANGES={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:">= 1.0.0"},e.helpers={},e.partials={};var i=Object.prototype.toString,r="[object Function]",n="[object Object]";e.registerHelper=function(t,r,o){if(i.call(t)===n){if(o||r)throw new e.Exception("Arg not supported with multiple helpers");e.Utils.extend(this.helpers,t)}else o&&(r.not=o),this.helpers[t]=r},e.registerPartial=function(t,r){i.call(t)===n?e.Utils.extend(this.partials,t):this.partials[t]=r},e.registerHelper("helperMissing",function(e){if(2===arguments.length)return t;throw new Error("Missing helper: '"+e+"'")}),e.registerHelper("blockHelperMissing",function(t,n){var o=n.inverse||function(){},s=n.fn,a=i.call(t);return a===r&&(t=t.call(this)),t===!0?s(this):t===!1||null==t?o(this):"[object Array]"===a?t.length>0?e.helpers.each(t,n):o(this):s(t)}),e.K=function(){},e.createFrame=Object.create||function(t){e.K.prototype=t;var i=new e.K;return e.K.prototype=null,i},e.logger={DEBUG:0,INFO:1,WARN:2,ERROR:3,level:3,methodMap:{0:"debug",1:"info",2:"warn",3:"error"},log:function(t,i){if(e.logger.level<=t){var r=e.logger.methodMap[t];"undefined"!=typeof console&&console[r]&&console[r].call(console,i)}}},e.log=function(t,i){e.logger.log(t,i)},e.registerHelper("each",function(t,n){var o,s=n.fn,a=n.inverse,l=0,d="",h=i.call(t);if(h===r&&(t=t.call(this)),n.data&&(o=e.createFrame(n.data)),t&&"object"==typeof t)if(t instanceof Array)for(var u=t.length;u>l;l++)o&&(o.index=l),d+=s(t[l],{data:o});else for(var c in t)t.hasOwnProperty(c)&&(o&&(o.key=c),d+=s(t[c],{data:o}),l++);return 0===l&&(d=a(this)),d}),e.registerHelper("if",function(t,n){var o=i.call(t);return o===r&&(t=t.call(this)),!t||e.Utils.isEmpty(t)?n.inverse(this):n.fn(this)}),e.registerHelper("unless",function(t,i){return e.helpers["if"].call(this,t,{fn:i.inverse,inverse:i.fn})}),e.registerHelper("with",function(t,n){var o=i.call(t);return o===r&&(t=t.call(this)),e.Utils.isEmpty(t)?void 0:n.fn(t)}),e.registerHelper("log",function(t,i){var r=i.data&&null!=i.data.level?parseInt(i.data.level,10):1;e.log(r,t)});var o=function(){function e(){this.yy={}}var t={trace:function(){},yy:{},symbols_:{error:2,root:3,program:4,EOF:5,simpleInverse:6,statements:7,statement:8,openInverse:9,closeBlock:10,openBlock:11,mustache:12,partial:13,CONTENT:14,COMMENT:15,OPEN_BLOCK:16,inMustache:17,CLOSE:18,OPEN_INVERSE:19,OPEN_ENDBLOCK:20,path:21,OPEN:22,OPEN_UNESCAPED:23,CLOSE_UNESCAPED:24,OPEN_PARTIAL:25,partialName:26,params:27,hash:28,dataName:29,param:30,STRING:31,INTEGER:32,BOOLEAN:33,hashSegments:34,hashSegment:35,ID:36,EQUALS:37,DATA:38,pathSegments:39,SEP:40,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",14:"CONTENT",15:"COMMENT",16:"OPEN_BLOCK",18:"CLOSE",19:"OPEN_INVERSE",20:"OPEN_ENDBLOCK",22:"OPEN",23:"OPEN_UNESCAPED",24:"CLOSE_UNESCAPED",25:"OPEN_PARTIAL",31:"STRING",32:"INTEGER",33:"BOOLEAN",36:"ID",37:"EQUALS",38:"DATA",40:"SEP"},productions_:[0,[3,2],[4,2],[4,3],[4,2],[4,1],[4,1],[4,0],[7,1],[7,2],[8,3],[8,3],[8,1],[8,1],[8,1],[8,1],[11,3],[9,3],[10,3],[12,3],[12,3],[13,3],[13,4],[6,2],[17,3],[17,2],[17,2],[17,1],[17,1],[27,2],[27,1],[30,1],[30,1],[30,1],[30,1],[30,1],[28,1],[34,2],[34,1],[35,3],[35,3],[35,3],[35,3],[35,3],[26,1],[26,1],[26,1],[29,2],[21,1],[39,3],[39,1]],performAction:function(e,t,i,r,n,o){var s=o.length-1;switch(n){case 1:return o[s-1];case 2:this.$=new r.ProgramNode([],o[s]);break;case 3:this.$=new r.ProgramNode(o[s-2],o[s]);break;case 4:this.$=new r.ProgramNode(o[s-1],[]);break;case 5:this.$=new r.ProgramNode(o[s]);break;case 6:this.$=new r.ProgramNode([],[]);break;case 7:this.$=new r.ProgramNode([]);break;case 8:this.$=[o[s]];break;case 9:o[s-1].push(o[s]),this.$=o[s-1];break;case 10:this.$=new r.BlockNode(o[s-2],o[s-1].inverse,o[s-1],o[s]);break;case 11:this.$=new r.BlockNode(o[s-2],o[s-1],o[s-1].inverse,o[s]);break;case 12:this.$=o[s];break;case 13:this.$=o[s];break;case 14:this.$=new r.ContentNode(o[s]);break;case 15:this.$=new r.CommentNode(o[s]);break;case 16:this.$=new r.MustacheNode(o[s-1][0],o[s-1][1]);break;case 17:this.$=new r.MustacheNode(o[s-1][0],o[s-1][1]);break;case 18:this.$=o[s-1];break;case 19:this.$=new r.MustacheNode(o[s-1][0],o[s-1][1],"&"===o[s-2][2]);break;case 20:this.$=new r.MustacheNode(o[s-1][0],o[s-1][1],!0);break;case 21:this.$=new r.PartialNode(o[s-1]);break;case 22:this.$=new r.PartialNode(o[s-2],o[s-1]);break;case 23:break;case 24:this.$=[[o[s-2]].concat(o[s-1]),o[s]];break;case 25:this.$=[[o[s-1]].concat(o[s]),null];break;case 26:this.$=[[o[s-1]],o[s]];break;case 27:this.$=[[o[s]],null];break;case 28:this.$=[[o[s]],null];break;case 29:o[s-1].push(o[s]),this.$=o[s-1];break;case 30:this.$=[o[s]];break;case 31:this.$=o[s];break;case 32:this.$=new r.StringNode(o[s]);break;case 33:this.$=new r.IntegerNode(o[s]);break;case 34:this.$=new r.BooleanNode(o[s]);break;case 35:this.$=o[s];break;case 36:this.$=new r.HashNode(o[s]);break;case 37:o[s-1].push(o[s]),this.$=o[s-1];break;case 38:this.$=[o[s]];break;case 39:this.$=[o[s-2],o[s]];break;case 40:this.$=[o[s-2],new r.StringNode(o[s])];break;case 41:this.$=[o[s-2],new r.IntegerNode(o[s])];break;case 42:this.$=[o[s-2],new r.BooleanNode(o[s])];break;case 43:this.$=[o[s-2],o[s]];break;case 44:this.$=new r.PartialNameNode(o[s]);break;case 45:this.$=new r.PartialNameNode(new r.StringNode(o[s]));break;case 46:this.$=new r.PartialNameNode(new r.IntegerNode(o[s]));break;case 47:this.$=new r.DataNode(o[s]);break;case 48:this.$=new r.IdNode(o[s]);break;case 49:o[s-2].push({part:o[s],separator:o[s-1]}),this.$=o[s-2];break;case 50:this.$=[{part:o[s]}]}},table:[{3:1,4:2,5:[2,7],6:3,7:4,8:6,9:7,11:8,12:9,13:10,14:[1,11],15:[1,12],16:[1,13],19:[1,5],22:[1,14],23:[1,15],25:[1,16]},{1:[3]},{5:[1,17]},{5:[2,6],7:18,8:6,9:7,11:8,12:9,13:10,14:[1,11],15:[1,12],16:[1,13],19:[1,19],20:[2,6],22:[1,14],23:[1,15],25:[1,16]},{5:[2,5],6:20,8:21,9:7,11:8,12:9,13:10,14:[1,11],15:[1,12],16:[1,13],19:[1,5],20:[2,5],22:[1,14],23:[1,15],25:[1,16]},{17:23,18:[1,22],21:24,29:25,36:[1,28],38:[1,27],39:26},{5:[2,8],14:[2,8],15:[2,8],16:[2,8],19:[2,8],20:[2,8],22:[2,8],23:[2,8],25:[2,8]},{4:29,6:3,7:4,8:6,9:7,11:8,12:9,13:10,14:[1,11],15:[1,12],16:[1,13],19:[1,5],20:[2,7],22:[1,14],23:[1,15],25:[1,16]},{4:30,6:3,7:4,8:6,9:7,11:8,12:9,13:10,14:[1,11],15:[1,12],16:[1,13],19:[1,5],20:[2,7],22:[1,14],23:[1,15],25:[1,16]},{5:[2,12],14:[2,12],15:[2,12],16:[2,12],19:[2,12],20:[2,12],22:[2,12],23:[2,12],25:[2,12]},{5:[2,13],14:[2,13],15:[2,13],16:[2,13],19:[2,13],20:[2,13],22:[2,13],23:[2,13],25:[2,13]},{5:[2,14],14:[2,14],15:[2,14],16:[2,14],19:[2,14],20:[2,14],22:[2,14],23:[2,14],25:[2,14]},{5:[2,15],14:[2,15],15:[2,15],16:[2,15],19:[2,15],20:[2,15],22:[2,15],23:[2,15],25:[2,15]},{17:31,21:24,29:25,36:[1,28],38:[1,27],39:26},{17:32,21:24,29:25,36:[1,28],38:[1,27],39:26},{17:33,21:24,29:25,36:[1,28],38:[1,27],39:26},{21:35,26:34,31:[1,36],32:[1,37],36:[1,28],39:26},{1:[2,1]},{5:[2,2],8:21,9:7,11:8,12:9,13:10,14:[1,11],15:[1,12],16:[1,13],19:[1,19],20:[2,2],22:[1,14],23:[1,15],25:[1,16]},{17:23,21:24,29:25,36:[1,28],38:[1,27],39:26},{5:[2,4],7:38,8:6,9:7,11:8,12:9,13:10,14:[1,11],15:[1,12],16:[1,13],19:[1,19],20:[2,4],22:[1,14],23:[1,15],25:[1,16]},{5:[2,9],14:[2,9],15:[2,9],16:[2,9],19:[2,9],20:[2,9],22:[2,9],23:[2,9],25:[2,9]},{5:[2,23],14:[2,23],15:[2,23],16:[2,23],19:[2,23],20:[2,23],22:[2,23],23:[2,23],25:[2,23]},{18:[1,39]},{18:[2,27],21:44,24:[2,27],27:40,28:41,29:48,30:42,31:[1,45],32:[1,46],33:[1,47],34:43,35:49,36:[1,50],38:[1,27],39:26},{18:[2,28],24:[2,28]},{18:[2,48],24:[2,48],31:[2,48],32:[2,48],33:[2,48],36:[2,48],38:[2,48],40:[1,51]},{21:52,36:[1,28],39:26},{18:[2,50],24:[2,50],31:[2,50],32:[2,50],33:[2,50],36:[2,50],38:[2,50],40:[2,50]},{10:53,20:[1,54]},{10:55,20:[1,54]},{18:[1,56]},{18:[1,57]},{24:[1,58]},{18:[1,59],21:60,36:[1,28],39:26},{18:[2,44],36:[2,44]},{18:[2,45],36:[2,45]},{18:[2,46],36:[2,46]},{5:[2,3],8:21,9:7,11:8,12:9,13:10,14:[1,11],15:[1,12],16:[1,13],19:[1,19],20:[2,3],22:[1,14],23:[1,15],25:[1,16]},{14:[2,17],15:[2,17],16:[2,17],19:[2,17],20:[2,17],22:[2,17],23:[2,17],25:[2,17]},{18:[2,25],21:44,24:[2,25],28:61,29:48,30:62,31:[1,45],32:[1,46],33:[1,47],34:43,35:49,36:[1,50],38:[1,27],39:26},{18:[2,26],24:[2,26]},{18:[2,30],24:[2,30],31:[2,30],32:[2,30],33:[2,30],36:[2,30],38:[2,30]},{18:[2,36],24:[2,36],35:63,36:[1,64]},{18:[2,31],24:[2,31],31:[2,31],32:[2,31],33:[2,31],36:[2,31],38:[2,31]},{18:[2,32],24:[2,32],31:[2,32],32:[2,32],33:[2,32],36:[2,32],38:[2,32]},{18:[2,33],24:[2,33],31:[2,33],32:[2,33],33:[2,33],36:[2,33],38:[2,33]},{18:[2,34],24:[2,34],31:[2,34],32:[2,34],33:[2,34],36:[2,34],38:[2,34]},{18:[2,35],24:[2,35],31:[2,35],32:[2,35],33:[2,35],36:[2,35],38:[2,35]},{18:[2,38],24:[2,38],36:[2,38]},{18:[2,50],24:[2,50],31:[2,50],32:[2,50],33:[2,50],36:[2,50],37:[1,65],38:[2,50],40:[2,50]},{36:[1,66]},{18:[2,47],24:[2,47],31:[2,47],32:[2,47],33:[2,47],36:[2,47],38:[2,47]},{5:[2,10],14:[2,10],15:[2,10],16:[2,10],19:[2,10],20:[2,10],22:[2,10],23:[2,10],25:[2,10]},{21:67,36:[1,28],39:26},{5:[2,11],14:[2,11],15:[2,11],16:[2,11],19:[2,11],20:[2,11],22:[2,11],23:[2,11],25:[2,11]},{14:[2,16],15:[2,16],16:[2,16],19:[2,16],20:[2,16],22:[2,16],23:[2,16],25:[2,16]},{5:[2,19],14:[2,19],15:[2,19],16:[2,19],19:[2,19],20:[2,19],22:[2,19],23:[2,19],25:[2,19]},{5:[2,20],14:[2,20],15:[2,20],16:[2,20],19:[2,20],20:[2,20],22:[2,20],23:[2,20],25:[2,20]},{5:[2,21],14:[2,21],15:[2,21],16:[2,21],19:[2,21],20:[2,21],22:[2,21],23:[2,21],25:[2,21]},{18:[1,68]},{18:[2,24],24:[2,24]},{18:[2,29],24:[2,29],31:[2,29],32:[2,29],33:[2,29],36:[2,29],38:[2,29]},{18:[2,37],24:[2,37],36:[2,37]},{37:[1,65]},{21:69,29:73,31:[1,70],32:[1,71],33:[1,72],36:[1,28],38:[1,27],39:26},{18:[2,49],24:[2,49],31:[2,49],32:[2,49],33:[2,49],36:[2,49],38:[2,49],40:[2,49]},{18:[1,74]},{5:[2,22],14:[2,22],15:[2,22],16:[2,22],19:[2,22],20:[2,22],22:[2,22],23:[2,22],25:[2,22]},{18:[2,39],24:[2,39],36:[2,39]},{18:[2,40],24:[2,40],36:[2,40]},{18:[2,41],24:[2,41],36:[2,41]},{18:[2,42],24:[2,42],36:[2,42]},{18:[2,43],24:[2,43],36:[2,43]},{5:[2,18],14:[2,18],15:[2,18],16:[2,18],19:[2,18],20:[2,18],22:[2,18],23:[2,18],25:[2,18]}],defaultActions:{17:[2,1]},parseError:function(e){throw new Error(e)},parse:function(e){function t(){var e;return e=i.lexer.lex()||1,"number"!=typeof e&&(e=i.symbols_[e]||e),e}var i=this,r=[0],n=[null],o=[],s=this.table,a="",l=0,d=0,h=0;this.lexer.setInput(e),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,this.yy.parser=this,"undefined"==typeof this.lexer.yylloc&&(this.lexer.yylloc={});var u=this.lexer.yylloc;o.push(u);var c=this.lexer.options&&this.lexer.options.ranges;"function"==typeof this.yy.parseError&&(this.parseError=this.yy.parseError);for(var f,m,p,_,g,v,y,b,x,w={};;){if(p=r[r.length-1],this.defaultActions[p]?_=this.defaultActions[p]:((null===f||"undefined"==typeof f)&&(f=t()),_=s[p]&&s[p][f]),"undefined"==typeof _||!_.length||!_[0]){var T="";if(!h){x=[];for(v in s[p])this.terminals_[v]&&v>2&&x.push("'"+this.terminals_[v]+"'");T=this.lexer.showPosition?"Parse error on line "+(l+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+x.join(", ")+", got '"+(this.terminals_[f]||f)+"'":"Parse error on line "+(l+1)+": Unexpected "+(1==f?"end of input":"'"+(this.terminals_[f]||f)+"'"),this.parseError(T,{text:this.lexer.match,token:this.terminals_[f]||f,line:this.lexer.yylineno,loc:u,expected:x})}}if(_[0]instanceof Array&&_.length>1)throw new Error("Parse Error: multiple actions possible at state: "+p+", token: "+f);switch(_[0]){case 1:r.push(f),n.push(this.lexer.yytext),o.push(this.lexer.yylloc),r.push(_[1]),f=null,m?(f=m,m=null):(d=this.lexer.yyleng,a=this.lexer.yytext,l=this.lexer.yylineno,u=this.lexer.yylloc,h>0&&h--);break;case 2:if(y=this.productions_[_[1]][1],w.$=n[n.length-y],w._$={first_line:o[o.length-(y||1)].first_line,last_line:o[o.length-1].last_line,first_column:o[o.length-(y||1)].first_column,last_column:o[o.length-1].last_column},c&&(w._$.range=[o[o.length-(y||1)].range[0],o[o.length-1].range[1]]),g=this.performAction.call(w,a,d,l,this.yy,_[1],n,o),"undefined"!=typeof g)return g;y&&(r=r.slice(0,-1*y*2),n=n.slice(0,-1*y),o=o.slice(0,-1*y)),r.push(this.productions_[_[1]][0]),n.push(w.$),o.push(w._$),b=s[r[r.length-2]][r[r.length-1]],r.push(b);break;case 3:return!0}}return!0}},i=function(){var e={EOF:1,parseError:function(e,t){if(!this.yy.parser)throw new Error(e);this.yy.parser.parseError(e,t)},setInput:function(e){return this._input=e,this._more=this._less=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var e=this._input[0];this.yytext+=e,this.yyleng++,this.offset++,this.match+=e,this.matched+=e;var t=e.match(/(?:\r\n?|\n).*/g);return t?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),e},unput:function(e){var t=e.length,i=e.split(/(?:\r\n?|\n)/g);this._input=e+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-t-1),this.offset-=t;var r=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),i.length-1&&(this.yylineno-=i.length-1);var n=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:i?(i.length===r.length?this.yylloc.first_column:0)+r[r.length-i.length].length-i[0].length:this.yylloc.first_column-t},this.options.ranges&&(this.yylloc.range=[n[0],n[0]+this.yyleng-t]),this},more:function(){return this._more=!0,this},less:function(e){this.unput(this.match.slice(e))},pastInput:function(){var e=this.matched.substr(0,this.matched.length-this.match.length);return(e.length>20?"...":"")+e.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var e=this.match;return e.length<20&&(e+=this._input.substr(0,20-e.length)),(e.substr(0,20)+(e.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var e=this.pastInput(),t=new Array(e.length+1).join("-");return e+this.upcomingInput()+"\n"+t+"^"},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var e,t,i,r,n;this._more||(this.yytext="",this.match="");for(var o=this._currentRules(),s=0;s<o.length&&(i=this._input.match(this.rules[o[s]]),!i||t&&!(i[0].length>t[0].length)||(t=i,r=s,this.options.flex));s++);return t?(n=t[0].match(/(?:\r\n?|\n).*/g),n&&(this.yylineno+=n.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:n?n[n.length-1].length-n[n.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+t[0].length},this.yytext+=t[0],this.match+=t[0],this.matches=t,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._input=this._input.slice(t[0].length),this.matched+=t[0],e=this.performAction.call(this,this.yy,this,o[r],this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),e?e:void 0):""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var e=this.next();return"undefined"!=typeof e?e:this.lex()},begin:function(e){this.conditionStack.push(e)},popState:function(){return this.conditionStack.pop()},_currentRules:function(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function(){return this.conditionStack[this.conditionStack.length-2]},pushState:function(e){this.begin(e)}};return e.options={},e.performAction=function(e,t,i,r){switch(i){case 0:return t.yytext="\\",14;case 1:if("\\"!==t.yytext.slice(-1)&&this.begin("mu"),"\\"===t.yytext.slice(-1)&&(t.yytext=t.yytext.substr(0,t.yyleng-1),this.begin("emu")),t.yytext)return 14;break;case 2:return 14;case 3:return"\\"!==t.yytext.slice(-1)&&this.popState(),"\\"===t.yytext.slice(-1)&&(t.yytext=t.yytext.substr(0,t.yyleng-1)),14;case 4:return t.yytext=t.yytext.substr(0,t.yyleng-4),this.popState(),15;case 5:return 25;case 6:return 16;case 7:return 20;case 8:return 19;case 9:return 19;case 10:return 23;case 11:return 22;case 12:this.popState(),this.begin("com");break;case 13:return t.yytext=t.yytext.substr(3,t.yyleng-5),this.popState(),15;case 14:return 22;case 15:return 37;case 16:return 36;case 17:return 36;case 18:return 40;case 19:break;case 20:return this.popState(),24;case 21:return this.popState(),18;case 22:return t.yytext=t.yytext.substr(1,t.yyleng-2).replace(/\\"/g,'"'),31;case 23:return t.yytext=t.yytext.substr(1,t.yyleng-2).replace(/\\'/g,"'"),31;case 24:return 38;case 25:return 33;case 26:return 33;case 27:return 32;case 28:return 36;case 29:return t.yytext=t.yytext.substr(1,t.yyleng-2),36;case 30:return"INVALID";case 31:return 5}},e.rules=[/^(?:\\\\(?=(\{\{)))/,/^(?:[^\x00]*?(?=(\{\{)))/,/^(?:[^\x00]+)/,/^(?:[^\x00]{2,}?(?=(\{\{|$)))/,/^(?:[\s\S]*?--\}\})/,/^(?:\{\{>)/,/^(?:\{\{#)/,/^(?:\{\{\/)/,/^(?:\{\{\^)/,/^(?:\{\{\s*else\b)/,/^(?:\{\{\{)/,/^(?:\{\{&)/,/^(?:\{\{!--)/,/^(?:\{\{![\s\S]*?\}\})/,/^(?:\{\{)/,/^(?:=)/,/^(?:\.(?=[}\/ ]))/,/^(?:\.\.)/,/^(?:[\/.])/,/^(?:\s+)/,/^(?:\}\}\})/,/^(?:\}\})/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:@)/,/^(?:true(?=[}\s]))/,/^(?:false(?=[}\s]))/,/^(?:-?[0-9]+(?=[}\s]))/,/^(?:[^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=[=}\s\/.]))/,/^(?:\[[^\]]*\])/,/^(?:.)/,/^(?:$)/],e.conditions={mu:{rules:[5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31],inclusive:!1},emu:{rules:[3],inclusive:!1},com:{rules:[4],inclusive:!1},INITIAL:{rules:[0,1,2,31],inclusive:!0}},e}();return t.lexer=i,e.prototype=t,t.Parser=e,new e}();e.Parser=o,e.parse=function(t){return t.constructor===e.AST.ProgramNode?t:(e.Parser.yy=e.AST,e.Parser.parse(t))},e.AST={},e.AST.ProgramNode=function(t,i){this.type="program",this.statements=t,i&&(this.inverse=new e.AST.ProgramNode(i))},e.AST.MustacheNode=function(e,t,i){this.type="mustache",this.escaped=!i,this.hash=t;var r=this.id=e[0],n=this.params=e.slice(1),o=this.eligibleHelper=r.isSimple;this.isHelper=o&&(n.length||t)},e.AST.PartialNode=function(e,t){this.type="partial",this.partialName=e,this.context=t},e.AST.BlockNode=function(t,i,r,n){var o=function(t,i){if(t.original!==i.original)throw new e.Exception(t.original+" doesn't match "+i.original)};o(t.id,n),this.type="block",this.mustache=t,this.program=i,this.inverse=r,this.inverse&&!this.program&&(this.isInverse=!0)},e.AST.ContentNode=function(e){this.type="content",this.string=e},e.AST.HashNode=function(e){this.type="hash",this.pairs=e},e.AST.IdNode=function(t){this.type="ID";for(var i="",r=[],n=0,o=0,s=t.length;s>o;o++){var a=t[o].part;if(i+=(t[o].separator||"")+a,".."===a||"."===a||"this"===a){if(r.length>0)throw new e.Exception("Invalid path: "+i);".."===a?n++:this.isScoped=!0}else r.push(a)}this.original=i,this.parts=r,this.string=r.join("."),this.depth=n,this.isSimple=1===t.length&&!this.isScoped&&0===n,this.stringModeValue=this.string},e.AST.PartialNameNode=function(e){this.type="PARTIAL_NAME",this.name=e.original},e.AST.DataNode=function(e){this.type="DATA",this.id=e},e.AST.StringNode=function(e){this.type="STRING",this.original=this.string=this.stringModeValue=e},e.AST.IntegerNode=function(e){this.type="INTEGER",this.original=this.integer=e,this.stringModeValue=Number(e)},e.AST.BooleanNode=function(e){this.type="BOOLEAN",this.bool=e,this.stringModeValue="true"===e},e.AST.CommentNode=function(e){this.type="comment",this.comment=e};var s=["description","fileName","lineNumber","message","name","number","stack"];e.Exception=function(){for(var e=Error.prototype.constructor.apply(this,arguments),t=0;t<s.length;t++)this[s[t]]=e[s[t]]},e.Exception.prototype=new Error,e.SafeString=function(e){this.string=e},e.SafeString.prototype.toString=function(){return this.string.toString()};var a={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},l=/[&<>"'`]/g,d=/[&<>"'`]/,h=function(e){return a[e]||"&amp;"};e.Utils={extend:function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])},escapeExpression:function(t){return t instanceof e.SafeString?t.toString():null==t||t===!1?"":(t=t.toString(),d.test(t)?t.replace(l,h):t)},isEmpty:function(e){return e||0===e?"[object Array]"===i.call(e)&&0===e.length?!0:!1:!0}};var u=e.Compiler=function(){},c=e.JavaScriptCompiler=function(){};u.prototype={compiler:u,disassemble:function(){for(var e,t,i,r=this.opcodes,n=[],o=0,s=r.length;s>o;o++)if(e=r[o],"DECLARE"===e.opcode)n.push("DECLARE "+e.name+"="+e.value);else{t=[];for(var a=0;a<e.args.length;a++)i=e.args[a],"string"==typeof i&&(i='"'+i.replace("\n","\\n")+'"'),t.push(i);n.push(e.opcode+" "+t.join(" "))}return n.join("\n")},equals:function(e){var t=this.opcodes.length;if(e.opcodes.length!==t)return!1;for(var i=0;t>i;i++){var r=this.opcodes[i],n=e.opcodes[i];if(r.opcode!==n.opcode||r.args.length!==n.args.length)return!1;for(var o=0;o<r.args.length;o++)if(r.args[o]!==n.args[o])return!1}if(t=this.children.length,e.children.length!==t)return!1;for(i=0;t>i;i++)if(!this.children[i].equals(e.children[i]))return!1;return!0},guid:0,compile:function(e,t){this.children=[],this.depths={list:[]},this.options=t;var i=this.options.knownHelpers;if(this.options.knownHelpers={helperMissing:!0,blockHelperMissing:!0,each:!0,"if":!0,unless:!0,"with":!0,log:!0},i)for(var r in i)this.options.knownHelpers[r]=i[r];return this.program(e)},accept:function(e){return this[e.type](e)},program:function(e){var t,i=e.statements;this.opcodes=[];for(var r=0,n=i.length;n>r;r++)t=i[r],this[t.type](t);return this.isSimple=1===n,this.depths.list=this.depths.list.sort(function(e,t){return e-t}),this},compileProgram:function(e){var t,i=(new this.compiler).compile(e,this.options),r=this.guid++;this.usePartial=this.usePartial||i.usePartial,this.children[r]=i;for(var n=0,o=i.depths.list.length;o>n;n++)t=i.depths.list[n],2>t||this.addDepth(t-1);return r},block:function(e){var t=e.mustache,i=e.program,r=e.inverse;i&&(i=this.compileProgram(i)),r&&(r=this.compileProgram(r));var n=this.classifyMustache(t);"helper"===n?this.helperMustache(t,i,r):"simple"===n?(this.simpleMustache(t),this.opcode("pushProgram",i),this.opcode("pushProgram",r),this.opcode("emptyHash"),this.opcode("blockValue")):(this.ambiguousMustache(t,i,r),this.opcode("pushProgram",i),this.opcode("pushProgram",r),this.opcode("emptyHash"),this.opcode("ambiguousBlockValue")),this.opcode("append")},hash:function(e){var t,i,r=e.pairs;this.opcode("pushHash");for(var n=0,o=r.length;o>n;n++)t=r[n],i=t[1],this.options.stringParams?(i.depth&&this.addDepth(i.depth),this.opcode("getContext",i.depth||0),this.opcode("pushStringParam",i.stringModeValue,i.type)):this.accept(i),this.opcode("assignToHash",t[0]);this.opcode("popHash")},partial:function(e){var t=e.partialName;this.usePartial=!0,e.context?this.ID(e.context):this.opcode("push","depth0"),this.opcode("invokePartial",t.name),this.opcode("append")},content:function(e){this.opcode("appendContent",e.string)},mustache:function(e){var t=this.options,i=this.classifyMustache(e);"simple"===i?this.simpleMustache(e):"helper"===i?this.helperMustache(e):this.ambiguousMustache(e),this.opcode(e.escaped&&!t.noEscape?"appendEscaped":"append")},ambiguousMustache:function(e,t,i){var r=e.id,n=r.parts[0],o=null!=t||null!=i;this.opcode("getContext",r.depth),this.opcode("pushProgram",t),this.opcode("pushProgram",i),this.opcode("invokeAmbiguous",n,o)},simpleMustache:function(e){var t=e.id;"DATA"===t.type?this.DATA(t):t.parts.length?this.ID(t):(this.addDepth(t.depth),this.opcode("getContext",t.depth),this.opcode("pushContext")),this.opcode("resolvePossibleLambda")},helperMustache:function(e,t,i){var r=this.setupFullMustacheParams(e,t,i),n=e.id.parts[0];if(this.options.knownHelpers[n])this.opcode("invokeKnownHelper",r.length,n);else{if(this.options.knownHelpersOnly)throw new Error("You specified knownHelpersOnly, but used the unknown helper "+n);this.opcode("invokeHelper",r.length,n)}},ID:function(e){this.addDepth(e.depth),this.opcode("getContext",e.depth);var t=e.parts[0];t?this.opcode("lookupOnContext",e.parts[0]):this.opcode("pushContext");for(var i=1,r=e.parts.length;r>i;i++)this.opcode("lookup",e.parts[i])},DATA:function(t){if(this.options.data=!0,t.id.isScoped||t.id.depth)throw new e.Exception("Scoped data references are not supported: "+t.original);this.opcode("lookupData");for(var i=t.id.parts,r=0,n=i.length;n>r;r++)this.opcode("lookup",i[r])},STRING:function(e){this.opcode("pushString",e.string)},INTEGER:function(e){this.opcode("pushLiteral",e.integer)},BOOLEAN:function(e){this.opcode("pushLiteral",e.bool)},comment:function(){},opcode:function(e){this.opcodes.push({opcode:e,args:[].slice.call(arguments,1)})},declare:function(e,t){this.opcodes.push({opcode:"DECLARE",name:e,value:t})},addDepth:function(e){if(isNaN(e))throw new Error("EWOT");0!==e&&(this.depths[e]||(this.depths[e]=!0,this.depths.list.push(e)))},classifyMustache:function(e){var t=e.isHelper,i=e.eligibleHelper,r=this.options;if(i&&!t){var n=e.id.parts[0];r.knownHelpers[n]?t=!0:r.knownHelpersOnly&&(i=!1)}return t?"helper":i?"ambiguous":"simple"},pushParams:function(e){for(var t,i=e.length;i--;)t=e[i],this.options.stringParams?(t.depth&&this.addDepth(t.depth),this.opcode("getContext",t.depth||0),this.opcode("pushStringParam",t.stringModeValue,t.type)):this[t.type](t)},setupMustacheParams:function(e){var t=e.params;return this.pushParams(t),e.hash?this.hash(e.hash):this.opcode("emptyHash"),t},setupFullMustacheParams:function(e,t,i){var r=e.params;return this.pushParams(r),this.opcode("pushProgram",t),this.opcode("pushProgram",i),e.hash?this.hash(e.hash):this.opcode("emptyHash"),r}};var f=function(e){this.value=e};c.prototype={nameLookup:function(e,t){return/^[0-9]+$/.test(t)?e+"["+t+"]":c.isValidJavaScriptVariableName(t)?e+"."+t:e+"['"+t+"']"},appendToBuffer:function(e){return this.environment.isSimple?"return "+e+";":{appendToBuffer:!0,content:e,toString:function(){return"buffer += "+e+";"}}},initializeBuffer:function(){return this.quotedString("")},namespace:"Handlebars",compile:function(t,i,r,n){this.environment=t,this.options=i||{},e.log(e.logger.DEBUG,this.environment.disassemble()+"\n\n"),this.name=this.environment.name,this.isChild=!!r,this.context=r||{programs:[],environments:[],aliases:{}},this.preamble(),this.stackSlot=0,this.stackVars=[],this.registers={list:[]},this.compileStack=[],this.inlineStack=[],this.compileChildren(t,i);var o,s=t.opcodes;for(this.i=0,g=s.length;this.i<g;this.i++)o=s[this.i],"DECLARE"===o.opcode?this[o.name]=o.value:this[o.opcode].apply(this,o.args);return this.createFunctionContext(n)},nextOpcode:function(){var e=this.environment.opcodes;return e[this.i+1]},eat:function(){this.i=this.i+1},preamble:function(){var e=[];if(this.isChild)e.push("");else{var t=this.namespace,i="helpers = this.merge(helpers, "+t+".helpers);";this.environment.usePartial&&(i=i+" partials = this.merge(partials, "+t+".partials);"),this.options.data&&(i+=" data = data || {};"),e.push(i)}e.push(this.environment.isSimple?"":", buffer = "+this.initializeBuffer()),this.lastContext=0,this.source=e},createFunctionContext:function(t){var i=this.stackVars.concat(this.registers.list);if(i.length>0&&(this.source[1]=this.source[1]+", "+i.join(", ")),!this.isChild)for(var r in this.context.aliases)this.context.aliases.hasOwnProperty(r)&&(this.source[1]=this.source[1]+", "+r+"="+this.context.aliases[r]);this.source[1]&&(this.source[1]="var "+this.source[1].substring(2)+";"),this.isChild||(this.source[1]+="\n"+this.context.programs.join("\n")+"\n"),this.environment.isSimple||this.source.push("return buffer;");for(var n=this.isChild?["depth0","data"]:["Handlebars","depth0","helpers","partials","data"],o=0,s=this.environment.depths.list.length;s>o;o++)n.push("depth"+this.environment.depths.list[o]);var a=this.mergeSource();if(!this.isChild){var l=e.COMPILER_REVISION,d=e.REVISION_CHANGES[l];a="this.compilerInfo = ["+l+",'"+d+"'];\n"+a}if(t)return n.push(a),Function.apply(this,n);var h="function "+(this.name||"")+"("+n.join(",")+") {\n  "+a+"}";return e.log(e.logger.DEBUG,h+"\n\n"),h},mergeSource:function(){for(var e,i="",r=0,n=this.source.length;n>r;r++){var o=this.source[r];o.appendToBuffer?e=e?e+"\n    + "+o.content:o.content:(e&&(i+="buffer += "+e+";\n  ",e=t),i+=o+"\n  ")}return i},blockValue:function(){this.context.aliases.blockHelperMissing="helpers.blockHelperMissing";var e=["depth0"];this.setupParams(0,e),this.replaceStack(function(t){return e.splice(1,0,t),"blockHelperMissing.call("+e.join(", ")+")"})},ambiguousBlockValue:function(){this.context.aliases.blockHelperMissing="helpers.blockHelperMissing";var e=["depth0"];this.setupParams(0,e);var t=this.topStack();e.splice(1,0,t),e[e.length-1]="options",this.source.push("if (!"+this.lastHelper+") { "+t+" = blockHelperMissing.call("+e.join(", ")+"); }")},appendContent:function(e){this.source.push(this.appendToBuffer(this.quotedString(e)))},append:function(){this.flushInline();var e=this.popStack();this.source.push("if("+e+" || "+e+" === 0) { "+this.appendToBuffer(e)+" }"),this.environment.isSimple&&this.source.push("else { "+this.appendToBuffer("''")+" }")},appendEscaped:function(){this.context.aliases.escapeExpression="this.escapeExpression",this.source.push(this.appendToBuffer("escapeExpression("+this.popStack()+")"))},getContext:function(e){this.lastContext!==e&&(this.lastContext=e)},lookupOnContext:function(e){this.push(this.nameLookup("depth"+this.lastContext,e,"context"))},pushContext:function(){this.pushStackLiteral("depth"+this.lastContext)},resolvePossibleLambda:function(){this.context.aliases.functionType='"function"',this.replaceStack(function(e){return"typeof "+e+" === functionType ? "+e+".apply(depth0) : "+e})},lookup:function(e){this.replaceStack(function(t){return t+" == null || "+t+" === false ? "+t+" : "+this.nameLookup(t,e,"context")})},lookupData:function(){this.push("data")},pushStringParam:function(e,t){this.pushStackLiteral("depth"+this.lastContext),this.pushString(t),"string"==typeof e?this.pushString(e):this.pushStackLiteral(e)},emptyHash:function(){this.pushStackLiteral("{}"),this.options.stringParams&&(this.register("hashTypes","{}"),this.register("hashContexts","{}"))},pushHash:function(){this.hash={values:[],types:[],contexts:[]}},popHash:function(){var e=this.hash;this.hash=t,this.options.stringParams&&(this.register("hashContexts","{"+e.contexts.join(",")+"}"),this.register("hashTypes","{"+e.types.join(",")+"}")),this.push("{\n    "+e.values.join(",\n    ")+"\n  }")},pushString:function(e){this.pushStackLiteral(this.quotedString(e))},push:function(e){return this.inlineStack.push(e),e},pushLiteral:function(e){this.pushStackLiteral(e)},pushProgram:function(e){this.pushStackLiteral(null!=e?this.programExpression(e):null)},invokeHelper:function(e,t){this.context.aliases.helperMissing="helpers.helperMissing";var i=this.lastHelper=this.setupHelper(e,t,!0),r=this.nameLookup("depth"+this.lastContext,t,"context");this.push(i.name+" || "+r),this.replaceStack(function(e){return e+" ? "+e+".call("+i.callParams+") : helperMissing.call("+i.helperMissingParams+")"})},invokeKnownHelper:function(e,t){var i=this.setupHelper(e,t);this.push(i.name+".call("+i.callParams+")")},invokeAmbiguous:function(e,t){this.context.aliases.functionType='"function"',this.pushStackLiteral("{}");
var i=this.setupHelper(0,e,t),r=this.lastHelper=this.nameLookup("helpers",e,"helper"),n=this.nameLookup("depth"+this.lastContext,e,"context"),o=this.nextStack();this.source.push("if ("+o+" = "+r+") { "+o+" = "+o+".call("+i.callParams+"); }"),this.source.push("else { "+o+" = "+n+"; "+o+" = typeof "+o+" === functionType ? "+o+".apply(depth0) : "+o+"; }")},invokePartial:function(e){var t=[this.nameLookup("partials",e,"partial"),"'"+e+"'",this.popStack(),"helpers","partials"];this.options.data&&t.push("data"),this.context.aliases.self="this",this.push("self.invokePartial("+t.join(", ")+")")},assignToHash:function(e){var t,i,r=this.popStack();this.options.stringParams&&(i=this.popStack(),t=this.popStack());var n=this.hash;t&&n.contexts.push("'"+e+"': "+t),i&&n.types.push("'"+e+"': "+i),n.values.push("'"+e+"': ("+r+")")},compiler:c,compileChildren:function(e,t){for(var i,r,n=e.children,o=0,s=n.length;s>o;o++){i=n[o],r=new this.compiler;var a=this.matchExistingProgram(i);null==a?(this.context.programs.push(""),a=this.context.programs.length,i.index=a,i.name="program"+a,this.context.programs[a]=r.compile(i,t,this.context),this.context.environments[a]=i):(i.index=a,i.name="program"+a)}},matchExistingProgram:function(e){for(var t=0,i=this.context.environments.length;i>t;t++){var r=this.context.environments[t];if(r&&r.equals(e))return t}},programExpression:function(e){if(this.context.aliases.self="this",null==e)return"self.noop";for(var t,i=this.environment.children[e],r=i.depths.list,n=[i.index,i.name,"data"],o=0,s=r.length;s>o;o++)t=r[o],n.push(1===t?"depth0":"depth"+(t-1));return(0===r.length?"self.program(":"self.programWithDepth(")+n.join(", ")+")"},register:function(e,t){this.useRegister(e),this.source.push(e+" = "+t+";")},useRegister:function(e){this.registers[e]||(this.registers[e]=!0,this.registers.list.push(e))},pushStackLiteral:function(e){return this.push(new f(e))},pushStack:function(e){this.flushInline();var t=this.incrStack();return e&&this.source.push(t+" = "+e+";"),this.compileStack.push(t),t},replaceStack:function(e){var t,i="",r=this.isInline();if(r){var n=this.popStack(!0);if(n instanceof f)t=n.value;else{var o=this.stackSlot?this.topStackName():this.incrStack();i="("+this.push(o)+" = "+n+"),",t=this.topStack()}}else t=this.topStack();var s=e.call(this,t);return r?((this.inlineStack.length||this.compileStack.length)&&this.popStack(),this.push("("+i+s+")")):(/^stack/.test(t)||(t=this.nextStack()),this.source.push(t+" = ("+i+s+");")),t},nextStack:function(){return this.pushStack()},incrStack:function(){return this.stackSlot++,this.stackSlot>this.stackVars.length&&this.stackVars.push("stack"+this.stackSlot),this.topStackName()},topStackName:function(){return"stack"+this.stackSlot},flushInline:function(){var e=this.inlineStack;if(e.length){this.inlineStack=[];for(var t=0,i=e.length;i>t;t++){var r=e[t];r instanceof f?this.compileStack.push(r):this.pushStack(r)}}},isInline:function(){return this.inlineStack.length},popStack:function(e){var t=this.isInline(),i=(t?this.inlineStack:this.compileStack).pop();return!e&&i instanceof f?i.value:(t||this.stackSlot--,i)},topStack:function(e){var t=this.isInline()?this.inlineStack:this.compileStack,i=t[t.length-1];return!e&&i instanceof f?i.value:i},quotedString:function(e){return'"'+e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")+'"'},setupHelper:function(e,t,i){var r=[];this.setupParams(e,r,i);var n=this.nameLookup("helpers",t,"helper");return{params:r,name:n,callParams:["depth0"].concat(r).join(", "),helperMissingParams:i&&["depth0",this.quotedString(t)].concat(r).join(", ")}},setupParams:function(e,t,i){var r,n,o,s=[],a=[],l=[];s.push("hash:"+this.popStack()),n=this.popStack(),o=this.popStack(),(o||n)&&(o||(this.context.aliases.self="this",o="self.noop"),n||(this.context.aliases.self="this",n="self.noop"),s.push("inverse:"+n),s.push("fn:"+o));for(var d=0;e>d;d++)r=this.popStack(),t.push(r),this.options.stringParams&&(l.push(this.popStack()),a.push(this.popStack()));return this.options.stringParams&&(s.push("contexts:["+a.join(",")+"]"),s.push("types:["+l.join(",")+"]"),s.push("hashContexts:hashContexts"),s.push("hashTypes:hashTypes")),this.options.data&&s.push("data:data"),s="{"+s.join(",")+"}",i?(this.register("options",s),t.push("options")):t.push(s),t.join(", ")}};for(var m="break else new var case finally return void catch for switch while continue function this with default if throw delete in try do instanceof typeof abstract enum int short boolean export interface static byte extends long super char final native synchronized class float package throws const goto private transient debugger implements protected volatile double import public let yield".split(" "),p=c.RESERVED_WORDS={},_=0,g=m.length;g>_;_++)p[m[_]]=!0;c.isValidJavaScriptVariableName=function(e){return!c.RESERVED_WORDS[e]&&/^[a-zA-Z_$][0-9a-zA-Z_$]+$/.test(e)?!0:!1},e.precompile=function(t,i){if(null==t||"string"!=typeof t&&t.constructor!==e.AST.ProgramNode)throw new e.Exception("You must pass a string or Handlebars AST to Handlebars.precompile. You passed "+t);i=i||{},"data"in i||(i.data=!0);var r=e.parse(t),n=(new u).compile(r,i);return(new c).compile(n,i)},e.compile=function(i,r){function n(){var n=e.parse(i),o=(new u).compile(n,r),s=(new c).compile(o,r,t,!0);return e.template(s)}if(null==i||"string"!=typeof i&&i.constructor!==e.AST.ProgramNode)throw new e.Exception("You must pass a string or Handlebars AST to Handlebars.compile. You passed "+i);r=r||{},"data"in r||(r.data=!0);var o;return function(e,t){return o||(o=n()),o.call(this,e,t)}},e.VM={template:function(t){var i={escapeExpression:e.Utils.escapeExpression,invokePartial:e.VM.invokePartial,programs:[],program:function(t,i,r){var n=this.programs[t];return r?n=e.VM.program(t,i,r):n||(n=this.programs[t]=e.VM.program(t,i)),n},merge:function(t,i){var r=t||i;return t&&i&&(r={},e.Utils.extend(r,i),e.Utils.extend(r,t)),r},programWithDepth:e.VM.programWithDepth,noop:e.VM.noop,compilerInfo:null};return function(r,n){n=n||{};var o=t.call(i,e,r,n.helpers,n.partials,n.data),s=i.compilerInfo||[],a=s[0]||1,l=e.COMPILER_REVISION;if(a!==l){if(l>a){var d=e.REVISION_CHANGES[l],h=e.REVISION_CHANGES[a];throw"Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+d+") or downgrade your runtime to an older version ("+h+")."}throw"Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+s[1]+")."}return o}},programWithDepth:function(e,t,i){var r=Array.prototype.slice.call(arguments,3),n=function(e,n){return n=n||{},t.apply(this,[e,n.data||i].concat(r))};return n.program=e,n.depth=r.length,n},program:function(e,t,i){var r=function(e,r){return r=r||{},t(e,r.data||i)};return r.program=e,r.depth=0,r},noop:function(){return""},invokePartial:function(i,r,n,o,s,a){var l={helpers:o,partials:s,data:a};if(i===t)throw new e.Exception("The partial "+r+" could not be found");if(i instanceof Function)return i(n,l);if(e.compile)return s[r]=e.compile(i,{data:a!==t}),s[r](n,l);throw new e.Exception("The partial "+r+" could not be compiled when running in runtime-only mode")}},e.template=e.VM.template}(Handlebars),function(){var e,t,i,r,n;!function(){if(n=this.Ember=this.Ember||{},"undefined"==typeof n&&(n={}),"undefined"==typeof n.__loader){var o={},s={};e=function(e,t,i){o[e]={deps:t,callback:i}},r=i=t=function(e){function i(t){if("."!==t.charAt(0))return t;for(var i=t.split("/"),r=e.split("/").slice(0,-1),n=0,o=i.length;o>n;n++){var s=i[n];if(".."===s)r.pop();else{if("."===s)continue;r.push(s)}}return r.join("/")}if(s.hasOwnProperty(e))return s[e];if(s[e]={},!o[e])throw new Error("Could not find module "+e);for(var r,n=o[e],a=n.deps,l=n.callback,d=[],h=0,u=a.length;u>h;h++)d.push("exports"===a[h]?r={}:t(i(a[h])));var c=l.apply(this,d);return s[e]=r||c},r._eak_seen=o,n.__loader={define:e,require:i,registry:o}}else e=n.__loader.define,r=i=t=n.__loader.require}(),function(){e("ember-debug",["ember-metal/core","ember-metal/error","ember-metal/logger"],function(e,t,i){"use strict";var r=e["default"],n=t["default"],o=i["default"];if(r.assert=function(e,t){if(!t)throw new n("Assertion Failed: "+e)},r.warn=function(e,t){t||(o.warn("WARNING: "+e),"trace"in o&&o.trace())},r.debug=function(e){o.debug("DEBUG: "+e)},r.deprecate=function(e,t){if(!t){if(r.ENV.RAISE_ON_DEPRECATION)throw new n(e);var i;try{__fail__.fail()}catch(s){i=s}if(r.LOG_STACKTRACE_ON_DEPRECATION&&i.stack){var a,l="";i.arguments?(a=i.stack.replace(/^\s+at\s+/gm,"").replace(/^([^\(]+?)([\n$])/gm,"{anonymous}($1)$2").replace(/^Object.<anonymous>\s*\(([^\)]+)\)/gm,"{anonymous}($1)").split("\n"),a.shift()):a=i.stack.replace(/(?:\n@:0)?\s+$/m,"").replace(/^\(/gm,"{anonymous}(").split("\n"),l="\n    "+a.slice(2).join("\n    "),e+=l}o.warn("DEPRECATION: "+e)}},r.deprecateFunc=function(e,t){return function(){return r.deprecate(e),t.apply(this,arguments)}},r.runInDebug=function(e){e()},!r.testing){var s="undefined"!=typeof InstallTrigger,a=!!window.chrome&&!window.opera;"undefined"!=typeof window&&(s||a)&&window.addEventListener&&window.addEventListener("load",function(){if(document.documentElement&&document.documentElement.dataset&&!document.documentElement.dataset.emberExtension){var e;a?e="https://chrome.google.com/webstore/detail/ember-inspector/bmdblncegkenkacieihfhpjfppoconhi":s&&(e="https://addons.mozilla.org/en-US/firefox/addon/ember-inspector/"),r.debug("For more advanced debugging, install the Ember Inspector from "+e)}},!1)}})}(),function(){e("ember-metal/array",["exports"],function(e){"use strict";var t=Array.prototype,i=function(e){return e&&Function.prototype.toString.call(e).indexOf("[native code]")>-1},r=i(t.map)?t.map:function(e){if(void 0===this||null===this)throw new TypeError;var t=Object(this),i=t.length>>>0;if("function"!=typeof e)throw new TypeError;for(var r=new Array(i),n=arguments[1],o=0;i>o;o++)o in t&&(r[o]=e.call(n,t[o],o,t));return r},o=i(t.forEach)?t.forEach:function(e){if(void 0===this||null===this)throw new TypeError;var t=Object(this),i=t.length>>>0;if("function"!=typeof e)throw new TypeError;for(var r=arguments[1],n=0;i>n;n++)n in t&&e.call(r,t[n],n,t)},s=i(t.indexOf)?t.indexOf:function(e,t){null===t||void 0===t?t=0:0>t&&(t=Math.max(0,this.length+t));for(var i=t,r=this.length;r>i;i++)if(this[i]===e)return i;return-1},a=i(t.filter)?t.filter:function(e,t){var i,r,n=[],o=this.length;for(i=0;o>i;i++)this.hasOwnProperty(i)&&(r=this[i],e.call(t,r,i,this)&&n.push(r));return n};n.SHIM_ES5&&(t.map||(t.map=r),t.forEach||(t.forEach=o),t.filter||(t.filter=a),t.indexOf||(t.indexOf=s)),e.map=r,e.forEach=o,e.filter=a,e.indexOf=s}),e("ember-metal/binding",["ember-metal/core","ember-metal/property_get","ember-metal/property_set","ember-metal/utils","ember-metal/map","ember-metal/observer","ember-metal/run_loop","exports"],function(e,t,i,r,n,o,s,a){"use strict";function l(e){return w.test(e)}function d(e,t){return m(l(t)?f.lookup:e,t)}function h(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])}function u(e,t,i){return new T(t,i).connect(e)}function c(e,t,i){return new T(t,i).oneWay().connect(e)}var f=e["default"],m=t.get,p=(i.set,i.trySet),_=r.guidFor,g=n.Map,v=o.addObserver,y=o.removeObserver,b=o._suspendObserver,x=s["default"];f.LOG_BINDINGS=!1||!!f.ENV.LOG_BINDINGS;var w=/^([A-Z$]|([0-9][A-Z$]))/,T=function(e,t){this._direction="fwd",this._from=t,this._to=e,this._directionMap=g.create()};T.prototype={copy:function(){var e=new T(this._to,this._from);return this._oneWay&&(e._oneWay=!0),e},from:function(e){return this._from=e,this},to:function(e){return this._to=e,this},oneWay:function(){return this._oneWay=!0,this},toString:function(){var e=this._oneWay?"[oneWay]":"";return"Ember.Binding<"+_(this)+">("+this._from+" -> "+this._to+")"+e},connect:function(e){f.assert("Must pass a valid object to Ember.Binding.connect()",!!e);var t=this._from,i=this._to;return p(e,i,d(e,t)),v(e,t,this,this.fromDidChange),this._oneWay||v(e,i,this,this.toDidChange),this._readyToSync=!0,this},disconnect:function(e){f.assert("Must pass a valid object to Ember.Binding.disconnect()",!!e);var t=!this._oneWay;return y(e,this._from,this,this.fromDidChange),t&&y(e,this._to,this,this.toDidChange),this._readyToSync=!1,this},fromDidChange:function(e){this._scheduleSync(e,"fwd")},toDidChange:function(e){this._scheduleSync(e,"back")},_scheduleSync:function(e,t){var i=this._directionMap,r=i.get(e);r||(x.schedule("sync",this,this._sync,e),i.set(e,t)),"back"===r&&"fwd"===t&&i.set(e,"fwd")},_sync:function(e){var t=f.LOG_BINDINGS;if(!e.isDestroyed&&this._readyToSync){var i=this._directionMap,r=i.get(e),n=this._from,o=this._to;if(i.remove(e),"fwd"===r){var s=d(e,this._from);t&&f.Logger.log(" ",this.toString(),"->",s,e),this._oneWay?p(e,o,s):b(e,o,this,this.toDidChange,function(){p(e,o,s)})}else if("back"===r){var a=m(e,this._to);t&&f.Logger.log(" ",this.toString(),"<-",a,e),b(e,n,this,this.fromDidChange,function(){p(l(n)?f.lookup:e,n,a)})}}}},h(T,{from:function(){var e=this,t=new e;return t.from.apply(t,arguments)},to:function(){var e=this,t=new e;return t.to.apply(t,arguments)},oneWay:function(e,t){var i=this,r=new i(null,e);return r.oneWay(t)}}),a.Binding=T,a.bind=u,a.oneWay=c,a.isGlobalPath=l}),e("ember-metal/chains",["ember-metal/core","ember-metal/property_get","ember-metal/utils","ember-metal/array","ember-metal/watch_key","exports"],function(e,t,i,r,n,o){"use strict";function s(e){return e.match(T)[0]}function a(){if(0!==E.length){var e=E;E=[],v.call(e,function(e){e[0].add(e[1])}),w("Watching an undefined global, Ember expects watched globals to be setup by the time the run loop is flushed, check for typos",0===E.length)}}function l(e,t,i){if(e&&"object"==typeof e){var r=x(e),n=r.chainWatchers;r.hasOwnProperty("chainWatchers")||(n=r.chainWatchers={}),n[t]||(n[t]=[]),n[t].push(i),y(e,t,r)}}function d(e,t,i){if(e&&"object"==typeof e){var r=e[g];if(!r||r.hasOwnProperty("chainWatchers")){var n=r&&r.chainWatchers;if(n&&n[t]){n=n[t];for(var o=0,s=n.length;s>o;o++)n[o]===i&&n.splice(o,1)}b(e,t,r)}}}function h(e,t,i){this._parent=e,this._key=t,this._watching=void 0===i,this._value=i,this._paths={},this._watching&&(this._object=e.value(),this._object&&l(this._object,this._key,this)),this._parent&&"@each"===this._parent._key&&this.value()}function u(e,t){if(!e)return void 0;var i=e[g];if(i&&i.proto===e)return void 0;if("@each"===t)return m(e,t);var r=i&&i.descs[t];return r&&r._cacheable?t in i.cache?i.cache[t]:void 0:m(e,t)}function c(e){var t=e[g],i=t&&t.chains;i&&(i.value()!==e?x(e).chains=i=i.copy(e):i.didChange(null))}var f=e["default"],m=t.get,p=t.normalizeTuple,_=i.meta,g=i.META_KEY,v=r.forEach,y=n.watchKey,b=n.unwatchKey,x=_,w=f.warn,T=/^([^\.]+)/,E=[],C=h.prototype;C.value=function(){if(void 0===this._value&&this._watching){var e=this._parent.value();this._value=u(e,this._key)}return this._value},C.destroy=function(){if(this._watching){var e=this._object;e&&d(e,this._key,this),this._watching=!1}},C.copy=function(e){var t,i=new h(null,null,e),r=this._paths;for(t in r)r[t]<=0||i.add(t);return i},C.add=function(e){var t,i,r,n,o;if(o=this._paths,o[e]=(o[e]||0)+1,t=this.value(),i=p(t,e),i[0]&&i[0]===t)e=i[1],r=s(e),e=e.slice(r.length+1);else{if(!i[0])return E.push([this,e]),void(i.length=0);n=i[0],r=e.slice(0,0-(i[1].length+1)),e=i[1]}i.length=0,this.chain(r,e,n)},C.remove=function(e){var t,i,r,n,o;o=this._paths,o[e]>0&&o[e]--,t=this.value(),i=p(t,e),i[0]===t?(e=i[1],r=s(e),e=e.slice(r.length+1)):(n=i[0],r=e.slice(0,0-(i[1].length+1)),e=i[1]),i.length=0,this.unchain(r,e)},C.count=0,C.chain=function(e,t,i){var r,n=this._chains;n||(n=this._chains={}),r=n[e],r||(r=n[e]=new h(this,e,i)),r.count++,t&&t.length>0&&(e=s(t),t=t.slice(e.length+1),r.chain(e,t))},C.unchain=function(e,t){var i=this._chains,r=i[e];t&&t.length>1&&(e=s(t),t=t.slice(e.length+1),r.unchain(e,t)),r.count--,r.count<=0&&(delete i[r._key],r.destroy())},C.willChange=function(e){var t=this._chains;if(t)for(var i in t)t.hasOwnProperty(i)&&t[i].willChange(e);this._parent&&this._parent.chainWillChange(this,this._key,1,e)},C.chainWillChange=function(e,t,i,r){this._key&&(t=this._key+"."+t),this._parent?this._parent.chainWillChange(this,t,i+1,r):(i>1&&r.push(this.value(),t),t="this."+t,this._paths[t]>0&&r.push(this.value(),t))},C.chainDidChange=function(e,t,i,r){this._key&&(t=this._key+"."+t),this._parent?this._parent.chainDidChange(this,t,i+1,r):(i>1&&r.push(this.value(),t),t="this."+t,this._paths[t]>0&&r.push(this.value(),t))},C.didChange=function(e){if(this._watching){var t=this._parent.value();t!==this._object&&(d(this._object,this._key,this),this._object=t,l(t,this._key,this)),this._value=void 0,this._parent&&"@each"===this._parent._key&&this.value()}var i=this._chains;if(i)for(var r in i)i.hasOwnProperty(r)&&i[r].didChange(e);null!==e&&this._parent&&this._parent.chainDidChange(this,this._key,1,e)},o.flushPendingChains=a,o.removeChainWatcher=d,o.ChainNode=h,o.finishChains=c}),e("ember-metal/computed",["ember-metal/core","ember-metal/property_get","ember-metal/property_set","ember-metal/utils","ember-metal/enumerable_utils","ember-metal/platform","ember-metal/watching","ember-metal/expand_properties","ember-metal/error","ember-metal/properties","ember-metal/property_events","ember-metal/is_empty","ember-metal/is_none","exports"],function(e,t,i,r,n,o,s,a,l,d,h,u,c,f){"use strict";function m(){}function p(e,t){var i=e[t];return i?e.hasOwnProperty(t)||(i=e[t]=H(i)):i=e[t]={},i}function _(e){return p(e,"deps")}function g(e,t,i,r){var n,o,s,a,l,d=e._dependentKeys;if(d)for(n=_(r),o=0,s=d.length;s>o;o++)a=d[o],l=p(n,a),l[i]=(l[i]||0)+1,I(t,a,r)}function v(e,t,i,r){var n,o,s,a,l,d=e._dependentKeys;if(d)for(n=_(r),o=0,s=d.length;s>o;o++)a=d[o],l=p(n,a),l[i]=(l[i]||0)-1,P(t,a,r)}function y(e,t){e.__ember_arity__=e.length,this.func=e,this._cacheable=t&&void 0!==t.cacheable?t.cacheable:!0,this._dependentKeys=t&&t.dependentKeys,this._readOnly=t&&(void 0!==t.readOnly||!!t.readOnly)||!1}function b(e){for(var t=0,i=e.length;i>t;t++)e[t].didChange(null)}function x(e){var t;if(arguments.length>1&&(t=X.call(arguments,0,-1),e=X.call(arguments,-1)[0]),"function"!=typeof e)throw new V("Computed Property declared without a property function");var i=new y(e);return t&&i.property.apply(i,t),i}function w(e,t){var i=e[N],r=i&&i.cache,n=r&&r[t];return n===m?void 0:n}function T(e,t){for(var i={},r=0;r<t.length;r++)i[t[r]]=F(e,t[r]);return i}function E(e,t){x[e]=function(e){var i=X.call(arguments);return x(e,function(){return t.apply(this,i)})}}function C(e,t){x[e]=function(){var e=X.call(arguments),i=x(function(){return t.apply(this,[T(this,e)])});return i.property.apply(i,e)}}var S=e["default"],F=t.get,M=i.set,A=r.meta,N=r.META_KEY,R=(r.guidFor,r.typeOf,r.inspect),D=(n["default"],o.create),I=s.watch,P=s.unwatch,k=a["default"],V=l["default"],O=d.Descriptor,L=d.defineProperty,B=h.propertyWillChange,U=h.propertyDidChange,z=u["default"],j=c.isNone;S.warn("The CP_DEFAULT_CACHEABLE flag has been removed and computed properties are always cached by default. Use `volatile` if you don't want caching.",S.ENV.CP_DEFAULT_CACHEABLE!==!1);var G=A,X=[].slice,H=D;y.prototype=new O;var Y=y.prototype;Y._dependentKeys=void 0,Y._suspended=void 0,Y._meta=void 0,Y.cacheable=function(e){return this._cacheable=e!==!1,this},Y.volatile=function(){return this.cacheable(!1)},Y.readOnly=function(e){return this._readOnly=void 0===e||!!e,this},Y.property=function(){var e,t=function(t){e.push(t)};e=[];for(var i=0,r=arguments.length;r>i;i++)k(arguments[i],t);return this._dependentKeys=e,this},Y.meta=function(e){return 0===arguments.length?this._meta||{}:(this._meta=e,this)},Y.didChange=function(e,t){if(this._cacheable&&this._suspended!==e){var i=G(e);void 0!==i.cache[t]&&(i.cache[t]=void 0,v(this,e,t,i))}},Y.get=function(e,t){var i,r,n,o;if(this._cacheable){n=G(e),r=n.cache;var s=r[t];if(s===m)return void 0;if(void 0!==s)return s;i=this.func.call(e,t),r[t]=void 0===i?m:i,o=n.chainWatchers&&n.chainWatchers[t],o&&b(o),g(this,e,t,n)}else i=this.func.call(e,t);return i},Y.set=function(e,t,i){var r,n,o,s=this._cacheable,a=this.func,l=G(e,s),d=this._suspended,h=!1,u=l.cache;if(this._readOnly)throw new V('Cannot set read-only property "'+t+'" on object: '+R(e));this._suspended=e;try{if(s&&void 0!==u[t]&&(n=u[t],h=!0),r=a.wrappedFunction?a.wrappedFunction.__ember_arity__:a.__ember_arity__,3===r)o=a.call(e,t,i,n);else{if(2!==r)return L(e,t,null,n),void M(e,t,i);o=a.call(e,t,i)}if(h&&n===o)return;var c=l.watching[t];c&&B(e,t),h&&(u[t]=void 0),s&&(h||g(this,e,t,l),u[t]=void 0===o?m:o),c&&U(e,t)}finally{this._suspended=d}return o},Y.teardown=function(e,t){var i=G(e);return t in i.cache&&v(this,e,t,i),this._cacheable&&delete i.cache[t],null},w.set=function(e,t,i){e[t]=void 0===i?m:i},w.get=function(e,t){var i=e[t];return i===m?void 0:i},w.remove=function(e,t){e[t]=void 0},x.empty=function(e){return x(e+".length",function(){return z(F(this,e))})},E("notEmpty",function(e){return!z(F(this,e))}),E("none",function(e){return j(F(this,e))}),E("not",function(e){return!F(this,e)}),E("bool",function(e){return!!F(this,e)}),E("match",function(e,t){var i=F(this,e);return"string"==typeof i?t.test(i):!1}),E("equal",function(e,t){return F(this,e)===t}),E("gt",function(e,t){return F(this,e)>t}),E("gte",function(e,t){return F(this,e)>=t}),E("lt",function(e,t){return F(this,e)<t}),E("lte",function(e,t){return F(this,e)<=t}),C("and",function(e){for(var t in e)if(e.hasOwnProperty(t)&&!e[t])return!1;return!0}),C("or",function(e){for(var t in e)if(e.hasOwnProperty(t)&&e[t])return!0;return!1}),C("any",function(e){for(var t in e)if(e.hasOwnProperty(t)&&e[t])return e[t];return null}),C("collect",function(e){var t=[];for(var i in e)e.hasOwnProperty(i)&&t.push(j(e[i])?null:e[i]);return t}),x.alias=function(e){return x(e,function(t,i){return arguments.length>1?(M(this,e,i),F(this,e)):F(this,e)})},x.oneWay=function(e){return x(e,function(){return F(this,e)})},x.readOnly=function(e){return x(e,function(){return F(this,e)}).readOnly()},x.defaultTo=function(e){return x(function(t,i){return 1===arguments.length?F(this,e):null!=i?i:F(this,e)})},f.ComputedProperty=y,f.computed=x,f.cacheFor=w}),e("ember-metal/core",["exports"],function(e){"use strict";"undefined"==typeof n&&(n={});{var t=(n.imports=n.imports||this,n.exports=n.exports||this);n.lookup=n.lookup||this}t.Em=t.Ember=n,n.isNamespace=!0,n.toString=function(){return"Ember"},n.VERSION="1.6.1",n.ENV||(n.ENV="undefined"!=typeof EmberENV?EmberENV:"undefined"!=typeof ENV?ENV:{}),n.config=n.config||{},"undefined"==typeof n.ENV.DISABLE_RANGE_API&&(n.ENV.DISABLE_RANGE_API=!0),"undefined"==typeof MetamorphENV&&(t.MetamorphENV={}),MetamorphENV.DISABLE_RANGE_API=n.ENV.DISABLE_RANGE_API,n.FEATURES=n.ENV.FEATURES||{},n.FEATURES.isEnabled=function(e){var t=n.FEATURES[e];return n.ENV.ENABLE_ALL_FEATURES?!0:t===!0||t===!1||void 0===t?t:n.ENV.ENABLE_OPTIONAL_FEATURES?!0:!1},n.EXTEND_PROTOTYPES=n.ENV.EXTEND_PROTOTYPES,"undefined"==typeof n.EXTEND_PROTOTYPES&&(n.EXTEND_PROTOTYPES=!0),n.LOG_STACKTRACE_ON_DEPRECATION=n.ENV.LOG_STACKTRACE_ON_DEPRECATION!==!1,n.SHIM_ES5=n.ENV.SHIM_ES5===!1?!1:n.EXTEND_PROTOTYPES,n.LOG_VERSION=n.ENV.LOG_VERSION===!1?!1:!0,n.K=function(){return this},"undefined"==typeof n.assert&&(n.assert=n.K),"undefined"==typeof n.warn&&(n.warn=n.K),"undefined"==typeof n.debug&&(n.debug=n.K),"undefined"==typeof n.runInDebug&&(n.runInDebug=n.K),"undefined"==typeof n.deprecate&&(n.deprecate=n.K),"undefined"==typeof n.deprecateFunc&&(n.deprecateFunc=function(e,t){return t}),n.uuid=0,e["default"]=n}),e("ember-metal/enumerable_utils",["ember-metal/array","exports"],function(e,t){"use strict";var i,r,n,o,s,i=e.map,r=e.forEach,n=e.indexOf,s=e.filter;i=Array.prototype.map||i,r=Array.prototype.forEach||r,n=Array.prototype.indexOf||n,s=Array.prototype.filter||s,o=Array.prototype.splice;var a={map:function(e,t,r){return e.map?e.map.call(e,t,r):i.call(e,t,r)},forEach:function(e,t,i){return e.forEach?e.forEach.call(e,t,i):r.call(e,t,i)},filter:function(e,t,i){return e.filter?e.filter.call(e,t,i):s.call(e,t,i)},indexOf:function(e,t,i){return e.indexOf?e.indexOf.call(e,t,i):n.call(e,t,i)},indexesOf:function(e,t){return void 0===t?[]:a.map(t,function(t){return a.indexOf(e,t)})},addObject:function(e,t){var i=a.indexOf(e,t);-1===i&&e.push(t)},removeObject:function(e,t){var i=a.indexOf(e,t);-1!==i&&e.splice(i,1)},_replace:function(e,t,i,r){for(var n,s,a=[].concat(r),l=[],d=6e4,h=t,u=i;a.length;)s=u>d?d:u,0>=s&&(s=0),n=a.splice(0,d),n=[h,s].concat(n),h+=d,u-=s,l=l.concat(o.apply(e,n));return l},replace:function(e,t,i,r){return e.replace?e.replace(t,i,r):a._replace(e,t,i,r)},intersection:function(e,t){var i=[];return a.forEach(e,function(e){a.indexOf(t,e)>=0&&i.push(e)}),i}};t["default"]=a}),e("ember-metal/error",["ember-metal/platform","exports"],function(e,t){"use strict";var i=e.create,r=["description","fileName","lineNumber","message","name","number","stack"],o=function(){var e=Error.apply(this,arguments);Error.captureStackTrace&&Error.captureStackTrace(this,n.Error);for(var t=0;t<r.length;t++)this[r[t]]=e[r[t]]};o.prototype=i(Error.prototype),t["default"]=o}),e("ember-metal/events",["ember-metal/core","ember-metal/utils","ember-metal/platform","exports"],function(e,t,i,r){"use strict";function n(e,t,i){for(var r=-1,n=e.length-3;n>=0;n-=3)if(t===e[n]&&i===e[n+1]){r=n;break}return r}function o(e,t){var i,r=C(e,!0);return r.listeners||(r.listeners={}),r.hasOwnProperty("listeners")||(r.listeners=T(r.listeners)),i=r.listeners[t],i&&!r.listeners.hasOwnProperty(t)?i=r.listeners[t]=r.listeners[t].slice():i||(i=r.listeners[t]=[]),i}function s(e,t,i){var r=e[y],o=r&&r.listeners&&r.listeners[t];if(o)for(var s=o.length-3;s>=0;s-=3){var a=o[s],l=o[s+1],d=o[s+2],h=n(i,a,l);-1===h&&i.push(a,l,d)}}function a(e,t,i){var r=e[y],o=r&&r.listeners&&r.listeners[t],s=[];if(o){for(var a=o.length-3;a>=0;a-=3){var l=o[a],d=o[a+1],h=o[a+2],u=n(i,l,d);-1===u&&(i.push(l,d,h),s.push(l,d,h))}return s}}function l(e,t,i,r,s){g.assert("You must pass at least an object and event name to Ember.addListener",!!e&&!!t),r||"function"!=typeof i||(r=i,i=null);var a=o(e,t),l=n(a,i,r),d=0;s&&(d|=S),-1===l&&(a.push(i,r,d),"function"==typeof e.didAddListener&&e.didAddListener(t,i,r))}function d(e,t,i,r){function s(i,r){var s=o(e,t),a=n(s,i,r);-1!==a&&(s.splice(a,3),"function"==typeof e.didRemoveListener&&e.didRemoveListener(t,i,r))}if(g.assert("You must pass at least an object and event name to Ember.removeListener",!!e&&!!t),r||"function"!=typeof i||(r=i,i=null),r)s(i,r);else{var a=e[y],l=a&&a.listeners&&a.listeners[t];if(!l)return;for(var d=l.length-3;d>=0;d-=3)s(l[d],l[d+1])}}function h(e,t,i,r,s){function a(){return s.call(i)}function l(){-1!==h&&(d[h+2]&=~F)}r||"function"!=typeof i||(r=i,i=null);var d=o(e,t),h=n(d,i,r);return-1!==h&&(d[h+2]|=F),b(a,l)}function u(e,t,i,r,s){function a(){return s.call(i)}function l(){for(var e=0,t=f.length;t>e;e++){var i=f[e];m[e][i+2]&=~F}}r||"function"!=typeof i||(r=i,i=null);var d,h,u,c,f=[],m=[];for(u=0,c=t.length;c>u;u++){d=t[u],h=o(e,d);var p=n(h,i,r);-1!==p&&(h[p+2]|=F,f.push(p),m.push(h))}return b(a,l)}function c(e){var t=e[y].listeners,i=[];if(t)for(var r in t)t[r]&&i.push(r);return i}function f(e,t,i,r){if(e!==g&&"function"==typeof e.sendEvent&&e.sendEvent(t,i),!r){var n=e[y];r=n&&n.listeners&&n.listeners[t]}if(r){for(var o=r.length-3;o>=0;o-=3){var s=r[o],a=r[o+1],l=r[o+2];a&&(l&F||(l&S&&d(e,t,s,a),s||(s=e),"string"==typeof a?i?w(s,a,i):s[a]():i?x(s,a,i):a.call(s)))}return!0}}function m(e,t){var i=e[y],r=i&&i.listeners&&i.listeners[t];return!(!r||!r.length)}function p(e,t){var i=[],r=e[y],n=r&&r.listeners&&r.listeners[t];if(!n)return i;for(var o=0,s=n.length;s>o;o+=3){var a=n[o],l=n[o+1];i.push([a,l])}return i}function _(){var e=E.call(arguments,-1)[0],t=E.call(arguments,0,-1);return e.__ember_listens__=t,e}var g=e["default"],v=t.meta,y=t.META_KEY,b=t.tryFinally,x=t.apply,w=t.applyStr,T=i.create,E=[].slice,C=v,S=1,F=2;r.on=_,r.addListener=l,r.removeListener=d,r.suspendListener=h,r.suspendListeners=u,r.sendEvent=f,r.hasListeners=m,r.watchedEvents=c,r.listenersFor=p,r.listenersDiff=a,r.listenersUnion=s}),e("ember-metal/expand_properties",["ember-metal/error","ember-metal/enumerable_utils","exports"],function(e,t,i){"use strict";function r(e,t){var i,r,o;if(e.indexOf(" ")>-1)throw new n("Brace expanded properties cannot contain spaces, e.g. `user.{firstName, lastName}` should be `user.{firstName,lastName}`");(i=a.exec(e))?(r=i[1],o=i[2],s(o.split(","),function(e){t(r+e)})):t(e)}var n=e["default"],o=t["default"],s=o.forEach,a=/^((?:[^\.]*\.)*)\{(.*)\}$/;i["default"]=r}),e("ember-metal/get_properties",["ember-metal/property_get","ember-metal/utils","exports"],function(e,t,i){"use strict";function r(e){var t={},i=arguments,r=1;2===arguments.length&&"array"===o(arguments[1])&&(r=0,i=arguments[1]);for(var s=i.length;s>r;r++)t[i[r]]=n(e,i[r]);return t}var n=e.get,o=t.typeOf;i["default"]=r}),e("ember-metal/instrumentation",["ember-metal/core","ember-metal/utils","exports"],function(e,t,i){"use strict";function r(e,t,i,r){function n(){for(_=0,g=m.length;g>_;_++)p=m[_],v[_]=p.before(e,c(),t);return i.call(r)}function o(e){t=t||{},t.exception=e}function s(){for(_=0,g=m.length;g>_;_++)p=m[_],p.after(e,c(),t,v[_]);a.STRUCTURED_PROFILE&&console.timeEnd(d)}var d,f,m=h[e];if(a.STRUCTURED_PROFILE&&(d=e+": "+t.object,console.time(d)),m||(m=u(e)),0===m.length)return f=i.call(r),a.STRUCTURED_PROFILE&&console.timeEnd(d),f;var p,_,g,v=[];return l(n,o,s)}function n(e,t){for(var i,r=e.split("."),n=[],o=0,s=r.length;s>o;o++)i=r[o],n.push("*"===i?"[^\\.]*":i);n=n.join("\\."),n+="(\\..*)?";var a={pattern:e,regex:new RegExp("^"+n+"$"),object:t};return d.push(a),h={},a}function o(e){for(var t,i=0,r=d.length;r>i;i++)d[i]===e&&(t=i);d.splice(t,1),h={}}function s(){d=[],h={}}var a=e["default"],l=t.tryCatchFinally,d=[],h={},u=function(e){for(var t,i=[],r=0,n=d.length;n>r;r++)t=d[r],t.regex.test(e)&&i.push(t.object);return h[e]=i,i},c=function(){var e="undefined"!=typeof window?window.performance||{}:{},t=e.now||e.mozNow||e.webkitNow||e.msNow||e.oNow;return t?t.bind(e):function(){return+new Date}}();i.instrument=r,i.subscribe=n,i.unsubscribe=o,i.reset=s}),e("ember-metal/is_blank",["ember-metal/core","ember-metal/is_empty","exports"],function(e,t,i){"use strict";function r(e){return n(e)||"string"==typeof e&&null===e.match(/\S/)}var n=(e["default"],t["default"]);i["default"]=r}),e("ember-metal/is_empty",["ember-metal/core","ember-metal/property_get","ember-metal/is_none","exports"],function(e,t,i,r){"use strict";var n=e["default"],o=t.get,s=i["default"],a=function(e){return s(e)||0===e.length&&"function"!=typeof e||"object"==typeof e&&0===o(e,"length")},l=n.deprecateFunc("Ember.empty is deprecated. Please use Ember.isEmpty instead.",a);r["default"]=a,r.isEmpty=a,r.empty=l}),e("ember-metal/is_none",["ember-metal/core","exports"],function(e,t){"use strict";var i=e["default"],r=function(e){return null===e||void 0===e},n=i.deprecateFunc("Ember.none is deprecated. Please use Ember.isNone instead.",r);t["default"]=r,t.isNone=r,t.none=n}),e("ember-metal/libraries",["ember-metal/enumerable_utils","exports"],function(e,t){"use strict";var i=e["default"],r=i.forEach,n=i.indexOf,o=function(){var e=[],t=0,i=function(t){for(var i=0;i<e.length;i++)if(e[i].name===t)return e[i]};return e.register=function(t,r){i(t)||e.push({name:t,version:r})},e.registerCoreLibrary=function(r,n){i(r)||e.splice(t++,0,{name:r,version:n})},e.deRegister=function(t){var r=i(t);r&&e.splice(n(e,r),1)},e.each=function(t){r(e,function(e){t(e.name,e.version)})},e}();t["default"]=o}),e("ember-metal/logger",["ember-metal/core","ember-metal/error","exports"],function(e,t,i){"use strict";function r(e){var t,i;o.imports.console?t=o.imports.console:"undefined"!=typeof console&&(t=console);var r="object"==typeof t?t[e]:null;return r?"function"==typeof r.apply?(i=function(){r.apply(t,arguments)
},i.displayName="console."+e,i):function(){var e=Array.prototype.join.call(arguments,", ");r(e)}:void 0}function n(e,t){if(!e)try{throw new s("assertion failed: "+t)}catch(i){setTimeout(function(){throw i},0)}}var o=e["default"],s=t["default"],a={log:r("log")||o.K,warn:r("warn")||o.K,error:r("error")||o.K,info:r("info")||o.K,debug:r("debug")||r("info")||o.K,assert:r("assert")||n};i["default"]=a}),e("ember-metal",["ember-metal/core","ember-metal/merge","ember-metal/instrumentation","ember-metal/utils","ember-metal/error","ember-metal/enumerable_utils","ember-metal/platform","ember-metal/array","ember-metal/logger","ember-metal/property_get","ember-metal/events","ember-metal/observer_set","ember-metal/property_events","ember-metal/properties","ember-metal/property_set","ember-metal/map","ember-metal/get_properties","ember-metal/set_properties","ember-metal/watch_key","ember-metal/chains","ember-metal/watch_path","ember-metal/watching","ember-metal/expand_properties","ember-metal/computed","ember-metal/observer","ember-metal/mixin","ember-metal/binding","ember-metal/run_loop","ember-metal/libraries","ember-metal/is_none","ember-metal/is_empty","ember-metal/is_blank","exports"],function(e,i,r,o,s,a,l,d,h,u,c,f,m,p,_,g,v,y,b,x,w,T,E,C,S,F,M,A,N,R,D,I,P){"use strict";var k=n.Instrumentation={};k.instrument=r.instrument,k.subscribe=r.subscribe,k.unsubscribe=r.unsubscribe,k.reset=r.reset,n.instrument=r.instrument,n.subscribe=r.subscribe,n.generateGuid=o.generateGuid,n.GUID_KEY=o.GUID_KEY,n.GUID_PREFIX=o.GUID_PREFIX,n.create=l.create,n.platform=l.platform;var V=n.ArrayPolyfills={};V.map=d.map,V.forEach=d.forEach,V.filter=d.filter,V.indexOf=d.indexOf,n.Error=s["default"],n.guidFor=o.guidFor,n.META_DESC=o.META_DESC,n.EMPTY_META=o.EMPTY_META,n.meta=o.meta,n.getMeta=o.getMeta,n.setMeta=o.setMeta,n.metaPath=o.metaPath,n.inspect=o.inspect,n.typeOf=o.typeOf,n.tryCatchFinally=o.tryCatchFinally,n.isArray=o.isArray,n.makeArray=o.makeArray,n.canInvoke=o.canInvoke,n.tryInvoke=o.tryInvoke,n.tryFinally=o.tryFinally,n.wrap=o.wrap,n.apply=o.apply,n.applyStr=o.applyStr,n.Logger=h["default"],n.get=u.get,n.getWithDefault=u.getWithDefault,n.normalizeTuple=u.normalizeTuple,n._getPath=u._getPath,n.EnumerableUtils=a["default"],n.on=c.on,n.addListener=c.addListener,n.removeListener=c.removeListener,n._suspendListener=c.suspendListener,n._suspendListeners=c.suspendListeners,n.sendEvent=c.sendEvent,n.hasListeners=c.hasListeners,n.watchedEvents=c.watchedEvents,n.listenersFor=c.listenersFor,n.listenersDiff=c.listenersDiff,n.listenersUnion=c.listenersUnion,n._ObserverSet=f["default"],n.propertyWillChange=m.propertyWillChange,n.propertyDidChange=m.propertyDidChange,n.overrideChains=m.overrideChains,n.beginPropertyChanges=m.beginPropertyChanges,n.endPropertyChanges=m.endPropertyChanges,n.changeProperties=m.changeProperties,n.Descriptor=p.Descriptor,n.defineProperty=p.defineProperty,n.set=_.set,n.trySet=_.trySet,n.OrderedSet=g.OrderedSet,n.Map=g.Map,n.MapWithDefault=g.MapWithDefault,n.getProperties=v["default"],n.setProperties=y["default"],n.watchKey=b.watchKey,n.unwatchKey=b.unwatchKey,n.flushPendingChains=x.flushPendingChains,n.removeChainWatcher=x.removeChainWatcher,n._ChainNode=x.ChainNode,n.finishChains=x.finishChains,n.watchPath=w.watchPath,n.unwatchPath=w.unwatchPath,n.watch=T.watch,n.isWatching=T.isWatching,n.unwatch=T.unwatch,n.rewatch=T.rewatch,n.destroy=T.destroy,n.expandProperties=E["default"],n.ComputedProperty=C.ComputedProperty,n.computed=C.computed,n.cacheFor=C.cacheFor,n.addObserver=S.addObserver,n.observersFor=S.observersFor,n.removeObserver=S.removeObserver,n.addBeforeObserver=S.addBeforeObserver,n._suspendBeforeObserver=S._suspendBeforeObserver,n._suspendBeforeObservers=S._suspendBeforeObservers,n._suspendObserver=S._suspendObserver,n._suspendObservers=S._suspendObservers,n.beforeObserversFor=S.beforeObserversFor,n.removeBeforeObserver=S.removeBeforeObserver,n.IS_BINDING=F.IS_BINDING,n.required=F.required,n.aliasMethod=F.aliasMethod,n.observer=F.observer,n.immediateObserver=F.immediateObserver,n.beforeObserver=F.beforeObserver,n.mixin=F.mixin,n.Mixin=F.Mixin,n.oneWay=M.oneWay,n.bind=M.bind,n.Binding=M.Binding,n.isGlobalPath=M.isGlobalPath,n.run=A["default"],n.libraries=N["default"],n.libraries.registerCoreLibrary("Ember",n.VERSION),n.isNone=R.isNone,n.none=R.none,n.isEmpty=D.isEmpty,n.empty=D.empty,n.isBlank=I["default"],n.merge=i["default"],n.onerror=null,n.__loader.registry["ember-debug"]&&t("ember-debug"),P["default"]=n}),e("ember-metal/map",["ember-metal/property_set","ember-metal/utils","ember-metal/array","ember-metal/platform","exports"],function(e,t,i,r,o){"use strict";function s(){this.clear()}function a(e){m.call(this),this.defaultValue=e.defaultValue}var l=e.set,d=t.guidFor,h=i.indexOf,u=r.create,c=function(e){var t={};for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t},f=function(e,t){var i=e.keys.copy(),r=c(e.values);return t.keys=i,t.values=r,t.length=e.length,t};s.create=function(){return new s},s.prototype={clear:function(){this.presenceSet={},this.list=[]},add:function(e){var t=d(e),i=this.presenceSet,r=this.list;t in i||(i[t]=!0,r.push(e))},remove:function(e){var t=d(e),i=this.presenceSet,r=this.list;delete i[t];var n=h.call(r,e);n>-1&&r.splice(n,1)},isEmpty:function(){return 0===this.list.length},has:function(e){var t=d(e),i=this.presenceSet;return t in i},forEach:function(e,t){for(var i=this.toArray(),r=0,n=i.length;n>r;r++)e.call(t,i[r])},toArray:function(){return this.list.slice()},copy:function(){var e=new s;return e.presenceSet=c(this.presenceSet),e.list=this.toArray(),e}};var m=n.Map=function(){this.keys=s.create(),this.values={}};m.create=function(){return new m},m.prototype={length:0,get:function(e){var t=this.values,i=d(e);return t[i]},set:function(e,t){var i=this.keys,r=this.values,n=d(e);i.add(e),r[n]=t,l(this,"length",i.list.length)},remove:function(e){var t=this.keys,i=this.values,r=d(e);return i.hasOwnProperty(r)?(t.remove(e),delete i[r],l(this,"length",t.list.length),!0):!1},has:function(e){var t=this.values,i=d(e);return t.hasOwnProperty(i)},forEach:function(e,t){var i=this.keys,r=this.values;i.forEach(function(i){var n=d(i);e.call(t,i,r[n])})},copy:function(){return f(this,new m)}},a.create=function(e){return e?new a(e):new m},a.prototype=u(m.prototype),a.prototype.get=function(e){var t=this.has(e);if(t)return m.prototype.get.call(this,e);var i=this.defaultValue(e);return this.set(e,i),i},a.prototype.copy=function(){return f(this,new a({defaultValue:this.defaultValue}))},o.OrderedSet=s,o.Map=m,o.MapWithDefault=a}),e("ember-metal/merge",["exports"],function(e){"use strict";function t(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e}e["default"]=t}),e("ember-metal/mixin",["ember-metal/core","ember-metal/merge","ember-metal/array","ember-metal/platform","ember-metal/utils","ember-metal/expand_properties","ember-metal/properties","ember-metal/computed","ember-metal/binding","ember-metal/observer","ember-metal/events","exports"],function(e,t,i,r,n,o,s,a,l,d,h,u){"use strict";function c(){var e,t=this.__nextSuper;return t&&(this.__nextSuper=null,e=J(this,t,arguments),this.__nextSuper=t),e}function f(e){var t=_t(e,!0),i=t.mixins;return i?t.hasOwnProperty("mixins")||(i=t.mixins=pt(i)):i=t.mixins={},i}function m(e,t){return t&&t.length>0&&(e.mixins=ut.call(t,function(e){if(e instanceof D)return e;var t=new D;return t.properties=e,t})),e}function p(e){return"function"==typeof e&&e.isMethod!==!1&&e!==Boolean&&e!==Object&&e!==Number&&e!==Array&&e!==Date&&e!==String}function _(e,t){var i;return t instanceof D?(i=q(t),e[i]?gt:(e[i]=t,t.properties)):t}function g(e,t,i,r){var n;return n=i[e]||r[e],t[e]&&(n=n?n.concat(t[e]):t[e]),n}function v(e,t,i,r,n){var o;return void 0===r[t]&&(o=n[t]),o=o||e.descs[t],o&&o instanceof rt?(i=pt(i),i.func=Q(i.func,o.func),i):i}function y(e,t,i,r,n){var o;return void 0===n[t]&&(o=r[t]),o=o||e[t],"function"!=typeof o?i:Q(i,o)}function b(e,t,i,r){var n=r[t]||e[t];return n?"function"==typeof n.concat?n.concat(i):Z(n).concat(i):Z(i)}function x(e,t,i,r){var n=r[t]||e[t];if(!n)return i;var o=G({},n),s=!1;for(var a in i)if(i.hasOwnProperty(a)){var l=i[a];p(l)?(s=!0,o[a]=y(e,a,l,n,{})):o[a]=l}return s&&(o._super=c),o}function w(e,t,i,r,n,o,s,a){if(i instanceof tt){if(i===U&&n[t])return gt;i.func&&(i=v(r,t,i,o,n)),n[t]=i,o[t]=void 0}else s&&ct.call(s,t)>=0||"concatenatedProperties"===t||"mergedProperties"===t?i=b(e,t,i,o):a&&ct.call(a,t)>=0?i=x(e,t,i,o):p(i)&&(i=y(e,t,i,o,n)),n[t]=void 0,o[t]=i}function T(e,t,i,r,n,o){function s(e){delete i[e],delete r[e]}for(var a,l,d,h,u,c,f=0,m=e.length;m>f;f++)if(a=e[f],j.assert("Expected hash or Mixin instance, got "+Object.prototype.toString.call(a),"object"==typeof a&&null!==a&&"[object Array]"!==Object.prototype.toString.call(a)),l=_(t,a),l!==gt)if(l){c=_t(n),n.willMergeMixin&&n.willMergeMixin(l),h=g("concatenatedProperties",l,r,n),u=g("mergedProperties",l,r,n);for(d in l)l.hasOwnProperty(d)&&(o.push(d),w(n,d,l[d],c,i,r,h,u));l.hasOwnProperty("toString")&&(n.toString=l.toString)}else a.mixins&&(T(a.mixins,t,i,r,n,o),a._without&&ft.call(a._without,s))}function E(e,t,i,r){if(vt.test(t)){var n=r.bindings;n?r.hasOwnProperty("bindings")||(n=r.bindings=pt(r.bindings)):n=r.bindings={},n[t]=i}}function C(e,t){var i,r,n,o=t.bindings;if(o){for(i in o)r=o[i],r&&(n=i.slice(0,-7),r instanceof nt?(r=r.copy(),r.to(n)):r=new nt(n,r),r.connect(e),e[i]=r);t.bindings={}}}function S(e,t){return C(e,t||_t(e)),e}function F(e,t,i,r,n){var o,s=t.methodName;return r[s]||n[s]?(o=n[s],t=r[s]):i.descs[s]?(t=i.descs[s],o=void 0):(t=void 0,o=e[s]),{desc:t,value:o}}function M(e,t,i,r,n){var o=i[r];if(o)for(var s=0,a=o.length;a>s;s++)n(e,o[s],null,t)}function A(e,t,i){var r=e[t];"function"==typeof r&&(M(e,t,r,"__ember_observesBefore__",lt),M(e,t,r,"__ember_observes__",st),M(e,t,r,"__ember_listens__",ht)),"function"==typeof i&&(M(e,t,i,"__ember_observesBefore__",at),M(e,t,i,"__ember_observes__",ot),M(e,t,i,"__ember_listens__",dt))}function N(e,t,i){var r,n,o,s={},a={},l=_t(e),d=[];e._super=c,T(t,f(e),s,a,e,d);for(var h=0,u=d.length;u>h;h++)if(r=d[h],"constructor"!==r&&a.hasOwnProperty(r)&&(o=s[r],n=a[r],o!==U)){for(;o&&o instanceof z;){var m=F(e,o,l,s,a);o=m.desc,n=m.value}(void 0!==o||void 0!==n)&&(A(e,r,n),E(e,r,n,l),it(e,r,o,n,l))}return i||S(e,l),e}function R(e){var t=mt.call(arguments,1);return N(e,t,!1),e}function D(){return m(this,arguments)}function I(e,t,i){var r=q(e);if(i[r])return!1;if(i[r]=!0,e===t)return!0;for(var n=e.mixins,o=n?n.length:0;--o>=0;)if(I(n[o],t,i))return!0;return!1}function P(e,t,i){if(!i[q(t)])if(i[q(t)]=!0,t.properties){var r=t.properties;for(var n in r)r.hasOwnProperty(n)&&(e[n]=!0)}else t.mixins&&ft.call(t.mixins,function(t){P(e,t,i)})}function k(){return U}function V(e){return new z(e)}function O(){var e,t=mt.call(arguments,-1)[0],i=function(t){e.push(t)},r=mt.call(arguments,0,-1);"function"!=typeof t&&(t=arguments[0],r=mt.call(arguments,1)),e=[];for(var n=0;n<r.length;++n)et(r[n],i);if("function"!=typeof t)throw new j.Error("Ember.observer called without a function");return t.__ember_observes__=e,t}function L(){for(var e=0,t=arguments.length;t>e;e++){var i=arguments[e];j.assert("Immediate observers must observe internal properties only, not properties on other objects.","string"!=typeof i||-1===i.indexOf("."))}return O.apply(this,arguments)}function B(){var e,t=mt.call(arguments,-1)[0],i=function(t){e.push(t)},r=mt.call(arguments,0,-1);"function"!=typeof t&&(t=arguments[0],r=mt.call(arguments,1)),e=[];for(var n=0;n<r.length;++n)et(r[n],i);if("function"!=typeof t)throw new j.Error("Ember.beforeObserver called without a function");return t.__ember_observesBefore__=e,t}var U,z,j=e["default"],G=t["default"],X=i.map,H=i.indexOf,Y=i.forEach,W=r.create,q=n.guidFor,K=n.meta,$=n.META_KEY,Q=n.wrap,Z=n.makeArray,J=n.apply,et=o["default"],tt=s.Descriptor,it=s.defineProperty,rt=a.ComputedProperty,nt=l.Binding,ot=d.addObserver,st=d.removeObserver,at=d.addBeforeObserver,lt=d.removeBeforeObserver,dt=h.addListener,ht=h.removeListener,ut=X,ct=H,ft=Y,mt=[].slice,pt=W,it=it,_t=K,gt={},vt=/^.+Binding$/;D.prototype={properties:null,mixins:null,ownerConstructor:null},D._apply=N,D.applyPartial=function(e){var t=mt.call(arguments,1);return N(e,t,!0)},D.finishPartial=S,j.anyUnprocessedMixins=!1,D.create=function(){j.anyUnprocessedMixins=!0;var e=this;return m(new e,arguments)};var yt=D.prototype;yt.reopen=function(){var e,t;this.properties?(e=D.create(),e.properties=this.properties,delete this.properties,this.mixins=[e]):this.mixins||(this.mixins=[]);var i,r=arguments.length,n=this.mixins;for(i=0;r>i;i++)e=arguments[i],j.assert("Expected hash or Mixin instance, got "+Object.prototype.toString.call(e),"object"==typeof e&&null!==e&&"[object Array]"!==Object.prototype.toString.call(e)),e instanceof D?n.push(e):(t=D.create(),t.properties=e,n.push(t));return this},yt.apply=function(e){return N(e,[this],!1)},yt.applyPartial=function(e){return N(e,[this],!0)},yt.detect=function(e){if(!e)return!1;if(e instanceof D)return I(e,this,{});var t=e[$],i=t&&t.mixins;return i?!!i[q(this)]:!1},yt.without=function(){var e=new D(this);return e._without=mt.call(arguments),e},yt.keys=function(){var e={},t={},i=[];P(e,this,t);for(var r in e)e.hasOwnProperty(r)&&i.push(r);return i},D.mixins=function(e){var t=e[$],i=t&&t.mixins,r=[];if(!i)return r;for(var n in i){var o=i[n];o.properties||r.push(o)}return r},U=new tt,U.toString=function(){return"(Required Property)"},z=function(e){this.methodName=e},z.prototype=new tt,u.IS_BINDING=vt,u.mixin=R,u.Mixin=D,u.required=k,u.aliasMethod=V,u.observer=O,u.immediateObserver=L,u.beforeObserver=B}),e("ember-metal/observer",["ember-metal/watching","ember-metal/array","ember-metal/events","exports"],function(e,t,i,r){"use strict";function n(e){return e+E}function o(e){return e+C}function s(e,t,i,r){return b(e,n(t),i,r),_(e,t),this}function a(e,t){return y(e,n(t))}function l(e,t,i,r){return g(e,t),x(e,n(t),i,r),this}function d(e,t,i,r){return b(e,o(t),i,r),_(e,t),this}function h(e,t,i,r,n){return T(e,o(t),i,r,n)}function u(e,t,i,r,o){return T(e,n(t),i,r,o)}function c(e,t,i,r,n){var s=v.call(t,o);return w(e,s,i,r,n)}function f(e,t,i,r,o){var s=v.call(t,n);return w(e,s,i,r,o)}function m(e,t){return y(e,o(t))}function p(e,t,i,r){return g(e,t),x(e,o(t),i,r),this}var _=e.watch,g=e.unwatch,v=t.map,y=i.listenersFor,b=i.addListener,x=i.removeListener,w=i.suspendListeners,T=i.suspendListener,E=":change",C=":before";r.addObserver=s,r.observersFor=a,r.removeObserver=l,r.addBeforeObserver=d,r._suspendBeforeObserver=h,r._suspendObserver=u,r._suspendBeforeObservers=c,r._suspendObservers=f,r.beforeObserversFor=m,r.removeBeforeObserver=p}),e("ember-metal/observer_set",["ember-metal/utils","ember-metal/events","exports"],function(e,t,i){"use strict";function r(){this.clear()}var n=e.guidFor,o=t.sendEvent;r.prototype.add=function(e,t,i){var r,o=this.observerSet,s=this.observers,a=n(e),l=o[a];return l||(o[a]=l={}),r=l[t],void 0===r&&(r=s.push({sender:e,keyName:t,eventName:i,listeners:[]})-1,l[t]=r),s[r].listeners},r.prototype.flush=function(){var e,t,i,r,n=this.observers;for(this.clear(),e=0,t=n.length;t>e;++e)i=n[e],r=i.sender,r.isDestroying||r.isDestroyed||o(r,i.eventName,[r,i.keyName],i.listeners)},r.prototype.clear=function(){this.observerSet={},this.observers=[]},i["default"]=r}),e("ember-metal/platform",["ember-metal/core","exports"],function(e,t){"use strict";var i=e["default"],r={},n=Object.create;if(n&&2!==n({a:1},{a:{value:2}}).a&&(n=null),!n||i.ENV.STUB_OBJECT_CREATE){var o=function(){};n=function(e,t){if(o.prototype=e,e=new o,t){o.prototype=e;for(var i in t)o.prototype[i]=t[i].value;e=new o}return o.prototype=null,e},n.isSimulated=!0}var s,a,l=Object.defineProperty;if(l)try{l({},"a",{get:function(){}})}catch(d){l=null}l&&(s=function(){var e={};return l(e,"a",{configurable:!0,enumerable:!0,get:function(){},set:function(){}}),l(e,"a",{configurable:!0,enumerable:!0,writable:!0,value:!0}),e.a===!0}(),a=function(){try{return l(document.createElement("div"),"definePropertyOnDOM",{}),!0}catch(e){}return!1}(),s?a||(l=function(e,t,i){var r;return r="object"==typeof Node?e instanceof Node:"object"==typeof e&&"number"==typeof e.nodeType&&"string"==typeof e.nodeName,r?e[t]=i.value:Object.defineProperty(e,t,i)}):l=null),r.defineProperty=l,r.hasPropertyAccessors=!0,r.defineProperty||(r.hasPropertyAccessors=!1,r.defineProperty=function(e,t,i){i.get||(e[t]=i.value)},r.defineProperty.isSimulated=!0),i.ENV.MANDATORY_SETTER&&!r.hasPropertyAccessors&&(i.ENV.MANDATORY_SETTER=!1),t.create=n,t.platform=r}),e("ember-metal/properties",["ember-metal/core","ember-metal/utils","ember-metal/platform","ember-metal/property_events","exports"],function(e,t,i,r,n){"use strict";function o(){}function s(e,t,i,r,n){var s,a,l,d;return n||(n=c(e)),s=n.descs,a=n.descs[t],l=n.watching[t]>0,a instanceof o&&a.teardown(e,t),i instanceof o?(d=i,s[t]=i,m&&l?f(e,t,{configurable:!0,enumerable:!0,writable:!0,value:void 0}):e[t]=void 0):(s[t]=void 0,null==i?(d=r,m&&l?(n.values[t]=r,f(e,t,{configurable:!0,enumerable:!0,set:p,get:_(t)})):e[t]=r):(d=i,f(e,t,i))),l&&u(e,t,n),e.didDefineProperty&&e.didDefineProperty(e,t,d),this}var a=e["default"],l=t.META_KEY,d=t.meta,h=i.platform,u=r.overrideChains,c=d,f=h.defineProperty,m=a.ENV.MANDATORY_SETTER,p=a.MANDATORY_SETTER_FUNCTION=function(){a.assert("You must use Ember.set() to access this property (of "+this+")",!1)},_=a.DEFAULT_GETTER_FUNCTION=function(e){return function(){var t=this[l];return t&&t.values[e]}};n.Descriptor=o,n.defineProperty=s}),e("ember-metal/property_events",["ember-metal/utils","ember-metal/events","ember-metal/observer_set","exports"],function(e,t,i,r){"use strict";function n(e,t){var i=e[y],r=i&&i.watching[t]>0||"length"===t,n=i&&i.proto,o=i&&i.descs[t];r&&n!==e&&(o&&o.willChange&&o.willChange(e,t),s(e,t,i),d(e,t,i),p(e,t))}function o(e,t){var i=e[y],r=i&&i.watching[t]>0||"length"===t,n=i&&i.proto,o=i&&i.descs[t];n!==e&&(o&&o.didChange&&o.didChange(e,t),(r||"length"===t)&&(a(e,t,i),h(e,t,i,!1),_(e,t)))}function s(e,t,i){if(!e.isDestroying){var r=g,o=!r;o&&(r=g={}),l(n,e,t,r,i),o&&(g=null)}}function a(e,t,i){if(!e.isDestroying){var r=v,n=!r;n&&(r=v={}),l(o,e,t,r,i),n&&(v=null)}}function l(e,t,i,r,n){var o=b(t);if(r[o]||(r[o]={}),!r[o][i]){r[o][i]=!0;var s=n.deps;if(s=s&&s[i])for(var a in s){var l=n.descs[a];l&&l._suspended===t||e(t,a)}}}function d(e,t,i){if(i.hasOwnProperty("chainWatchers")&&i.chainWatchers[t]){var r,o,s=i.chainWatchers[t],a=[];for(r=0,o=s.length;o>r;r++)s[r].willChange(a);for(r=0,o=a.length;o>r;r+=2)n(a[r],a[r+1])}}function h(e,t,i,r){if(i&&i.hasOwnProperty("chainWatchers")&&i.chainWatchers[t]){var n,s,a=i.chainWatchers[t],l=r?null:[];for(n=0,s=a.length;s>n;n++)a[n].didChange(l);if(!r)for(n=0,s=l.length;s>n;n+=2)o(l[n],l[n+1])}}function u(e,t,i){h(e,t,i,!0)}function c(){M++}function f(){M--,0>=M&&(S.clear(),F.flush())}function m(e,t){c(),x(e,f,t)}function p(e,t){if(!e.isDestroying){var i,r,n=t+":before";M?(i=S.add(e,t,n),r=E(e,n,i),w(e,n,[e,t],r)):w(e,n,[e,t])}}function _(e,t){if(!e.isDestroying){var i,r=t+":change";M?(i=F.add(e,t,r),T(e,r,i)):w(e,r,[e,t])}}var g,v,y=e.META_KEY,b=e.guidFor,x=e.tryFinally,w=t.sendEvent,T=t.listenersUnion,E=t.listenersDiff,C=i["default"],S=new C,F=new C,M=0;r.propertyWillChange=n,r.propertyDidChange=o,r.overrideChains=u,r.beginPropertyChanges=c,r.endPropertyChanges=f,r.changeProperties=m}),e("ember-metal/property_get",["ember-metal/core","ember-metal/utils","ember-metal/error","exports"],function(e,t,i,r){"use strict";function n(e,t){var i,r=0===t.indexOf(f),n=!r&&c.test(t);if((!e||n)&&(e=l.lookup),r&&(t=t.slice(5)),e===l.lookup&&(i=t.match(m)[0],e=a(e,i),t=t.slice(i.length+1)),!t||0===t.length)throw new h("Path cannot be empty");return[e,t]}function o(e,t){var i,r,o,s,d;if(null===e&&-1===t.indexOf("."))return a(l.lookup,t);for(i=0===t.indexOf(f),(!e||i)&&(o=n(e,t),e=o[0],t=o[1],o.length=0),r=t.split("."),d=r.length,s=0;null!=e&&d>s;s++)if(e=a(e,r[s],!0),e&&e.isDestroyed)return void 0;return e}function s(e,t,i){var r=a(e,t);return void 0===r?i:r}var a,l=e["default"],d=t.META_KEY,h=i["default"],u=l.ENV.MANDATORY_SETTER,c=/^([A-Z$]|([0-9][A-Z$])).*[\.]/,f="this.",m=/^([^\.]+)/;a=function(e,t){if(""===t)return e;if(t||"string"!=typeof e||(t=e,e=null),l.assert("Cannot call get with "+t+" key.",!!t),l.assert("Cannot call get with '"+t+"' on an undefined object.",void 0!==e),null===e)return o(e,t);var i,r=e[d],n=r&&r.descs[t];return void 0===n&&-1!==t.indexOf(".")?o(e,t):n?n.get(e,t):(i=u&&r&&r.watching[t]>0?r.values[t]:e[t],void 0!==i||"object"!=typeof e||t in e||"function"!=typeof e.unknownProperty?i:e.unknownProperty(t))},l.config.overrideAccessors&&(l.get=a,l.config.overrideAccessors(),a=l.get),r["default"]=a,r.get=a,r.getWithDefault=s,r.normalizeTuple=n,r._getPath=o}),e("ember-metal/property_set",["ember-metal/core","ember-metal/property_get","ember-metal/utils","ember-metal/property_events","ember-metal/properties","ember-metal/error","exports"],function(e,t,i,r,n,o,s){"use strict";function a(e,t,i,r){var n;if(n=t.slice(t.lastIndexOf(".")+1),t=t===n?n:t.slice(0,t.length-(n.length+1)),"this"!==t&&(e=h(e,t)),!n||0===n.length)throw new p("Property set failed: You passed an empty path");if(!e){if(r)return;throw new p('Property set failed: object in path "'+t+'" could not be found or was destroyed.')}return v(e,n,i)}function l(e,t,i){return v(e,t,i,!0)}var d=e["default"],h=t._getPath,u=i.META_KEY,c=r.propertyWillChange,f=r.propertyDidChange,m=n.defineProperty,p=o["default"],_=d.ENV.MANDATORY_SETTER,g=/^([A-Z$]|([0-9][A-Z$]))/,v=function(e,t,i,r){if("string"==typeof e&&(d.assert("Path '"+e+"' must be global if no obj is given.",g.test(e)),i=t,t=e,e=null),d.assert("Cannot call set with "+t+" key.",!!t),!e)return a(e,t,i,r);var n,o,s=e[u],l=s&&s.descs[t];if(void 0===l&&-1!==t.indexOf("."))return a(e,t,i,r);if(d.assert("You need to provide an object and key to `set`.",!!e&&void 0!==t),d.assert("calling set on destroyed object",!e.isDestroyed),void 0!==l)l.set(e,t,i);else{if("object"==typeof e&&null!==e&&void 0!==i&&e[t]===i)return i;n="object"==typeof e&&!(t in e),n&&"function"==typeof e.setUnknownProperty?e.setUnknownProperty(t,i):s&&s.watching[t]>0?(o=_?s.values[t]:e[t],i!==o&&(c(e,t),_?(void 0!==o||t in e)&&e.propertyIsEnumerable(t)?s.values[t]=i:m(e,t,null,i):e[t]=i,f(e,t))):e[t]=i}return i};d.config.overrideAccessors&&(d.set=v,d.config.overrideAccessors(),v=d.set),s.set=v,s.trySet=l}),e("ember-metal/run_loop",["ember-metal/core","ember-metal/utils","ember-metal/array","ember-metal/property_events","exports"],function(e,i,r,n,o){"use strict";function s(){g.currentRunLoop||a.assert("You have turned on testing mode, which disabled the run-loop's autorun. You will need to wrap any code with asynchronous side-effects in an run",!a.testing)}var a=e["default"],l=i.apply,d=r.indexOf,h=n.beginPropertyChanges,u=n.endPropertyChanges,c=function(e){g.currentRunLoop=e},f=function(e,t){g.currentRunLoop=t},m=t("backburner").Backburner,p=new m(["sync","actions","destroy"],{sync:{before:h,after:u},defaultQueue:"actions",onBegin:c,onEnd:f,onErrorTarget:a,onErrorMethod:"onerror"}),_=[].slice,g=([].concat,function(){return l(p,p.run,arguments)});g.join=function(){if(!g.currentRunLoop)return l(a,g,arguments);var e=_.call(arguments);e.unshift("actions"),l(g,g.schedule,e)},g.bind=function(){var e=_.call(arguments);return function(){return l(g,g.join,e.concat(_.call(arguments)))}},g.backburner=p,g.currentRunLoop=null,g.queues=p.queueNames,g.begin=function(){p.begin()},g.end=function(){p.end()},g.schedule=function(){s(),l(p,p.schedule,arguments)},g.hasScheduledTimers=function(){return p.hasTimers()},g.cancelTimers=function(){p.cancelTimers()},g.sync=function(){p.currentInstance&&p.currentInstance.queues.sync.flush()},g.later=function(){return l(p,p.later,arguments)},g.once=function(){s();var e=_.call(arguments);return e.unshift("actions"),l(p,p.scheduleOnce,e)},g.scheduleOnce=function(){return s(),l(p,p.scheduleOnce,arguments)},g.next=function(){var e=_.call(arguments);return e.push(1),l(p,p.later,e)},g.cancel=function(e){return p.cancel(e)},g.debounce=function(){return l(p,p.debounce,arguments)},g.throttle=function(){return l(p,p.throttle,arguments)},g._addQueue=function(e,t){-1===d.call(g.queues,e)&&g.queues.splice(d.call(g.queues,t)+1,0,e)},o["default"]=g}),e("ember-metal/set_properties",["ember-metal/property_events","ember-metal/property_set","exports"],function(e,t,i){"use strict";function r(e,t){return n(function(){for(var i in t)t.hasOwnProperty(i)&&o(e,i,t[i])}),e}var n=e.changeProperties,o=t.set;i["default"]=r}),e("ember-metal/utils",["ember-metal/core","ember-metal/platform","ember-metal/array","exports"],function(e,i,n,o){"use strict";function s(e,t){t||(t=S);var i=t+R++;return e&&(null===e[I]?e[I]=i:(P.value=i,F(e,I,P))),i}function a(e){if(void 0===e)return"(undefined)";if(null===e)return"(null)";var t,i=typeof e;switch(i){case"number":return t=A[e],t||(t=A[e]="nu"+e),t;case"string":return t=N[e],t||(t=N[e]="st"+R++),t;case"boolean":return e?"(true)":"(false)";default:return e[I]?e[I]:e===Object?"(Object)":e===Array?"(Array)":(t="ember"+R++,null===e[I]?e[I]=t:(P.value=t,F(e,I,P)),t)}}function l(e){this.descs={},this.watching={},this.cache={},this.cacheMeta={},this.source=e}function d(e,t){var i=e[V];return t===!1?i||L:(i?i.source!==e&&(O||F(e,V,k),i=M(i),i.descs=M(i.descs),i.watching=M(i.watching),i.cache={},i.cacheMeta={},i.source=e,D&&(i.values=M(i.values)),e[V]=i):(O||F(e,V,k),i=new l(e),D&&(i.values={}),e[V]=i,i.descs.constructor=null),i)}function h(e,t){var i=d(e,!1);return i[t]}function u(e,t,i){var r=d(e,!0);return r[t]=i,i}function c(e,t,i){w.deprecate("Ember.metaPath is deprecated and will be removed from future releases.");for(var r,n,o=d(e,i),s=0,a=t.length;a>s;s++){if(r=t[s],n=o[r]){if(n.__ember_source__!==e){if(!i)return void 0;n=o[r]=M(n),n.__ember_source__=e}}else{if(!i)return void 0;n=o[r]={__ember_source__:e}}o=n}return n}function f(e,t){function i(){var i,r=this.__nextSuper;return this.__nextSuper=t,i=b(this,e,arguments),this.__nextSuper=r,i}return i.wrappedFunction=e,i.wrappedFunction.__ember_arity__=e.length,i.__ember_observes__=e.__ember_observes__,i.__ember_observesBefore__=e.__ember_observesBefore__,i.__ember_listens__=e.__ember_listens__,i}function m(e){var i,n;return"undefined"==typeof B&&(i="ember-runtime/mixins/array",r._eak_seen[i]&&(B=t(i)["default"])),!e||e.setInterval?!1:Array.isArray&&Array.isArray(e)?!0:B&&B.detect(e)?!0:(n=v(e),"array"===n?!0:void 0!==e.length&&"object"===n?!0:!1)}function p(e){return null===e||void 0===e?[]:m(e)?e:[e]}function _(e,t){return!(!e||"function"!=typeof e[t])}function g(e,t,i){return _(e,t)?i?x(e,t,i):x(e,t):void 0}function v(e){var i,n;return"undefined"==typeof H&&(n="ember-runtime/system/object",r._eak_seen[n]&&(H=t(n)["default"])),i=null===e||void 0===e?String(e):G[Y.call(e)]||"object","function"===i?H&&H.detect(e)&&(i="class"):"object"===i&&(e instanceof Error?i="error":H&&e instanceof H?i="instance":e instanceof Date&&(i="date")),i}function y(e){var t=v(e);if("array"===t)return"["+e+"]";if("object"!==t)return e+"";var i,r=[];for(var n in e)if(e.hasOwnProperty(n)){if(i=e[n],"toString"===i)continue;"function"===v(i)&&(i="function() { ... }"),r.push(n+": "+i)}return"{"+r.join(", ")+"}"}function b(e,t,i){var r=i&&i.length;if(!i||!r)return t.call(e);switch(r){case 1:return t.call(e,i[0]);case 2:return t.call(e,i[0],i[1]);case 3:return t.call(e,i[0],i[1],i[2]);case 4:return t.call(e,i[0],i[1],i[2],i[3]);case 5:return t.call(e,i[0],i[1],i[2],i[3],i[4]);default:return t.apply(e,i)}}function x(e,t,i){var r=i&&i.length;if(!i||!r)return e[t]();switch(r){case 1:return e[t](i[0]);case 2:return e[t](i[0],i[1]);case 3:return e[t](i[0],i[1],i[2]);case 4:return e[t](i[0],i[1],i[2],i[3]);case 5:return e[t](i[0],i[1],i[2],i[3],i[4]);default:return e[t].apply(e,i)}}var w=e["default"],T=i.platform,E=i.create,C=n.forEach,S="ember",F=T.defineProperty,M=E,A=[],N={},R=0,D=w.ENV.MANDATORY_SETTER,I="__ember"+ +new Date,P={writable:!1,configurable:!1,enumerable:!1,value:null},k={writable:!0,configurable:!1,enumerable:!1,value:null},V="__ember_meta__",O=T.defineProperty.isSimulated;l.prototype={descs:null,deps:null,watching:null,listeners:null,cache:null,cacheMeta:null,source:null,mixins:null,bindings:null,chains:null,chainWatchers:null,values:null,proto:null},O&&(l.prototype.__preventPlainObject__=!0,l.prototype.toJSON=function(){});var L=new l(null);D&&(L.values={});var B,U,z=function(){var e=0;try{try{}finally{throw e++,new Error("needsFinallyFixTest")}}catch(t){}return 1!==e}();U=z?function(e,t,i){var r,n,o;i=i||this;try{r=e.call(i)}finally{try{n=t.call(i)}catch(s){o=s}}if(o)throw o;return void 0===n?r:n}:function(e,t,i){var r,n;i=i||this;try{r=e.call(i)}finally{n=t.call(i)}return void 0===n?r:n};var j;j=z?function(e,t,i,r){var n,o,s;r=r||this;try{n=e.call(r)}catch(a){n=t.call(r,a)}finally{try{o=i.call(r)}catch(l){s=l}}if(s)throw s;return void 0===o?n:o}:function(e,t,i,r){var n,o;r=r||this;try{n=e.call(r)}catch(s){n=t.call(r,s)}finally{o=i.call(r)}return void 0===o?n:o};var G={},X="Boolean Number String Function Array Date RegExp Object".split(" ");C.call(X,function(e){G["[object "+e+"]"]=e.toLowerCase()});var H,Y=Object.prototype.toString;o.generateGuid=s,o.GUID_KEY=I,o.GUID_PREFIX=S,o.guidFor=a,o.META_DESC=k,o.EMPTY_META=L,o.META_KEY=V,o.meta=d,o.getMeta=h,o.setMeta=u,o.metaPath=c,o.inspect=y,o.typeOf=v,o.tryCatchFinally=j,o.isArray=m,o.makeArray=p,o.canInvoke=_,o.tryInvoke=g,o.tryFinally=U,o.wrap=f,o.applyStr=x,o.apply=b}),e("backburner",["backburner/utils","backburner/deferred_action_queues","exports"],function(e,t,i){"use strict";function r(e){return x(e)||E.test(e)}function n(e,t){this.queueNames=e,this.options=t||{},this.options.defaultQueue||(this.options.defaultQueue=e[0]),this.instanceStack=[],this._debouncees=[],this._throttlers=[]}function o(e){return function(){try{return e.apply(this,arguments)}catch(t){throw t}}}function s(e){return e.onError||e.onErrorTarget&&e.onErrorTarget[e.onErrorMethod]}function a(e){e.begin(),e._autorun=T.setTimeout(function(){e._autorun=null,e.end()})}function l(e,t,i){(!e._laterTimer||t<e._laterTimerExpiresAt)&&(e._laterTimer=T.setTimeout(function(){e._laterTimer=null,e._laterTimerExpiresAt=null,d(e)},i),e._laterTimerExpiresAt=t)}function d(e){var t,i,r,n=+new Date;e.run(function(){for(i=f(n,w),t=w.splice(0,i),i=1,r=t.length;r>i;i+=2)e.schedule(e.options.defaultQueue,null,t[i])}),w.length&&l(e,w[0],w[0]-n)}function h(e,t,i){return c(e,t,i)}function u(e,t,i){return c(e,t,i)}function c(e,t,i){for(var r,n=-1,o=0,s=i.length;s>o;o++)if(r=i[o],r[0]===e&&r[1]===t){n=o;break}return n}function f(e,t){for(var i,r,n=0,o=t.length-2;o>n;)r=(o-n)/2,i=n+r-r%2,e>=t[i]?n=i+2:o=i;return e>=t[n]?n+2:n}var m=e["default"],p=t.DeferredActionQueues,_=[].slice,g=[].pop,v=m.each,y=m.isString,b=m.isFunction,x=m.isNumber,w=[],T=this,E=/\d+/,C=function(e,t){try{t()}catch(e){}return!!e}();if(n.prototype={queueNames:null,options:null,currentInstance:null,instanceStack:null,begin:function(){var e=this.options,t=e&&e.onBegin,i=this.currentInstance;i&&this.instanceStack.push(i),this.currentInstance=new p(this.queueNames,e),t&&t(this.currentInstance,i)},end:function(){var e=this.options,t=e&&e.onEnd,i=this.currentInstance,r=null,n=!1;try{i.flush()}finally{n||(n=!0,this.currentInstance=null,this.instanceStack.length&&(r=this.instanceStack.pop(),this.currentInstance=r),t&&t(i,r))}},run:function(e,t){var i=s(this.options);this.begin(),t||(t=e,e=null),y(t)&&(t=e[t]);var r=_.call(arguments,2),n=!1;if(i)try{return t.apply(e,r)}catch(o){i(o)}finally{n||(n=!0,this.end())}else try{return t.apply(e,r)}finally{n||(n=!0,this.end())}},defer:function(e,t,i){i||(i=t,t=null),y(i)&&(i=t[i]);var r=this.DEBUG?new Error:void 0,n=arguments.length>3?_.call(arguments,3):void 0;return this.currentInstance||a(this),this.currentInstance.schedule(e,t,i,n,!1,r)},deferOnce:function(e,t,i){i||(i=t,t=null),y(i)&&(i=t[i]);var r=this.DEBUG?new Error:void 0,n=arguments.length>3?_.call(arguments,3):void 0;
return this.currentInstance||a(this),this.currentInstance.schedule(e,t,i,n,!0,r)},setTimeout:function(){function e(){if(p)try{t.apply(n,h)}catch(e){p(e)}else t.apply(n,h)}var t,i,n,o,a,d,h=_.call(arguments),u=h.length;if(0!==u){if(1===u)t=h.shift(),i=0;else if(2===u)o=h[0],a=h[1],b(a)||b(o[a])?(n=h.shift(),t=h.shift(),i=0):r(a)?(t=h.shift(),i=h.shift()):(t=h.shift(),i=0);else{var c=h[h.length-1];i=r(c)?h.pop():0,o=h[0],d=h[1],b(d)||y(d)&&null!==o&&d in o?(n=h.shift(),t=h.shift()):t=h.shift()}var m=+new Date+parseInt(i,10);y(t)&&(t=n[t]);var p=s(this.options),g=f(m,w);return w.splice(g,0,m,e),l(this,m,i),e}},throttle:function(e,t){var i,r,n,o,s=this,a=arguments,l=g.call(a);return x(l)||y(l)?(i=l,l=!0):i=g.call(a),i=parseInt(i,10),n=u(e,t,this._throttlers),n>-1?this._throttlers[n]:(o=T.setTimeout(function(){l||s.run.apply(s,a);var i=u(e,t,s._throttlers);i>-1&&s._throttlers.splice(i,1)},i),l&&s.run.apply(s,a),r=[e,t,o],this._throttlers.push(r),r)},debounce:function(e,t){var i,r,n,o,s=this,a=arguments,l=g.call(a);return x(l)||y(l)?(i=l,l=!1):i=g.call(a),i=parseInt(i,10),r=h(e,t,this._debouncees),r>-1&&(n=this._debouncees[r],this._debouncees.splice(r,1),clearTimeout(n[2])),o=T.setTimeout(function(){l||s.run.apply(s,a);var i=h(e,t,s._debouncees);i>-1&&s._debouncees.splice(i,1)},i),l&&-1===r&&s.run.apply(s,a),n=[e,t,o],s._debouncees.push(n),n},cancelTimers:function(){var e=function(e){clearTimeout(e[2])};v(this._throttlers,e),this._throttlers=[],v(this._debouncees,e),this._debouncees=[],this._laterTimer&&(clearTimeout(this._laterTimer),this._laterTimer=null),w=[],this._autorun&&(clearTimeout(this._autorun),this._autorun=null)},hasTimers:function(){return!!w.length||!!this._debouncees.length||!!this._throttlers.length||this._autorun},cancel:function(e){var t=typeof e;if(e&&"object"===t&&e.queue&&e.method)return e.queue.cancel(e);if("function"!==t)return"[object Array]"===Object.prototype.toString.call(e)?this._cancelItem(u,this._throttlers,e)||this._cancelItem(h,this._debouncees,e):void 0;for(var i=0,r=w.length;r>i;i+=2)if(w[i+1]===e)return w.splice(i,2),!0},_cancelItem:function(e,t,i){var r,n;return i.length<3?!1:(n=e(i[0],i[1],t),n>-1&&(r=t[n],r[2]===i[2])?(t.splice(n,1),clearTimeout(i[2]),!0):!1)}},n.prototype.schedule=n.prototype.defer,n.prototype.scheduleOnce=n.prototype.deferOnce,n.prototype.later=n.prototype.setTimeout,C){var S=n.prototype.run;n.prototype.run=o(S);var F=n.prototype.end;n.prototype.end=o(F)}i.Backburner=n}),e("backburner/deferred_action_queues",["backburner/utils","backburner/queue","exports"],function(e,t,i){"use strict";function r(e,t){var i=this.queues={};this.queueNames=e=e||[],this.options=t,a(e,function(e){i[e]=new s(this,e,t)})}function n(e,t){for(var i,r,n=0,o=t;o>=n;n++)if(i=e.queueNames[n],r=e.queues[i],r._queue.length)return n;return-1}var o=e["default"],s=t.Queue,a=o.each,l=o.isString;r.prototype={queueNames:null,queues:null,options:null,schedule:function(e,t,i,r,n,o){var s=this.queues,a=s[e];if(!a)throw new Error("You attempted to schedule an action in a queue ("+e+") that doesn't exist");return n?a.pushUnique(t,i,r,o):a.push(t,i,r,o)},invoke:function(e,t,i){i&&i.length>0?t.apply(e,i):t.call(e)},invokeWithOnError:function(e,t,i,r){try{i&&i.length>0?t.apply(e,i):t.call(e)}catch(n){r(n)}},flush:function(){for(var e,t,i,r,o=this.queues,s=this.queueNames,a=0,d=s.length,h=this.options,u=h.onError||h.onErrorTarget&&h.onErrorTarget[h.onErrorMethod],c=u?this.invokeWithOnError:this.invoke;d>a;){e=s[a],t=o[e],i=t._queueBeingFlushed=t._queue.slice(),t._queue=[];var f,m,p,_,g=t.options,v=g&&g.before,y=g&&g.after,b=0,x=i.length;for(x&&v&&v();x>b;)f=i[b],m=i[b+1],p=i[b+2],_=i[b+3],l(m)&&(m=f[m]),m&&c(f,m,p,u),b+=4;t._queueBeingFlushed=null,x&&y&&y(),-1===(r=n(this,a))?a++:a=r}}},i.DeferredActionQueues=r}),e("backburner/queue",["exports"],function(e){"use strict";function t(e,t,i){this.daq=e,this.name=t,this.globalOptions=i,this.options=i[t],this._queue=[]}t.prototype={daq:null,name:null,options:null,onError:null,_queue:null,push:function(e,t,i,r){var n=this._queue;return n.push(e,t,i,r),{queue:this,target:e,method:t}},pushUnique:function(e,t,i,r){var n,o,s,a,l=this._queue;for(s=0,a=l.length;a>s;s+=4)if(n=l[s],o=l[s+1],n===e&&o===t)return l[s+2]=i,l[s+3]=r,{queue:this,target:e,method:t};return l.push(e,t,i,r),{queue:this,target:e,method:t}},flush:function(){var e,t,i,r,n,o=this._queue,s=this.globalOptions,a=this.options,l=a&&a.before,d=a&&a.after,h=s.onError||s.onErrorTarget&&s.onErrorTarget[s.onErrorMethod],u=o.length;for(u&&l&&l(),n=0;u>n;n+=4)if(e=o[n],t=o[n+1],i=o[n+2],r=o[n+3],i&&i.length>0)if(h)try{t.apply(e,i)}catch(c){h(c)}else t.apply(e,i);else if(h)try{t.call(e)}catch(c){h(c)}else t.call(e);u&&d&&d(),o.length>u?(this._queue=o.slice(u),this.flush()):this._queue.length=0},cancel:function(e){var t,i,r,n,o=this._queue;for(r=0,n=o.length;n>r;r+=4)if(t=o[r],i=o[r+1],t===e.target&&i===e.method)return o.splice(r,4),!0;if(o=this._queueBeingFlushed)for(r=0,n=o.length;n>r;r+=4)if(t=o[r],i=o[r+1],t===e.target&&i===e.method)return o[r+1]=null,!0}},e.Queue=t}),e("backburner/utils",["exports"],function(e){"use strict";e["default"]={each:function(e,t){for(var i=0;i<e.length;i++)t(e[i])},isString:function(e){return"string"==typeof e},isFunction:function(e){return"function"==typeof e},isNumber:function(e){return"number"==typeof e}}}),e("ember-metal/watch_key",["ember-metal/core","ember-metal/utils","ember-metal/platform","exports"],function(e,t,i,r){"use strict";function n(e,t,i){if("length"!==t||"array"!==l(e)){var r=i||h(e),n=r.watching;n[t]?n[t]=(n[t]||0)+1:(n[t]=1,"function"==typeof e.willWatchProperty&&e.willWatchProperty(t),u&&t in e&&(r.values[t]=e[t],c(e,t,{configurable:!0,enumerable:e.propertyIsEnumerable(t),set:s.MANDATORY_SETTER_FUNCTION,get:s.DEFAULT_GETTER_FUNCTION(t)})))}}function o(e,t,i){var r=i||h(e),n=r.watching;1===n[t]?(n[t]=0,"function"==typeof e.didUnwatchProperty&&e.didUnwatchProperty(t),u&&t in e&&c(e,t,{configurable:!0,enumerable:e.propertyIsEnumerable(t),set:function(i){c(e,t,{configurable:!0,writable:!0,enumerable:!0,value:i}),delete r.values[t]},get:s.DEFAULT_GETTER_FUNCTION(t)})):n[t]>1&&n[t]--}var s=e["default"],a=t.meta,l=t.typeOf,d=i.platform,h=a,u=s.ENV.MANDATORY_SETTER,c=d.defineProperty;r.watchKey=n,r.unwatchKey=o}),e("ember-metal/watch_path",["ember-metal/utils","ember-metal/chains","exports"],function(e,t,i){"use strict";function r(e,t){var i=t||d(e),r=i.chains;return r?r.value()!==e&&(r=i.chains=r.copy(e)):r=i.chains=new l(null,null,e),r}function n(e,t,i){if("length"!==t||"array"!==a(e)){var n=i||d(e),o=n.watching;o[t]?o[t]=(o[t]||0)+1:(o[t]=1,r(e,n).add(t))}}function o(e,t,i){var n=i||d(e),o=n.watching;1===o[t]?(o[t]=0,r(e,n).remove(t)):o[t]>1&&o[t]--}var s=e.meta,a=e.typeOf,l=t.ChainNode,d=s;i.watchPath=n,i.unwatchPath=o}),e("ember-metal/watching",["ember-metal/utils","ember-metal/chains","ember-metal/watch_key","ember-metal/watch_path","exports"],function(e,t,i,r,n){"use strict";function o(e){return-1===e.indexOf(".")}function s(e,t,i){("length"!==t||"array"!==f(e))&&(o(t)?g(e,t,i):y(e,t,i))}function a(e,t){var i=e[u];return(i&&i.watching[t])>0}function l(e,t,i){("length"!==t||"array"!==f(e))&&(o(t)?v(e,t,i):b(e,t,i))}function d(e){var t=e[u],i=t&&t.chains;c in e&&!e.hasOwnProperty(c)&&m(e),i&&i.value()!==e&&(t.chains=i.copy(e))}function h(e){var t,i,r,n,o=e[u];if(o&&(e[u]=null,t=o.chains))for(x.push(t);x.length>0;){if(t=x.pop(),i=t._chains)for(r in i)i.hasOwnProperty(r)&&x.push(i[r]);t._watching&&(n=t._object,n&&p(n,t._key,t))}}var u=(e.meta,e.META_KEY),c=e.GUID_KEY,f=e.typeOf,m=e.generateGuid,p=t.removeChainWatcher,_=t.flushPendingChains,g=i.watchKey,v=i.unwatchKey,y=r.watchPath,b=r.unwatchPath;s.flushPending=_;var x=[];n.watch=s,n.isWatching=a,n.unwatch=l,n.rewatch=d,n.destroy=h})}(),function(){e("rsvp/all",["./promise","exports"],function(e,t){"use strict";var i=e["default"];t["default"]=function(e,t){return i.all(e,t)}}),e("rsvp/all_settled",["./promise","./utils","exports"],function(e,t,i){"use strict";function r(e){return{state:"fulfilled",value:e}}function n(e){return{state:"rejected",reason:e}}var o=e["default"],s=t.isArray,a=t.isNonThenable;i["default"]=function(e,t){return new o(function(t){function i(e){return function(t){d(e,r(t))}}function l(e){return function(t){d(e,n(t))}}function d(e,i){c[e]=i,0===--u&&t(c)}if(!s(e))throw new TypeError("You must pass an array to allSettled.");var h,u=e.length;if(0===u)return void t([]);for(var c=new Array(u),f=0;f<e.length;f++)h=e[f],a(h)?d(f,r(h)):o.cast(h).then(i(f),l(f))},t)}}),e("rsvp/config",["./events","exports"],function(e,t){"use strict";function i(e,t){return"onerror"===e?void n.on("error",t):2!==arguments.length?n[e]:void(n[e]=t)}var r=e["default"],n={instrument:!1};r.mixin(n),t.config=n,t.configure=i}),e("rsvp/defer",["./promise","exports"],function(e,t){"use strict";var i=e["default"];t["default"]=function(e){var t={};return t.promise=new i(function(e,i){t.resolve=e,t.reject=i},e),t}}),e("rsvp/events",["exports"],function(e){"use strict";var t=function(e,t){for(var i=0,r=e.length;r>i;i++)if(e[i]===t)return i;return-1},i=function(e){var t=e._promiseCallbacks;return t||(t=e._promiseCallbacks={}),t};e["default"]={mixin:function(e){return e.on=this.on,e.off=this.off,e.trigger=this.trigger,e._promiseCallbacks=void 0,e},on:function(e,r){var n,o=i(this);n=o[e],n||(n=o[e]=[]),-1===t(n,r)&&n.push(r)},off:function(e,r){var n,o,s=i(this);return r?(n=s[e],o=t(n,r),void(-1!==o&&n.splice(o,1))):void(s[e]=[])},trigger:function(e,t){var r,n,o=i(this);if(r=o[e])for(var s=0;s<r.length;s++)(n=r[s])(t)}}}),e("rsvp/filter",["./all","./map","./utils","exports"],function(e,t,i,r){"use strict";function n(e,t,i){return o(e,i).then(function(r){if(!l(e))throw new TypeError("You must pass an array to filter.");if(!a(t))throw new TypeError("You must pass a function to filter's second argument.");return s(e,t,i).then(function(e){var t,i=r.length,n=[];for(t=0;i>t;t++)e[t]&&n.push(r[t]);return n})})}var o=e["default"],s=t["default"],a=i.isFunction,l=i.isArray;r["default"]=n}),e("rsvp/hash",["./promise","./utils","exports"],function(e,t,i){"use strict";var r=e["default"],n=t.isNonThenable,o=t.keysOf;i["default"]=function(e){return new r(function(t,i){function s(e){return function(i){h[e]=i,0===--c&&t(h)}}function a(e){c=0,i(e)}var l,d,h={},u=o(e),c=u.length;if(0===c)return void t(h);for(var f=0;f<u.length;f++)d=u[f],l=e[d],n(l)?(h[d]=l,0===--c&&t(h)):r.cast(l).then(s(d),a)})}}),e("rsvp/instrument",["./config","./utils","exports"],function(e,t,i){"use strict";var r=e.config,n=t.now;i["default"]=function(e,t,i){try{r.trigger(e,{guid:t._guidKey+t._id,eventName:e,detail:t._detail,childGuid:i&&t._guidKey+i._id,label:t._label,timeStamp:n(),stack:new Error(t._label).stack})}catch(o){setTimeout(function(){throw o},0)}}}),e("rsvp/map",["./promise","./all","./utils","exports"],function(e,t,i,r){"use strict";var n=(e["default"],t["default"]),o=i.isArray,s=i.isFunction;r["default"]=function(e,t,i){return n(e,i).then(function(r){if(!o(e))throw new TypeError("You must pass an array to map.");if(!s(t))throw new TypeError("You must pass a function to map's second argument.");var a,l=r.length,d=[];for(a=0;l>a;a++)d.push(t(r[a]));return n(d,i)})}}),e("rsvp/node",["./promise","exports"],function(e,t){"use strict";function i(e,t){return function(i,r){i?t(i):e(arguments.length>2?n.call(arguments,1):r)}}var r=e["default"],n=Array.prototype.slice;t["default"]=function(e,t){return function(){var o=n.call(arguments),s=this||t;return new r(function(t,n){r.all(o).then(function(r){try{r.push(i(t,n)),e.apply(s,r)}catch(o){n(o)}})})}}}),e("rsvp/promise",["./config","./events","./instrument","./utils","./promise/cast","./promise/all","./promise/race","./promise/resolve","./promise/reject","exports"],function(e,t,i,r,n,o,s,a,l,d){"use strict";function h(){}function u(e,t){if(!C(e))throw new TypeError("You must pass a resolver function as the first argument to the promise constructor");if(!(this instanceof u))throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this._id=I++,this._label=t,this._subscribers=[],w.instrument&&T("created",this),h!==e&&c(e,this)}function c(e,t){function i(e){g(t,e)}function r(e){y(t,e)}try{e(i,r)}catch(n){r(n)}}function f(e,t,i,r){var n=e._subscribers,o=n.length;n[o]=t,n[o+V]=i,n[o+O]=r}function m(e,t){var i,r,n=e._subscribers,o=e._detail;w.instrument&&T(t===V?"fulfilled":"rejected",e);for(var s=0;s<n.length;s+=3)i=n[s],r=n[s+t],p(t,i,r,o);e._subscribers=null}function p(e,t,i,r){var n,o,s,a,l=C(i);if(l)try{n=i(r),s=!0}catch(d){a=!0,o=d}else n=r,s=!0;_(t,n)||(l&&s?g(t,n):a?y(t,o):e===V?g(t,n):e===O&&y(t,n))}function _(e,t){var i,r=null;try{if(e===t)throw new TypeError("A promises callback cannot return that same promise.");if(E(t)&&(r=t.then,C(r)))return r.call(t,function(r){return i?!0:(i=!0,void(t!==r?g(e,r):v(e,r)))},function(t){return i?!0:(i=!0,void y(e,t))},"derived from: "+(e._label||" unknown promise")),!0}catch(n){return i?!0:(y(e,n),!0)}return!1}function g(e,t){e===t?v(e,t):_(e,t)||v(e,t)}function v(e,t){e._state===P&&(e._state=k,e._detail=t,w.async(b,e))}function y(e,t){e._state===P&&(e._state=k,e._detail=t,w.async(x,e))}function b(e){m(e,e._state=V)}function x(e){e._onerror&&e._onerror(e._detail),m(e,e._state=O)}var w=e.config,T=(t["default"],i["default"]),E=r.objectOrFunction,C=r.isFunction,S=r.now,F=n["default"],M=o["default"],A=s["default"],N=a["default"],R=l["default"],D="rsvp_"+S()+"-",I=0;d["default"]=u,u.cast=F,u.all=M,u.race=A,u.resolve=N,u.reject=R;var P=void 0,k=0,V=1,O=2;u.prototype={constructor:u,_id:void 0,_guidKey:D,_label:void 0,_state:void 0,_detail:void 0,_subscribers:void 0,_onerror:function(e){w.trigger("error",e)},then:function(e,t,i){var r=this;this._onerror=null;var n=new this.constructor(h,i);if(this._state){var o=arguments;w.async(function(){p(r._state,n,o[r._state-1],r._detail)})}else f(this,n,e,t);return w.instrument&&T("chained",r,n),n},"catch":function(e,t){return this.then(null,e,t)},"finally":function(e,t){var i=this.constructor;return this.then(function(t){return i.cast(e()).then(function(){return t})},function(t){return i.cast(e()).then(function(){throw t})},t)}}}),e("rsvp/promise/all",["../utils","exports"],function(e,t){"use strict";var i=e.isArray,r=e.isNonThenable;t["default"]=function(e,t){var n=this;return new n(function(t,o){function s(e){return function(i){h[e]=i,0===--d&&t(h)}}function a(e){d=0,o(e)}if(!i(e))throw new TypeError("You must pass an array to all.");var l,d=e.length,h=new Array(d);if(0===d)return void t(h);for(var u=0;u<e.length;u++)l=e[u],r(l)?(h[u]=l,0===--d&&t(h)):n.cast(l).then(s(u),a)},t)}}),e("rsvp/promise/cast",["exports"],function(e){"use strict";e["default"]=function(e,t){var i=this;return e&&"object"==typeof e&&e.constructor===i?e:new i(function(t){t(e)},t)}}),e("rsvp/promise/race",["../utils","exports"],function(e,t){"use strict";var i=e.isArray,r=(e.isFunction,e.isNonThenable);t["default"]=function(e,t){var n,o=this;return new o(function(t,s){function a(e){d&&(d=!1,t(e))}function l(e){d&&(d=!1,s(e))}if(!i(e))throw new TypeError("You must pass an array to race.");for(var d=!0,h=0;h<e.length;h++){if(n=e[h],r(n))return d=!1,void t(n);o.cast(n).then(a,l)}},t)}}),e("rsvp/promise/reject",["exports"],function(e){"use strict";e["default"]=function(e,t){var i=this;return new i(function(t,i){i(e)},t)}}),e("rsvp/promise/resolve",["exports"],function(e){"use strict";e["default"]=function(e,t){var i=this;return new i(function(t){t(e)},t)}}),e("rsvp/race",["./promise","exports"],function(e,t){"use strict";var i=e["default"];t["default"]=function(e,t){return i.race(e,t)}}),e("rsvp/reject",["./promise","exports"],function(e,t){"use strict";var i=e["default"];t["default"]=function(e,t){return i.reject(e,t)}}),e("rsvp/resolve",["./promise","exports"],function(e,t){"use strict";var i=e["default"];t["default"]=function(e,t){return i.resolve(e,t)}}),e("rsvp/rethrow",["exports"],function(e){"use strict";e["default"]=function(e){throw setTimeout(function(){throw e}),e}}),e("rsvp/utils",["exports"],function(e){"use strict";function t(e){return"function"==typeof e||"object"==typeof e&&null!==e}function i(e){return"function"==typeof e}function r(e){return!t(e)}function n(e){return"[object Array]"===Object.prototype.toString.call(e)}e.objectOrFunction=t,e.isFunction=i,e.isNonThenable=r,e.isArray=n;var o=Date.now||function(){return(new Date).getTime()};e.now=o;var s=Object.keys||function(e){var t=[];for(var i in e)t.push(i);return t};e.keysOf=s}),e("rsvp",["./rsvp/promise","./rsvp/events","./rsvp/node","./rsvp/all","./rsvp/all_settled","./rsvp/race","./rsvp/hash","./rsvp/rethrow","./rsvp/defer","./rsvp/config","./rsvp/map","./rsvp/resolve","./rsvp/reject","./rsvp/filter","exports"],function(e,t,i,r,n,o,s,a,l,d,h,u,c,f,m){"use strict";function p(e,t){F.async(e,t)}function _(){F.on.apply(F,arguments)}function g(){F.off.apply(F,arguments)}var v=e["default"],y=t["default"],b=i["default"],x=r["default"],w=n["default"],T=o["default"],E=s["default"],C=a["default"],S=l["default"],F=d.config,M=d.configure,A=h["default"],N=u["default"],R=c["default"],D=f["default"];if("undefined"!=typeof window&&"object"==typeof window.__PROMISE_INSTRUMENTATION__){var I=window.__PROMISE_INSTRUMENTATION__;M("instrument",!0);for(var P in I)I.hasOwnProperty(P)&&_(P,I[P])}m.Promise=v,m.EventTarget=y,m.all=x,m.allSettled=w,m.race=T,m.hash=E,m.rethrow=C,m.defer=S,m.denodeify=b,m.configure=M,m.on=_,m.off=g,m.resolve=N,m.reject=R,m.async=p,m.map=A,m.filter=D})}(),function(){e("container/container",["container/inheriting_dict","exports"],function(e,t){"use strict";function i(e){this.parent=e,this.children=[],this.resolver=e&&e.resolver||function(){},this.registry=new y(e&&e.registry),this.cache=new y(e&&e.cache),this.factoryCache=new y(e&&e.factoryCache),this.resolveCache=new y(e&&e.resolveCache),this.typeInjections=new y(e&&e.typeInjections),this.injections={},this.factoryTypeInjections=new y(e&&e.factoryTypeInjections),this.factoryInjections={},this._options=new y(e&&e._options),this._typeOptions=new y(e&&e._typeOptions)}function r(e,t){return e.cache.has(t)?!0:!!e.resolve(t)}function o(e,t,i){if(i=i||{},e.cache.has(t)&&i.singleton!==!1)return e.cache.get(t);var r=f(e,t);return void 0!==r?(a(e,t)&&i.singleton!==!1&&e.cache.set(t,r),r):void 0}function s(e){throw new Error(e+" is not currently supported on child containers")}function a(e,t){var i=d(e,t,"singleton");return i!==!1}function l(e,t){var i={};if(!t)return i;for(var r,n,s=0,a=t.length;a>s;s++){if(r=t[s],n=o(e,r.fullName),void 0===n)throw new Error("Attempting to inject an unknown injection: `"+r.fullName+"`");i[r.property]=n}return i}function d(e,t,i){var r=e._options.get(t);if(r&&void 0!==r[i])return r[i];var n=t.split(":")[0];return r=e._typeOptions.get(n),r?r[i]:void 0}function h(e,t){var i,r=t,o=e.resolve(r),s=e.factoryCache,a=t.split(":")[0];if(void 0!==o){if(s.has(t))return s.get(t);if(!o||"function"!=typeof o.extend||!n.MODEL_FACTORY_INJECTIONS&&"model"===a)return o;var l=u(e,t),d=c(e,t);return d._toString=e.makeToString(o,t),i=o.extend(l),i.reopenClass(d),s.set(t,i),i}}function u(e,t){var i=t.split(":"),r=i[0],n=[];return n=n.concat(e.typeInjections.get(r)||[]),n=n.concat(e.injections[t]||[]),n=l(e,n),n._debugContainerKey=t,n.container=e,n}function c(e,t){var i=t.split(":"),r=i[0],n=[];return n=n.concat(e.factoryTypeInjections.get(r)||[]),n=n.concat(e.factoryInjections[t]||[]),n=l(e,n),n._debugContainerKey=t,n}function f(e,t){var i=h(e,t);return d(e,t,"instantiate")===!1?i:i?"function"==typeof i.extend?i.create():i.create(u(e,t)):void 0}function m(e,t){e.cache.eachLocal(function(i,r){d(e,i,"instantiate")!==!1&&t(r)})}function p(e){e.cache.eachLocal(function(t,i){d(e,t,"instantiate")!==!1&&i.destroy()}),e.cache.dict={}}function _(e,t,i,r){var n=e.get(t);n||(n=[],e.set(t,n)),n.push({property:i,fullName:r})}function g(e){if(!b.test(e))throw new TypeError("Invalid Fullname, expected: `type:name` got: "+e)}function v(e,t,i,r){var n=e[t]=e[t]||[];n.push({property:i,fullName:r})}var y=e["default"];i.prototype={parent:null,children:null,resolver:null,registry:null,cache:null,typeInjections:null,injections:null,_options:null,_typeOptions:null,child:function(){var e=new i(this);return this.children.push(e),e},set:function(e,t,i){e[t]=i},register:function(e,t,i){if(g(e),void 0===t)throw new TypeError("Attempting to register an unknown factory: `"+e+"`");var r=this.normalize(e);if(this.cache.has(r))throw new Error("Cannot re-register: `"+e+"`, as it has already been looked up.");this.registry.set(r,t),this._options.set(r,i||{})},unregister:function(e){g(e);var t=this.normalize(e);this.registry.remove(t),this.cache.remove(t),this.factoryCache.remove(t),this.resolveCache.remove(t),this._options.remove(t)},resolve:function(e){g(e);var t=this.normalize(e),i=this.resolveCache.get(t);if(i)return i;var r=this.resolver(t)||this.registry.get(t);return this.resolveCache.set(t,r),r},describe:function(e){return e},normalize:function(e){return e},makeToString:function(e){return e.toString()},lookup:function(e,t){return g(e),o(this,this.normalize(e),t)},lookupFactory:function(e){return g(e),h(this,this.normalize(e))},has:function(e){return g(e),r(this,this.normalize(e))},optionsForType:function(e,t){this.parent&&s("optionsForType"),this._typeOptions.set(e,t)},options:function(e,t){this.optionsForType(e,t)},typeInjection:function(e,t,i){g(i),this.parent&&s("typeInjection");var r=i.split(":")[0];if(r===e)throw new Error("Cannot inject a `"+i+"` on other "+e+"(s). Register the `"+i+"` as a different type and perform the typeInjection.");_(this.typeInjections,e,t,i)},injection:function(e,t,i){this.parent&&s("injection"),g(i);var r=this.normalize(i);if(-1===e.indexOf(":"))return this.typeInjection(e,t,r);g(e);var n=this.normalize(e);v(this.injections,n,t,r)},factoryTypeInjection:function(e,t,i){this.parent&&s("factoryTypeInjection"),_(this.factoryTypeInjections,e,t,this.normalize(i))},factoryInjection:function(e,t,i){this.parent&&s("injection");var r=this.normalize(e),n=this.normalize(i);return g(i),-1===e.indexOf(":")?this.factoryTypeInjection(r,t,n):(g(e),void v(this.factoryInjections,r,t,n))},destroy:function(){for(var e=0,t=this.children.length;t>e;e++)this.children[e].destroy();this.children=[],m(this,function(e){e.destroy()}),this.parent=void 0,this.isDestroyed=!0},reset:function(){for(var e=0,t=this.children.length;t>e;e++)p(this.children[e]);p(this)}};var b=/^[^:]+.+:[^:]+$/;t["default"]=i}),e("container/inheriting_dict",["exports"],function(e){"use strict";function t(e){this.parent=e,this.dict={}}t.prototype={parent:null,dict:null,get:function(e){var t=this.dict;return t.hasOwnProperty(e)?t[e]:this.parent?this.parent.get(e):void 0},set:function(e,t){this.dict[e]=t},remove:function(e){delete this.dict[e]},has:function(e){var t=this.dict;return t.hasOwnProperty(e)?!0:this.parent?this.parent.has(e):!1},eachLocal:function(e,t){var i=this.dict;for(var r in i)i.hasOwnProperty(r)&&e.call(t,r,i[r])}},e["default"]=t}),e("container",["container/container","exports"],function(e,t){"use strict";n.MODEL_FACTORY_INJECTIONS=!1,n.ENV&&"undefined"!=typeof n.ENV.MODEL_FACTORY_INJECTIONS&&(n.MODEL_FACTORY_INJECTIONS=!!n.ENV.MODEL_FACTORY_INJECTIONS);var i=e["default"];t["default"]=i})}(),function(){e("ember-runtime/compare",["ember-metal/core","ember-metal/utils","ember-runtime/mixins/comparable","exports"],function(e,t,i,r){"use strict";function n(e,t){if(e===t)return 0;var i=s(e),r=s(t);if(a){if("instance"===i&&a.detect(e.constructor))return e.constructor.compare(e,t);if("instance"===r&&a.detect(t.constructor))return 1-t.constructor.compare(t,e)}var l=o.ORDER_DEFINITION_MAPPING;if(!l){var d=o.ORDER_DEFINITION;l=o.ORDER_DEFINITION_MAPPING={};var h,u;for(h=0,u=d.length;u>h;++h)l[d[h]]=h;delete o.ORDER_DEFINITION}var c=l[i],f=l[r];if(f>c)return-1;if(c>f)return 1;switch(i){case"boolean":case"number":return t>e?-1:e>t?1:0;case"string":var m=e.localeCompare(t);return 0>m?-1:m>0?1:0;case"array":for(var p=e.length,_=t.length,g=Math.min(p,_),v=0,y=0;0===v&&g>y;)v=n(e[y],t[y]),y++;return 0!==v?v:_>p?-1:p>_?1:0;case"instance":return a&&a.detect(e)?e.compare(e,t):0;case"date":var b=e.getTime(),x=t.getTime();return x>b?-1:b>x?1:0;default:return 0}}var o=e["default"],s=t.typeOf,a=i["default"];o.ORDER_DEFINITION=o.ENV.ORDER_DEFINITION||["undefined","null","boolean","number","string","array","object","instance","function","class","date"],r["default"]=n}),e("ember-runtime/computed/array_computed",["ember-metal/core","ember-runtime/computed/reduce_computed","ember-metal/enumerable_utils","ember-metal/platform","ember-metal/observer","ember-metal/error","exports"],function(e,t,i,r,n,o,s){"use strict";function a(){var e=this;return h.apply(this,arguments),this.func=function(t){return function(i){return e._hasInstanceMeta(this,i)||g(e._dependentKeys,function(t){f(this,t,function(){e.recomputeOnce.call(this,i)})},this),t.apply(this,arguments)}}(this.func),this}function l(e){var t;if(arguments.length>1&&(t=p.call(arguments,0,-1),e=p.call(arguments,-1)[0]),"object"!=typeof e)throw new m("Array Computed Property declared without an options hash");var i=new a(e);return t&&i.property.apply(i,t),i}var d=e["default"],h=(t.reduceComputed,t.ReduceComputedProperty),u=i["default"],c=r.create,f=n.addObserver,m=o["default"],p=[].slice,_=c,g=u.forEach;a.prototype=_(h.prototype),a.prototype.initialValue=function(){return d.A()},a.prototype.resetValue=function(e){return e.clear(),e},a.prototype.didChange=function(){},s.arrayComputed=l,s.ArrayComputedProperty=a}),e("ember-runtime/computed/reduce_computed",["ember-metal/core","ember-metal/property_get","ember-metal/property_set","ember-metal/utils","ember-metal/error","ember-metal/property_events","ember-metal/expand_properties","ember-metal/observer","ember-metal/computed","ember-metal/platform","ember-metal/enumerable_utils","ember-runtime/system/tracked_array","ember-runtime/mixins/array","ember-metal/run_loop","ember-runtime/system/set","exports"],function(e,t,i,r,n,o,s,a,l,d,h,u,c,f,m,p){"use strict";function _(e,t){return"@this"===t?e:N(e,t)}function g(e,t,i){this.callbacks=e,this.cp=t,this.instanceMeta=i,this.dependentKeysByGuid={},this.trackedArraysByGuid={},this.suspended=!1,this.changedItems={},this.changedItemCount=0}function v(e,t,i){A.assert("Internal error: trackedArray is null or undefined",i),this.dependentArray=e,this.index=t,this.item=e.objectAt(t),this.trackedArray=i,this.beforeObserver=null,this.observer=null,this.destroyed=!1}function y(e,t,i){return 0>e?Math.max(0,t+e):t>e?e:Math.min(t-i,e)}function b(e,t,i){return Math.min(i,t-e)}function x(e,t,i,r,n,o){var s={arrayChanged:e,index:i,item:t,propertyName:r,property:n};return o&&(s.previousValues=o),s}function w(e,t,i,r,n){tt(e,function(o,s){n.setValue(t.addedItem.call(this,n.getValue(),o,x(e,o,s,r,i),n.sugarMeta))},this)}function T(e,t){{var i;e._callbacks()}e._hasInstanceMeta(this,t)?(i=e._instanceMeta(this,t),i.setValue(e.resetValue(i.getValue()))):i=e._instanceMeta(this,t),e.options.initialize&&e.options.initialize.call(this,i.getValue(),{property:e,propertyName:t},i.sugarMeta)}function E(e,t){if(nt.test(t))return!1;var i=_(e,t);return Y.detect(i)}function C(e,t,i){this.context=e,this.propertyName=t,this.cache=D(e).cache,this.dependentArrays={},this.sugarMeta={},this.initialValue=i}function S(e){var t=this;this.options=e,this._dependentKeys=null,this._itemPropertyKeys={},this._previousItemPropertyKeys={},this.readOnly(),this.cacheable(),this.recomputeOnce=function(e){W.once(this,i,e)};var i=function(e){var i=(t._dependentKeys,t._instanceMeta(this,e)),r=t._callbacks();T.call(this,t,e),i.dependentArraysObserver.suspendArrayObservers(function(){tt(t._dependentKeys,function(e){if(A.assert("dependent array "+e+" must be an `Ember.Array`.  If you are not extending arrays, you will need to wrap native arrays with `Ember.A`",!(K(_(this,e))&&!Y.detect(_(this,e)))),E(this,e)){var r=_(this,e),n=i.dependentArrays[e];r===n?t._previousItemPropertyKeys[e]&&(delete t._previousItemPropertyKeys[e],i.dependentArraysObserver.setupPropertyObservers(e,t._itemPropertyKeys[e])):(i.dependentArrays[e]=r,n&&i.dependentArraysObserver.teardownObservers(n,e),r&&i.dependentArraysObserver.setupObservers(r,e))}},this)},this),tt(t._dependentKeys,function(n){if(E(this,n)){var o=_(this,n);o&&w.call(this,o,r,t,e,i)}},this)};this.func=function(e){return A.assert("Computed reduce values require at least one dependent key",t._dependentKeys),i.call(this,e),t._instanceMeta(this,e).getValue()}}function F(e){return e}function M(e){var t;if(arguments.length>1&&(t=J.call(arguments,0,-1),e=J.call(arguments,-1)[0]),"object"!=typeof e)throw new I("Reduce Computed Property declared without an options hash");if(!("initialValue"in e))throw new I("Reduce Computed Property declared without an initial value");var i=new S(e);return t&&i.property.apply(i,t),i}var A=e["default"],N=t.get,R=(i.set,r.guidFor),D=r.meta,I=n["default"],P=o.propertyWillChange,k=o.propertyDidChange,V=s["default"],O=a.addObserver,L=(a.observersFor,a.removeObserver),B=a.addBeforeObserver,U=a.removeBeforeObserver,z=l.ComputedProperty,j=l.cacheFor,G=d.create,X=h["default"],H=u["default"],Y=c["default"],W=f["default"],q=m["default"],K=r.isArray,$=j.set,Q=j.get,Z=j.remove,J=[].slice,et=G,tt=X.forEach,it=/^(.*)\.@each\.(.*)/,rt=/(.*\.@each){2,}/,nt=/\.\[\]$/;g.prototype={setValue:function(e){this.instanceMeta.setValue(e,!0)},getValue:function(){return this.instanceMeta.getValue()},setupObservers:function(e,t){this.dependentKeysByGuid[R(e)]=t,e.addArrayObserver(this,{willChange:"dependentArrayWillChange",didChange:"dependentArrayDidChange"}),this.cp._itemPropertyKeys[t]&&this.setupPropertyObservers(t,this.cp._itemPropertyKeys[t])},teardownObservers:function(e,t){var i=this.cp._itemPropertyKeys[t]||[];delete this.dependentKeysByGuid[R(e)],this.teardownPropertyObservers(t,i),e.removeArrayObserver(this,{willChange:"dependentArrayWillChange",didChange:"dependentArrayDidChange"})},suspendArrayObservers:function(e,t){var i=this.suspended;this.suspended=!0,e.call(t),this.suspended=i},setupPropertyObservers:function(e,t){var i=_(this.instanceMeta.context,e),r=_(i,"length"),n=new Array(r);this.resetTransformations(e,n),tt(i,function(r,o){var s=this.createPropertyObserverContext(i,o,this.trackedArraysByGuid[e]);n[o]=s,tt(t,function(e){B(r,e,this,s.beforeObserver),O(r,e,this,s.observer)},this)},this)},teardownPropertyObservers:function(e,t){var i,r,n,o=this,s=this.trackedArraysByGuid[e];s&&s.apply(function(e,s,a){a!==H.DELETE&&tt(e,function(e){e.destroyed=!0,i=e.beforeObserver,r=e.observer,n=e.item,tt(t,function(e){U(n,e,o,i),L(n,e,o,r)})})})},createPropertyObserverContext:function(e,t,i){var r=new v(e,t,i);return this.createPropertyObserver(r),r},createPropertyObserver:function(e){var t=this;e.beforeObserver=function(i,r){return t.itemPropertyWillChange(i,r,e.dependentArray,e)},e.observer=function(i,r){return t.itemPropertyDidChange(i,r,e.dependentArray,e)}},resetTransformations:function(e,t){this.trackedArraysByGuid[e]=new H(t)},trackAdd:function(e,t,i){var r=this.trackedArraysByGuid[e];r&&r.addItems(t,i)},trackRemove:function(e,t,i){var r=this.trackedArraysByGuid[e];return r?r.removeItems(t,i):[]},updateIndexes:function(e,t){var i=_(t,"length");e.apply(function(e,t,r,n){r!==H.DELETE&&(0!==n||r!==H.RETAIN||e.length!==i||0!==t)&&tt(e,function(e,i){e.index=i+t})})},dependentArrayWillChange:function(e,t,i){function r(e){l[a].destroyed=!0,U(o,e,this,l[a].beforeObserver),L(o,e,this,l[a].observer)}if(!this.suspended){var n,o,s,a,l,d=this.callbacks.removedItem,h=R(e),u=this.dependentKeysByGuid[h],c=this.cp._itemPropertyKeys[u]||[],f=_(e,"length"),m=y(t,f,0),p=b(m,f,i);for(l=this.trackRemove(u,m,p),a=p-1;a>=0&&(s=m+a,!(s>=f));--a)o=e.objectAt(s),tt(c,r,this),n=x(e,o,s,this.instanceMeta.propertyName,this.cp),this.setValue(d.call(this.instanceMeta.context,this.getValue(),o,n,this.instanceMeta.sugarMeta))}},dependentArrayDidChange:function(e,t,i,r){if(!this.suspended){var n,o,s=this.callbacks.addedItem,a=R(e),l=this.dependentKeysByGuid[a],d=new Array(r),h=this.cp._itemPropertyKeys[l],u=_(e,"length"),c=y(t,u,r);
tt(e.slice(c,c+r),function(t,i){h&&(o=d[i]=this.createPropertyObserverContext(e,c+i,this.trackedArraysByGuid[l]),tt(h,function(e){B(t,e,this,o.beforeObserver),O(t,e,this,o.observer)},this)),n=x(e,t,c+i,this.instanceMeta.propertyName,this.cp),this.setValue(s.call(this.instanceMeta.context,this.getValue(),t,n,this.instanceMeta.sugarMeta))},this),this.trackAdd(l,c,d)}},itemPropertyWillChange:function(e,t,i,r){var n=R(e);this.changedItems[n]||(this.changedItems[n]={array:i,observerContext:r,obj:e,previousValues:{}}),++this.changedItemCount,this.changedItems[n].previousValues[t]=_(e,t)},itemPropertyDidChange:function(){0===--this.changedItemCount&&this.flushChanges()},flushChanges:function(){var e,t,i,r=this.changedItems;for(e in r)t=r[e],t.observerContext.destroyed||(this.updateIndexes(t.observerContext.trackedArray,t.observerContext.dependentArray),i=x(t.array,t.obj,t.observerContext.index,this.instanceMeta.propertyName,this.cp,t.previousValues),this.setValue(this.callbacks.removedItem.call(this.instanceMeta.context,this.getValue(),t.obj,i,this.instanceMeta.sugarMeta)),this.setValue(this.callbacks.addedItem.call(this.instanceMeta.context,this.getValue(),t.obj,i,this.instanceMeta.sugarMeta)));this.changedItems={}}},C.prototype={getValue:function(){var e=Q(this.cache,this.propertyName);return void 0!==e?e:this.initialValue},setValue:function(e,t){e!==Q(this.cache,this.propertyName)&&(t&&P(this.context,this.propertyName),void 0===e?Z(this.cache,this.propertyName):$(this.cache,this.propertyName,e),t&&k(this.context,this.propertyName))}},S.prototype=et(z.prototype),S.prototype._callbacks=function(){if(!this.callbacks){var e=this.options;this.callbacks={removedItem:e.removedItem||F,addedItem:e.addedItem||F}}return this.callbacks},S.prototype._hasInstanceMeta=function(e,t){return!!D(e).cacheMeta[t]},S.prototype._instanceMeta=function(e,t){var i=D(e).cacheMeta,r=i[t];return r||(r=i[t]=new C(e,t,this.initialValue()),r.dependentArraysObserver=new g(this._callbacks(),this,r,e,t,r.sugarMeta)),r},S.prototype.initialValue=function(){return"function"==typeof this.options.initialValue?this.options.initialValue():this.options.initialValue},S.prototype.resetValue=function(){return this.initialValue()},S.prototype.itemPropertyKey=function(e,t){this._itemPropertyKeys[e]=this._itemPropertyKeys[e]||[],this._itemPropertyKeys[e].push(t)},S.prototype.clearItemPropertyKeys=function(e){this._itemPropertyKeys[e]&&(this._previousItemPropertyKeys[e]=this._itemPropertyKeys[e],this._itemPropertyKeys[e]=[])},S.prototype.property=function(){var e,t,i=this,r=J.call(arguments),n=new q;return tt(r,function(r){if(rt.test(r))throw new I("Nested @each properties not supported: "+r);if(e=it.exec(r)){t=e[1];var o=e[2],s=function(e){i.itemPropertyKey(t,e)};V(o,s),n.add(t)}else n.add(r)}),z.prototype.property.apply(this,n.toArray())},p.reduceComputed=M,p.ReduceComputedProperty=S}),e("ember-runtime/computed/reduce_computed_macros",["ember-metal/core","ember-metal/merge","ember-metal/property_get","ember-metal/property_set","ember-metal/utils","ember-metal/error","ember-metal/enumerable_utils","ember-metal/run_loop","ember-metal/observer","ember-runtime/computed/array_computed","ember-runtime/computed/reduce_computed","ember-runtime/system/object_proxy","ember-runtime/system/subarray","ember-runtime/keys","ember-runtime/compare","exports"],function(e,t,i,r,n,o,s,a,l,d,h,u,c,f,m,p){"use strict";function _(e){return B(e,{initialValue:0,addedItem:function(e,t){return e+t},removedItem:function(e,t){return e-t}})}function g(e){return B(e,{initialValue:-1/0,addedItem:function(e,t){return Math.max(e,t)},removedItem:function(e,t){return e>t?e:void 0}})}function v(e){return B(e,{initialValue:1/0,addedItem:function(e,t){return Math.min(e,t)},removedItem:function(e,t){return t>e?e:void 0}})}function y(e,t){var i={addedItem:function(e,i,r){var n=t.call(this,i);return e.insertAt(r.index,n),e},removedItem:function(e,t,i){return e.removeAt(i.index,1),e}};return L(e,i)}function b(e,t){var i=function(e){return R(e,t)};return y(e+".@each."+t,i)}function x(e,t){var i={initialize:function(e,t,i){i.filteredArrayIndexes=new z},addedItem:function(e,i,r,n){var o=!!t.call(this,i),s=n.filteredArrayIndexes.addItem(r.index,o);return o&&e.insertAt(s,i),e},removedItem:function(e,t,i,r){var n=r.filteredArrayIndexes.removeItem(i.index);return n>-1&&e.removeAt(n),e}};return L(e,i)}function w(e,t,i){var r;return r=2===arguments.length?function(e){return R(e,t)}:function(e){return R(e,t)===i},x(e+".@each."+t,r)}function T(){var e=X.call(arguments);return e.push({initialize:function(e,t,i){i.itemCounts={}},addedItem:function(e,t,i,r){var n=I(t);return r.itemCounts[n]?++r.itemCounts[n]:r.itemCounts[n]=1,e.addObject(t),e},removedItem:function(e,t,i,r){var n=I(t),o=r.itemCounts;return 0===--o[n]&&e.removeObject(t),e}}),L.apply(null,e)}function E(){var e=function(e){return k.map(e.property._dependentKeys,function(e){return I(e)})},t=X.call(arguments);return t.push({initialize:function(e,t,i){i.itemCounts={}},addedItem:function(t,i,r,n){var o=I(i),s=(e(r),I(r.arrayChanged)),a=r.property._dependentKeys.length,l=n.itemCounts;return l[o]||(l[o]={}),void 0===l[o][s]&&(l[o][s]=0),1===++l[o][s]&&a===j(l[o]).length&&t.addObject(i),t},removedItem:function(t,i,r,n){var o,s=I(i),a=(e(r),I(r.arrayChanged)),l=(r.property._dependentKeys.length,n.itemCounts);return void 0===l[s][a]&&(l[s][a]=0),0===--l[s][a]&&(delete l[s][a],o=j(l[s]).length,0===o&&delete l[s],t.removeObject(i)),t}}),L.apply(null,t)}function C(e,t){if(2!==arguments.length)throw new P("setDiff requires exactly two dependent arrays.");return L(e,t,{addedItem:function(i,r,n){var o=R(this,e),s=R(this,t);return n.arrayChanged===o?s.contains(r)||i.addObject(r):i.removeObject(r),i},removedItem:function(i,r,n){var o=R(this,e),s=R(this,t);return n.arrayChanged===s?o.contains(r)&&i.addObject(r):i.removeObject(r),i}})}function S(e,t,i,r){function n(e){return I(M.detectInstance(e)?R(e,"content"):e)}var o,s,a,l,d;return arguments.length<4&&(r=R(e,"length")),arguments.length<3&&(i=0),i===r?i:(o=i+Math.floor((r-i)/2),s=e.objectAt(o),l=n(s),d=n(t),l===d?o:(a=this.order(s,t),0===a&&(a=d>l?-1:1),0>a?this.binarySearch(e,t,o+1,r):a>0?this.binarySearch(e,t,i,o):o))}function F(e,t){A.assert("Ember.computed.sort requires two arguments: an array key to sort and either a sort properties key or sort function",2===arguments.length);var i,r;return"function"==typeof t?i=function(e,i,r){r.order=t,r.binarySearch=S}:(r=t,i=function(t,i,n){function o(){var t,o,a,l=R(this,r),d=n.sortProperties=[],h=n.sortPropertyAscending={};A.assert("Cannot sort: '"+r+"' is not an array.",D(l)),i.property.clearItemPropertyKeys(e),H(l,function(r){-1!==(o=r.indexOf(":"))?(t=r.substring(0,o),a="desc"!==r.substring(o+1).toLowerCase()):(t=r,a=!0),d.push(t),h[t]=a,i.property.itemPropertyKey(e,t)}),l.addObserver("@each",this,s)}function s(){V.once(this,a,i.propertyName)}function a(e){o.call(this),i.property.recomputeOnce.call(this,e)}O(this,r,s),o.call(this),n.order=function(e,t){for(var i,r,n,o=t instanceof M,s=0;s<this.sortProperties.length;++s)if(i=this.sortProperties[s],r=G(R(e,i),o?t[i]:R(t,i)),0!==r)return n=this.sortPropertyAscending[i],n?r:-1*r;return 0},n.binarySearch=S}),L(e,{initialize:i,addedItem:function(e,t,i,r){var n=r.binarySearch(e,t);return e.insertAt(n,t),e},removedItem:function(e,t,i,r){var n,o,s;return i.previousValues?(n=N({content:t},i.previousValues),s=M.create(n)):s=t,o=r.binarySearch(e,s),e.removeAt(o),e}})}var M,A=e["default"],N=t["default"],R=i.get,D=(r.set,n.isArray),I=n.guidFor,P=o["default"],k=s["default"],V=a["default"],O=l.addObserver,L=d.arrayComputed,B=h.reduceComputed,U=u["default"],z=c["default"],j=f["default"],G=m["default"],X=[].slice,H=k.forEach,Y=b,W=w,q=T,M=U.extend();p.sum=_,p.min=v,p.max=g,p.map=y,p.sort=F,p.setDiff=C,p.mapBy=b,p.mapProperty=Y,p.filter=x,p.filterBy=w,p.filterProperty=W,p.uniq=T,p.union=q,p.intersect=E}),e("ember-runtime/controllers/array_controller",["ember-metal/core","ember-metal/property_get","ember-metal/property_set","ember-metal/enumerable_utils","ember-runtime/system/array_proxy","ember-runtime/mixins/sortable","ember-runtime/controllers/controller","ember-metal/computed","ember-metal/error","exports"],function(e,t,i,r,n,o,s,a,l,d){"use strict";var h=e["default"],u=t.get,c=(i.set,r["default"]),f=n["default"],m=o["default"],p=s.ControllerMixin,_=a.computed,g=l["default"],v=c.forEach,y=c.replace,b=f.extend(p,m,{itemController:null,lookupItemController:function(){return u(this,"itemController")},objectAtContent:function(e){var t=u(this,"length"),i=u(this,"arrangedContent"),r=i&&i.objectAt(e);if(e>=0&&t>e){var n=this.lookupItemController(r);if(n)return this.controllerAt(e,r,n)}return r},arrangedContentDidChange:function(){this._super(),this._resetSubControllers()},arrayContentDidChange:function(e,t,i){var r=u(this,"_subControllers"),n=r.slice(e,e+t);v(n,function(e){e&&e.destroy()}),y(r,e,t,new Array(i)),this._super(e,t,i)},init:function(){this._super(),this.set("_subControllers",[])},content:_(function(){return h.A()}),_isVirtual:!1,controllerAt:function(e,t,i){var r,n=u(this,"container"),o=u(this,"_subControllers"),s=o[e];if(s)return s;if(r="controller:"+i,!n.has(r))throw new g('Could not resolve itemController: "'+i+'"');var a;return this._isVirtual&&(a=u(this,"parentController")),a=a||this,s=n.lookupFactory(r).create({target:this,parentController:a,content:t}),o[e]=s,s},_subControllers:null,_resetSubControllers:function(){var e,t=u(this,"_subControllers");if(t.length){for(var i=0,r=t.length;r>i;i++)e=t[i],e&&e.destroy();t.length=0}},willDestroy:function(){this._resetSubControllers(),this._super()}});d["default"]=b}),e("ember-runtime/controllers/controller",["ember-metal/core","ember-metal/property_get","ember-runtime/system/object","ember-metal/mixin","ember-metal/computed","ember-runtime/mixins/action_handler","exports"],function(e,t,i,r,n,o,s){"use strict";var a=e["default"],l=(t.get,i["default"]),d=r.Mixin,h=n.computed,u=o["default"],c=d.create(u,{isController:!0,target:null,container:null,parentController:null,store:null,model:h.alias("content"),deprecatedSendHandles:function(e){return!!this[e]},deprecatedSend:function(e){var t=[].slice.call(arguments,1);a.assert(""+this+" has the action "+e+" but it is not a function","function"==typeof this[e]),a.deprecate("Action handlers implemented directly on controllers are deprecated in favor of action handlers on an `actions` object ( action: `"+e+"` on "+this+")",!1),this[e].apply(this,t)}}),f=l.extend(c);s.Controller=f,s.ControllerMixin=c}),e("ember-runtime/controllers/object_controller",["ember-runtime/controllers/controller","ember-runtime/system/object_proxy","exports"],function(e,t,i){"use strict";var r=e.ControllerMixin,n=t["default"],o=n.extend(r);i["default"]=o}),e("ember-runtime/copy",["ember-metal/enumerable_utils","ember-metal/utils","ember-runtime/system/object","ember-runtime/mixins/copyable","ember-metal/platform","exports"],function(e,t,i,r,o,s){"use strict";function a(e,t,i,r){var o,s,l;if("object"!=typeof e||null===e)return e;if(t&&(s=f(i,e))>=0)return r[s];if(n.assert("Cannot clone an Ember.Object that does not implement Ember.Copyable",!(e instanceof u)||c&&c.detect(e)),"array"===h(e)){if(o=e.slice(),t)for(s=o.length;--s>=0;)o[s]=a(o[s],t,i,r)}else if(c&&c.detect(e))o=e.copy(t,i,r);else if(e instanceof Date)o=new Date(e.getTime());else{o={};for(l in e)e.hasOwnProperty(l)&&"__"!==l.substring(0,2)&&(o[l]=t?a(e[l],t,i,r):e[l])}return t&&(i.push(e),r.push(o)),o}function l(e,t){return"object"!=typeof e||null===e?e:c&&c.detect(e)?e.copy(t):a(e,t,t?[]:null,t?[]:null)}var d=e["default"],h=t.typeOf,u=i["default"],c=r["default"],f=(o.create,d.indexOf);s["default"]=l}),e("ember-runtime/core",["exports"],function(e){"use strict";function t(e,t){return e&&"function"==typeof e.isEqual?e.isEqual(t):e instanceof Date&&t instanceof Date?e.getTime()===t.getTime():e===t}e.isEqual=t}),e("ember-runtime/ext/function",["ember-metal/core","ember-metal/expand_properties","ember-metal/computed"],function(e,t,i){"use strict";var r=e["default"],n=t["default"],o=i.computed,s=Array.prototype.slice,a=Function.prototype;(r.EXTEND_PROTOTYPES===!0||r.EXTEND_PROTOTYPES.Function)&&(a.property=function(){var e=o(this);return e.property.apply(e,arguments)},a.observes=function(){for(var e=function(e){t.push(e)},t=[],i=0;i<arguments.length;++i)n(arguments[i],e);return this.__ember_observes__=t,this},a.observesImmediately=function(){for(var e=0,t=arguments.length;t>e;e++){var i=arguments[e];r.assert("Immediate observers must observe internal properties only, not properties on other objects.",-1===i.indexOf("."))}return this.observes.apply(this,arguments)},a.observesBefore=function(){for(var e=function(e){t.push(e)},t=[],i=0;i<arguments.length;++i)n(arguments[i],e);return this.__ember_observesBefore__=t,this},a.on=function(){var e=s.call(arguments);return this.__ember_listens__=e,this})}),e("ember-runtime/ext/rsvp",["ember-metal/core","ember-metal/logger","exports"],function(e,i,r){"use strict";var n,o=e["default"],s=i["default"],a=t("rsvp"),l="ember-testing/test";a.onerrorDefault=function(e){if(e instanceof Error)if(o.testing){if(!n&&o.__loader.registry[l]&&(n=t(l)["default"]),!n||!n.adapter)throw e;n.adapter.exception(e)}else o.onerror?o.onerror(e):(s.error(e.stack),o.assert(e,!1))},a.on("error",a.onerrorDefault),r["default"]=a}),e("ember-runtime/ext/string",["ember-metal/core","ember-runtime/system/string"],function(e,t){"use strict";var i=e["default"],r=t.fmt,n=t.w,o=t.loc,s=t.camelize,a=t.decamelize,l=t.dasherize,d=t.underscore,h=t.capitalize,u=t.classify,c=String.prototype;(i.EXTEND_PROTOTYPES===!0||i.EXTEND_PROTOTYPES.String)&&(c.fmt=function(){return r(this,arguments)},c.w=function(){return n(this)},c.loc=function(){return o(this,arguments)},c.camelize=function(){return s(this)},c.decamelize=function(){return a(this)},c.dasherize=function(){return l(this)},c.underscore=function(){return d(this)},c.classify=function(){return u(this)},c.capitalize=function(){return h(this)})}),e("ember-runtime/keys",["ember-metal/enumerable_utils","ember-metal/platform","exports"],function(e,t,i){"use strict";var r=e["default"],n=t.create,o=Object.keys;if(!o||n.isSimulated){var s=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","valueOf","toLocaleString","toString"],a=function(e,t,i){"__"!==i.substring(0,2)&&"_super"!==i&&(r.indexOf(t,i)>=0||("function"!=typeof e.hasOwnProperty||e.hasOwnProperty(i))&&t.push(i))};o=function(e){var t,i=[];for(t in e)a(e,i,t);for(var r=0,n=s.length;n>r;r++)t=s[r],a(e,i,t);return i}}i["default"]=o}),e("ember-runtime",["ember-metal","ember-runtime/core","ember-runtime/keys","ember-runtime/compare","ember-runtime/copy","ember-runtime/system/namespace","ember-runtime/system/object","ember-runtime/system/tracked_array","ember-runtime/system/subarray","ember-runtime/system/container","ember-runtime/system/application","ember-runtime/system/array_proxy","ember-runtime/system/object_proxy","ember-runtime/system/core_object","ember-runtime/system/each_proxy","ember-runtime/system/native_array","ember-runtime/system/set","ember-runtime/system/string","ember-runtime/system/deferred","ember-runtime/system/lazy_load","ember-runtime/mixins/array","ember-runtime/mixins/comparable","ember-runtime/mixins/copyable","ember-runtime/mixins/enumerable","ember-runtime/mixins/freezable","ember-runtime/mixins/observable","ember-runtime/mixins/action_handler","ember-runtime/mixins/deferred","ember-runtime/mixins/mutable_enumerable","ember-runtime/mixins/mutable_array","ember-runtime/mixins/target_action_support","ember-runtime/mixins/evented","ember-runtime/mixins/promise_proxy","ember-runtime/mixins/sortable","ember-runtime/computed/array_computed","ember-runtime/computed/reduce_computed","ember-runtime/computed/reduce_computed_macros","ember-runtime/controllers/array_controller","ember-runtime/controllers/object_controller","ember-runtime/controllers/controller","ember-runtime/ext/rsvp","ember-runtime/ext/string","ember-runtime/ext/function","exports"],function(e,t,i,r,o,s,a,l,d,h,u,c,f,m,p,_,g,v,y,b,x,w,T,E,C,S,F,M,A,N,R,D,I,P,k,V,O,L,B,U,z,j,G,X){"use strict";n.compare=r["default"],n.copy=o["default"],n.isEqual=t.isEqual,n.keys=i["default"],n.Array=x["default"],n.Comparable=w["default"],n.Copyable=T["default"],n.SortableMixin=P["default"],n.Freezable=C.Freezable,n.FROZEN_ERROR=C.FROZEN_ERROR,n.DeferredMixin=M["default"],n.MutableEnumerable=A["default"],n.MutableArray=N["default"],n.TargetActionSupport=R["default"],n.Evented=D["default"],n.PromiseProxyMixin=I["default"],n.Observable=S["default"],n.arrayComputed=k.arrayComputed,n.ArrayComputedProperty=k.ArrayComputedProperty,n.reduceComputed=V.reduceComputed,n.ReduceComputedProperty=V.ReduceComputedProperty;var H=n.computed;H.sum=O.sum,H.min=O.min,H.max=O.max,H.map=O.map,H.sort=O.sort,H.setDiff=O.setDiff,H.mapBy=O.mapBy,H.mapProperty=O.mapProperty,H.filter=O.filter,H.filterBy=O.filterBy,H.filterProperty=O.filterProperty,H.uniq=O.uniq,H.union=O.union,H.intersect=O.intersect,n.String=v["default"],n.Object=a["default"],n.TrackedArray=l["default"],n.SubArray=d["default"],n.Container=h["default"],n.Namespace=s["default"],n.Application=u["default"],n.Enumerable=E["default"],n.ArrayProxy=c["default"],n.ObjectProxy=f["default"],n.ActionHandler=F["default"],n.CoreObject=m["default"],n.EachArray=p.EachArray,n.EachProxy=p.EachProxy,n.NativeArray=_["default"],n.Set=g["default"],n.Deferred=y["default"],n.onLoad=b.onLoad,n.runLoadHooks=b.runLoadHooks,n.ArrayController=L["default"],n.ObjectController=B["default"],n.Controller=U.Controller,n.ControllerMixin=U.ControllerMixin,n.RSVP=z["default"],X["default"]=n}),e("ember-runtime/mixins/action_handler",["ember-metal/merge","ember-metal/mixin","ember-metal/property_get","ember-metal/utils","exports"],function(e,t,i,r,o){"use strict";var s=e["default"],a=t.Mixin,l=i.get,d=r.typeOf,h=a.create({mergedProperties:["_actions"],willMergeMixin:function(e){var t;e._actions||(n.assert("'actions' should not be a function","function"!=typeof e.actions),"object"===d(e.actions)?t="actions":"object"===d(e.events)&&(n.deprecate("Action handlers contained in an `events` object are deprecated in favor of putting them in an `actions` object",!1),t="events"),t&&(e._actions=s(e._actions||{},e[t])),delete e[t])},send:function(e){var t,i=[].slice.call(arguments,1);if(this._actions&&this._actions[e]){if(this._actions[e].apply(this,i)!==!0)return}else if(!n.FEATURES.isEnabled("ember-routing-drop-deprecated-action-style")&&this.deprecatedSend&&this.deprecatedSendHandles&&this.deprecatedSendHandles(e)&&(n.warn("The current default is deprecated but will prefer to handle actions directly on the controller instead of a similarly named action in the actions hash. To turn off this deprecated feature set: Ember.FEATURES['ember-routing-drop-deprecated-action-style'] = true"),this.deprecatedSend.apply(this,[].slice.call(arguments))!==!0))return;(t=l(this,"target"))&&(n.assert("The `target` for "+this+" ("+t+") does not have a `send` method","function"==typeof t.send),t.send.apply(t,arguments))}});o["default"]=h}),e("ember-runtime/mixins/array",["ember-metal/core","ember-metal/property_get","ember-metal/property_set","ember-metal/computed","ember-metal/is_none","ember-runtime/mixins/enumerable","ember-metal/enumerable_utils","ember-metal/mixin","ember-metal/property_events","ember-metal/events","ember-metal/watching","exports"],function(e,i,r,n,o,s,a,l,d,h,u,c){"use strict";var f=e["default"],m=i.get,p=(r.set,n.computed),_=n.cacheFor,g=o.isNone,v=(o.none,s["default"]),y=a["default"],b=l.Mixin,x=l.required,w=d.propertyWillChange,T=d.propertyDidChange,E=h.addListener,C=h.removeListener,S=h.sendEvent,F=h.hasListeners,M=u.isWatching,A=y.map,N=b.create(v,{length:x(),objectAt:function(e){return 0>e||e>=m(this,"length")?void 0:m(this,e)},objectsAt:function(e){var t=this;return A(e,function(e){return t.objectAt(e)})},nextObject:function(e){return this.objectAt(e)},"[]":p(function(e,t){return void 0!==t&&this.replace(0,m(this,"length"),t),this}),firstObject:p(function(){return this.objectAt(0)}),lastObject:p(function(){return this.objectAt(m(this,"length")-1)}),contains:function(e){return this.indexOf(e)>=0},slice:function(e,t){var i=f.A(),r=m(this,"length");for(g(e)&&(e=0),(g(t)||t>r)&&(t=r),0>e&&(e=r+e),0>t&&(t=r+t);t>e;)i[i.length]=this.objectAt(e++);return i},indexOf:function(e,t){var i,r=m(this,"length");for(void 0===t&&(t=0),0>t&&(t+=r),i=t;r>i;i++)if(this.objectAt(i)===e)return i;return-1},lastIndexOf:function(e,t){var i,r=m(this,"length");for((void 0===t||t>=r)&&(t=r-1),0>t&&(t+=r),i=t;i>=0;i--)if(this.objectAt(i)===e)return i;return-1},addArrayObserver:function(e,t){var i=t&&t.willChange||"arrayWillChange",r=t&&t.didChange||"arrayDidChange",n=m(this,"hasArrayObservers");return n||w(this,"hasArrayObservers"),E(this,"@array:before",e,i),E(this,"@array:change",e,r),n||T(this,"hasArrayObservers"),this},removeArrayObserver:function(e,t){var i=t&&t.willChange||"arrayWillChange",r=t&&t.didChange||"arrayDidChange",n=m(this,"hasArrayObservers");return n&&w(this,"hasArrayObservers"),C(this,"@array:before",e,i),C(this,"@array:change",e,r),n&&T(this,"hasArrayObservers"),this},hasArrayObservers:p(function(){return F(this,"@array:change")||F(this,"@array:before")}),arrayContentWillChange:function(e,t,i){void 0===e?(e=0,t=i=-1):(void 0===t&&(t=-1),void 0===i&&(i=-1)),M(this,"@each")&&m(this,"@each"),S(this,"@array:before",[this,e,t,i]);var r,n;if(e>=0&&t>=0&&m(this,"hasEnumerableObservers")){r=[],n=e+t;for(var o=e;n>o;o++)r.push(this.objectAt(o))}else r=t;return this.enumerableContentWillChange(r,i),this},arrayContentDidChange:function(e,t,i){void 0===e?(e=0,t=i=-1):(void 0===t&&(t=-1),void 0===i&&(i=-1));var r,n;if(e>=0&&i>=0&&m(this,"hasEnumerableObservers")){r=[],n=e+i;for(var o=e;n>o;o++)r.push(this.objectAt(o))}else r=i;this.enumerableContentDidChange(t,r),S(this,"@array:change",[this,e,t,i]);var s=m(this,"length"),a=_(this,"firstObject"),l=_(this,"lastObject");return this.objectAt(0)!==a&&(w(this,"firstObject"),T(this,"firstObject")),this.objectAt(s-1)!==l&&(w(this,"lastObject"),T(this,"lastObject")),this},"@each":p(function(){if(!this.__each){var e=t("ember-runtime/system/each_proxy").EachProxy;this.__each=new e(this)}return this.__each})});c["default"]=N}),e("ember-runtime/mixins/comparable",["ember-metal/mixin","exports"],function(e,t){"use strict";var i=e.Mixin,r=e.required,n=i.create({compare:r(Function)});t["default"]=n}),e("ember-runtime/mixins/copyable",["ember-metal/property_get","ember-metal/property_set","ember-metal/mixin","ember-runtime/mixins/freezable","ember-runtime/system/string","ember-metal/error","exports"],function(e,t,i,r,n,o,s){"use strict";var a=e.get,l=(t.set,i.required),d=r.Freezable,h=i.Mixin,u=n.fmt,c=o["default"],f=h.create({copy:l(Function),frozenCopy:function(){if(d&&d.detect(this))return a(this,"isFrozen")?this:this.copy().freeze();throw new c(u("%@ does not support freezing",[this]))}});s["default"]=f}),e("ember-runtime/mixins/deferred",["ember-metal/core","ember-metal/property_get","ember-metal/mixin","ember-metal/computed","ember-metal/run_loop","ember-runtime/ext/rsvp","exports"],function(e,t,i,r,n,o,s){"use strict";var a=e["default"],l=t.get,d=i.Mixin,h=r.computed,u=n["default"],c=o["default"],f=function(){a.Test&&a.Test.adapter&&a.Test.adapter.asyncStart()},m=function(){a.Test&&a.Test.adapter&&a.Test.adapter.asyncEnd()};c.configure("async",function(e,t){var i=!u.currentRunLoop;a.testing&&i&&f(),u.backburner.schedule("actions",function(){a.testing&&i&&m(),e(t)})}),c.Promise.prototype.fail=function(e,t){return a.deprecate("RSVP.Promise.fail has been renamed as RSVP.Promise.catch"),this["catch"](e,t)};var p=d.create({then:function(e,t,i){function r(t){return e(t===o?s:t)}var n,o,s;return s=this,n=l(this,"_deferred"),o=n.promise,o.then(e&&r,t,i)},resolve:function(e){var t,i;t=l(this,"_deferred"),i=t.promise,t.resolve(e===this?i:e)},reject:function(e){l(this,"_deferred").reject(e)},_deferred:h(function(){return c.defer("Ember: DeferredMixin - "+this)})});s["default"]=p}),e("ember-runtime/mixins/enumerable",["ember-metal/core","ember-metal/property_get","ember-metal/property_set","ember-metal/utils","ember-metal/mixin","ember-metal/enumerable_utils","ember-metal/computed","ember-metal/property_events","ember-metal/events","ember-runtime/compare","exports"],function(e,t,i,r,n,o,s,a,l,d,h){"use strict";function u(){return 0===D.length?{}:D.pop()}function c(e){return D.push(e),null}function f(e,t){function i(i){var n=p(i,e);return r?t===n:!!n}var r=2===arguments.length;return i}var m=e["default"],p=t.get,_=i.set,g=r.apply,v=n.Mixin,y=n.required,b=n.aliasMethod,x=o["default"],w=s.computed,T=a.propertyWillChange,E=a.propertyDidChange,C=l.addListener,S=l.removeListener,F=l.sendEvent,M=l.hasListeners,A=d["default"],N=Array.prototype.slice,R=x.indexOf,D=[],I=v.create({nextObject:y(Function),firstObject:w(function(){if(0===p(this,"length"))return void 0;var e,t=u();return e=this.nextObject(0,null,t),c(t),e}).property("[]"),lastObject:w(function(){var e=p(this,"length");if(0===e)return void 0;var t,i=u(),r=0,n=null;do n=t,t=this.nextObject(r++,n,i);while(void 0!==t);return c(i),n}).property("[]"),contains:function(e){return void 0!==this.find(function(t){return t===e})},forEach:function(e,t){if("function"!=typeof e)throw new TypeError;var i=p(this,"length"),r=null,n=u();void 0===t&&(t=null);for(var o=0;i>o;o++){var s=this.nextObject(o,r,n);e.call(t,s,o,this),r=s}return r=null,n=c(n),this},getEach:function(e){return this.mapBy(e)},setEach:function(e,t){return this.forEach(function(i){_(i,e,t)})},map:function(e,t){var i=m.A();return this.forEach(function(r,n,o){i[n]=e.call(t,r,n,o)}),i},mapBy:function(e){return this.map(function(t){return p(t,e)})},mapProperty:b("mapBy"),filter:function(e,t){var i=m.A();return this.forEach(function(r,n,o){e.call(t,r,n,o)&&i.push(r)}),i},reject:function(e,t){return this.filter(function(){return!g(t,e,arguments)})},filterBy:function(){return this.filter(g(this,f,arguments))},filterProperty:b("filterBy"),rejectBy:function(e,t){var i=function(i){return p(i,e)===t},r=function(t){return!!p(t,e)},n=2===arguments.length?i:r;return this.reject(n)},rejectProperty:b("rejectBy"),find:function(e,t){var i=p(this,"length");void 0===t&&(t=null);for(var r,n,o=null,s=!1,a=u(),l=0;i>l&&!s;l++)r=this.nextObject(l,o,a),(s=e.call(t,r,l,this))&&(n=r),o=r;return r=o=null,a=c(a),n},findBy:function(){return this.find(g(this,f,arguments))},findProperty:b("findBy"),every:function(e,t){return!this.find(function(i,r,n){return!e.call(t,i,r,n)})},everyBy:b("isEvery"),everyProperty:b("isEvery"),isEvery:function(){return this.every(g(this,f,arguments))},any:function(e,t){var i,r,n=p(this,"length"),o=u(),s=!1,a=null;for(void 0===t&&(t=null),r=0;n>r&&!s;r++)i=this.nextObject(r,a,o),s=e.call(t,i,r,this),a=i;return i=a=null,o=c(o),s},some:b("any"),isAny:function(){return this.any(g(this,f,arguments))},anyBy:b("isAny"),someProperty:b("isAny"),reduce:function(e,t,i){if("function"!=typeof e)throw new TypeError;var r=t;return this.forEach(function(t,n){r=e(r,t,n,this,i)},this),r},invoke:function(e){var t,i=m.A();return arguments.length>1&&(t=N.call(arguments,1)),this.forEach(function(r,n){var o=r&&r[e];"function"==typeof o&&(i[n]=t?g(r,o,t):r[e]())},this),i},toArray:function(){var e=m.A();return this.forEach(function(t,i){e[i]=t}),e},compact:function(){return this.filter(function(e){return null!=e})},without:function(e){if(!this.contains(e))return this;var t=m.A();return this.forEach(function(i){i!==e&&(t[t.length]=i)}),t},uniq:function(){var e=m.A();return this.forEach(function(t){R(e,t)<0&&e.push(t)}),e},"[]":w(function(){return this}),addEnumerableObserver:function(e,t){var i=t&&t.willChange||"enumerableWillChange",r=t&&t.didChange||"enumerableDidChange",n=p(this,"hasEnumerableObservers");return n||T(this,"hasEnumerableObservers"),C(this,"@enumerable:before",e,i),C(this,"@enumerable:change",e,r),n||E(this,"hasEnumerableObservers"),this},removeEnumerableObserver:function(e,t){var i=t&&t.willChange||"enumerableWillChange",r=t&&t.didChange||"enumerableDidChange",n=p(this,"hasEnumerableObservers");return n&&T(this,"hasEnumerableObservers"),S(this,"@enumerable:before",e,i),S(this,"@enumerable:change",e,r),n&&E(this,"hasEnumerableObservers"),this},hasEnumerableObservers:w(function(){return M(this,"@enumerable:change")||M(this,"@enumerable:before")}),enumerableContentWillChange:function(e,t){var i,r,n;return i="number"==typeof e?e:e?p(e,"length"):e=-1,r="number"==typeof t?t:t?p(t,"length"):t=-1,n=0>r||0>i||r-i!==0,-1===e&&(e=null),-1===t&&(t=null),T(this,"[]"),n&&T(this,"length"),F(this,"@enumerable:before",[this,e,t]),this},enumerableContentDidChange:function(e,t){var i,r,n;return i="number"==typeof e?e:e?p(e,"length"):e=-1,r="number"==typeof t?t:t?p(t,"length"):t=-1,n=0>r||0>i||r-i!==0,-1===e&&(e=null),-1===t&&(t=null),F(this,"@enumerable:change",[this,e,t]),n&&E(this,"length"),E(this,"[]"),this},sortBy:function(){var e=arguments;return this.toArray().sort(function(t,i){for(var r=0;r<e.length;r++){var n=e[r],o=p(t,n),s=p(i,n),a=A(o,s);if(a)return a}return 0})}});h["default"]=I}),e("ember-runtime/mixins/evented",["ember-metal/mixin","ember-metal/events","exports"],function(e,t,i){"use strict";var r=e.Mixin,n=t.addListener,o=t.removeListener,s=t.hasListeners,a=t.sendEvent,l=r.create({on:function(e,t,i){return n(this,e,t,i),this},one:function(e,t,i){return i||(i=t,t=null),n(this,e,t,i,!0),this},trigger:function(e){var t,i,r=[];for(t=1,i=arguments.length;i>t;t++)r.push(arguments[t]);a(this,e,r)},off:function(e,t,i){return o(this,e,t,i),this},has:function(e){return s(this,e)}});i["default"]=l}),e("ember-runtime/mixins/freezable",["ember-metal/mixin","ember-metal/property_get","ember-metal/property_set","exports"],function(e,t,i,r){"use strict";var n=e.Mixin,o=t.get,s=i.set,a=n.create({isFrozen:!1,freeze:function(){return o(this,"isFrozen")?this:(s(this,"isFrozen",!0),this)}}),l="Frozen object cannot be modified.";r.Freezable=a,r.FROZEN_ERROR=l}),e("ember-runtime/mixins/mutable_array",["ember-metal/property_get","ember-metal/property_set","ember-metal/utils","ember-metal/error","ember-metal/mixin","ember-runtime/mixins/array","ember-runtime/mixins/mutable_enumerable","ember-runtime/mixins/enumerable","exports"],function(e,t,i,r,n,o,s,a,l){"use strict";var d="Index out of range",h=[],u=e.get,c=(t.set,i.isArray),f=r["default"],m=n.Mixin,p=n.required,_=o["default"],g=s["default"],v=a["default"],y=m.create(_,g,{replace:p(),clear:function(){var e=u(this,"length");return 0===e?this:(this.replace(0,e,h),this)},insertAt:function(e,t){if(e>u(this,"length"))throw new f(d);return this.replace(e,0,[t]),this},removeAt:function(e,t){if("number"==typeof e){if(0>e||e>=u(this,"length"))throw new f(d);void 0===t&&(t=1),this.replace(e,t,h)}return this},pushObject:function(e){return this.insertAt(u(this,"length"),e),e},pushObjects:function(e){if(!v.detect(e)&&!c(e))throw new TypeError("Must pass Ember.Enumerable to Ember.MutableArray#pushObjects");return this.replace(u(this,"length"),0,e),this},popObject:function(){var e=u(this,"length");if(0===e)return null;var t=this.objectAt(e-1);return this.removeAt(e-1,1),t},shiftObject:function(){if(0===u(this,"length"))return null;var e=this.objectAt(0);return this.removeAt(0),e},unshiftObject:function(e){return this.insertAt(0,e),e},unshiftObjects:function(e){return this.replace(0,0,e),this},reverseObjects:function(){var e=u(this,"length");if(0===e)return this;var t=this.toArray().reverse();return this.replace(0,e,t),this},setObjects:function(e){if(0===e.length)return this.clear();var t=u(this,"length");return this.replace(0,t,e),this},removeObject:function(e){for(var t=u(this,"length")||0;--t>=0;){var i=this.objectAt(t);i===e&&this.removeAt(t)}return this},addObject:function(e){return this.contains(e)||this.pushObject(e),this}});l["default"]=y}),e("ember-runtime/mixins/mutable_enumerable",["ember-metal/enumerable_utils","ember-runtime/mixins/enumerable","ember-metal/mixin","ember-metal/property_events","exports"],function(e,t,i,r,n){"use strict";
var o=e["default"],s=t["default"],a=i.Mixin,l=i.required,d=r.beginPropertyChanges,h=r.endPropertyChanges,u=o.forEach,c=a.create(s,{addObject:l(Function),addObjects:function(e){return d(this),u(e,function(e){this.addObject(e)},this),h(this),this},removeObject:l(Function),removeObjects:function(e){d(this);for(var t=e.length-1;t>=0;t--)this.removeObject(e[t]);return h(this),this}});n["default"]=c}),e("ember-runtime/mixins/observable",["ember-metal/core","ember-metal/property_get","ember-metal/property_set","ember-metal/utils","ember-metal/get_properties","ember-metal/set_properties","ember-metal/mixin","ember-metal/events","ember-metal/property_events","ember-metal/observer","ember-metal/computed","ember-metal/is_none","exports"],function(e,t,i,r,n,o,s,a,l,d,h,u,c){"use strict";var f=e["default"],m=t.get,p=t.getWithDefault,_=i.set,g=r.apply,v=n["default"],y=o["default"],b=s.Mixin,x=a.hasListeners,w=l.beginPropertyChanges,T=l.propertyWillChange,E=l.propertyDidChange,C=l.endPropertyChanges,S=d.addObserver,F=d.addBeforeObserver,M=d.removeObserver,A=d.observersFor,N=h.cacheFor,R=u.isNone,D=Array.prototype.slice,I=b.create({get:function(e){return m(this,e)},getProperties:function(){return g(null,v,[this].concat(D.call(arguments)))},set:function(e,t){return _(this,e,t),this},setProperties:function(e){return y(this,e)},beginPropertyChanges:function(){return w(),this},endPropertyChanges:function(){return C(),this},propertyWillChange:function(e){return T(this,e),this},propertyDidChange:function(e){return E(this,e),this},notifyPropertyChange:function(e){return this.propertyWillChange(e),this.propertyDidChange(e),this},addBeforeObserver:function(e,t,i){F(this,e,t,i)},addObserver:function(e,t,i){S(this,e,t,i)},removeObserver:function(e,t,i){M(this,e,t,i)},hasObserverFor:function(e){return x(this,e+":change")},getWithDefault:function(e,t){return p(this,e,t)},incrementProperty:function(e,t){return R(t)&&(t=1),f.assert("Must pass a numeric value to incrementProperty",!isNaN(parseFloat(t))&&isFinite(t)),_(this,e,(parseFloat(m(this,e))||0)+t),m(this,e)},decrementProperty:function(e,t){return R(t)&&(t=1),f.assert("Must pass a numeric value to decrementProperty",!isNaN(parseFloat(t))&&isFinite(t)),_(this,e,(m(this,e)||0)-t),m(this,e)},toggleProperty:function(e){return _(this,e,!m(this,e)),m(this,e)},cacheFor:function(e){return N(this,e)},observersForKey:function(e){return A(this,e)}});c["default"]=I}),e("ember-runtime/mixins/promise_proxy",["ember-metal/property_get","ember-metal/property_set","ember-metal/computed","ember-metal/mixin","ember-metal/error","exports"],function(e,t,i,r,n,o){"use strict";function s(e,t){return d(e,"isFulfilled",!1),d(e,"isRejected",!1),t.then(function(t){return d(e,"isFulfilled",!0),d(e,"content",t),t},function(t){throw d(e,"isRejected",!0),d(e,"reason",t),t},"Ember: PromiseProxy")}function a(e){return function(){var t=l(this,"promise");return t[e].apply(t,arguments)}}var l=e.get,d=t.set,h=i.computed,u=r.Mixin,c=n["default"],f=h.not,m=h.or,p=u.create({reason:null,isPending:f("isSettled").readOnly(),isSettled:m("isRejected","isFulfilled").readOnly(),isRejected:!1,isFulfilled:!1,promise:h(function(e,t){if(2===arguments.length)return s(this,t);throw new c("PromiseProxy's promise must be set")}),then:a("then"),"catch":a("catch"),"finally":a("finally")});o["default"]=p}),e("ember-runtime/mixins/sortable",["ember-metal/core","ember-metal/property_get","ember-metal/property_set","ember-metal/enumerable_utils","ember-metal/mixin","ember-runtime/mixins/mutable_enumerable","ember-runtime/compare","ember-metal/observer","ember-metal/computed","exports"],function(e,t,i,r,n,o,s,a,l,d){"use strict";var h=e["default"],u=t.get,c=(i.set,r["default"]),f=n.Mixin,m=o["default"],p=s["default"],_=a.addObserver,g=a.removeObserver,v=l.computed,y=n.beforeObserver,b=n.observer,x=c.forEach,w=f.create(m,{sortProperties:null,sortAscending:!0,sortFunction:p,orderBy:function(e,t){var i=0,r=u(this,"sortProperties"),n=u(this,"sortAscending"),o=u(this,"sortFunction");return h.assert("you need to define `sortProperties`",!!r),x(r,function(r){0===i&&(i=o.call(this,u(e,r),u(t,r)),0===i||n||(i=-1*i))},this),i},destroy:function(){var e=u(this,"content"),t=u(this,"sortProperties");return e&&t&&x(e,function(e){x(t,function(t){g(e,t,this,"contentItemSortPropertyDidChange")},this)},this),this._super()},isSorted:v.notEmpty("sortProperties"),arrangedContent:v("content","sortProperties.@each",function(){var e=u(this,"content"),t=u(this,"isSorted"),i=u(this,"sortProperties"),r=this;return e&&t?(e=e.slice(),e.sort(function(e,t){return r.orderBy(e,t)}),x(e,function(e){x(i,function(t){_(e,t,this,"contentItemSortPropertyDidChange")},this)},this),h.A(e)):e}),_contentWillChange:y("content",function(){var e=u(this,"content"),t=u(this,"sortProperties");e&&t&&x(e,function(e){x(t,function(t){g(e,t,this,"contentItemSortPropertyDidChange")},this)},this),this._super()}),sortPropertiesWillChange:y("sortProperties",function(){this._lastSortAscending=void 0}),sortPropertiesDidChange:b("sortProperties",function(){this._lastSortAscending=void 0}),sortAscendingWillChange:y("sortAscending",function(){this._lastSortAscending=u(this,"sortAscending")}),sortAscendingDidChange:b("sortAscending",function(){if(void 0!==this._lastSortAscending&&u(this,"sortAscending")!==this._lastSortAscending){var e=u(this,"arrangedContent");e.reverseObjects()}}),contentArrayWillChange:function(e,t,i,r){var n=u(this,"isSorted");if(n){var o=u(this,"arrangedContent"),s=e.slice(t,t+i),a=u(this,"sortProperties");x(s,function(e){o.removeObject(e),x(a,function(t){g(e,t,this,"contentItemSortPropertyDidChange")},this)},this)}return this._super(e,t,i,r)},contentArrayDidChange:function(e,t,i,r){var n=u(this,"isSorted"),o=u(this,"sortProperties");if(n){var s=e.slice(t,t+r);x(s,function(e){this.insertItemSorted(e),x(o,function(t){_(e,t,this,"contentItemSortPropertyDidChange")},this)},this)}return this._super(e,t,i,r)},insertItemSorted:function(e){var t=u(this,"arrangedContent"),i=u(t,"length"),r=this._binarySearch(e,0,i);t.insertAt(r,e)},contentItemSortPropertyDidChange:function(e){var t=u(this,"arrangedContent"),i=t.indexOf(e),r=t.objectAt(i-1),n=t.objectAt(i+1),o=r&&this.orderBy(e,r),s=n&&this.orderBy(e,n);(0>o||s>0)&&(t.removeObject(e),this.insertItemSorted(e))},_binarySearch:function(e,t,i){var r,n,o,s;return t===i?t:(s=u(this,"arrangedContent"),r=t+Math.floor((i-t)/2),n=s.objectAt(r),o=this.orderBy(n,e),0>o?this._binarySearch(e,r+1,i):o>0?this._binarySearch(e,t,r):r)}});d["default"]=w}),e("ember-runtime/mixins/target_action_support",["ember-metal/core","ember-metal/property_get","ember-metal/property_set","ember-metal/utils","ember-metal/mixin","ember-metal/computed","exports"],function(e,t,i,r,n,o,s){"use strict";var a=e["default"],l=t.get,d=(i.set,r.typeOf),h=n.Mixin,u=o.computed,c=h.create({target:null,action:null,actionContext:null,targetObject:u(function(){var e=l(this,"target");if("string"===d(e)){var t=l(this,e);return void 0===t&&(t=l(a.lookup,e)),t}return e}).property("target"),actionContextObject:u(function(){var e=l(this,"actionContext");if("string"===d(e)){var t=l(this,e);return void 0===t&&(t=l(a.lookup,e)),t}return e}).property("actionContext"),triggerAction:function(e){function t(e,t){var i=[];return t&&i.push(t),i.concat(e)}e=e||{};var i=e.action||l(this,"action"),r=e.target||l(this,"targetObject"),n=e.actionContext;if("undefined"==typeof n&&(n=l(this,"actionContextObject")||this),r&&i){var o;return r.send?o=r.send.apply(r,t(n,i)):(a.assert("The action '"+i+"' did not exist on "+r,"function"==typeof r[i]),o=r[i].apply(r,t(n))),o!==!1&&(o=!0),o}return!1}});s["default"]=c}),e("ember-runtime/system/application",["ember-runtime/system/namespace","exports"],function(e,t){"use strict";var i=e["default"],r=i.extend();t["default"]=r}),e("ember-runtime/system/array_proxy",["ember-metal/core","ember-metal/property_get","ember-metal/property_set","ember-metal/utils","ember-metal/computed","ember-metal/mixin","ember-metal/property_events","ember-metal/error","ember-runtime/system/object","ember-runtime/mixins/mutable_array","ember-runtime/mixins/enumerable","ember-runtime/system/string","exports"],function(e,t,i,r,n,o,s,a,l,d,h,u,c){"use strict";var f=e["default"],m=t.get,p=(i.set,r.isArray),_=r.apply,g=n.computed,v=o.beforeObserver,y=o.observer,b=s.beginPropertyChanges,x=s.endPropertyChanges,w=a["default"],T=l["default"],E=d["default"],C=h["default"],S=u.fmt,F="Index out of range",M=[],A=g.alias,N=f.K,R=T.extend(E,{content:null,arrangedContent:A("content"),objectAtContent:function(e){return m(this,"arrangedContent").objectAt(e)},replaceContent:function(e,t,i){m(this,"content").replace(e,t,i)},_contentWillChange:v("content",function(){this._teardownContent()}),_teardownContent:function(){var e=m(this,"content");e&&e.removeArrayObserver(this,{willChange:"contentArrayWillChange",didChange:"contentArrayDidChange"})},contentArrayWillChange:N,contentArrayDidChange:N,_contentDidChange:y("content",function(){var e=m(this,"content");f.assert("Can't set ArrayProxy's content to itself",e!==this),this._setupContent()}),_setupContent:function(){var e=m(this,"content");e&&(f.assert(S("ArrayProxy expects an Array or Ember.ArrayProxy, but you passed %@",[typeof e]),p(e)||e.isDestroyed),e.addArrayObserver(this,{willChange:"contentArrayWillChange",didChange:"contentArrayDidChange"}))},_arrangedContentWillChange:v("arrangedContent",function(){var e=m(this,"arrangedContent"),t=e?m(e,"length"):0;this.arrangedContentArrayWillChange(this,0,t,void 0),this.arrangedContentWillChange(this),this._teardownArrangedContent(e)}),_arrangedContentDidChange:y("arrangedContent",function(){var e=m(this,"arrangedContent"),t=e?m(e,"length"):0;f.assert("Can't set ArrayProxy's content to itself",e!==this),this._setupArrangedContent(),this.arrangedContentDidChange(this),this.arrangedContentArrayDidChange(this,0,void 0,t)}),_setupArrangedContent:function(){var e=m(this,"arrangedContent");e&&(f.assert(S("ArrayProxy expects an Array or Ember.ArrayProxy, but you passed %@",[typeof e]),p(e)||e.isDestroyed),e.addArrayObserver(this,{willChange:"arrangedContentArrayWillChange",didChange:"arrangedContentArrayDidChange"}))},_teardownArrangedContent:function(){var e=m(this,"arrangedContent");e&&e.removeArrayObserver(this,{willChange:"arrangedContentArrayWillChange",didChange:"arrangedContentArrayDidChange"})},arrangedContentWillChange:N,arrangedContentDidChange:N,objectAt:function(e){return m(this,"content")&&this.objectAtContent(e)},length:g(function(){var e=m(this,"arrangedContent");return e?m(e,"length"):0}),_replace:function(e,t,i){var r=m(this,"content");return f.assert("The content property of "+this.constructor+" should be set before modifying it",r),r&&this.replaceContent(e,t,i),this},replace:function(){if(m(this,"arrangedContent")!==m(this,"content"))throw new w("Using replace on an arranged ArrayProxy is not allowed.");_(this,this._replace,arguments)},_insertAt:function(e,t){if(e>m(this,"content.length"))throw new w(F);return this._replace(e,0,[t]),this},insertAt:function(e,t){if(m(this,"arrangedContent")===m(this,"content"))return this._insertAt(e,t);throw new w("Using insertAt on an arranged ArrayProxy is not allowed.")},removeAt:function(e,t){if("number"==typeof e){var i,r=m(this,"content"),n=m(this,"arrangedContent"),o=[];if(0>e||e>=m(this,"length"))throw new w(F);for(void 0===t&&(t=1),i=e;e+t>i;i++)o.push(r.indexOf(n.objectAt(i)));for(o.sort(function(e,t){return t-e}),b(),i=0;i<o.length;i++)this._replace(o[i],1,M);x()}return this},pushObject:function(e){return this._insertAt(m(this,"content.length"),e),e},pushObjects:function(e){if(!C.detect(e)&&!p(e))throw new TypeError("Must pass Ember.Enumerable to Ember.MutableArray#pushObjects");return this._replace(m(this,"length"),0,e),this},setObjects:function(e){if(0===e.length)return this.clear();var t=m(this,"length");return this._replace(0,t,e),this},unshiftObject:function(e){return this._insertAt(0,e),e},unshiftObjects:function(e){return this._replace(0,0,e),this},slice:function(){var e=this.toArray();return e.slice.apply(e,arguments)},arrangedContentArrayWillChange:function(e,t,i,r){this.arrayContentWillChange(t,i,r)},arrangedContentArrayDidChange:function(e,t,i,r){this.arrayContentDidChange(t,i,r)},init:function(){this._super(),this._setupContent(),this._setupArrangedContent()},willDestroy:function(){this._teardownArrangedContent(),this._teardownContent()}});c["default"]=R}),e("ember-runtime/system/container",["ember-metal/property_set","exports"],function(e,i){"use strict";var r=e["default"],n=t("container")["default"];n.set=r,i["default"]=n}),e("ember-runtime/system/core_object",["ember-metal/core","ember-metal/property_get","ember-metal/property_set","ember-metal/utils","ember-metal/platform","ember-metal/watching","ember-metal/chains","ember-metal/events","ember-metal/mixin","ember-metal/enumerable_utils","ember-metal/error","ember-runtime/keys","ember-runtime/mixins/action_handler","ember-metal/properties","ember-metal/binding","ember-metal/computed","ember-metal/run_loop","exports"],function(e,t,i,r,n,o,s,a,l,d,h,u,c,f,m,p,_,g){"use strict";function v(){var e,t,i=!1,r=function(){i||r.proto(),Y(this,C,tt),Y(this,"__nextSuper",et);var n=S(this),o=n.proto;if(n.proto=this,e){var s=e;e=null,w(this,this.reopen,s)}if(t){var a=t;t=null;for(var l=this.concatenatedProperties,d=0,h=a.length;h>d;d++){var u=a[d];if(b.assert("Ember.Object.create no longer supports mixing in other definitions, use createWithMixins instead.",!(u instanceof I)),"object"!=typeof u&&void 0!==u)throw new V("Ember.Object.create only accepts objects.");if(u)for(var c=L(u),f=0,m=c.length;m>f;f++){var p=c[f];if(u.hasOwnProperty(p)){var _=u[p];if(D.test(p)){var g=n.bindings;g?n.hasOwnProperty("bindings")||(g=n.bindings=H(n.bindings)):g=n.bindings={},g[p]=_}var v=n.descs[p];if(b.assert("Ember.Object.create no longer supports defining computed properties. Define computed properties using extend() or reopen() before calling create().",!(_ instanceof j)),b.assert("Ember.Object.create no longer supports defining methods that call _super.",!("function"==typeof _&&-1!==_.toString().indexOf("._super"))),b.assert("`actions` must be provided at extend time, not at create time, when Ember.ActionHandler is used (i.e. views, controllers & routes).",!("actions"===p&&B.detect(this))),l&&Z(l,p)>=0){var y=this[p];_=y?"function"==typeof y.concat?y.concat(_):M(y).concat(_):M(_)}v?v.set(this,p,_):"function"!=typeof this.setUnknownProperty||p in this?Q?U(this,p,null,_):this[p]=_:this.setUnknownProperty(p,_)}}}}K(this,n),w(this,this.init,arguments),n.proto=o,N(this),R(this,"init")};return r.toString=I.prototype.toString,r.willReopen=function(){i&&(r.PrototypeMixin=I.create(r.PrototypeMixin)),i=!1},r._initMixins=function(t){e=t},r._initProperties=function(e){t=e},r.proto=function(){var e=r.superclass;return e&&e.proto(),i||(i=!0,r.PrototypeMixin.applyPartial(r.prototype),A(r.prototype)),this.prototype},r}function y(e){return function(){return e}}var b=e["default"],x=(t.get,i.set,r.guidFor),w=r.apply,T=n.create,E=r.generateGuid,C=r.GUID_KEY,S=r.meta,F=r.META_KEY,M=r.makeArray,A=o.rewatch,N=s.finishChains,R=a.sendEvent,D=l.IS_BINDING,I=l.Mixin,P=l.required,k=d["default"],V=h["default"],O=n.platform,L=u["default"],B=c["default"],U=f.defineProperty,z=m.Binding,j=p.ComputedProperty,G=_["default"],X=o.destroy,H=T,Y=O.defineProperty,W=G.schedule,q=I._apply,K=I.finishPartial,$=I.prototype.reopen,Q=b.ENV.MANDATORY_SETTER,Z=k.indexOf,J=b.K,et={configurable:!0,writable:!0,enumerable:!1,value:void 0},tt={configurable:!0,writable:!0,enumerable:!1,value:null},it=v();it.toString=function(){return"Ember.CoreObject"},it.PrototypeMixin=I.create({reopen:function(){return q(this,arguments,!0),this},init:function(){},concatenatedProperties:null,isDestroyed:!1,isDestroying:!1,destroy:function(){return this.isDestroying?void 0:(this.isDestroying=!0,W("actions",this,this.willDestroy),W("destroy",this,this._scheduledDestroy),this)},willDestroy:J,_scheduledDestroy:function(){this.isDestroyed||(X(this),this.isDestroyed=!0)},bind:function(e,t){return t instanceof z||(t=z.from(t)),t.to(e).connect(this),t},toString:function(){var e="function"==typeof this.toStringExtension,t=e?":"+this.toStringExtension():"",i="<"+this.constructor.toString()+":"+x(this)+t+">";return this.toString=y(i),i}}),it.PrototypeMixin.ownerConstructor=it,b.config.overridePrototypeMixin&&b.config.overridePrototypeMixin(it.PrototypeMixin),it.__super__=null;var rt=I.create({ClassMixin:P(),PrototypeMixin:P(),isClass:!0,isMethod:!1,extend:function(){var e,t=v();return t.ClassMixin=I.create(this.ClassMixin),t.PrototypeMixin=I.create(this.PrototypeMixin),t.ClassMixin.ownerConstructor=t,t.PrototypeMixin.ownerConstructor=t,$.apply(t.PrototypeMixin,arguments),t.superclass=this,t.__super__=this.prototype,e=t.prototype=H(this.prototype),e.constructor=t,E(e),S(e).proto=e,t.ClassMixin.apply(t),t},createWithMixins:function(){var e=this;return arguments.length>0&&this._initMixins(arguments),new e},create:function(){var e=this;return arguments.length>0&&this._initProperties(arguments),new e},reopen:function(){return this.willReopen(),w(this.PrototypeMixin,$,arguments),this},reopenClass:function(){return w(this.ClassMixin,$,arguments),q(this,arguments,!1),this},detect:function(e){if("function"!=typeof e)return!1;for(;e;){if(e===this)return!0;e=e.superclass}return!1},detectInstance:function(e){return e instanceof this},metaForProperty:function(e){var t=this.proto()[F],i=t&&t.descs[e];return b.assert("metaForProperty() could not find a computed property with key '"+e+"'.",!!i&&i instanceof j),i._meta||{}},eachComputedProperty:function(e,t){var i,r=this.proto(),n=S(r).descs,o={};for(var s in n)i=n[s],i instanceof j&&e.call(t||this,s,i._meta||o)}});rt.ownerConstructor=it,b.config.overrideClassMixin&&b.config.overrideClassMixin(rt),it.ClassMixin=rt,rt.apply(it),g["default"]=it}),e("ember-runtime/system/deferred",["ember-runtime/mixins/deferred","ember-metal/property_get","ember-runtime/system/object","exports"],function(e,t,i,r){"use strict";var n=e["default"],o=(t.get,i["default"]),s=o.extend(n);s.reopenClass({promise:function(e,t){var i=s.create();return e.call(t,i),i}}),r["default"]=s}),e("ember-runtime/system/each_proxy",["ember-metal/core","ember-metal/property_get","ember-metal/property_set","ember-metal/utils","ember-metal/enumerable_utils","ember-metal/array","ember-runtime/mixins/array","ember-runtime/system/object","ember-metal/computed","ember-metal/observer","ember-metal/events","ember-metal/properties","ember-metal/property_events","exports"],function(e,t,i,r,n,o,s,a,l,d,h,u,c,f){"use strict";function m(e,t,i,r,n){var o,s=i._objects;for(s||(s=i._objects={});--n>=r;){var a=e.objectAt(n);a&&(_.assert("When using @each to observe the array "+e+", the array must return an object","instance"===M(a)||"object"===M(a)),C(a,t,i,"contentKeyWillChange"),E(a,t,i,"contentKeyDidChange"),o=v(a),s[o]||(s[o]=[]),s[o].push(n))}}function p(e,t,i,r,n){var o=i._objects;o||(o=i._objects={});for(var s,a;--n>=r;){var l=e.objectAt(n);l&&(S(l,t,i,"contentKeyWillChange"),F(l,t,i,"contentKeyDidChange"),a=v(l),s=o[a],s[b.call(s,n)]=null)}}var _=e["default"],g=t.get,v=(i.set,r.guidFor),y=n["default"],b=o.indexOf,x=s["default"],w=a["default"],T=l.computed,E=d.addObserver,C=d.addBeforeObserver,S=d.removeBeforeObserver,F=d.removeObserver,M=r.typeOf,A=h.watchedEvents,N=u.defineProperty,R=c.beginPropertyChanges,D=c.propertyDidChange,I=c.propertyWillChange,P=c.endPropertyChanges,k=c.changeProperties,V=y.forEach,O=w.extend(x,{init:function(e,t,i){this._super(),this._keyName=t,this._owner=i,this._content=e},objectAt:function(e){var t=this._content.objectAt(e);return t&&g(t,this._keyName)},length:T(function(){var e=this._content;return e?g(e,"length"):0})}),L=/^.+:(before|change)$/,B=w.extend({init:function(e){this._super(),this._content=e,e.addArrayObserver(this),V(A(this),function(e){this.didAddListener(e)},this)},unknownProperty:function(e){var t;return t=new O(this._content,e,this),N(this,e,null,t),this.beginObservingContentKey(e),t},arrayWillChange:function(e,t,i){var r,n,o=this._keys;n=i>0?t+i:-1,R(this);for(r in o)o.hasOwnProperty(r)&&(n>0&&p(e,r,this,t,n),I(this,r));I(this._content,"@each"),P(this)},arrayDidChange:function(e,t,i,r){var n,o=this._keys;n=r>0?t+r:-1,k(function(){for(var i in o)o.hasOwnProperty(i)&&(n>0&&m(e,i,this,t,n),D(this,i));D(this._content,"@each")},this)},didAddListener:function(e){L.test(e)&&this.beginObservingContentKey(e.slice(0,-7))},didRemoveListener:function(e){L.test(e)&&this.stopObservingContentKey(e.slice(0,-7))},beginObservingContentKey:function(e){var t=this._keys;if(t||(t=this._keys={}),t[e])t[e]++;else{t[e]=1;var i=this._content,r=g(i,"length");m(i,e,this,0,r)}},stopObservingContentKey:function(e){var t=this._keys;if(t&&t[e]>0&&--t[e]<=0){var i=this._content,r=g(i,"length");p(i,e,this,0,r)}},contentKeyWillChange:function(e,t){I(this,t)},contentKeyDidChange:function(e,t){D(this,t)}});f.EachArray=O,f.EachProxy=B}),e("ember-runtime/system/lazy_load",["ember-metal/core","ember-metal/array","ember-runtime/system/native_array","exports"],function(e,t,i,r){"use strict";function n(e,t){var i;l[e]=l[e]||s.A(),l[e].pushObject(t),(i=d[e])&&t(i)}function o(e,t){if(d[e]=t,"object"==typeof window&&"function"==typeof window.dispatchEvent&&"function"==typeof CustomEvent){var i=new CustomEvent(e,{detail:t,name:e});window.dispatchEvent(i)}l[e]&&a.call(l[e],function(e){e(t)})}var s=e["default"],a=t.forEach,l=s.ENV.EMBER_LOAD_HOOKS||{},d={};r.onLoad=n,r.runLoadHooks=o}),e("ember-runtime/system/namespace",["ember-metal/core","ember-metal/property_get","ember-metal/array","ember-metal/utils","ember-metal/mixin","ember-runtime/system/object","exports"],function(e,t,i,r,n,o,s){"use strict";function a(e,t,i){var r=e.length;x[e.join(".")]=t;for(var n in t)if(w.call(t,n)){var o=t[n];if(e[r]=n,o&&o.toString===h)o.toString=c(e.join(".")),o[E]=e.join(".");else if(o&&o.isNamespace){if(i[g(o)])continue;i[g(o)]=!0,a(e,o,i)}}e.length=r}function l(){var e,t,i=f.lookup;if(!b.PROCESSED)for(var r in i)if(T.test(r)&&(!i.hasOwnProperty||i.hasOwnProperty(r))){try{e=i[r],t=e&&e.isNamespace}catch(n){continue}t&&(e[E]=r)}}function d(e){var t=e.superclass;return t?t[E]?t[E]:d(t):void 0}function h(){f.BOOTED||this[E]||u();var e;if(this[E])e=this[E];else if(this._toString)e=this._toString;else{var t=d(this);e=t?"(subclass of "+t+")":"(unknown mixin)",this.toString=c(e)}return e}function u(){var e=!b.PROCESSED,t=f.anyUnprocessedMixins;if(e&&(l(),b.PROCESSED=!0),e||t){for(var i,r=b.NAMESPACES,n=0,o=r.length;o>n;n++)i=r[n],a([i.toString()],i,{});f.anyUnprocessedMixins=!1}}function c(e){return function(){return e}}var f=e["default"],m=t.get,p=i.indexOf,_=r.GUID_KEY,g=r.guidFor,v=n.Mixin,y=o["default"],b=y.extend({isNamespace:!0,init:function(){b.NAMESPACES.push(this),b.PROCESSED=!1},toString:function(){var e=m(this,"name");return e?e:(l(),this[E])},nameClasses:function(){a([this.toString()],this,{})},destroy:function(){var e=b.NAMESPACES,t=this.toString();t&&(f.lookup[t]=void 0,delete b.NAMESPACES_BY_ID[t]),e.splice(p.call(e,this),1),this._super()}});b.reopenClass({NAMESPACES:[f],NAMESPACES_BY_ID:{},PROCESSED:!1,processAll:u,byName:function(e){return f.BOOTED||u(),x[e]}});var x=b.NAMESPACES_BY_ID,w={}.hasOwnProperty,T=/^[A-Z]/,E=f.NAME_KEY=_+"_name";v.prototype.toString=h,s["default"]=b}),e("ember-runtime/system/native_array",["ember-metal/core","ember-metal/property_get","ember-metal/property_set","ember-metal/enumerable_utils","ember-metal/mixin","ember-runtime/mixins/array","ember-runtime/mixins/mutable_array","ember-runtime/mixins/observable","ember-runtime/mixins/copyable","ember-runtime/mixins/freezable","ember-runtime/copy","exports"],function(e,t,i,r,n,o,s,a,l,d,h,u){"use strict";var c=e["default"],f=t.get,m=(i.set,r["default"]),p=n.Mixin,_=o["default"],g=s["default"],v=a["default"],y=l["default"],b=d.FROZEN_ERROR,x=h["default"],w=m._replace,T=m.forEach,E=p.create(g,v,y,{get:function(e){return"length"===e?this.length:"number"==typeof e?this[e]:this._super(e)},objectAt:function(e){return this[e]},replace:function(e,t,i){if(this.isFrozen)throw b;var r=i?f(i,"length"):0;return this.arrayContentWillChange(e,t,r),0===r?this.splice(e,t):w(this,e,t,i),this.arrayContentDidChange(e,t,r),this},unknownProperty:function(e,t){var i;return void 0!==t&&void 0===i&&(i=this[e]=t),i},indexOf:function(e,t){var i,r=this.length;for(t=void 0===t?0:0>t?Math.ceil(t):Math.floor(t),0>t&&(t+=r),i=t;r>i;i++)if(this[i]===e)return i;return-1},lastIndexOf:function(e,t){var i,r=this.length;for(t=void 0===t?r-1:0>t?Math.ceil(t):Math.floor(t),0>t&&(t+=r),i=t;i>=0;i--)if(this[i]===e)return i;return-1},copy:function(e){return e?this.map(function(e){return x(e,!0)}):this.slice()}}),C=["length"];T(E.keys(),function(e){Array.prototype[e]&&C.push(e)}),C.length>0&&(E=E.without.apply(E,C));var S=function(e){return void 0===e&&(e=[]),_.detect(e)?e:E.apply(e)};E.activate=function(){E.apply(Array.prototype),S=function(e){return e||[]}},(c.EXTEND_PROTOTYPES===!0||c.EXTEND_PROTOTYPES.Array)&&E.activate(),c.A=S,u.A=S,u.NativeArray=E,u["default"]=E}),e("ember-runtime/system/object",["ember-runtime/system/core_object","ember-runtime/mixins/observable","exports"],function(e,t,i){"use strict";var r=e["default"],n=t["default"],o=r.extend(n);o.toString=function(){return"Ember.Object"},i["default"]=o}),e("ember-runtime/system/object_proxy",["ember-metal/core","ember-metal/property_get","ember-metal/property_set","ember-metal/utils","ember-metal/observer","ember-metal/property_events","ember-metal/computed","ember-metal/properties","ember-metal/mixin","ember-runtime/system/string","ember-runtime/system/object","exports"],function(e,t,i,r,n,o,s,a,l,d,h,u){"use strict";function c(e,t){var i=t.slice(8);i in this||w(this,i)}function f(e,t){var i=t.slice(8);i in this||T(this,i)}var m=e["default"],p=t.get,_=i.set,g=r.meta,v=n.addObserver,y=n.removeObserver,b=n.addBeforeObserver,x=n.removeBeforeObserver,w=o.propertyWillChange,T=o.propertyDidChange,E=s.computed,C=a.defineProperty,S=l.observer,F=d.fmt,M=h["default"],A=M.extend({content:null,_contentDidChange:S("content",function(){m.assert("Can't set ObjectProxy's content to itself",p(this,"content")!==this)}),isTruthy:E.bool("content"),_debugContainerKey:null,willWatchProperty:function(e){var t="content."+e;b(this,t,null,c),v(this,t,null,f)},didUnwatchProperty:function(e){var t="content."+e;x(this,t,null,c),y(this,t,null,f)},unknownProperty:function(e){var t=p(this,"content");return t?p(t,e):void 0},setUnknownProperty:function(e,t){var i=g(this);if(i.proto===this)return C(this,e,null,t),t;var r=p(this,"content");return m.assert(F("Cannot delegate set('%@', %@) to the 'content' property of object proxy %@: its 'content' is undefined.",[e,t,this]),r),_(r,e,t)}});u["default"]=A}),e("ember-runtime/system/set",["ember-metal/core","ember-metal/property_get","ember-metal/property_set","ember-metal/utils","ember-metal/is_none","ember-runtime/system/string","ember-runtime/system/core_object","ember-runtime/mixins/mutable_enumerable","ember-runtime/mixins/enumerable","ember-runtime/mixins/copyable","ember-runtime/mixins/freezable","ember-metal/error","ember-metal/property_events","ember-metal/mixin","ember-metal/computed","exports"],function(e,t,i,r,n,o,s,a,l,d,h,u,c,f,m,p){"use strict";var _=(e["default"],t.get),g=i.set,v=r.guidFor,y=n.isNone,b=o.fmt,x=s["default"],w=a["default"],T=l["default"],E=d["default"],C=h.Freezable,S=h.FROZEN_ERROR,F=u["default"],M=c.propertyWillChange,A=c.propertyDidChange,N=f.aliasMethod,R=m.computed,D=x.extend(w,E,C,{length:0,clear:function(){if(this.isFrozen)throw new F(S);var e=_(this,"length");if(0===e)return this;var t;this.enumerableContentWillChange(e,0),M(this,"firstObject"),M(this,"lastObject");for(var i=0;e>i;i++)t=v(this[i]),delete this[t],delete this[i];return g(this,"length",0),A(this,"firstObject"),A(this,"lastObject"),this.enumerableContentDidChange(e,0),this},isEqual:function(e){if(!T.detect(e))return!1;var t=_(this,"length");if(_(e,"length")!==t)return!1;for(;--t>=0;)if(!e.contains(this[t]))return!1;return!0},add:N("addObject"),remove:N("removeObject"),pop:function(){if(_(this,"isFrozen"))throw new F(S);var e=this.length>0?this[this.length-1]:null;return this.remove(e),e},push:N("addObject"),shift:N("pop"),unshift:N("push"),addEach:N("addObjects"),removeEach:N("removeObjects"),init:function(e){this._super(),e&&this.addObjects(e)},nextObject:function(e){return this[e]},firstObject:R(function(){return this.length>0?this[0]:void 0}),lastObject:R(function(){return this.length>0?this[this.length-1]:void 0}),addObject:function(e){if(_(this,"isFrozen"))throw new F(S);if(y(e))return this;var t,i=v(e),r=this[i],n=_(this,"length");return r>=0&&n>r&&this[r]===e?this:(t=[e],this.enumerableContentWillChange(null,t),M(this,"lastObject"),n=_(this,"length"),this[i]=n,this[n]=e,g(this,"length",n+1),A(this,"lastObject"),this.enumerableContentDidChange(null,t),this)},removeObject:function(e){if(_(this,"isFrozen"))throw new F(S);if(y(e))return this;var t,i,r=v(e),n=this[r],o=_(this,"length"),s=0===n,a=n===o-1;return n>=0&&o>n&&this[n]===e&&(i=[e],this.enumerableContentWillChange(i,null),s&&M(this,"firstObject"),a&&M(this,"lastObject"),o-1>n&&(t=this[o-1],this[n]=t,this[v(t)]=n),delete this[r],delete this[o-1],g(this,"length",o-1),s&&A(this,"firstObject"),a&&A(this,"lastObject"),this.enumerableContentDidChange(i,null)),this},contains:function(e){return this[v(e)]>=0},copy:function(){var e=this.constructor,t=new e,i=_(this,"length");for(g(t,"length",i);--i>=0;)t[i]=this[i],t[v(this[i])]=i;return t},toString:function(){var e,t=this.length,i=[];for(e=0;t>e;e++)i[e]=this[e];return b("Ember.Set<%@>",[i.join(",")])}});p["default"]=D}),e("ember-runtime/system/string",["ember-metal/core","ember-metal/utils","exports"],function(e,t,i){"use strict";function r(e,t){var i=0;return e.replace(/%@([0-9]+)?/g,function(e,r){return r=r?parseInt(r,10)-1:i++,e=t[r],null===e?"(null)":void 0===e?"":f(e)})}function n(e,t){return e=c.STRINGS[e]||e,r(e,t)}function o(e){return e.split(/\s+/)}function s(e){return e.replace(_,"$1_$2").toLowerCase()}function a(e){var t,i=p,r=i.hasOwnProperty(e);return r?i[e]:(t=s(e).replace(m,"-"),i[e]=t,t)}function l(e){return e.replace(g,function(e,t,i){return i?i.toUpperCase():""}).replace(/^([A-Z])/,function(e){return e.toLowerCase()})}function d(e){for(var t=e.split("."),i=[],r=0,n=t.length;n>r;r++){var o=l(t[r]);i.push(o.charAt(0).toUpperCase()+o.substr(1))}return i.join(".")}function h(e){return e.replace(v,"$1_$2").replace(y,"_").toLowerCase()}function u(e){return e.charAt(0).toUpperCase()+e.substr(1)}var c=e["default"],f=t.inspect,m=/[ _]/g,p={},_=/([a-z\d])([A-Z])/g,g=/(\-|_|\.|\s)+(.)?/g,v=/([a-z\d])([A-Z]+)/g,y=/\-|\s+/g;c.STRINGS={};var b={fmt:r,loc:n,w:o,decamelize:s,dasherize:a,camelize:l,classify:d,underscore:h,capitalize:u};i["default"]=b,i.fmt=r,i.loc=n,i.w=o,i.decamelize=s,i.dasherize=a,i.camelize=l,i.classify=d,i.underscore=h,i.capitalize=u}),e("ember-runtime/system/subarray",["ember-metal/property_get","ember-metal/error","ember-metal/enumerable_utils","exports"],function(e,t,i,r){"use strict";function n(e,t){this.type=e,this.count=t}function o(e){arguments.length<1&&(e=0),this._operations=e>0?[new n(a,e)]:[]}var s=(e.get,t["default"]),a=(i["default"],"r"),l="f";o.prototype={addItem:function(e,t){var i=-1,r=t?a:l,o=this;return this._findOperation(e,function(s,l,d,h,u){var c,f;r===s.type?++s.count:e===d?o._operations.splice(l,0,new n(r,1)):(c=new n(r,1),f=new n(s.type,h-e+1),s.count=e-d,o._operations.splice(l+1,0,c,f)),t&&(i=s.type===a?u+(e-d):u),o._composeAt(l)},function(e){o._operations.push(new n(r,1)),t&&(i=e),o._composeAt(o._operations.length-1)}),i},removeItem:function(e){var t=-1,i=this;return this._findOperation(e,function(r,n,o,s,l){r.type===a&&(t=l+(e-o)),r.count>1?--r.count:(i._operations.splice(n,1),i._composeAt(n))},function(){throw new s("Can't remove an item that has never been added.")
}),t},_findOperation:function(e,t,i){var r,n,o,s,l,d=0;for(r=s=0,n=this._operations.length;n>r;s=l+1,++r){if(o=this._operations[r],l=s+o.count-1,e>=s&&l>=e)return void t(o,r,s,l,d);o.type===a&&(d+=o.count)}i(d)},_composeAt:function(e){var t,i=this._operations[e];i&&(e>0&&(t=this._operations[e-1],t.type===i.type&&(i.count+=t.count,this._operations.splice(e-1,1),--e)),e<this._operations.length-1&&(t=this._operations[e+1],t.type===i.type&&(i.count+=t.count,this._operations.splice(e+1,1))))},toString:function(){var e="";return forEach(this._operations,function(t){e+=" "+t.type+":"+t.count}),e.substring(1)}},r["default"]=o}),e("ember-runtime/system/tracked_array",["ember-metal/property_get","ember-metal/enumerable_utils","exports"],function(e,t,i){"use strict";function r(e){arguments.length<1&&(e=[]);var t=s(e,"length");this._operations=t?[new n(d,t,e)]:[]}function n(e,t,i){this.type=e,this.count=t,this.items=i}function o(e,t,i,r){this.operation=e,this.index=t,this.split=i,this.rangeStart=r}var s=e.get,a=t["default"],l=a.forEach,d="r",h="i",u="d";r.RETAIN=d,r.INSERT=h,r.DELETE=u,r.prototype={addItems:function(e,t){var i=s(t,"length");if(!(1>i)){var r,o,a=this._findArrayOperation(e),l=a.operation,d=a.index,u=a.rangeStart;o=new n(h,i,t),l?a.split?(this._split(d,e-u,o),r=d+1):(this._operations.splice(d,0,o),r=d):(this._operations.push(o),r=d),this._composeInsert(r)}},removeItems:function(e,t){if(!(1>t)){var i,r,o=this._findArrayOperation(e),s=(o.operation,o.index),a=o.rangeStart;return i=new n(u,t),o.split?(this._split(s,e-a,i),r=s+1):(this._operations.splice(s,0,i),r=s),this._composeDelete(r)}},apply:function(e){var t=[],i=0;l(this._operations,function(r,n){e(r.items,i,r.type,n),r.type!==u&&(i+=r.count,t=t.concat(r.items))}),this._operations=[new n(d,t.length,t)]},_findArrayOperation:function(e){var t,i,r,n,s,a=!1;for(t=n=0,i=this._operations.length;i>t;++t)if(r=this._operations[t],r.type!==u){if(s=n+r.count-1,e===n)break;if(e>n&&s>=e){a=!0;break}n=s+1}return new o(r,t,a,n)},_split:function(e,t,i){var r=this._operations[e],o=r.items.slice(t),s=new n(r.type,o.length,o);r.count=t,r.items=r.items.slice(0,t),this._operations.splice(e+1,0,i,s)},_composeInsert:function(e){var t=this._operations[e],i=this._operations[e-1],r=this._operations[e+1],n=i&&i.type,o=r&&r.type;n===h?(i.count+=t.count,i.items=i.items.concat(t.items),o===h?(i.count+=r.count,i.items=i.items.concat(r.items),this._operations.splice(e,2)):this._operations.splice(e,1)):o===h&&(t.count+=r.count,t.items=t.items.concat(r.items),this._operations.splice(e+1,1))},_composeDelete:function(e){var t,i,r,n=this._operations[e],o=n.count,s=this._operations[e-1],a=s&&s.type,l=!1,d=[];a===u&&(n=s,e-=1);for(var c=e+1;o>0;++c)t=this._operations[c],i=t.type,r=t.count,i!==u?(r>o?(d=d.concat(t.items.splice(0,o)),t.count-=o,c-=1,r=o,o=0):(r===o&&(l=!0),d=d.concat(t.items),o-=r),i===h&&(n.count-=r)):n.count+=r;return n.count>0?this._operations.splice(e+1,c-1-e):this._operations.splice(e,l?2:1),d},toString:function(){var e="";return l(this._operations,function(t){e+=" "+t.type+":"+t.count}),e.substring(1)}},i["default"]=r})}(),function(){e("ember-views",["ember-runtime","ember-views/system/jquery","ember-views/system/utils","ember-views/system/render_buffer","ember-views/system/ext","ember-views/views/states","ember-views/views/view","ember-views/views/container_view","ember-views/views/collection_view","ember-views/views/component","ember-views/system/event_dispatcher","ember-views/mixins/view_target_action_support","exports"],function(e,t,i,r,o,s,a,l,d,h,u,c,f){"use strict";n.$=t["default"],n.ViewTargetActionSupport=c["default"],n.RenderBuffer=r["default"];var m=n.ViewUtils={};m.setInnerHTML=i.setInnerHTML,m.isSimpleClick=i.isSimpleClick,n.CoreView=a.CoreView,n.View=a.View,n.View.states=s.states,n.View.cloneStates=s.cloneStates,n._ViewCollection=a.ViewCollection,n.ContainerView=l["default"],n.CollectionView=d["default"],n.Component=h["default"],n.EventDispatcher=u["default"],f["default"]=n}),e("ember-views/mixins/component_template_deprecation",["ember-metal/core","ember-metal/property_get","ember-metal/mixin","exports"],function(e,t,i,r){"use strict";var n=e["default"],o=t.get,s=i.Mixin,a=s.create({willMergeMixin:function(e){this._super.apply(this,arguments);var t,i,r=e.layoutName||e.layout||o(this,"layoutName");e.templateName&&!r&&(t="templateName",i="layoutName",e.layoutName=e.templateName,delete e.templateName),e.template&&!r&&(t="template",i="layout",e.layout=e.template,delete e.template),t&&n.deprecate("Do not specify "+t+" on a Component, use "+i+" instead.",!1)}});r["default"]=a}),e("ember-views/mixins/view_target_action_support",["ember-metal/mixin","ember-runtime/mixins/target_action_support","ember-metal/computed","exports"],function(e,t,i,r){"use strict";var n=e.Mixin,o=t["default"],s=i.computed,a=s.alias,l=n.create(o,{target:a("controller"),actionContext:a("context")});r["default"]=l}),e("ember-views/system/event_dispatcher",["ember-metal/core","ember-metal/property_get","ember-metal/property_set","ember-metal/is_none","ember-metal/run_loop","ember-metal/utils","ember-runtime/system/string","ember-runtime/system/object","ember-views/system/jquery","ember-views/views/view","exports"],function(e,i,r,n,o,s,a,l,d,h,u){"use strict";var c,f=e["default"],m=i.get,p=r.set,_=n.isNone,g=o["default"],v=s.typeOf,y=a.fmt,b=l["default"],x=d["default"],w=h.View,T=b.extend({events:{touchstart:"touchStart",touchmove:"touchMove",touchend:"touchEnd",touchcancel:"touchCancel",keydown:"keyDown",keyup:"keyUp",keypress:"keyPress",mousedown:"mouseDown",mouseup:"mouseUp",contextmenu:"contextMenu",click:"click",dblclick:"doubleClick",mousemove:"mouseMove",focusin:"focusIn",focusout:"focusOut",mouseenter:"mouseEnter",mouseleave:"mouseLeave",submit:"submit",input:"input",change:"change",dragstart:"dragStart",drag:"drag",dragenter:"dragEnter",dragleave:"dragLeave",dragover:"dragOver",drop:"drop",dragend:"dragEnd"},rootElement:"body",setup:function(e,t){var i,r=m(this,"events");x.extend(r,e||{}),_(t)||p(this,"rootElement",t),t=x(m(this,"rootElement")),f.assert(y("You cannot use the same root element (%@) multiple times in an Ember.Application",[t.selector||t[0].tagName]),!t.is(".ember-application")),f.assert("You cannot make a new Ember.Application using a root element that is a descendent of an existing Ember.Application",!t.closest(".ember-application").length),f.assert("You cannot make a new Ember.Application using a root element that is an ancestor of an existing Ember.Application",!t.find(".ember-application").length),t.addClass("ember-application"),f.assert('Unable to add "ember-application" class to rootElement. Make sure you set rootElement to the body or an element in the body.',t.is(".ember-application"));for(i in r)r.hasOwnProperty(i)&&this.setupHandler(t,i,r[i])},setupHandler:function(e,i,r){var n=this;e.on(i+".ember",".ember-view",function(e,t){var i=w.views[this.id],o=!0,s=null;return s=n._findNearestEventManager(i,r),s&&s!==t?o=n._dispatchEvent(s,e,r,i):i?o=n._bubbleEvent(i,e,r):e.stopPropagation(),o}),e.on(i+".ember","[data-ember-action]",function(e){c||(c=t("ember-routing/helpers/action").ActionHelper);var i=x(e.currentTarget).attr("data-ember-action"),n=c.registeredActions[i];return n&&n.eventName===r?n.handler(e):void 0})},_findNearestEventManager:function(e,t){for(var i=null;e&&(i=m(e,"eventManager"),!i||!i[t]);)e=m(e,"parentView");return i},_dispatchEvent:function(e,t,i,r){var n=!0,o=e[i];return"function"===v(o)?(n=g(e,o,t,r),t.stopPropagation()):n=this._bubbleEvent(r,t,i),n},_bubbleEvent:function(e,t,i){return g(e,e.handleEvent,i,t)},destroy:function(){var e=m(this,"rootElement");return x(e).off(".ember","**").removeClass("ember-application"),this._super()}});u["default"]=T}),e("ember-views/system/ext",["ember-metal/run_loop"],function(e){"use strict";{var t=e["default"];t.queues}t._addQueue("render","actions"),t._addQueue("afterRender","render")}),e("ember-views/system/jquery",["ember-metal/core","ember-runtime/system/string","ember-metal/enumerable_utils","exports"],function(e,t,r,n){"use strict";var o=e["default"],s=t.w,a=r["default"],l=a.forEach,d=o.imports&&o.imports.jQuery||this&&this.jQuery;if(d||"function"!=typeof i||(d=i("jquery")),o.assert("Ember Views require jQuery between 1.7 and 2.1",d&&(d().jquery.match(/^((1\.(7|8|9|10|11))|(2\.(0|1)))(\.\d+)?(pre|rc\d?)?/)||o.ENV.FORCE_JQUERY)),d){var h=s("dragstart drag dragenter dragleave dragover drop dragend");l(h,function(e){d.event.fixHooks[e]={props:["dataTransfer"]}})}n["default"]=d}),e("ember-views/system/render_buffer",["ember-metal/core","ember-metal/property_get","ember-metal/property_set","ember-views/system/utils","ember-views/system/jquery","exports"],function(e,t,i,r,n,o){"use strict";function s(){this.seen={},this.list=[]}function a(e){return e&&u.test(e)?e.replace(c,""):e}function l(e){var t={"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},i=function(e){return t[e]||"&amp;"},r=e.toString();return m.test(r)?r.replace(f,i):r}var d=(e["default"],t.get,i.set,r.setInnerHTML),h=n["default"];s.prototype={add:function(e){e in this.seen||(this.seen[e]=!0,this.list.push(e))},toDOM:function(){return this.list.join(" ")}};var u=/[^a-zA-Z0-9\-]/,c=/[^a-zA-Z0-9\-]/g,f=/&(?!\w+;)|[<>"'`]/g,m=/[&<>"'`]/,p=function(){var e=document.createElement("div"),t=document.createElement("input");return t.setAttribute("name","foo"),e.appendChild(t),!!e.innerHTML.match("foo")}(),_=function(e){return new g(e)},g=function(e){this.tagNames=[e||null],this.buffer=""};g.prototype={_element:null,_hasElement:!0,elementClasses:null,classes:null,elementId:null,elementAttributes:null,elementProperties:null,elementTag:null,elementStyle:null,parentBuffer:null,push:function(e){return this.buffer+=e,this},addClass:function(e){return this.elementClasses=this.elementClasses||new s,this.elementClasses.add(e),this.classes=this.elementClasses.list,this},setClasses:function(e){this.elementClasses=null;var t,i=e.length;for(t=0;i>t;t++)this.addClass(e[t])},id:function(e){return this.elementId=e,this},attr:function(e,t){var i=this.elementAttributes=this.elementAttributes||{};return 1===arguments.length?i[e]:(i[e]=t,this)},removeAttr:function(e){var t=this.elementAttributes;return t&&delete t[e],this},prop:function(e,t){var i=this.elementProperties=this.elementProperties||{};return 1===arguments.length?i[e]:(i[e]=t,this)},removeProp:function(e){var t=this.elementProperties;return t&&delete t[e],this},style:function(e,t){return this.elementStyle=this.elementStyle||{},this.elementStyle[e]=t,this},begin:function(e){return this.tagNames.push(e||null),this},pushOpeningTag:function(){var e=this.currentTagName();if(e){if(this._hasElement&&!this._element&&0===this.buffer.length)return void(this._element=this.generateElement());var t,i,r=this.buffer,n=this.elementId,o=this.classes,s=this.elementAttributes,d=this.elementProperties,h=this.elementStyle;if(r+="<"+a(e),n&&(r+=' id="'+l(n)+'"',this.elementId=null),o&&(r+=' class="'+l(o.join(" "))+'"',this.classes=null,this.elementClasses=null),h){r+=' style="';for(i in h)h.hasOwnProperty(i)&&(r+=i+":"+l(h[i])+";");r+='"',this.elementStyle=null}if(s){for(t in s)s.hasOwnProperty(t)&&(r+=" "+t+'="'+l(s[t])+'"');this.elementAttributes=null}if(d){for(i in d)if(d.hasOwnProperty(i)){var u=d[i];(u||"number"==typeof u)&&(r+=u===!0?" "+i+'="'+i+'"':" "+i+'="'+l(d[i])+'"')}this.elementProperties=null}r+=">",this.buffer=r}},pushClosingTag:function(){var e=this.tagNames.pop();e&&(this.buffer+="</"+a(e)+">")},currentTagName:function(){return this.tagNames[this.tagNames.length-1]},generateElement:function(){var e,t,i,r=this.tagNames.pop(),n=this.elementId,o=this.classes,s=this.elementAttributes,d=this.elementProperties,u=this.elementStyle,c="";i=s&&s.name&&!p?"<"+a(r)+' name="'+l(s.name)+'">':r;var f=document.createElement(i),m=h(f);if(n&&(m.attr("id",n),this.elementId=null),o&&(m.attr("class",o.join(" ")),this.classes=null,this.elementClasses=null),u){for(t in u)u.hasOwnProperty(t)&&(c+=t+":"+u[t]+";");m.attr("style",c),this.elementStyle=null}if(s){for(e in s)s.hasOwnProperty(e)&&m.attr(e,s[e]);this.elementAttributes=null}if(d){for(t in d)d.hasOwnProperty(t)&&m.prop(t,d[t]);this.elementProperties=null}return f},element:function(){var e=this.innerString();return e&&(this._element=d(this._element,e)),this._element},string:function(){if(this._hasElement&&this._element){var e=this.element(),t=e.outerHTML;return"undefined"==typeof t?h("<div/>").append(e).html():t}return this.innerString()},innerString:function(){return this.buffer}},o["default"]=_}),e("ember-views/system/utils",["ember-metal/core","exports"],function(e,t){"use strict";function i(e){var t=e.shiftKey||e.metaKey||e.altKey||e.ctrlKey,i=e.which>1;return!t&&!i}var r=e["default"],n="undefined"!=typeof document&&function(){var e=document.createElement("div");return e.innerHTML="<div></div>",e.firstChild.innerHTML="<script></script>",""===e.firstChild.innerHTML}(),o="undefined"!=typeof document&&function(){var e=document.createElement("div");return e.innerHTML="Test: <script type='text/x-placeholder'></script>Value","Test:"===e.childNodes[0].nodeValue&&" Value"===e.childNodes[2].nodeValue}(),s=function(e,t){if(e.getAttribute("id")===t)return e;var i,r,n,o=e.childNodes.length;for(i=0;o>i;i++)if(r=e.childNodes[i],n=1===r.nodeType&&s(r,t))return n},a=function(e,t){n&&(t="&shy;"+t);var i=[];if(o&&(t=t.replace(/(\s+)(<script id='([^']+)')/g,function(e,t,r,n){return i.push([n,t]),r})),e.innerHTML=t,i.length>0){var r,a=i.length;for(r=0;a>r;r++){var l=s(e,i[r][0]),d=document.createTextNode(i[r][1]);l.parentNode.insertBefore(d,l)}}if(n){for(var h=e.firstChild;1===h.nodeType&&!h.nodeName;)h=h.firstChild;3===h.nodeType&&"­"===h.nodeValue.charAt(0)&&(h.nodeValue=h.nodeValue.slice(1))}},l={},d=function(e){if(void 0!==l[e])return l[e];var t=!0;if("select"===e.toLowerCase()){var i=document.createElement("select");a(i,'<option value="test">Test</option>'),t=1===i.options.length}return l[e]=t,t},h=function(e,t){var i=e.tagName;if(d(i))a(e,t);else{var n=e.outerHTML||(new XMLSerializer).serializeToString(e);r.assert("Can't set innerHTML on "+e.tagName+" in this browser",n);var o=n.match(new RegExp("<"+i+"([^>]*)>","i"))[0],s="</"+i+">",l=document.createElement("div");for(a(l,o+t+s),e=l.firstChild;e.tagName!==i;)e=e.nextSibling}return e};t.setInnerHTML=h,t.isSimpleClick=i}),e("ember-views/views/collection_view",["ember-metal/core","ember-metal/platform","ember-metal/binding","ember-metal/merge","ember-metal/property_get","ember-metal/property_set","ember-runtime/system/string","ember-views/views/container_view","ember-views/views/view","ember-metal/mixin","ember-runtime/mixins/array","exports"],function(e,t,i,r,n,o,s,a,l,d,h,u){"use strict";var c=e["default"],f=(t.create,i.isGlobalPath),m=(r["default"],n.get),p=o.set,_=s.fmt,g=a["default"],v=l.CoreView,y=l.View,b=d.observer,x=d.beforeObserver,w=h["default"],T=g.extend({content:null,emptyViewClass:y,emptyView:null,itemViewClass:y,init:function(){var e=this._super();return this._contentDidChange(),e},_contentWillChange:x("content",function(){var e=this.get("content");e&&e.removeArrayObserver(this);var t=e?m(e,"length"):0;this.arrayWillChange(e,0,t)}),_contentDidChange:b("content",function(){var e=m(this,"content");e&&(this._assertArrayLike(e),e.addArrayObserver(this));var t=e?m(e,"length"):0;this.arrayDidChange(e,0,null,t)}),_assertArrayLike:function(e){c.assert(_("an Ember.CollectionView's content must implement Ember.Array. You passed %@",[e]),w.detect(e))},destroy:function(){if(this._super()){var e=m(this,"content");return e&&e.removeArrayObserver(this),this._createdEmptyView&&this._createdEmptyView.destroy(),this}},arrayWillChange:function(e,t,i){var r=m(this,"emptyView");r&&r instanceof y&&r.removeFromParent();var n,o,s,a=this._childViews;s=this._childViews.length;var l=i===s;for(l&&(this.currentState.empty(this),this.invokeRecursively(function(e){e.removedFromDOM=!0},!1)),o=t+i-1;o>=t;o--)n=a[o],n.destroy()},arrayDidChange:function(e,t,i,r){var n,o,s,a,l,d,h=[];if(a=e?m(e,"length"):0)for(l=m(this,"itemViewClass"),"string"==typeof l&&f(l)&&(l=m(l)||l),c.assert(_("itemViewClass must be a subclass of Ember.View, not %@",[l]),"string"==typeof l||y.detect(l)),s=t;t+r>s;s++)o=e.objectAt(s),n=this.createChildView(l,{content:o,contentIndex:s}),h.push(n);else{if(d=m(this,"emptyView"),!d)return;"string"==typeof d&&f(d)&&(d=m(d)||d),d=this.createChildView(d),h.push(d),p(this,"emptyView",d),v.detect(d)&&(this._createdEmptyView=d)}this.replace(t,0,h)},createChildView:function(e,t){e=this._super(e,t);var i=m(e,"tagName");return(null===i||void 0===i)&&(i=T.CONTAINER_MAP[m(this,"tagName")],p(e,"tagName",i)),e}});T.CONTAINER_MAP={ul:"li",ol:"li",table:"tr",thead:"tr",tbody:"tr",tfoot:"tr",tr:"td",select:"option"},u["default"]=T}),e("ember-views/views/component",["ember-metal/core","ember-views/mixins/component_template_deprecation","ember-runtime/mixins/target_action_support","ember-views/views/view","ember-metal/property_get","ember-metal/property_set","ember-metal/is_none","ember-metal/computed","exports"],function(e,t,i,r,n,o,s,a,l){"use strict";var d=e["default"],h=t["default"],u=i["default"],c=r.View,f=n.get,m=o.set,p=s.isNone,_=a.computed,g=Array.prototype.slice,v=c.extend(u,h,{instrumentName:"component",instrumentDisplay:_(function(){return this._debugContainerKey?"{{"+this._debugContainerKey.split(":")[1]+"}}":void 0}),init:function(){this._super(),m(this,"context",this),m(this,"controller",this)},defaultLayout:function(e,t){d.Handlebars.helpers["yield"].call(e,t)},template:_(function(e,t){if(void 0!==t)return t;var i=f(this,"templateName"),r=this.templateForName(i,"template");return d.assert("You specified the templateName "+i+" for "+this+", but it did not exist.",!i||r),r||f(this,"defaultTemplate")}).property("templateName"),templateName:null,cloneKeywords:function(){return{view:this,controller:this}},_yield:function(e,t){var i=t.data.view,r=this._parentView,n=f(this,"template");n&&(d.assert("A Component must have a parent view in order to yield.",r),i.appendChild(c,{isVirtual:!0,tagName:"",_contextView:r,template:n,context:f(r,"context"),controller:f(r,"controller"),templateData:{keywords:r.cloneKeywords()}}))},targetObject:_(function(){var e=f(this,"_parentView");return e?f(e,"controller"):null}).property("_parentView"),sendAction:function(e){var t,i=g.call(arguments,1);void 0===e?(t=f(this,"action"),d.assert("The default action was triggered on the component "+this.toString()+", but the action name ("+t+") was not a string.",p(t)||"string"==typeof t)):(t=f(this,e),d.assert("The "+e+" action was triggered on the component "+this.toString()+", but the action name ("+t+") was not a string.",p(t)||"string"==typeof t)),void 0!==t&&this.triggerAction({action:t,actionContext:i})}});l["default"]=v}),e("ember-views/views/container_view",["ember-metal/core","ember-metal/merge","ember-runtime/mixins/mutable_array","ember-metal/property_get","ember-metal/property_set","ember-views/views/view","ember-views/views/states","ember-metal/error","ember-metal/enumerable_utils","ember-metal/computed","ember-metal/run_loop","ember-metal/properties","ember-views/system/render_buffer","ember-metal/mixin","ember-runtime/system/native_array","exports"],function(e,t,i,r,n,o,s,a,l,d,h,u,c,f,m,p){"use strict";function _(e,t,i,r){t.triggerRecursively("willInsertElement"),i?i.domManager.after(i,r.string()):e.domManager.prepend(e,r.string()),t.forEach(function(e){e.transitionTo("inDOM"),e.propertyDidChange("element"),e.triggerRecursively("didInsertElement")})}var g=e["default"],v=t["default"],y=i["default"],b=r.get,x=n.set,w=o.View,T=o.ViewCollection,E=s.cloneStates,C=s.states,S=a["default"],F=l["default"],M=F.forEach,A=d.computed,N=h["default"],R=u.defineProperty,D=c["default"],I=f.observer,P=f.beforeObserver,k=m.A,V=E(C),O=w.extend(y,{states:V,init:function(){this._super();var e=b(this,"childViews");R(this,"childViews",w.childViewsProperty);var t=this._childViews;M(e,function(e,i){var r;"string"==typeof e?(r=b(this,e),r=this.createChildView(r),x(this,e,r)):r=this.createChildView(e),t[i]=r},this);var i=b(this,"currentView");i&&(t.length||(t=this._childViews=this._childViews.slice()),t.push(this.createChildView(i)))},replace:function(e,t,i){var r=i?b(i,"length"):0,n=this;if(g.assert("You can't add a child to a container - the child is already a child of another view",k(i).every(function(e){return!b(e,"_parentView")||b(e,"_parentView")===n})),this.arrayContentWillChange(e,t,r),this.childViewsWillChange(this._childViews,e,t),0===r)this._childViews.splice(e,t);else{var o=[e,t].concat(i);i.length&&!this._childViews.length&&(this._childViews=this._childViews.slice()),this._childViews.splice.apply(this._childViews,o)}return this.arrayContentDidChange(e,t,r),this.childViewsDidChange(this._childViews,e,t,r),this},objectAt:function(e){return this._childViews[e]},length:A(function(){return this._childViews.length}).volatile(),render:function(e){this.forEachChildView(function(t){t.renderToBuffer(e)})},instrumentName:"container",childViewsWillChange:function(e,t,i){if(this.propertyWillChange("childViews"),i>0){var r=e.slice(t,t+i);this.currentState.childViewsWillChange(this,e,t,i),this.initializeViews(r,null,null)}},removeChild:function(e){return this.removeObject(e),this},childViewsDidChange:function(e,t,i,r){if(r>0){var n=e.slice(t,t+r);this.initializeViews(n,this,b(this,"templateData")),this.currentState.childViewsDidChange(this,e,t,r)}this.propertyDidChange("childViews")},initializeViews:function(e,t,i){M(e,function(e){x(e,"_parentView",t),!e.container&&t&&x(e,"container",t.container),b(e,"templateData")||x(e,"templateData",i)})},currentView:null,_currentViewWillChange:P("currentView",function(){var e=b(this,"currentView");e&&e.destroy()}),_currentViewDidChange:I("currentView",function(){var e=b(this,"currentView");e&&(g.assert("You tried to set a current view that already has a parent. Make sure you don't have multiple outlets in the same view.",!b(e,"_parentView")),this.pushObject(e))}),_ensureChildrenAreInDOM:function(){this.currentState.ensureChildrenAreInDOM(this)}});v(V._default,{childViewsWillChange:g.K,childViewsDidChange:g.K,ensureChildrenAreInDOM:g.K}),v(V.inBuffer,{childViewsDidChange:function(){throw new S("You cannot modify child views while in the inBuffer state")}}),v(V.hasElement,{childViewsWillChange:function(e,t,i,r){for(var n=i;i+r>n;n++)t[n].remove()},childViewsDidChange:function(e){N.scheduleOnce("render",e,"_ensureChildrenAreInDOM")},ensureChildrenAreInDOM:function(e){var t,i,r,n,o,s=e._childViews,a=new T;for(t=0,i=s.length;i>t;t++)r=s[t],o||(o=D(),o._hasElement=!1),r.renderToBufferIfNeeded(o)?a.push(r):a.length?(_(e,a,n,o),o=null,n=r,a.clear()):n=r;a.length&&_(e,a,n,o)}}),p["default"]=O}),e("ember-views/views/states",["ember-metal/platform","ember-metal/merge","ember-views/views/states/default","ember-views/views/states/pre_render","ember-views/views/states/in_buffer","ember-views/views/states/has_element","ember-views/views/states/in_dom","ember-views/views/states/destroying","exports"],function(e,t,i,r,n,o,s,a,l){"use strict";function d(e){var t={};t._default={},t.preRender=h(t._default),t.destroying=h(t._default),t.inBuffer=h(t._default),t.hasElement=h(t._default),t.inDOM=h(t.hasElement);for(var i in e)e.hasOwnProperty(i)&&u(t[i],e[i]);return t}var h=e.create,u=t["default"],c=i["default"],f=r["default"],m=n["default"],p=o["default"],_=s["default"],g=a["default"],v={_default:c,preRender:f,inDOM:_,inBuffer:m,hasElement:p,destroying:g};l.cloneStates=d,l.states=v}),e("ember-views/views/states/default",["ember-metal/core","ember-metal/property_get","ember-metal/property_set","ember-metal/run_loop","ember-metal/error","exports"],function(e,t,i,r,n,o){"use strict";var s=e["default"],a=(t.get,i.set),l=r["default"],d=n["default"],h={appendChild:function(){throw new d("You can't use appendChild outside of the rendering process")},$:function(){return void 0},getElement:function(){return null},handleEvent:function(){return!0},destroyElement:function(e){return a(e,"element",null),e._scheduledInsert&&(l.cancel(e._scheduledInsert),e._scheduledInsert=null),e},renderToBufferIfNeeded:function(){return!1},rerender:s.K,invokeObserver:s.K};o["default"]=h}),e("ember-views/views/states/destroying",["ember-metal/merge","ember-metal/platform","ember-runtime/system/string","ember-views/views/states/default","ember-metal/error","exports"],function(e,t,i,r,o,s){"use strict";var a=e["default"],l=t.create,d=i.fmt,h=r["default"],u=o["default"],c="You can't call %@ on a view being destroyed",f=l(h);a(f,{appendChild:function(){throw new u(d(c,["appendChild"]))},rerender:function(){throw new u(d(c,["rerender"]))},destroyElement:function(){throw new u(d(c,["destroyElement"]))},empty:function(){throw new u(d(c,["empty"]))},setElement:function(){throw new u(d(c,["set('element', ...)"]))},renderToBufferIfNeeded:function(){return!1},insertElement:n.K}),s["default"]=f}),e("ember-views/views/states/has_element",["ember-views/views/states/default","ember-metal/run_loop","ember-metal/merge","ember-metal/platform","ember-views/system/jquery","ember-metal/error","ember-metal/property_get","ember-metal/property_set","exports"],function(e,t,i,r,n,o,s,a,l){"use strict";var d=e["default"],h=t["default"],u=i["default"],c=r.create,f=n["default"],m=o["default"],p=s.get,_=a.set,g=c(d);u(g,{$:function(e,t){var i=p(e,"element");return t?f(t,i):f(i)},getElement:function(e){var t=p(e,"parentView");return t&&(t=p(t,"element")),t?e.findElementInParentElement(t):f("#"+p(e,"elementId"))[0]},setElement:function(e,t){if(null!==t)throw new m("You cannot set an element to a non-null value when the element is already in the DOM.");return e.transitionTo("preRender"),t},rerender:function(e){return e.triggerRecursively("willClearRender"),e.clearRenderedChildren(),e.domManager.replace(e),e},destroyElement:function(e){return e._notifyWillDestroyElement(),e.domManager.remove(e),_(e,"element",null),e._scheduledInsert&&(h.cancel(e._scheduledInsert),e._scheduledInsert=null),e},empty:function(e){var t,i,r=e._childViews;if(r)for(t=r.length,i=0;t>i;i++)r[i]._notifyWillDestroyElement();e.domManager.empty(e)},handleEvent:function(e,t,i){return e.has(t)?e.trigger(t,i):!0},invokeObserver:function(e,t){t.call(e)}}),l["default"]=g}),e("ember-views/views/states/in_buffer",["ember-views/views/states/default","ember-metal/error","ember-metal/core","ember-metal/platform","ember-metal/merge","exports"],function(e,t,i,r,n,o){"use strict";var s=e["default"],a=t["default"],l=i["default"],d=r.create,h=n["default"],u=d(s);h(u,{$:function(e){return e.rerender(),l.$()},rerender:function(){throw new a("Something you did caused a view to re-render after it rendered but before it was inserted into the DOM.")},appendChild:function(e,t,i){var r=e.buffer,n=e._childViews;return t=e.createChildView(t,i),n.length||(n=e._childViews=n.slice()),n.push(t),t.renderToBuffer(r),e.propertyDidChange("childViews"),t},destroyElement:function(e){e.clearBuffer();var t=e._notifyWillDestroyElement();return t.transitionTo("preRender",!1),e},empty:function(){l.assert("Emptying a view in the inBuffer state is not allowed and should not happen under normal circumstances. Most likely there is a bug in your application. This may be due to excessive property change notifications.")},renderToBufferIfNeeded:function(){return!1},insertElement:function(){throw new a("You can't insert an element that has already been rendered")},setElement:function(e,t){return null===t?e.transitionTo("preRender"):(e.clearBuffer(),e.transitionTo("hasElement")),t},invokeObserver:function(e,t){t.call(e)}}),o["default"]=u}),e("ember-views/views/states/in_dom",["ember-metal/core","ember-metal/platform","ember-metal/merge","ember-metal/error","ember-views/views/states/has_element","exports"],function(e,i,r,n,o,s){"use strict";var a,l=e["default"],d=i.create,h=r["default"],u=n["default"],c=o["default"],f=d(c);h(f,{enter:function(e){a||(a=t("ember-views/views/view").View),e.isVirtual||(l.assert("Attempted to register a view with an id already in use: "+e.elementId,!a.views[e.elementId]),a.views[e.elementId]=e),e.addBeforeObserver("elementId",function(){throw new u("Changing a view's elementId after creation is not allowed")})},exit:function(e){a||(a=t("ember-views/views/view").View),this.isVirtual||delete a.views[e.elementId]},insertElement:function(){throw new u("You can't insert an element into the DOM that has already been inserted")}}),s["default"]=f}),e("ember-views/views/states/pre_render",["ember-views/views/states/default","ember-metal/platform","ember-metal/merge","exports"],function(e,t,i,r){"use strict";var o=e["default"],s=t.create,a=i["default"],l=s(o);a(l,{insertElement:function(e,t){e.createElement();var i=e.viewHierarchyCollection();i.trigger("willInsertElement"),t.call(e);var r=e.get("element");document.body.contains(r)&&(i.transitionTo("inDOM",!1),i.trigger("didInsertElement"))},renderToBufferIfNeeded:function(e,t){return e.renderToBuffer(t),!0},empty:n.K,setElement:function(e,t){return null!==t&&e.transitionTo("hasElement"),t}}),r["default"]=l}),e("ember-views/views/view",["ember-metal/core","ember-metal/error","ember-runtime/system/object","ember-runtime/mixins/evented","ember-runtime/mixins/action_handler","ember-views/system/render_buffer","ember-metal/property_get","ember-metal/property_set","ember-metal/set_properties","ember-metal/run_loop","ember-metal/observer","ember-metal/properties","ember-metal/utils","ember-metal/computed","ember-metal/mixin","ember-metal/is_none","container/container","ember-runtime/system/native_array","ember-metal/instrumentation","ember-runtime/system/string","ember-metal/enumerable_utils","ember-runtime/copy","ember-metal/binding","ember-metal/property_events","ember-views/views/states","ember-views/system/jquery","ember-views/system/ext","exports"],function(e,i,r,n,o,s,a,l,d,h,u,c,f,m,p,_,g,v,y,b,x,w,T,E,C,S,F,M){"use strict";function A(e){e.buffer=null}function N(e){W(e).cache.element=void 0}function R(){j.once(bt,"notifyMutationListeners")}var D,I=e["default"],P=i["default"],k=r["default"],V=n["default"],O=o["default"],L=s["default"],B=a.get,U=l.set,z=d["default"],j=h["default"],G=u.addObserver,X=u.removeObserver,H=c.defineProperty,Y=f.guidFor,W=f.meta,q=m.computed,K=p.observer,$=f.typeOf,Q=f.isArray,Z=_.isNone,J=p.Mixin,et=g["default"],tt=v.A,it=y.instrument,rt=b.dasherize,nt=x["default"],ot=nt.forEach,st=nt.addObject,at=nt.removeObject,lt=p.beforeObserver,dt=w["default"],ht=T.isGlobalPath,ut=E.propertyWillChange,ct=E.propertyDidChange,ft=C.cloneStates,mt=C.states,pt=S["default"],_t=q(function(){var e=this._childViews,i=tt(),r=this;return ot(e,function(e){var t;e.isVirtual?(t=B(e,"childViews"))&&i.pushObjects(t):i.push(e)}),i.replace=function(e,i,n){if(D||(D=t("ember-views/views/container_view")["default"]),r instanceof D)return I.deprecate("Manipulating an Ember.ContainerView through its childViews property is deprecated. Please use the ContainerView instance itself as an Ember.MutableArray."),r.replace(e,i,n);throw new P("childViews is immutable")},i});I.warn("The VIEW_PRESERVES_CONTEXT flag has been removed and the functionality can no longer be disabled.",I.ENV.VIEW_PRESERVES_CONTEXT!==!1),I.TEMPLATES={};var gt=k.extend(V,O,{isView:!0,states:ft(mt),init:function(){this._super(),this.transitionTo("preRender"),this._isVisible=B(this,"isVisible")},parentView:q("_parentView",function(){var e=this._parentView;return e&&e.isVirtual?B(e,"parentView"):e}),state:null,_parentView:null,concreteView:q("parentView",function(){return this.isVirtual?B(this,"parentView.concreteView"):this}),instrumentName:"core_view",instrumentDetails:function(e){e.object=this.toString(),e.containerKey=this._debugContainerKey,e.view=this},renderToBuffer:function(e,t){var i="render."+this.instrumentName,r={};return this.instrumentDetails(r),it(i,r,function(){return this._renderToBuffer(e,t)},this)},_renderToBuffer:function(e){var t=this.tagName;(null===t||void 0===t)&&(t="div");
var i=this.buffer=e&&e.begin(t)||L(t);return this.transitionTo("inBuffer",!1),this.beforeRender(i),this.render(i),this.afterRender(i),i},trigger:function(e){this._super.apply(this,arguments);var t=this[e];if(t){var i,r,n=[];for(i=1,r=arguments.length;r>i;i++)n.push(arguments[i]);return t.apply(this,n)}},deprecatedSendHandles:function(e){return!!this[e]},deprecatedSend:function(e){var t=[].slice.call(arguments,1);I.assert(""+this+" has the action "+e+" but it is not a function","function"==typeof this[e]),I.deprecate("Action handlers implemented directly on views are deprecated in favor of action handlers on an `actions` object ( action: `"+e+"` on "+this+")",!1),this[e].apply(this,t)},has:function(e){return"function"===$(this[e])||this._super(e)},destroy:function(){var e=this._parentView;if(this._super())return this.removedFromDOM||this.destroyElement(),e&&e.removeChild(this),this.transitionTo("destroying",!1),this},clearRenderedChildren:I.K,triggerRecursively:I.K,invokeRecursively:I.K,transitionTo:I.K,destroyElement:I.K}),vt=function(e){var t=this.views=e||[];this.length=t.length};vt.prototype={length:0,trigger:function(e){for(var t,i=this.views,r=0,n=i.length;n>r;r++)t=i[r],t.trigger&&t.trigger(e)},triggerRecursively:function(e){for(var t=this.views,i=0,r=t.length;r>i;i++)t[i].triggerRecursively(e)},invokeRecursively:function(e){for(var t,i=this.views,r=0,n=i.length;n>r;r++)t=i[r],e(t)},transitionTo:function(e,t){for(var i=this.views,r=0,n=i.length;n>r;r++)i[r].transitionTo(e,t)},push:function(){this.length+=arguments.length;var e=this.views;return e.push.apply(e,arguments)},objectAt:function(e){return this.views[e]},forEach:function(e){var t=this.views;return ot(t,e)},clear:function(){this.length=0,this.views.length=0}};var yt=[],bt=gt.extend({concatenatedProperties:["classNames","classNameBindings","attributeBindings"],isView:!0,templateName:null,layoutName:null,instrumentDisplay:q(function(){return this.helperName?"{{"+this.helperName+"}}":void 0}),template:q("templateName",function(e,t){if(void 0!==t)return t;var i=B(this,"templateName"),r=this.templateForName(i,"template");return I.assert("You specified the templateName "+i+" for "+this+", but it did not exist.",!i||r),r||B(this,"defaultTemplate")}),controller:q("_parentView",function(){var e=B(this,"_parentView");return e?B(e,"controller"):null}),layout:q(function(){var e=B(this,"layoutName"),t=this.templateForName(e,"layout");return I.assert("You specified the layoutName "+e+" for "+this+", but it did not exist.",!e||t),t||B(this,"defaultLayout")}).property("layoutName"),_yield:function(e,t){var i=B(this,"template");i&&i(e,t)},templateForName:function(e){if(e){I.assert("templateNames are not allowed to contain periods: "+e,-1===e.indexOf("."));var t=this.container||et&&et.defaultContainer;return t&&t.lookup("template:"+e)}},context:q(function(e,t){return 2===arguments.length?(U(this,"_context",t),t):B(this,"_context")}).volatile(),_context:q(function(){var e,t;return(t=B(this,"controller"))?t:(e=this._parentView,e?B(e,"_context"):null)}),_contextDidChange:K("context",function(){this.rerender()}),isVisible:!0,childViews:_t,_childViews:yt,_childViewsWillChange:lt("childViews",function(){if(this.isVirtual){var e=B(this,"parentView");e&&ut(e,"childViews")}}),_childViewsDidChange:K("childViews",function(){if(this.isVirtual){var e=B(this,"parentView");e&&ct(e,"childViews")}}),nearestInstanceOf:function(e){I.deprecate("nearestInstanceOf is deprecated and will be removed from future releases. Use nearestOfType.");for(var t=B(this,"parentView");t;){if(t instanceof e)return t;t=B(t,"parentView")}},nearestOfType:function(e){for(var t=B(this,"parentView"),i=e instanceof J?function(t){return e.detect(t)}:function(t){return e.detect(t.constructor)};t;){if(i(t))return t;t=B(t,"parentView")}},nearestWithProperty:function(e){for(var t=B(this,"parentView");t;){if(e in t)return t;t=B(t,"parentView")}},nearestChildOf:function(e){for(var t=B(this,"parentView");t;){if(B(t,"parentView")instanceof e)return t;t=B(t,"parentView")}},_parentViewDidChange:K("_parentView",function(){this.isDestroying||(this.trigger("parentViewDidChange"),B(this,"parentView.controller")&&!B(this,"controller")&&this.notifyPropertyChange("controller"))}),_controllerDidChange:K("controller",function(){this.isDestroying||(this.rerender(),this.forEachChildView(function(e){e.propertyDidChange("controller")}))}),cloneKeywords:function(){var e=B(this,"templateData"),t=e?dt(e.keywords):{};return U(t,"view",B(this,"concreteView")),U(t,"_view",this),U(t,"controller",B(this,"controller")),t},render:function(e){var t=B(this,"layout")||B(this,"template");if(t){var i,r=B(this,"context"),n=this.cloneKeywords(),o={view:this,buffer:e,isRenderData:!0,keywords:n,insideGroup:B(this,"templateData.insideGroup")};I.assert('template must be a function. Did you mean to call Ember.Handlebars.compile("...") or specify templateName instead?',"function"==typeof t),i=t(r,{data:o}),void 0!==i&&e.push(i)}},rerender:function(){return this.currentState.rerender(this)},clearRenderedChildren:function(){for(var e=this.lengthBeforeRender,t=this.lengthAfterRender,i=this._childViews,r=t-1;r>=e;r--)i[r]&&i[r].destroy()},_applyClassNameBindings:function(e){var t,i,r,n=this.classNames;ot(e,function(e){I.assert("classNameBindings must not have spaces in them. Multiple class name bindings can be provided as elements of an array, e.g. ['foo', ':bar']",-1===e.indexOf(" "));var o,s=bt._parsePropertyPath(e),a=function(){i=this._classStringForProperty(e),t=this.$(),o&&(t.removeClass(o),n.removeObject(o)),i?(t.addClass(i),o=i):o=null};r=this._classStringForProperty(e),r&&(st(n,r),o=r),this.registerObserver(this,s.path,a),this.one("willClearRender",function(){o&&(n.removeObject(o),o=null)})},this)},_unspecifiedAttributeBindings:null,_applyAttributeBindings:function(e,t){var i,r=this._unspecifiedAttributeBindings=this._unspecifiedAttributeBindings||{};ot(t,function(t){var n=t.split(":"),o=n[0],s=n[1]||o;o in this?(this._setupAttributeBindingObservation(o,s),i=B(this,o),bt.applyAttributeBindings(e,s,i)):r[o]=s},this),this.setUnknownProperty=this._setUnknownProperty},_setupAttributeBindingObservation:function(e,t){var i,r,n=function(){r=this.$(),i=B(this,e),bt.applyAttributeBindings(r,t,i)};this.registerObserver(this,e,n)},setUnknownProperty:null,_setUnknownProperty:function(e,t){var i=this._unspecifiedAttributeBindings&&this._unspecifiedAttributeBindings[e];return i&&this._setupAttributeBindingObservation(e,i),H(this,e),U(this,e,t)},_classStringForProperty:function(e){var t=bt._parsePropertyPath(e),i=t.path,r=B(this,i);return void 0===r&&ht(i)&&(r=B(I.lookup,i)),bt._classStringForValue(i,r,t.className,t.falsyClassName)},element:q("_parentView",function(e,t){return void 0!==t?this.currentState.setElement(this,t):this.currentState.getElement(this)}),$:function(e){return this.currentState.$(this,e)},mutateChildViews:function(e){for(var t,i=this._childViews,r=i.length;--r>=0;)t=i[r],e(this,t,r);return this},forEachChildView:function(e){var t=this._childViews;if(!t)return this;var i,r,n=t.length;for(r=0;n>r;r++)i=t[r],e(i);return this},appendTo:function(e){return this._insertElementLater(function(){I.assert("You tried to append to ("+e+") but that isn't in the DOM",pt(e).length>0),I.assert("You cannot append to an existing Ember.View. Consider using Ember.ContainerView instead.",!pt(e).is(".ember-view")&&!pt(e).parents().is(".ember-view")),this.$().appendTo(e)}),this},replaceIn:function(e){return I.assert("You tried to replace in ("+e+") but that isn't in the DOM",pt(e).length>0),I.assert("You cannot replace an existing Ember.View. Consider using Ember.ContainerView instead.",!pt(e).is(".ember-view")&&!pt(e).parents().is(".ember-view")),this._insertElementLater(function(){pt(e).empty(),this.$().appendTo(e)}),this},_insertElementLater:function(e){this._scheduledInsert=j.scheduleOnce("render",this,"_insertElement",e)},_insertElement:function(e){this._scheduledInsert=null,this.currentState.insertElement(this,e)},append:function(){return this.appendTo(document.body)},remove:function(){this.removedFromDOM||this.destroyElement(),this.invokeRecursively(function(e){e.clearRenderedChildren&&e.clearRenderedChildren()})},elementId:null,findElementInParentElement:function(e){var t="#"+this.elementId;return pt(t)[0]||pt(t,e)[0]},createElement:function(){if(B(this,"element"))return this;var e=this.renderToBuffer();return U(this,"element",e.element()),this},willInsertElement:I.K,didInsertElement:I.K,willClearRender:I.K,invokeRecursively:function(e,t){for(var i,r,n,o=t===!1?this._childViews:[this];o.length;){i=o.slice(),o=[];for(var s=0,a=i.length;a>s;s++)r=i[s],n=r._childViews?r._childViews.slice(0):null,e(r),n&&o.push.apply(o,n)}},triggerRecursively:function(e){for(var t,i,r,n=[this];n.length;){t=n.slice(),n=[];for(var o=0,s=t.length;s>o;o++)i=t[o],r=i._childViews?i._childViews.slice(0):null,i.trigger&&i.trigger(e),r&&n.push.apply(n,r)}},viewHierarchyCollection:function(){for(var e,t=new vt([this]),i=0;i<t.length;i++)e=t.objectAt(i),e._childViews&&t.push.apply(t,e._childViews);return t},destroyElement:function(){return this.currentState.destroyElement(this)},willDestroyElement:I.K,_notifyWillDestroyElement:function(){var e=this.viewHierarchyCollection();return e.trigger("willClearRender"),e.trigger("willDestroyElement"),e},_elementDidChange:K("element",function(){this.forEachChildView(N)}),parentViewDidChange:I.K,instrumentName:"view",instrumentDetails:function(e){e.template=B(this,"templateName"),this._super(e)},_renderToBuffer:function(e,t){this.lengthBeforeRender=this._childViews.length;var i=this._super(e,t);return this.lengthAfterRender=this._childViews.length,i},renderToBufferIfNeeded:function(e){return this.currentState.renderToBufferIfNeeded(this,e)},beforeRender:function(e){this.applyAttributesToBuffer(e),e.pushOpeningTag()},afterRender:function(e){e.pushClosingTag()},applyAttributesToBuffer:function(e){var t=B(this,"classNameBindings");t.length&&this._applyClassNameBindings(t);var i=B(this,"attributeBindings");i.length&&this._applyAttributeBindings(e,i),e.setClasses(this.classNames),e.id(this.elementId);var r=B(this,"ariaRole");r&&e.attr("role",r),B(this,"isVisible")===!1&&e.style("display","none")},tagName:null,ariaRole:null,classNames:["ember-view"],classNameBindings:yt,attributeBindings:yt,init:function(){this.elementId=this.elementId||Y(this),this._super(),this._childViews=this._childViews.slice(),I.assert("Only arrays are allowed for 'classNameBindings'","array"===$(this.classNameBindings)),this.classNameBindings=tt(this.classNameBindings.slice()),I.assert("Only arrays are allowed for 'classNames'","array"===$(this.classNames)),this.classNames=tt(this.classNames.slice())},appendChild:function(e,t){return this.currentState.appendChild(this,e,t)},removeChild:function(e){if(!this.isDestroying){U(e,"_parentView",null);var t=this._childViews;return at(t,e),this.propertyDidChange("childViews"),this}},removeAllChildren:function(){return this.mutateChildViews(function(e,t){e.removeChild(t)})},destroyAllChildren:function(){return this.mutateChildViews(function(e,t){t.destroy()})},removeFromParent:function(){var e=this._parentView;return this.remove(),e&&e.removeChild(this),this},destroy:function(){var e,t,i=this._childViews,r=B(this,"parentView"),n=this.viewName;if(this._super()){for(e=i.length,t=e-1;t>=0;t--)i[t].removedFromDOM=!0;for(n&&r&&r.set(n,null),e=i.length,t=e-1;t>=0;t--)i[t].destroy();return this}},createChildView:function(e,t){if(!e)throw new TypeError("createChildViews first argument must exist");if(e.isView&&e._parentView===this&&e.container===this.container)return e;if(t=t||{},t._parentView=this,gt.detect(e))t.templateData=t.templateData||B(this,"templateData"),t.container=this.container,e=e.create(t),e.viewName&&U(B(this,"concreteView"),e.viewName,e);else if("string"==typeof e){var i="view:"+e,r=this.container.lookupFactory(i);I.assert("Could not find view: '"+i+"'",!!r),t.templateData=B(this,"templateData"),e=r.create(t)}else I.assert("You must pass instance or subclass of View",e.isView),t.container=this.container,B(e,"templateData")||(t.templateData=B(this,"templateData")),z(e,t);return e},becameVisible:I.K,becameHidden:I.K,_isVisibleDidChange:K("isVisible",function(){this._isVisible!==B(this,"isVisible")&&j.scheduleOnce("render",this,this._toggleVisibility)}),_toggleVisibility:function(){var e=this.$();if(e){var t=B(this,"isVisible");this._isVisible!==t&&(e.toggle(t),this._isVisible=t,this._isAncestorHidden()||(t?this._notifyBecameVisible():this._notifyBecameHidden()))}},_notifyBecameVisible:function(){this.trigger("becameVisible"),this.forEachChildView(function(e){var t=B(e,"isVisible");(t||null===t)&&e._notifyBecameVisible()})},_notifyBecameHidden:function(){this.trigger("becameHidden"),this.forEachChildView(function(e){var t=B(e,"isVisible");(t||null===t)&&e._notifyBecameHidden()})},_isAncestorHidden:function(){for(var e=B(this,"parentView");e;){if(B(e,"isVisible")===!1)return!0;e=B(e,"parentView")}return!1},clearBuffer:function(){this.invokeRecursively(A)},transitionTo:function(e,t){var i=this.currentState,r=this.currentState=this.states[e];this.state=e,i&&i.exit&&i.exit(this),r.enter&&r.enter(this),"inDOM"===e&&(W(this).cache.element=void 0),t!==!1&&this.forEachChildView(function(t){t.transitionTo(e)})},handleEvent:function(e,t){return this.currentState.handleEvent(this,e,t)},registerObserver:function(e,t,i,r){if(r||"function"!=typeof i||(r=i,i=null),e&&"object"==typeof e){var n=this,o=function(){n.currentState.invokeObserver(this,r)},s=function(){j.scheduleOnce("render",this,o)};G(e,t,i,s),this.one("willClearRender",function(){X(e,t,i,s)})}}}),xt={prepend:function(e,t){e.$().prepend(t),R()},after:function(e,t){e.$().after(t),R()},html:function(e,t){e.$().html(t),R()},replace:function(e){var t=B(e,"element");U(e,"element",null),e._insertElementLater(function(){pt(t).replaceWith(B(e,"element")),R()})},remove:function(e){e.$().remove(),R()},empty:function(e){e.$().empty(),R()}};bt.reopen({domManager:xt}),bt.reopenClass({_parsePropertyPath:function(e){var t,i,r=e.split(":"),n=r[0],o="";return r.length>1&&(t=r[1],3===r.length&&(i=r[2]),o=":"+t,i&&(o+=":"+i)),{path:n,classNames:o,className:""===t?void 0:t,falsyClassName:i}},_classStringForValue:function(e,t,i,r){if(Q(t)&&(t=0!==B(t,"length")),i||r)return i&&t?i:r&&!t?r:null;if(t===!0){var n=e.split(".");return rt(n[n.length-1])}return t!==!1&&null!=t?t:null}});var wt=k.extend(V).create();bt.addMutationListener=function(e){wt.on("change",e)},bt.removeMutationListener=function(e){wt.off("change",e)},bt.notifyMutationListeners=function(){wt.trigger("change")},bt.views={},bt.childViewsProperty=_t,bt.applyAttributeBindings=function(e,t,i){var r=$(i);"value"===t||"string"!==r&&("number"!==r||isNaN(i))?"value"===t||"boolean"===r?Z(i)||i===!1?(e.removeAttr(t),e.prop(t,"")):i!==e.prop(t)&&e.prop(t,i):i||e.removeAttr(t):i!==e.attr(t)&&e.attr(t,i)},M.CoreView=gt,M.View=bt,M.ViewCollection=vt})}(),function(){e("metamorph",[],function(){"use strict";var e=function(){},t=0,i=function(){return"undefined"!=typeof MetamorphENV?MetamorphENV.DISABLE_RANGE_API:"undefined"!==ENV?ENV.DISABLE_RANGE_API:!1}(),r=!i&&"undefined"!=typeof document&&"createRange"in document&&"undefined"!=typeof Range&&Range.prototype.createContextualFragment,n="undefined"!=typeof document&&function(){var e=document.createElement("div");return e.innerHTML="<div></div>",e.firstChild.innerHTML="<script></script>",""===e.firstChild.innerHTML}(),o=document&&function(){var e=document.createElement("div");return e.innerHTML="Test: <script type='text/x-placeholder'></script>Value","Test:"===e.childNodes[0].nodeValue&&" Value"===e.childNodes[2].nodeValue}(),s=function(i){var r;r=this instanceof s?this:new e,r.innerHTML=i;var n="metamorph-"+t++;return r.start=n+"-start",r.end=n+"-end",r};e.prototype=s.prototype;var a,l,d,h,u,c,f,m,p;if(h=function(){return this.startTag()+this.innerHTML+this.endTag()},m=function(){return"<script id='"+this.start+"' type='text/x-placeholder'></script>"},p=function(){return"<script id='"+this.end+"' type='text/x-placeholder'></script>"},r)a=function(e,t){var i=document.createRange(),r=document.getElementById(e.start),n=document.getElementById(e.end);return t?(i.setStartBefore(r),i.setEndAfter(n)):(i.setStartAfter(r),i.setEndBefore(n)),i},l=function(e,t){var i=a(this,t);i.deleteContents();var r=i.createContextualFragment(e);i.insertNode(r)},d=function(){var e=a(this,!0);e.deleteContents()},u=function(e){var t=document.createRange();t.setStart(e),t.collapse(!1);var i=t.createContextualFragment(this.outerHTML());e.appendChild(i)},c=function(e){var t=document.createRange(),i=document.getElementById(this.end);t.setStartAfter(i),t.setEndAfter(i);var r=t.createContextualFragment(e);t.insertNode(r)},f=function(e){var t=document.createRange(),i=document.getElementById(this.start);t.setStartAfter(i),t.setEndAfter(i);var r=t.createContextualFragment(e);t.insertNode(r)};else{var _={select:[1,"<select multiple='multiple'>","</select>"],fieldset:[1,"<fieldset>","</fieldset>"],table:[1,"<table>","</table>"],tbody:[2,"<table><tbody>","</tbody></table>"],tr:[3,"<table><tbody><tr>","</tr></tbody></table>"],colgroup:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],map:[1,"<map>","</map>"],_default:[0,"",""]},g=function(e,t){if(e.getAttribute("id")===t)return e;var i,r,n,o=e.childNodes.length;for(i=0;o>i;i++)if(r=e.childNodes[i],n=1===r.nodeType&&g(r,t))return n},v=function(e,t){var i=[];if(o&&(t=t.replace(/(\s+)(<script id='([^']+)')/g,function(e,t,r,n){return i.push([n,t]),r})),e.innerHTML=t,i.length>0){var r,n=i.length;for(r=0;n>r;r++){var s=g(e,i[r][0]),a=document.createTextNode(i[r][1]);s.parentNode.insertBefore(a,s)}}},y=function(e,t){var i=_[e.tagName.toLowerCase()]||_._default,r=i[0],o=i[1],s=i[2];n&&(t="&shy;"+t);var a=document.createElement("div");v(a,o+t+s);for(var l=0;r>=l;l++)a=a.firstChild;if(n){for(var d=a;1===d.nodeType&&!d.nodeName;)d=d.firstChild;3===d.nodeType&&"­"===d.nodeValue.charAt(0)&&(d.nodeValue=d.nodeValue.slice(1))}return a},b=function(e){for(;""===e.parentNode.tagName;)e=e.parentNode;return e},x=function(e,t){e.parentNode!==t.parentNode&&t.parentNode.insertBefore(e,t.parentNode.firstChild)};l=function(e,t){var i,r,n,o=b(document.getElementById(this.start)),s=document.getElementById(this.end),a=s.parentNode;for(x(o,s),i=o.nextSibling;i;){if(r=i.nextSibling,n=i===s){if(!t)break;s=i.nextSibling}if(i.parentNode.removeChild(i),n)break;i=r}for(i=y(o.parentNode,e),t&&o.parentNode.removeChild(o);i;)r=i.nextSibling,a.insertBefore(i,s),i=r},d=function(){var e=b(document.getElementById(this.start)),t=document.getElementById(this.end);this.html(""),e.parentNode.removeChild(e),t.parentNode.removeChild(t)},u=function(e){for(var t,i=y(e,this.outerHTML());i;)t=i.nextSibling,e.appendChild(i),i=t},c=function(e){var t,i,r=document.getElementById(this.end),n=r.nextSibling,o=r.parentNode;for(i=y(o,e);i;)t=i.nextSibling,o.insertBefore(i,n),i=t},f=function(e){var t,i,r=document.getElementById(this.start),n=r.parentNode;i=y(n,e);for(var o=r.nextSibling;i;)t=i.nextSibling,n.insertBefore(i,o),i=t}}return s.prototype.html=function(e){return this.checkRemoved(),void 0===e?this.innerHTML:(l.call(this,e),void(this.innerHTML=e))},s.prototype.replaceWith=function(e){this.checkRemoved(),l.call(this,e,!0)},s.prototype.remove=d,s.prototype.outerHTML=h,s.prototype.appendTo=u,s.prototype.after=c,s.prototype.prepend=f,s.prototype.startTag=m,s.prototype.endTag=p,s.prototype.isRemoved=function(){var e=document.getElementById(this.start),t=document.getElementById(this.end);return!e||!t},s.prototype.checkRemoved=function(){if(this.isRemoved())throw new Error("Cannot perform operations on a Metamorph that is not in the DOM.")},s})}(),function(){e("ember-handlebars-compiler",["ember-metal/core","exports"],function(e,r){"use strict";var n=e["default"];"undefined"==typeof n.assert&&(n.assert=function(){}),"undefined"==typeof n.FEATURES&&(n.FEATURES={isEnabled:function(){}});var o,s,a=Object.create||function(e){function t(){}return t.prototype=e,new t},l=n.imports&&n.imports.Handlebars||this&&this.Handlebars;l||"function"!=typeof i||(l=i("handlebars")),n.assert("Ember Handlebars requires Handlebars version 1.0 or 1.1. Include a SCRIPT tag in the HTML HEAD linking to the Handlebars file before you link to Ember.",l),n.assert("Ember Handlebars requires Handlebars version 1.0 or 1.1, COMPILER_REVISION expected: 4, got: "+l.COMPILER_REVISION+" - Please note: Builds of master may have other COMPILER_REVISION values.",4===l.COMPILER_REVISION);var d=n.Handlebars=a(l);d.helper=function(e,i){o||(o=t("ember-views/views/view").View),s||(s=t("ember-views/views/component")["default"]),n.assert("You tried to register a component named '"+e+"', but component names must include a '-'",!s.detect(i)||e.match(/-/)),o.detect(i)?d.registerHelper(e,d.makeViewHelper(i)):d.registerBoundHelper.apply(null,arguments)},d.makeViewHelper=function(e){return function(t){return n.assert("You can only pass attributes (such as name=value) not bare values to a helper for a View found in '"+e.toString()+"'",arguments.length<2),d.helpers.view.call(this,e,t)}},d.helpers=a(l.helpers),d.Compiler=function(){},l.Compiler&&(d.Compiler.prototype=a(l.Compiler.prototype)),d.Compiler.prototype.compiler=d.Compiler,d.JavaScriptCompiler=function(){},l.JavaScriptCompiler&&(d.JavaScriptCompiler.prototype=a(l.JavaScriptCompiler.prototype),d.JavaScriptCompiler.prototype.compiler=d.JavaScriptCompiler),d.JavaScriptCompiler.prototype.namespace="Ember.Handlebars",d.JavaScriptCompiler.prototype.initializeBuffer=function(){return"''"},d.JavaScriptCompiler.prototype.appendToBuffer=function(e){return"data.buffer.push("+e+");"};var h=/helpers\.(.*?)\)/,u=/helpers\['(.*?)'/,c=/(.*blockHelperMissing\.call\(.*)(stack[0-9]+)(,.*)/;d.JavaScriptCompiler.stringifyLastBlockHelperMissingInvocation=function(e){var t=e[e.length-1],i=(h.exec(t)||u.exec(t))[1],r=c.exec(t);e[e.length-1]=r[1]+"'"+i+"'"+r[3]};var f=d.JavaScriptCompiler.stringifyLastBlockHelperMissingInvocation,m=d.JavaScriptCompiler.prototype.blockValue;d.JavaScriptCompiler.prototype.blockValue=function(){m.apply(this,arguments),f(this.source)};var p=d.JavaScriptCompiler.prototype.ambiguousBlockValue;d.JavaScriptCompiler.prototype.ambiguousBlockValue=function(){p.apply(this,arguments),f(this.source)},d.Compiler.prototype.mustache=function(e){if(!e.params.length&&!e.hash){var t=new l.AST.IdNode([{part:"_triageMustache"}]);e.escaped||(e.hash=e.hash||new l.AST.HashNode([]),e.hash.pairs.push(["unescaped",new l.AST.StringNode("true")])),e=new l.AST.MustacheNode([t].concat([e.id]),e.hash,!e.escaped)}return l.Compiler.prototype.mustache.call(this,e)},d.precompile=function(e,t){var i=l.parse(e),r={knownHelpers:{action:!0,unbound:!0,"bind-attr":!0,template:!0,view:!0,_triageMustache:!0},data:!0,stringParams:!0};t=void 0===t?!0:t;var n=(new d.Compiler).compile(i,r);return(new d.JavaScriptCompiler).compile(n,r,void 0,t)},l.compile&&(d.compile=function(e){var t=l.parse(e),i={data:!0,stringParams:!0},r=(new d.Compiler).compile(t,i),n=(new d.JavaScriptCompiler).compile(r,i,void 0,!0),o=d.template(n);return o.isMethod=!1,o}),r["default"]=d})}(),function(){e("ember-handlebars/component_lookup",["ember-runtime/system/object","exports"],function(e,t){"use strict";var i=e["default"],r=i.extend({lookupFactory:function(e,t){t=t||this.container;var i="component:"+e,r="template:components/"+e,o=t&&t.has(r);o&&t.injection(i,"layout",r);var s=t.lookupFactory(i);return o||s?(s||(t.register(i,n.Component),s=t.lookupFactory(i)),s):void 0}});t["default"]=r}),e("ember-handlebars/controls",["ember-handlebars/controls/checkbox","ember-handlebars/controls/text_field","ember-handlebars/controls/text_area","ember-metal/core","ember-handlebars-compiler","exports"],function(e,t,i,r,n,o){"use strict";function s(e){u.assert("You can only pass attributes to the `input` helper, not arguments",arguments.length<2);var t=e.hash,i=(e.hashTypes,t.type),r=t.on;return delete t.type,delete t.on,"checkbox"===i?(u.assert("{{input type='checkbox'}} does not support setting `value=someBooleanValue`; you must use `checked=someBooleanValue` instead.","ID"!==e.hashTypes.value),f.view.call(this,l,e)):(i&&(t.type=i),t.onEvent=r||"enter",f.view.call(this,d,e))}function a(e){u.assert("You can only pass attributes to the `textarea` helper, not arguments",arguments.length<2);e.hash,e.hashTypes;return f.view.call(this,h,e)}var l=e["default"],d=t["default"],h=i["default"],u=r["default"],c=n["default"],f=c.helpers;o.inputHelper=s,o.textareaHelper=a}),e("ember-handlebars/controls/checkbox",["ember-metal/property_get","ember-metal/property_set","ember-views/views/view","exports"],function(e,t,i,r){"use strict";var n=e.get,o=t.set,s=i.View,a=s.extend({instrumentDisplay:'{{input type="checkbox"}}',classNames:["ember-checkbox"],tagName:"input",attributeBindings:["type","checked","indeterminate","disabled","tabindex","name","autofocus","required","form"],type:"checkbox",checked:!1,disabled:!1,indeterminate:!1,init:function(){this._super(),this.on("change",this,this._updateElementValue)},didInsertElement:function(){this._super(),n(this,"element").indeterminate=!!n(this,"indeterminate")},_updateElementValue:function(){o(this,"checked",this.$().prop("checked"))}});r["default"]=a}),e("ember-handlebars/controls/select",["ember-handlebars-compiler","ember-metal/enumerable_utils","ember-metal/property_get","ember-metal/property_set","ember-views/views/view","ember-views/views/collection_view","ember-metal/utils","ember-metal/is_none","ember-metal/computed","ember-runtime/system/native_array","ember-metal/mixin","ember-metal/properties","exports"],function(e,t,i,r,o,s,a,l,d,h,u,c,f){"use strict";var m=e["default"],p=t["default"],_=i.get,g=r.set,v=o.View,y=s["default"],b=a.isArray,x=l["default"],w=d.computed,T=h.A,E=u.observer,C=c.defineProperty,S=p.indexOf,F=p.indexesOf,M=p.forEach,A=p.replace,N=(m.compile,v.extend({instrumentDisplay:"Ember.SelectOption",tagName:"option",attributeBindings:["value","selected"],defaultTemplate:function(e,t){t={data:t.data,hash:{}},m.helpers.bind.call(e,"view.label",t)},init:function(){this.labelPathDidChange(),this.valuePathDidChange(),this._super()},selected:w(function(){var e=_(this,"content"),t=_(this,"parentView.selection");return _(this,"parentView.multiple")?t&&S(t,e.valueOf())>-1:e==t}).property("content","parentView.selection"),labelPathDidChange:E("parentView.optionLabelPath",function(){var e=_(this,"parentView.optionLabelPath");e&&C(this,"label",w(function(){return _(this,e)}).property(e))}),valuePathDidChange:E("parentView.optionValuePath",function(){var e=_(this,"parentView.optionValuePath");e&&C(this,"value",w(function(){return _(this,e)}).property(e))})})),R=y.extend({instrumentDisplay:"Ember.SelectOptgroup",tagName:"optgroup",attributeBindings:["label"],selectionBinding:"parentView.selection",multipleBinding:"parentView.multiple",optionLabelPathBinding:"parentView.optionLabelPath",optionValuePathBinding:"parentView.optionValuePath",itemViewClassBinding:"parentView.optionView"}),D=v.extend({instrumentDisplay:"Ember.Select",tagName:"select",classNames:["ember-select"],defaultTemplate:n.Handlebars.template(function(e,t,i,r,o){function s(e,t){var r,n="";return t.buffer.push('<option value="">'),r=i._triageMustache.call(e,"view.prompt",{hash:{},hashTypes:{},hashContexts:{},contexts:[e],types:["ID"],data:t}),(r||0===r)&&t.buffer.push(r),t.buffer.push("</option>"),n}function a(e,t){var r;r=i.each.call(e,"view.groupedContent",{hash:{},hashTypes:{},hashContexts:{},inverse:m.noop,fn:m.program(4,l,t),contexts:[e],types:["ID"],data:t}),t.buffer.push(r||0===r?r:"")}function l(e,t){t.buffer.push(f(i.view.call(e,"view.groupView",{hash:{content:"content",label:"label"},hashTypes:{content:"ID",label:"ID"},hashContexts:{content:e,label:e},contexts:[e],types:["ID"],data:t})))}function d(e,t){var r;r=i.each.call(e,"view.content",{hash:{},hashTypes:{},hashContexts:{},inverse:m.noop,fn:m.program(7,h,t),contexts:[e],types:["ID"],data:t}),t.buffer.push(r||0===r?r:"")}function h(e,t){t.buffer.push(f(i.view.call(e,"view.optionView",{hash:{content:""},hashTypes:{content:"ID"},hashContexts:{content:e},contexts:[e],types:["ID"],data:t})))}this.compilerInfo=[4,">= 1.0.0"],i=this.merge(i,n.Handlebars.helpers),o=o||{};var u,c="",f=this.escapeExpression,m=this;return u=i["if"].call(t,"view.prompt",{hash:{},hashTypes:{},hashContexts:{},inverse:m.noop,fn:m.program(1,s,o),contexts:[t],types:["ID"],data:o}),(u||0===u)&&o.buffer.push(u),u=i["if"].call(t,"view.optionGroupPath",{hash:{},hashTypes:{},hashContexts:{},inverse:m.program(6,d,o),fn:m.program(3,a,o),contexts:[t],types:["ID"],data:o}),(u||0===u)&&o.buffer.push(u),c}),attributeBindings:["multiple","disabled","tabindex","name","required","autofocus","form","size"],multiple:!1,disabled:!1,required:!1,content:null,selection:null,value:w(function(e,t){if(2===arguments.length)return t;var i=_(this,"optionValuePath").replace(/^content\.?/,"");return i?_(this,"selection."+i):_(this,"selection")}).property("selection"),prompt:null,optionLabelPath:"content",optionValuePath:"content",optionGroupPath:null,groupView:R,groupedContent:w(function(){var e=_(this,"optionGroupPath"),t=T(),i=_(this,"content")||[];return M(i,function(i){var r=_(i,e);_(t,"lastObject.label")!==r&&t.pushObject({label:r,content:T()}),_(t,"lastObject.content").push(i)}),t}).property("optionGroupPath","content.@each"),optionView:N,_change:function(){_(this,"multiple")?this._changeMultiple():this._changeSingle()},selectionDidChange:E("selection.@each",function(){var e=_(this,"selection");if(_(this,"multiple")){if(!b(e))return void g(this,"selection",T([e]));this._selectionDidChangeMultiple()}else this._selectionDidChangeSingle()}),valueDidChange:E("value",function(){var e,t=_(this,"content"),i=_(this,"value"),r=_(this,"optionValuePath").replace(/^content\.?/,""),n=r?_(this,"selection."+r):_(this,"selection");i!==n&&(e=t?t.find(function(e){return i===(r?_(e,r):e)}):null,this.set("selection",e))}),_triggerChange:function(){var e=_(this,"selection"),t=_(this,"value");x(e)||this.selectionDidChange(),x(t)||this.valueDidChange(),this._change()},_changeSingle:function(){var e=this.$()[0].selectedIndex,t=_(this,"content"),i=_(this,"prompt");if(t&&_(t,"length")){if(i&&0===e)return void g(this,"selection",null);i&&(e-=1),g(this,"selection",t.objectAt(e))}},_changeMultiple:function(){var e=this.$("option:selected"),t=_(this,"prompt"),i=t?1:0,r=_(this,"content"),n=_(this,"selection");if(r&&e){var o=e.map(function(){return this.index-i}).toArray(),s=r.objectsAt(o);b(n)?A(n,0,_(n,"length"),s):g(this,"selection",s)}},_selectionDidChangeSingle:function(){var e=this.get("element");if(e){var t=_(this,"content"),i=_(this,"selection"),r=t?S(t,i):-1,n=_(this,"prompt");n&&(r+=1),e&&(e.selectedIndex=r)}},_selectionDidChangeMultiple:function(){var e,t=_(this,"content"),i=_(this,"selection"),r=t?F(t,i):[-1],n=_(this,"prompt"),o=n?1:0,s=this.$("option");s&&s.each(function(){e=this.index>-1?this.index-o:-1,this.selected=S(r,e)>-1})},init:function(){this._super(),this.on("didInsertElement",this,this._triggerChange),this.on("change",this,this._change)}});f["default"]=D,f.Select=D,f.SelectOption=N,f.SelectOptgroup=R}),e("ember-handlebars/controls/text_area",["ember-metal/property_get","ember-views/views/component","ember-handlebars/controls/text_support","ember-metal/mixin","exports"],function(e,t,i,r,n){"use strict";var o=e.get,s=t["default"],a=i["default"],l=r.observer,d=s.extend(a,{instrumentDisplay:"{{textarea}}",classNames:["ember-text-area"],tagName:"textarea",attributeBindings:["rows","cols","name","selectionEnd","selectionStart","wrap"],rows:null,cols:null,_updateElementValue:l("value",function(){var e=o(this,"value"),t=this.$();t&&e!==t.val()&&t.val(e)}),init:function(){this._super(),this.on("didInsertElement",this,this._updateElementValue)}});n["default"]=d}),e("ember-handlebars/controls/text_field",["ember-metal/property_get","ember-metal/property_set","ember-views/views/component","ember-handlebars/controls/text_support","exports"],function(e,t,i,r,n){"use strict";
var o=(e.get,t.set,i["default"]),s=r["default"],a=o.extend(s,{instrumentDisplay:'{{input type="text"}}',classNames:["ember-text-field"],tagName:"input",attributeBindings:["type","value","size","pattern","name","min","max","accept","autocomplete","autosave","formaction","formenctype","formmethod","formnovalidate","formtarget","height","inputmode","list","multiple","pattern","step","width"],value:"",type:"text",size:null,pattern:null,min:null,max:null});n["default"]=a}),e("ember-handlebars/controls/text_support",["ember-metal/property_get","ember-metal/property_set","ember-metal/mixin","ember-runtime/mixins/target_action_support","exports"],function(e,t,i,r,n){"use strict";function o(e,t,i){var r=s(t,e),n=s(t,"onEvent"),o=s(t,"value");(n===e||"keyPress"===n&&"key-press"===e)&&t.sendAction("action",o),t.sendAction(e,o),(r||n===e)&&(s(t,"bubbles")||i.stopPropagation())}var s=e.get,a=t.set,l=i.Mixin,d=r["default"],h=l.create(d,{value:"",attributeBindings:["placeholder","disabled","maxlength","tabindex","readonly","autofocus","form","selectionDirection","spellcheck","required","title","autocapitalize","autocorrect"],placeholder:null,disabled:!1,maxlength:null,init:function(){this._super(),this.on("focusOut",this,this._elementValueDidChange),this.on("change",this,this._elementValueDidChange),this.on("paste",this,this._elementValueDidChange),this.on("cut",this,this._elementValueDidChange),this.on("input",this,this._elementValueDidChange),this.on("keyUp",this,this.interpretKeyEvents)},action:null,onEvent:"enter",bubbles:!1,interpretKeyEvents:function(e){var t=h.KEY_EVENTS,i=t[e.keyCode];return this._elementValueDidChange(),i?this[i](e):void 0},_elementValueDidChange:function(){a(this,"value",this.$().val())},insertNewline:function(e){o("enter",this,e),o("insert-newline",this,e)},cancel:function(e){o("escape-press",this,e)},focusIn:function(e){o("focus-in",this,e)},focusOut:function(e){o("focus-out",this,e)},keyPress:function(e){o("key-press",this,e)}});h.KEY_EVENTS={13:"insertNewline",27:"cancel"},n["default"]=h}),e("ember-handlebars/ext",["ember-metal/core","ember-runtime/system/string","ember-handlebars-compiler","ember-metal/property_get","ember-metal/binding","ember-metal/error","ember-metal/mixin","ember-metal/is_empty","exports"],function(e,i,r,n,o,s,a,l,d){"use strict";function h(e,t,i){var r,n,o=i&&i.keywords||{};return r=t.split(".",1)[0],o.hasOwnProperty(r)&&(e=o[r],n=!0,t=t===r?"":t.substr(r.length+1)),{root:e,path:t,isKeyword:n}}function u(e,t,i){var r,n=i&&i.data,o=h(e,t,n);return e=o.root,t=o.path,r=F(e,t),void 0===r&&e!==T.lookup&&M(t)&&(r=F(T.lookup,t)),r}function c(e,t,i){var r=u(e,t,i);return null===r||void 0===r?r="":r instanceof Handlebars.SafeString||(r=String(r)),i.hash.unescaped||(r=Handlebars.Utils.escapeExpression(r)),r}function f(e,t,i){for(var r,n,o=[],s=i.types,a=0,l=t.length;l>a;a++)r=t[a],n=s[a],o.push("ID"===n?u(e,r,i):r);return o}function m(e,t,i){var r,n={},o=i.hashTypes;for(var s in t)t.hasOwnProperty(s)&&(r=o[s],n[s]="ID"===r?u(e,t[s],i):t[s]);return n}function p(e){x||(x=t("ember-handlebars/helpers/binding").resolveHelper);var i,r="",n=arguments[arguments.length-1],o=x(n.data.view.container,e);if(o)return o.apply(this,D.call(arguments,1));throw i="%@ Handlebars error: Could not find property '%@' on object %@.",n.data&&(r=n.data.view),new A(E(i,[r,e,this]))}function _(e){x||(x=t("ember-handlebars/helpers/binding").resolveHelper);var i=arguments[arguments.length-1];T.assert("`blockHelperMissing` was invoked without a helper name, which is most likely due to a mismatch between the version of Ember.js you're running now and the one used to precompile your templates. Please make sure the version of `ember-handlebars-compiler` you're using is up to date.",e);var r=x(i.data.view.container,e);return r?r.apply(this,D.call(arguments,1)):S.helperMissing.call(this,e)}function g(e){var t=D.call(arguments,1),i=v.apply(this,t);C.registerHelper(e,i)}function v(e){function i(){var t,i,n,o,s,a=D.call(arguments,0,-1),l=a.length,d=arguments[arguments.length-1],u=[],c=d.data,f=c.isUnbound?D.call(d.types,1):d.types,m=d.hash,p=c.view,_=d.contexts,g=_&&_.length?_[0]:this,v="",b=w.prototype.normalizedValue;T.assert("registerBoundHelper-generated helpers do not support use with Handlebars blocks.",!d.fn);var x=m.boundOptions={};for(n in m)N.test(n)&&(x[n.slice(0,-7)]=m[n]);var E=[];for(c.properties=[],t=0;l>t;++t)if(c.properties.push(a[t]),"ID"===f[t]){var C=h(g,a[t],c);u.push(C),E.push(C)}else u.push(c.isUnbound?{path:a[t]}:null);if(c.isUnbound)return y(this,e,u,d);var S=new w(null,null,!d.hash.unescaped,d.data);S.normalizedValue=function(){var i,r=[];for(i in x)x.hasOwnProperty(i)&&(s=h(g,x[i],c),S.path=s.path,S.pathRoot=s.root,m[i]=b.call(S));for(t=0;l>t;++t)s=u[t],s?(S.path=s.path,S.pathRoot=s.root,r.push(b.call(S))):r.push(a[t]);return r.push(d),e.apply(g,r)},p.appendChild(S);for(o in x)x.hasOwnProperty(o)&&E.push(h(g,x[o],c));for(t=0,i=E.length;i>t;++t)s=E[t],p.registerObserver(s.root,s.path,S,S.rerender);if("ID"===f[0]&&0!==u.length){var F=u[0],M=F.root,A=F.path;R(A)||(v=A+".");for(var I=0,P=r.length;P>I;I++)p.registerObserver(M,v+r[I],S,S.rerender)}}w||(w=t("ember-handlebars/views/handlebars_bound_view").SimpleHandlebarsView);var r=D.call(arguments,1);return i._rawFunction=e,i}function y(e,t,i,r){var n,o,s,a,l,d=[],h=r.hash,c=h.boundOptions,f=D.call(r.types,1);for(l in c)c.hasOwnProperty(l)&&(h[l]=u(e,c[l],r));for(n=0,o=i.length;o>n;++n)s=i[n],a=f[n],d.push("ID"===a?u(s.root,s.path,r):s.path);return d.push(r),t.apply(e,d)}function b(e){var t=I(e);return t.isTop=!0,t}var x,w,T=e["default"],E=i.fmt,C=r["default"],S=C.helpers,F=n.get,M=o.isGlobalPath,A=s["default"],N=a.IS_BINDING,R=l["default"],D=[].slice,I=C.template;d.normalizePath=h,d.template=b,d.makeBoundHelper=v,d.registerBoundHelper=g,d.resolveHash=m,d.resolveParams=f,d.handlebarsGet=u,d.getEscaped=c,d.evaluateUnboundHelper=y,d.helperMissingHelper=p,d.blockHelperMissingHelper=_}),e("ember-handlebars/helpers/binding",["ember-metal/core","ember-handlebars-compiler","ember-metal/property_get","ember-metal/property_set","ember-runtime/system/string","ember-metal/utils","ember-metal/platform","ember-metal/is_none","ember-metal/enumerable_utils","ember-metal/array","ember-views/views/view","ember-metal/run_loop","ember-handlebars/views/handlebars_bound_view","ember-metal/observer","ember-metal/binding","ember-views/system/jquery","ember-handlebars/ext","ember-runtime/keys","exports"],function(e,t,i,r,n,o,s,a,l,d,h,u,c,f,m,p,_,g,v){"use strict";function y(e){return!j(e)}function b(e,t,i,r,n,o){var s,a,l,d=t.data,h=t.fn,u=t.inverse,c=d.view,f=this||window;if(s=tt(f,e,d),"object"==typeof this){if(d.insideGroup){a=function(){H.once(c,"rerender")};var m,p,_=it(f,e,t);_=n?n(_):_,p=i?f:_,r(_)?m=h:u&&(m=u),m(p,{data:t.data})}else{var g=Y,v={preserveContext:i,shouldDisplayFunc:r,valueNormalizerFunc:n,displayTemplate:h,inverseTemplate:u,path:e,pathRoot:f,previousContext:f,isEscaped:!t.hash.unescaped,templateData:t.data,templateHash:t.hash,helperName:t.helperName};t.isWithHelper&&(g=ot);var y=c.createChildView(g,v);c.appendChild(y),a=function(){H.scheduleOnce("render",y,"rerenderIfNeeded")}}if(""!==s.path&&(c.registerObserver(s.root,s.path,a),o))for(l=0;l<o.length;l++)c.registerObserver(s.root,s.path+"."+o[l],a)}else d.buffer.push(rt(f,e,t))}function x(e,t,i){var r,n,o,s,a=i.data,l=a.view;if(r=tt(e,t,a),o=r.root,o&&"object"==typeof o){if(a.insideGroup)n=function(){H.once(l,"rerender")},s=rt(e,t,i),a.buffer.push(s);else{var d=new W(t,e,!i.hash.unescaped,i.data);d._parentView=l,l.appendChild(d),n=function(){H.scheduleOnce("render",d,"rerender")}}""!==r.path&&l.registerObserver(r.root,r.path,n)}else s=rt(e,t,i),a.buffer.push(s)}function w(e){var t=e&&L(e,"isTruthy");return"boolean"==typeof t?t:et(e)?0!==L(e,"length"):!!e}function T(e,t){P.assert("You cannot pass more than one argument to the _triageMustache helper",arguments.length<=2);var i=k.resolveHelper(t.data.view.container,e);return i?i.call(this,t):V.bind.call(this,e,t)}function E(e,t){if(V[t])return V[t];if(e&&-1!==t.indexOf("-")){var i=e.lookup("helper:"+t);if(!i){var r=e.lookup("component-lookup:main");P.assert("Could not find 'component-lookup:main' on the provided container, which is necessary for performing component lookups",r);var n=r.lookupFactory(t,e);n&&(i=k.makeViewHelper(n),e.register("helper:"+t,i))}return i}}function C(e,t){P.assert("You cannot pass more than one argument to the bind helper",arguments.length<=2);var i=t.contexts&&t.contexts.length?t.contexts[0]:this;return t.fn?(t.helperName="bind",b.call(i,e,t,!1,y)):x(i,e,t)}function S(e,t){var i=t.contexts&&t.contexts.length?t.contexts[0]:this;return t.helperName=t.helperName||"boundIf",b.call(i,e,t,!0,w,w,["isTruthy","length"])}function F(e,t){var i,r,n=t.contexts&&t.contexts.length?t.contexts[0]:this,o=t.data,s=t.fn,a=t.inverse;i=tt(n,e,o),r=it(n,e,t),w(r)||(s=a),s(n,{data:o})}function M(e,t){var i,r,n="with";if(4===arguments.length){var o,s,a,l,d;P.assert("If you pass more than one argument to the with helper, it must be in the form #with foo as bar","as"===arguments[1]),t=arguments[3],o=arguments[2],s=arguments[0],s&&(n+=" "+s+" as "+o),P.assert("You must pass a block to the with helper",t.fn&&t.fn!==Handlebars.VM.noop);var h=z(t);if(h.data=z(t.data),h.data.keywords=z(t.data.keywords||{}),K(s))d=s;else{l=tt(this,s,t.data),s=l.path,a=l.root;var u=J.expando+Q(a);h.data.keywords[u]=a,d=s?u+"."+s:u}h.hash.keywordName=o,h.hash.keywordPath=d,i=this,e=s,t=h,r=!0}else P.assert("You must pass exactly one argument to the with helper",2===arguments.length),P.assert("You must pass a block to the with helper",t.fn&&t.fn!==Handlebars.VM.noop),n+=" "+e,i=t.contexts[0],r=!1;return t.helperName=n,t.isWithHelper=!0,b.call(i,e,t,r,y)}function A(e,t){return P.assert("You must pass exactly one argument to the if helper",2===arguments.length),P.assert("You must pass a block to the if helper",t.fn&&t.fn!==Handlebars.VM.noop),t.helperName=t.helperName||"if "+e,t.data.isUnbound?V.unboundIf.call(t.contexts[0],e,t):V.boundIf.call(t.contexts[0],e,t)}function N(e,t){P.assert("You must pass exactly one argument to the unless helper",2===arguments.length),P.assert("You must pass a block to the unless helper",t.fn&&t.fn!==Handlebars.VM.noop);var i=t.fn,r=t.inverse,n="unless";return e&&(n+=" "+e),t.fn=r,t.inverse=i,t.helperName=t.helperName||n,t.data.isUnbound?V.unboundIf.call(t.contexts[0],e,t):V.boundIf.call(t.contexts[0],e,t)}function R(e){var t=e.hash;P.assert("You must specify at least one hash argument to bind-attr",!!nt(t).length);var i=e.data.view,r=[],n=this||window,o=++P.uuid,s=t["class"];if(null!=s){var a=I(n,s,i,o,e);r.push('class="'+Handlebars.Utils.escapeExpression(a.join(" "))+'"'),delete t["class"]}var l=nt(t);return G.call(l,function(s){var a,l=t[s];P.assert(B("You must provide an expression as the value of bound attribute. You specified: %@=%@",[s,l]),"string"==typeof l),a=tt(n,l,e.data);var d="this"===l?a.root:it(n,l,e),h=Z(d);P.assert(B("Attributes must be numbers, strings or booleans, not %@",[d]),null===d||void 0===d||"number"===h||"string"===h||"boolean"===h);var u,c;u=function(){var t=it(n,l,e);P.assert(B("Attributes must be numbers, strings or booleans, not %@",[t]),null===t||void 0===t||"number"==typeof t||"string"==typeof t||"boolean"==typeof t);var r=i.$("[data-bindattr-"+o+"='"+o+"']");return r&&0!==r.length?void X.applyAttributeBindings(r,s,t):void q(a.root,a.path,c)},"this"===l||a.isKeyword&&""===a.path||i.registerObserver(a.root,a.path,u),"string"===h||"number"===h&&!isNaN(d)?r.push(s+'="'+Handlebars.Utils.escapeExpression(d)+'"'):d&&"boolean"===h&&r.push(s+'="'+s+'"')},this),r.push("data-bindattr-"+o+'="'+o+'"'),new O(r.join(" "))}function D(){return P.warn("The 'bindAttr' view helper is deprecated in favor of 'bind-attr'"),V["bind-attr"].apply(this,arguments)}function I(e,t,i,r,n){var o,s,a,l=[],d=function(e,t,i){var r,n=t.path;return r="this"===n?e:""===n?!0:it(e,n,i),X._classStringForValue(n,r,t.className,t.falsyClassName)};return G.call(t.split(" "),function(t){var h,u,c,f,m=X._parsePropertyPath(t),p=m.path,_=e;""!==p&&"this"!==p&&(f=tt(e,p,n.data),_=f.root,p=f.path),u=function(){o=d(e,m,n),a=r?i.$("[data-bindattr-"+r+"='"+r+"']"):i.$(),a&&0!==a.length?(h&&a.removeClass(h),o?(a.addClass(o),h=o):h=null):q(_,p,c)},""!==p&&"this"!==p&&i.registerObserver(_,p,u),s=d(e,m,n),s&&(l.push(s),h=s)}),l}var P=e["default"],k=t["default"],V=k.helpers,O=k.SafeString,L=i.get,B=(r.set,n.fmt),U=o.apply,z=s.create,j=a["default"],G=(l["default"],d.forEach),X=h.View,H=u["default"],Y=c._HandlebarsBoundView,W=c.SimpleHandlebarsView,q=f.removeObserver,K=m.isGlobalPath,$=m.bind,Q=o.guidFor,Z=o.typeOf,J=p["default"],et=o.isArray,tt=_.normalizePath,it=_.handlebarsGet,rt=(_.getEscaped,_.getEscaped),nt=g["default"],ot=Y.extend({init:function(){var e;U(this,this._super,arguments);var t=this.templateData.keywords,i=this.templateHash.keywordName,r=this.templateHash.keywordPath,n=this.templateHash.controller,o=this.preserveContext;if(n){var s=this.previousContext;if(e=this.container.lookupFactory("controller:"+n).create({parentController:s,target:s}),this._generatedController=e,o){var a=J.expando+Q(e);t[a]=e,$(t,a+".model",r),r=a}else this.set("controller",e),this.valueNormalizerFunc=function(t){return e.set("model",t),e}}o&&$(t,i,r)},willDestroy:function(){this._super(),this._generatedController&&this._generatedController.destroy()}});v.bind=b,v._triageMustacheHelper=T,v.resolveHelper=E,v.bindHelper=C,v.boundIfHelper=S,v.unboundIfHelper=F,v.withHelper=M,v.ifHelper=A,v.unlessHelper=N,v.bindAttrHelper=R,v.bindAttrHelperDeprecated=D,v.bindClasses=I}),e("ember-handlebars/helpers/collection",["ember-metal/core","ember-metal/utils","ember-handlebars-compiler","ember-runtime/system/string","ember-metal/property_get","ember-handlebars/ext","ember-handlebars/helpers/view","ember-metal/computed","ember-views/views/collection_view","exports"],function(e,t,i,r,n,o,s,a,l,d){"use strict";function h(e,t){u.deprecate("Using the {{collection}} helper without specifying a class has been deprecated as the {{each}} helper now supports the same functionality.","collection"!==e),e&&e.data&&e.data.isRenderData?(t=e,e=void 0,u.assert("You cannot pass more than one argument to the collection helper",1===arguments.length)):u.assert("You cannot pass more than one argument to the collection helper",2===arguments.length);{var i,r,n,o=t.fn,s=t.data,a=t.inverse;t.data.view}e?(i=s.keywords.controller,r=i&&i.container,n=_(this,e,t)||r.lookupFactory("view:"+e),u.assert(m("%@ #collection: Could not find collection class %@",[s.view,e]),!!n)):n=y;var l,d,h=t.hash,v={},x=n.proto();h.itemView?(i=s.keywords.controller,u.assert('You specified an itemView, but the current context has no container to look the itemView up in. This probably means that you created a view manually, instead of through the container. Instead, use container.lookup("view:viewName"), which will properly instantiate your view.',i&&i.container),r=i.container,d=r.lookupFactory("view:"+h.itemView),u.assert("You specified the itemView "+h.itemView+", but it was not found at "+r.describe("view:"+h.itemView)+" (and it was not registered in the container)",!!d)):d=h.itemViewClass?_(x,h.itemViewClass,t):x.itemViewClass,u.assert(m("%@ #collection: Could not find itemViewClass %@",[s.view,d]),!!d),delete h.itemViewClass,delete h.itemView;for(var w in h)h.hasOwnProperty(w)&&(l=w.match(/^item(.)(.*)$/),l&&"itemController"!==w&&(v[l[1].toLowerCase()+l[2]]=h[w],delete h[w]));o&&(v.template=o,delete t.fn);var T;a&&a!==c.VM.noop?(T=p(x,"emptyViewClass"),T=T.extend({template:a,tagName:v.tagName})):h.emptyViewClass&&(T=_(this,h.emptyViewClass,t)),T&&(h.emptyView=T),v._context=h.keyword?this:b("content");var E=g.propertiesFromHTMLOptions({data:s,hash:v},this);return h.itemViewClass=d.extend(E),t.helperName=t.helperName||"collection",f.view.call(this,n,t)}var u=e["default"],c=(t.inspect,i["default"]),f=c.helpers,m=r.fmt,p=n.get,_=o.handlebarsGet,g=s.ViewHelper,v=a.computed,y=l["default"],b=v.alias;d["default"]=h}),e("ember-handlebars/helpers/debug",["ember-metal/core","ember-metal/utils","ember-metal/logger","ember-metal/property_get","ember-handlebars/ext","exports"],function(e,t,i,r,n,o){"use strict";function s(){for(var e=c.call(arguments,0,-1),t=arguments[arguments.length-1],i=d.log,r=[],n=!0,o=0;o<e.length;o++){var s=t.types[o];if("ID"!==s&&n)r.push(e[o]);else{var a=t.contexts&&t.contexts[o]||this,l=h(a,e[o],t.data);r.push("this"===l.path?l.root:u(l.root,l.path,t))}}i.apply(i,r)}function a(){{var e=this;l(e)}}var l=(e["default"],t.inspect),d=i["default"],h=(r.get,n.normalizePath),u=n.handlebarsGet,c=[].slice;o.logHelper=s,o.debuggerHelper=a}),e("ember-handlebars/helpers/each",["ember-metal/core","ember-handlebars-compiler","ember-runtime/system/string","ember-metal/property_get","ember-metal/property_set","ember-handlebars/views/metamorph_view","ember-views/views/collection_view","ember-metal/binding","ember-runtime/controllers/controller","ember-runtime/controllers/array_controller","ember-runtime/mixins/array","ember-runtime/copy","ember-metal/run_loop","ember-metal/observer","ember-metal/events","ember-handlebars/ext","ember-metal/computed","exports"],function(e,t,i,r,n,o,s,a,l,d,h,u,c,f,m,p,_,g){"use strict";function v(){j.reopen({_checkMetamorph:U("didInsertElement",function(){b.assert("The metamorph tags, "+this.morph.start+" and "+this.morph.end+", have different parents.\nThe browser has fixed your template to output valid HTML (for example, check that you have properly closed all tags and have used a TBODY tag when creating a table with '{{#each}}')",document.getElementById(this.morph.start).parentNode===document.getElementById(this.morph.end).parentNode)})})}function y(e,t){var i,r="each";if(4===arguments.length){b.assert("If you pass more than one argument to the each helper, it must be in the form #each foo in bar","in"===arguments[1]);var n=arguments[0];t=arguments[3],e=arguments[2],r+=" "+n+" in "+e,""===e&&(e="this"),t.hash.keyword=n}else 1===arguments.length?(t=e,e="this"):r+=" "+e;return t.hash.dataSourceBinding=e,i=this||window,t.helperName=t.helperName||r,!t.data.insideGroup||t.hash.groupedRows||t.hash.itemViewClass?T.collection.call(i,"Ember.Handlebars.EachView",t):void new X(i,e,t).render()}var b=e["default"],x=b.K,w=t["default"],T=w.helpers,E=i.fmt,C=r.get,S=n.set,F=o._Metamorph,M=o._MetamorphView,A=s["default"],N=a.Binding,R=l.ControllerMixin,D=d["default"],I=h["default"],P=u["default"],k=c["default"],V=f.addObserver,O=f.removeObserver,L=f.addBeforeObserver,B=f.removeBeforeObserver,U=m.on,z=p.handlebarsGet,z=(_.computed,p.handlebarsGet),j=A.extend(F,{init:function(){var e,t=C(this,"itemController");if(t){var i=C(this,"controller.container").lookupFactory("controller:array").create({_isVirtual:!0,parentController:C(this,"controller"),itemController:t,target:C(this,"controller"),_eachView:this});this.disableContentObservers(function(){S(this,"content",i),e=new N("content","_eachView.dataSource").oneWay(),e.connect(i)}),S(this,"_arrayController",i)}else this.disableContentObservers(function(){e=new N("content","dataSource").oneWay(),e.connect(this)});return this._super()},_assertArrayLike:function(e){b.assert(E("The value that #each loops over must be an Array. You passed %@, but it should have been an ArrayController",[e.constructor]),!R.detect(e)||e&&e.isGenerated||e instanceof D),b.assert(E("The value that #each loops over must be an Array. You passed %@",[R.detect(e)&&void 0!==e.get("model")?E("'%@' (wrapped in %@)",[e.get("model"),e]):e]),I.detect(e))},disableContentObservers:function(e){B(this,"content",null,"_contentWillChange"),O(this,"content",null,"_contentDidChange"),e.call(this),L(this,"content",null,"_contentWillChange"),V(this,"content",null,"_contentDidChange")},itemViewClass:M,emptyViewClass:M,createChildView:function(e,t){e=this._super(e,t);var i=C(this,"keyword"),r=C(e,"content");if(i){var n=C(e,"templateData");n=P(n),n.keywords=e.cloneKeywords(),S(e,"templateData",n),n.keywords[i]=r}return r&&r.isController&&S(e,"controller",r),e},destroy:function(){if(this._super()){var e=C(this,"_arrayController");return e&&e.destroy(),this}}}),G=function(e){e()};G(function(){v()});var X=w.GroupedEach=function(e,t,i){var r=this,n=w.normalizePath(e,t,i.data);this.context=e,this.path=t,this.options=i,this.template=i.fn,this.containingView=i.data.view,this.normalizedRoot=n.root,this.normalizedPath=n.path,this.content=this.lookupContent(),this.addContentObservers(),this.addArrayObservers(),this.containingView.on("willClearRender",function(){r.destroy()})};X.prototype={contentWillChange:function(){this.removeArrayObservers()},contentDidChange:function(){this.content=this.lookupContent(),this.addArrayObservers(),this.rerenderContainingView()},contentArrayWillChange:x,contentArrayDidChange:function(){this.rerenderContainingView()},lookupContent:function(){return z(this.normalizedRoot,this.normalizedPath,this.options)},addArrayObservers:function(){this.content&&this.content.addArrayObserver(this,{willChange:"contentArrayWillChange",didChange:"contentArrayDidChange"})},removeArrayObservers:function(){this.content&&this.content.removeArrayObserver(this,{willChange:"contentArrayWillChange",didChange:"contentArrayDidChange"})},addContentObservers:function(){L(this.normalizedRoot,this.normalizedPath,this,this.contentWillChange),V(this.normalizedRoot,this.normalizedPath,this,this.contentDidChange)},removeContentObservers:function(){B(this.normalizedRoot,this.normalizedPath,this.contentWillChange),O(this.normalizedRoot,this.normalizedPath,this.contentDidChange)},render:function(){if(this.content){var e=this.content,t=C(e,"length"),i=this.options.data,r=this.template;i.insideEach=!0;for(var n=0;t>n;n++)r(e.objectAt(n),{data:i})}},rerenderContainingView:function(){var e=this;k.scheduleOnce("render",this,function(){e.destroyed||e.containingView.rerender()})},destroy:function(){this.removeContentObservers(),this.content&&this.removeArrayObservers(),this.destroyed=!0}},g.EachView=j,g.GroupedEach=X,g.eachHelper=y}),e("ember-handlebars/helpers/loc",["ember-runtime/system/string","exports"],function(e,t){"use strict";function i(e){return r(e)}var r=e.loc;t["default"]=i}),e("ember-handlebars/helpers/partial",["ember-metal/core","ember-metal/is_none","ember-handlebars/ext","ember-handlebars/helpers/binding","exports"],function(e,t,i,r,n){"use strict";function o(e,t){var i=t.contexts&&t.contexts.length?t.contexts[0]:this;return t.helperName=t.helperName||"partial","ID"===t.types[0]?(t.fn=function(t,i){var r=h(t,e,i);a(t,r,i)},u.call(i,e,t,!0,s)):void a(i,e,t)}function s(e){return!d(e)}function a(e,t,i){var r=t.split("/"),n=r[r.length-1];r[r.length-1]="_"+n;var o=i.data.view,s=r.join("/"),a=o.templateForName(s),d=!a&&o.templateForName(t);l.assert("Unable to find partial with name '"+t+"'.",a||d),(a=a||d)(e,{data:i.data})}var l=e["default"],d=t.isNone,h=i.handlebarsGet,u=r.bind;n["default"]=o}),e("ember-handlebars/helpers/shared",["ember-handlebars/ext","exports"],function(e,t){"use strict";function i(e){for(var t=[],i=e.contexts,n=e.roots,o=e.data,s=0,a=i.length;a>s;s++)t.push(r(n[s],i[s],{data:o}));return t}var r=e.handlebarsGet;t["default"]=i}),e("ember-handlebars/helpers/template",["ember-metal/core","ember-handlebars-compiler","exports"],function(e,t,i){"use strict";function r(e,t){return n.deprecate("The `template` helper has been deprecated in favor of the `partial` helper. Please use `partial` instead, which will work the same way."),t.helperName=t.helperName||"template",s.partial.apply(this,arguments)}var n=e["default"],o=t["default"],s=o.helpers;i["default"]=r}),e("ember-handlebars/helpers/unbound",["ember-handlebars-compiler","ember-handlebars/helpers/binding","ember-handlebars/ext","exports"],function(e,t,i,r){"use strict";function n(e,t){var i,r,n,o,h=arguments[arguments.length-1],u=h.data.view.container;return o=this,arguments.length>2?(h.data.isUnbound=!0,i=a(u,e)||s.helperMissing,n=i.apply(o,d.call(arguments,1)),delete h.data.isUnbound,n):(r=t.contexts&&t.contexts.length?t.contexts[0]:o,l(r,e,t))}var o=e["default"],s=o.helpers,a=t.resolveHelper,l=i.handlebarsGet,d=[].slice;r["default"]=n}),e("ember-handlebars/helpers/view",["ember-metal/core","ember-runtime/system/object","ember-metal/property_get","ember-metal/property_set","ember-metal/mixin","ember-views/system/jquery","ember-views/views/view","ember-metal/binding","ember-handlebars/ext","ember-runtime/system/string","exports"],function(e,t,i,r,n,o,s,a,l,d,h){"use strict";function u(e,t){var i=t.hash,r=t.hashTypes;for(var n in i)if("ID"===r[n]){var o=i[n];_.test(n)?f.warn("You're attempting to render a view by passing "+n+"="+o+" to a view helper, but this syntax is ambiguous. You should either surround "+o+" in quotes or remove `Binding` from "+n+"."):(i[n+"Binding"]=o,r[n+"Binding"]="STRING",delete i[n],delete r[n])}i.hasOwnProperty("idBinding")&&(i.id=x(e,i.idBinding,t),r.id="STRING",delete i.idBinding,delete r.idBinding)}function c(e,t){return f.assert("The view helper only takes a single argument",arguments.length<=2),e&&e.data&&e.data.isRenderData&&(t=e,e="Ember.View"),t.helperName=t.helperName||"view",C.helper(this,e,t)}var f=e["default"],m=t["default"],p=i.get,_=(r.set,n.IS_BINDING),g=o["default"],v=s.View,y=a.isGlobalPath,b=l.normalizePath,x=l.handlebarsGet,w=d["default"],T=/^[a-z]/,E=/^view\./,C=m.create({propertiesFromHTMLOptions:function(e){var t=e.hash,i=e.data,r={},n=t["class"],o=!1;t.id&&(r.elementId=t.id,o=!0),t.tag&&(r.tagName=t.tag,o=!0),n&&(n=n.split(" "),r.classNames=n,o=!0),t.classBinding&&(r.classNameBindings=t.classBinding.split(" "),o=!0),t.classNameBindings&&(void 0===r.classNameBindings&&(r.classNameBindings=[]),r.classNameBindings=r.classNameBindings.concat(t.classNameBindings.split(" ")),o=!0),t.attributeBindings&&(f.assert("Setting 'attributeBindings' via Handlebars is not allowed. Please subclass Ember.View and set it there instead."),r.attributeBindings=null,o=!0),o&&(t=g.extend({},t),delete t.id,delete t.tag,delete t["class"],delete t.classBinding);var s;for(var a in t)t.hasOwnProperty(a)&&_.test(a)&&"string"==typeof t[a]&&(s=this.contextualizeBindingPath(t[a],i),s&&(t[a]=s));if(r.classNameBindings)for(var l in r.classNameBindings){var d=r.classNameBindings[l];if("string"==typeof d){var h=v._parsePropertyPath(d);s=this.contextualizeBindingPath(h.path,i),s&&(r.classNameBindings[l]=s+h.classNames)}}return g.extend(t,r)},contextualizeBindingPath:function(e,t){var i=b(null,e,t);return i.isKeyword?"templateData.keywords."+e:y(e)?null:"this"===e||""===e?"_parentView.context":"_parentView.context."+e},helper:function(e,t,i){var r,n=i.data,o=i.fn;u(e,i),"string"==typeof t?("STRING"===i.types[0]&&T.test(t)&&!E.test(t)?(f.assert("View requires a container",!!n.view.container),r=n.view.container.lookupFactory("view:"+t)):r=x(e,t,i),f.assert("Unable to find view at path '"+t+"'",!!r)):r=t,f.assert(w.fmt("You must pass a view to the #view helper, not %@ (%@)",[t,r]),v.detect(r)||v.detectInstance(r));var s=this.propertiesFromHTMLOptions(i,e),a=n.view;s.templateData=n;var l=r.proto?r.proto():r;o&&(f.assert("You cannot provide a template block if you also specified a templateName",!p(s,"templateName")&&!p(l,"templateName")),s.template=o),l.controller||l.controllerBinding||s.controller||s.controllerBinding||(s._context=e),i.helperName&&(s.helperName=i.helperName),a.appendChild(r,s)}});h.ViewHelper=C,h.viewHelper=c}),e("ember-handlebars/helpers/yield",["ember-metal/core","ember-metal/property_get","exports"],function(e,t,i){"use strict";function r(e){for(var t=e.data.view;t&&!o(t,"layout");)t=t._contextView?t._contextView:o(t,"_parentView");n.assert("You called yield in a template that was not a layout",!!t),t._yield(this,e)}var n=e["default"],o=t.get;i["default"]=r}),e("ember-handlebars/loader",["ember-handlebars/component_lookup","ember-views/system/jquery","ember-metal/error","ember-runtime/system/lazy_load","ember-handlebars-compiler","exports"],function(e,t,i,r,o,s){"use strict";function a(e){var t='script[type="text/x-handlebars"], script[type="text/x-raw-handlebars"]';u(t,e).each(function(){var e=u(this),t="text/x-raw-handlebars"===e.attr("type")?u.proxy(Handlebars.compile,Handlebars):u.proxy(m.compile,m),i=e.attr("data-template-name")||e.attr("id")||"application",r=t(e.html());if(void 0!==n.TEMPLATES[i])throw new c('Template named "'+i+'" already exists.');n.TEMPLATES[i]=r,e.remove()})}function l(){a(u(document))}function d(e){e.register("component-lookup:main",h)}var h=e["default"],u=t["default"],c=i["default"],f=r.onLoad,m=o["default"];f("Ember.Application",function(e){e.initializer({name:"domTemplates",initialize:l}),e.initializer({name:"registerComponentLookup",after:"domTemplates",initialize:d})}),s["default"]=a}),e("ember-handlebars",["ember-handlebars-compiler","ember-metal/core","ember-runtime/system/lazy_load","ember-handlebars/loader","ember-handlebars/ext","ember-handlebars/string","ember-handlebars/helpers/shared","ember-handlebars/helpers/binding","ember-handlebars/helpers/collection","ember-handlebars/helpers/view","ember-handlebars/helpers/unbound","ember-handlebars/helpers/debug","ember-handlebars/helpers/each","ember-handlebars/helpers/template","ember-handlebars/helpers/partial","ember-handlebars/helpers/yield","ember-handlebars/helpers/loc","ember-handlebars/controls/checkbox","ember-handlebars/controls/select","ember-handlebars/controls/text_area","ember-handlebars/controls/text_field","ember-handlebars/controls/text_support","ember-handlebars/controls","ember-handlebars/component_lookup","ember-handlebars/views/handlebars_bound_view","ember-handlebars/views/metamorph_view","exports"],function(e,t,i,r,n,o,s,a,l,d,h,u,c,f,m,p,_,g,v,y,b,x,w,T,E,C,S){"use strict";var F=e["default"],M=t["default"],A=i.runLoadHooks,N=r["default"],R=n.normalizePath,D=n.template,I=n.makeBoundHelper,P=n.registerBoundHelper,k=n.resolveHash,V=n.resolveParams,O=n.getEscaped,L=n.handlebarsGet,B=n.evaluateUnboundHelper,U=n.helperMissingHelper,z=n.blockHelperMissingHelper,j=s["default"],G=a.bind,X=a._triageMustacheHelper,H=a.resolveHelper,Y=a.bindHelper,W=a.boundIfHelper,q=a.unboundIfHelper,K=a.withHelper,$=a.ifHelper,Q=a.unlessHelper,Z=a.bindAttrHelper,J=a.bindAttrHelperDeprecated,et=a.bindClasses,tt=l["default"],it=d.ViewHelper,rt=d.viewHelper,nt=h["default"],ot=u.logHelper,st=u.debuggerHelper,at=c.EachView,lt=c.GroupedEach,dt=c.eachHelper,ht=f["default"],ut=m["default"],ct=p["default"],ft=_["default"],mt=g["default"],pt=v.Select,_t=v.SelectOption,gt=v.SelectOptgroup,vt=y["default"],yt=b["default"],bt=x["default"],bt=x["default"],xt=w.inputHelper,wt=w.textareaHelper,Tt=T["default"],Et=E._HandlebarsBoundView,Ct=E.SimpleHandlebarsView,St=C._SimpleMetamorphView,Ft=C._MetamorphView,Mt=C._Metamorph;F.bootstrap=N,F.template=D,F.makeBoundHelper=I,F.registerBoundHelper=P,F.resolveHash=k,F.resolveParams=V,F.resolveHelper=H,F.get=L,F.getEscaped=O,F.evaluateUnboundHelper=B,F.bind=G,F.bindClasses=et,F.EachView=at,F.GroupedEach=lt,F.resolvePaths=j,F.ViewHelper=it,F.normalizePath=R,M.Handlebars=F,M.ComponentLookup=Tt,M._SimpleHandlebarsView=Ct,M._HandlebarsBoundView=Et,M._SimpleMetamorphView=St,M._MetamorphView=Ft,M._Metamorph=Mt,M.TextSupport=bt,M.Checkbox=mt,M.Select=pt,M.SelectOption=_t,M.SelectOptgroup=gt,M.TextArea=vt,M.TextField=yt,M.TextSupport=bt,F.registerHelper("helperMissing",U),F.registerHelper("blockHelperMissing",z),F.registerHelper("bind",Y),F.registerHelper("boundIf",W),F.registerHelper("_triageMustache",X),F.registerHelper("unboundIf",q),F.registerHelper("with",K),F.registerHelper("if",$),F.registerHelper("unless",Q),F.registerHelper("bind-attr",Z),F.registerHelper("bindAttr",J),F.registerHelper("collection",tt),F.registerHelper("log",ot),F.registerHelper("debugger",st),F.registerHelper("each",dt),F.registerHelper("loc",ft),F.registerHelper("partial",ut),F.registerHelper("template",ht),F.registerHelper("yield",ct),F.registerHelper("view",rt),F.registerHelper("unbound",nt),F.registerHelper("input",xt),F.registerHelper("textarea",wt),A("Ember.Handlebars",F),S["default"]=F
}),e("ember-handlebars/string",["ember-runtime/system/string","exports"],function(e,t){"use strict";function i(e){return new Handlebars.SafeString(e)}var r=e["default"];r.htmlSafe=i,(n.EXTEND_PROTOTYPES===!0||n.EXTEND_PROTOTYPES.String)&&(String.prototype.htmlSafe=function(){return i(this)}),t["default"]=i}),e("ember-handlebars/views/handlebars_bound_view",["ember-handlebars-compiler","ember-metal/core","ember-metal/error","ember-metal/property_get","ember-metal/property_set","ember-metal/merge","ember-metal/run_loop","ember-metal/computed","ember-views/views/view","ember-views/views/states","ember-handlebars/views/metamorph_view","ember-handlebars/ext","exports"],function(e,i,r,n,o,s,a,l,d,h,u,c,f){"use strict";function m(e,t,i,r){this.path=e,this.pathRoot=t,this.isEscaped=i,this.templateData=r,this.morph=y(),this.state="preRender",this.updateId=null,this._parentView=null,this.buffer=null}var p=e["default"],_=p.SafeString,g=i["default"],v=g.K,y=t("metamorph"),b=r["default"],x=n.get,w=o.set,T=s["default"],E=a["default"],C=(l.computed,d.View,h.cloneStates),S=h.states,F=S,M=u._MetamorphView,A=c.handlebarsGet;m.prototype={isVirtual:!0,isView:!0,destroy:function(){this.updateId&&(E.cancel(this.updateId),this.updateId=null),this._parentView&&this._parentView.removeChild(this),this.morph=null,this.state="destroyed"},propertyWillChange:v,propertyDidChange:v,normalizedValue:function(){var e,t,i=this.path,r=this.pathRoot;return""===i?e=r:(t=this.templateData,e=A(r,i,{data:t})),e},renderToBuffer:function(e){var t="";t+=this.morph.startTag(),t+=this.render(),t+=this.morph.endTag(),e.push(t)},render:function(){var e=this.isEscaped,t=this.normalizedValue();return null===t||void 0===t?t="":t instanceof _||(t=String(t)),e&&(t=Handlebars.Utils.escapeExpression(t)),t},rerender:function(){switch(this.state){case"preRender":case"destroyed":break;case"inBuffer":throw new b("Something you did tried to replace an {{expression}} before it was inserted into the DOM.");case"hasElement":case"inDOM":this.updateId=E.scheduleOnce("render",this,"update")}return this},update:function(){this.updateId=null,this.morph.html(this.render())},transitionTo:function(e){this.state=e}};var S=C(F);T(S._default,{rerenderIfNeeded:v}),T(S.inDOM,{rerenderIfNeeded:function(e){e.normalizedValue()!==e._lastNormalizedValue&&e.rerender()}});var N=M.extend({states:S,instrumentName:"boundHandlebars",shouldDisplayFunc:null,preserveContext:!1,previousContext:null,displayTemplate:null,inverseTemplate:null,path:null,pathRoot:null,normalizedValue:function(){var e,t,i=x(this,"path"),r=x(this,"pathRoot"),n=x(this,"valueNormalizerFunc");return""===i?e=r:(t=x(this,"templateData"),e=A(r,i,{data:t})),n?n(e):e},rerenderIfNeeded:function(){this.currentState.rerenderIfNeeded(this)},render:function(e){var t=x(this,"isEscaped"),i=x(this,"shouldDisplayFunc"),r=x(this,"preserveContext"),n=x(this,"previousContext"),o=x(this,"inverseTemplate"),s=x(this,"displayTemplate"),a=this.normalizedValue();if(this._lastNormalizedValue=a,i(a))if(w(this,"template",s),r)w(this,"_context",n);else{if(!s)return null===a||void 0===a?a="":a instanceof _||(a=String(a)),t&&(a=Handlebars.Utils.escapeExpression(a)),void e.push(a);w(this,"_context",a)}else o?(w(this,"template",o),r?w(this,"_context",n):w(this,"_context",a)):w(this,"template",function(){return""});return this._super(e)}});f._HandlebarsBoundView=N,f.SimpleHandlebarsView=m}),e("ember-handlebars/views/metamorph_view",["ember-metal/core","ember-metal/property_get","ember-metal/property_set","ember-views/views/view","ember-metal/mixin","ember-metal/run_loop","exports"],function(e,i,r,n,o,s,a){"use strict";function l(){f.once(u,"notifyMutationListeners")}var d=e["default"],h=(i.get,r["default"],n.CoreView),u=n.View,c=o.Mixin,f=s["default"],m=t("metamorph"),p={remove:function(e){e.morph.remove(),l()},prepend:function(e,t){e.morph.prepend(t),l()},after:function(e,t){e.morph.after(t),l()},html:function(e,t){e.morph.html(t),l()},replace:function(e){var t=e.morph;e.transitionTo("preRender"),f.schedule("render",this,function(){if(!e.isDestroying){e.clearRenderedChildren();var i=e.renderToBuffer();e.invokeRecursively(function(e){e.propertyWillChange("element")}),e.triggerRecursively("willInsertElement"),t.replaceWith(i.string()),e.transitionTo("inDOM"),e.invokeRecursively(function(e){e.propertyDidChange("element")}),e.triggerRecursively("didInsertElement"),l()}})},empty:function(e){e.morph.html(""),l()}},_=c.create({isVirtual:!0,tagName:"",instrumentName:"metamorph",init:function(){this._super(),this.morph=m(),d.deprecate("Supplying a tagName to Metamorph views is unreliable and is deprecated. You may be setting the tagName on a Handlebars helper that creates a Metamorph.",!this.tagName)},beforeRender:function(e){e.push(this.morph.startTag()),e.pushOpeningTag()},afterRender:function(e){e.pushClosingTag(),e.push(this.morph.endTag())},createElement:function(){var e=this.renderToBuffer();this.outerHTML=e.string(),this.clearBuffer()},domManager:p}),g=u.extend(_),v=h.extend(_);a._SimpleMetamorphView=v,a._MetamorphView=g,a._Metamorph=_})}(),function(){e("ember-routing/ext/controller",["ember-metal/core","ember-metal/property_get","ember-metal/property_set","ember-metal/enumerable_utils","ember-runtime/controllers/controller","exports"],function(e,t,i,r,n,o){"use strict";var s=e["default"],a=t.get,l=(i.set,r["default"]),d=(l.map,n.ControllerMixin);d.reopen({transitionToRoute:function(){var e=a(this,"target"),t=e.transitionToRoute||e.transitionTo;return t.apply(e,arguments)},transitionTo:function(){return s.deprecate("transitionTo is deprecated. Please use transitionToRoute."),this.transitionToRoute.apply(this,arguments)},replaceRoute:function(){var e=a(this,"target"),t=e.replaceRoute||e.replaceWith;return t.apply(e,arguments)},replaceWith:function(){return s.deprecate("replaceWith is deprecated. Please use replaceRoute."),this.replaceRoute.apply(this,arguments)}}),o["default"]=d}),e("ember-routing/ext/run_loop",["ember-metal/run_loop"],function(e){"use strict";{var t=e["default"];t.queues}t._addQueue("routerTransitions","actions")}),e("ember-routing/ext/view",["ember-metal/property_get","ember-metal/property_set","ember-metal/run_loop","ember-views/views/view","exports"],function(e,t,i,r,n){"use strict";var o=e.get,s=t.set,a=i["default"],l=r.View;l.reopen({init:function(){s(this,"_outlets",{}),this._super()},connectOutlet:function(e,t){if(this._pendingDisconnections&&delete this._pendingDisconnections[e],this._hasEquivalentView(e,t))return void t.destroy();var i=o(this,"_outlets"),r=o(this,"container"),n=r&&r.lookup("router:main"),a=o(t,"renderedName");s(i,e,t),n&&a&&n._connectActiveView(a,t)},_hasEquivalentView:function(e,t){var i=o(this,"_outlets."+e);return i&&i.constructor===t.constructor&&i.get("template")===t.get("template")&&i.get("context")===t.get("context")},disconnectOutlet:function(e){this._pendingDisconnections||(this._pendingDisconnections={}),this._pendingDisconnections[e]=!0,a.once(this,"_finishDisconnections")},_finishDisconnections:function(){if(!this.isDestroyed){var e=o(this,"_outlets"),t=this._pendingDisconnections;this._pendingDisconnections=null;for(var i in t)s(e,i,null)}}}),n["default"]=l}),e("ember-routing/helpers/action",["ember-metal/core","ember-metal/property_get","ember-metal/array","ember-metal/run_loop","ember-views/system/utils","ember-handlebars","ember-routing/system/router","ember-handlebars/ext","ember-handlebars/helpers/view","ember-routing/helpers/shared","exports"],function(e,t,i,r,n,o,s,a,l,d,h){"use strict";function u(e,t){var i=[];t&&i.push(t);var r=e.options.types.slice(1),n=e.options.data;return i.concat(y(e.context,e.params,{types:r,data:n}))}function c(e){var t=arguments[arguments.length-1],i=x.call(arguments,1,-1),r=t.hash,n=t.data.keywords.controller,o={eventName:r.on||"click",parameters:{context:this,options:t,params:i},view:t.data.view,bubbles:r.bubbles,preventDefault:r.preventDefault,target:{options:t},boundProperty:"ID"===t.types[0]};r.target?(o.target.root=this,o.target.target=r.target):n&&(o.target.root=n);var s=w.registerAction(e,o,r.allowedKeys);return new b('data-ember-action="'+s+'"')}var f=e["default"],m=(t.get,i.forEach),p=r["default"],_=n.isSimpleClick,g=o["default"],g=(s["default"],o["default"]),v=a.handlebarsGet,y=(l.viewHelper,d.resolveParams),b=(d.resolvePath,g.SafeString),x=Array.prototype.slice,w={registeredActions:{}},T=["alt","shift","meta","ctrl"],E=/^click|mouse|touch/,C=function(e,t){if("undefined"==typeof t){if(E.test(e.type))return _(e);t=""}if(t.indexOf("any")>=0)return!0;var i=!0;return m.call(T,function(r){e[r+"Key"]&&-1===t.indexOf(r)&&(i=!1)}),i};w.registerAction=function(e,t,i){var r=++f.uuid;return w.registeredActions[r]={eventName:t.eventName,handler:function(r){if(!C(r,i))return!0;t.preventDefault!==!1&&r.preventDefault(),t.bubbles===!1&&r.stopPropagation();var n,o=t.target,s=t.parameters;o=o.target?v(o.root,o.target,o.options):o.root,t.boundProperty&&(n=y(s.context,[e],{types:["ID"],data:s.options.data})[0],("undefined"==typeof n||"function"==typeof n)&&(f.assert("You specified a quoteless path to the {{action}} helper '"+e+"' which did not resolve to an actionName. Perhaps you meant to use a quoted actionName? (e.g. {{action '"+e+"'}}).",!0),n=e)),n||(n=e),p(function(){o.send?o.send.apply(o,u(s,n)):(f.assert("The action '"+n+"' did not exist on "+o,"function"==typeof o[n]),o[n].apply(o,u(s)))})}},t.view.on("willClearRender",function(){delete w.registeredActions[r]}),r},h.ActionHelper=w,h.actionHelper=c}),e("ember-routing/helpers/link_to",["ember-metal/core","ember-metal/property_get","ember-metal/property_set","ember-metal/merge","ember-metal/run_loop","ember-metal/computed","ember-runtime/system/lazy_load","ember-runtime/system/string","ember-runtime/system/object","ember-runtime/keys","ember-views/system/utils","ember-views/views/view","ember-handlebars","ember-handlebars/helpers/view","ember-routing/system/router","ember-routing/helpers/shared","exports"],function(e,i,r,n,o,s,a,l,d,h,u,c,f,m,p,_,g){"use strict";function v(e,t){var i=e.parameters,r=E(e,"queryParamsObject"),n={};r&&C(n,r.values);for(var o=E(e,"resolvedParams"),s=E(e,"router"),a=o[0],l=s._queryParamsFor(a),d=l.qps,h={},u=0,c=d.length;c>u;++u){var f,m=d[u],p=null;if(m.prop in n?(f=n[m.prop],p=r.types[m.prop],delete n[m.prop]):m.urlKey in n&&(f=n[m.urlKey],p=r.types[m.urlKey],delete n[m.urlKey]),p){if("ID"===p){var _=I.normalizePath(i.context,f,i.options.data);f=I.get(_.root,_.path,i.options)}f=m.route.serializeQueryParam(f,m.urlKey,m.type)}else f=m.svalue;t&&f===m.sdef||(h[m.urlKey]=f)}return h}function y(e){var t=e.get("routeArgs");return t[t.length-1].queryParams?(t=t.slice(),t[t.length-1]={queryParams:v(e,!0)},t):t}function b(e){var t=e.options.types,i=e.options.data;return V(e.context,e.params,{types:t,data:i})}function x(){var e=O.call(arguments,-1)[0],t=O.call(arguments,0,-1),i=e.hash;if(t[t.length-1]instanceof B&&(i.queryParamsObject=t.pop()),i.disabledBinding=i.disabledWhen,!e.fn){var r=t.shift(),n=e.types.shift(),o=this;"ID"===n?(e.linkTextPath=r,e.fn=function(){return I.getEscaped(o,r,e)}):e.fn=function(){return r}}return i.parameters={context:this,options:e,params:t},e.helperName=e.helperName||"link-to",P.call(this,U,e)}function w(){return T.warn("The 'linkTo' view helper is deprecated in favor of 'link-to'"),x.apply(this,arguments)}var T=e["default"],E=i.get,C=(r.set,n["default"]),S=o["default"],F=s.computed,M=(a.onLoad,l.fmt),A=d["default"],N=h["default"],R=u.isSimpleClick,D=c.View,I=f["default"],P=m.viewHelper,k=(p["default"],_.resolveParams),V=_.resolvePaths,O=[].slice;t("ember-handlebars");var L=function(e,t){for(var i=0,r=0,n=t.length;n>r&&(i+=t[r].names.length,t[r].handler!==e);r++);return i},B=A.extend({values:null}),U=T.LinkView=D.extend({tagName:"a",currentWhen:null,title:null,rel:null,activeClass:"active",loadingClass:"loading",disabledClass:"disabled",_isDisabled:!1,replace:!1,attributeBindings:["href","title","rel"],classNameBindings:["active","loading","disabled"],eventName:"click",init:function(){this._super.apply(this,arguments);var e=E(this,"eventName");this.on(e,this,this._invoke)},_paramsChanged:function(){this.notifyPropertyChange("resolvedParams")},_setupPathObservers:function(){var e,t,i,r=this.parameters,n=r.options.linkTextPath,o=b(r),s=o.length;for(n&&(i=I.normalizePath(r.context,n,r.options.data),this.registerObserver(i.root,i.path,this,this.rerender)),t=0;s>t;t++)e=o[t],null!==e&&(i=I.normalizePath(r.context,e,r.options.data),this.registerObserver(i.root,i.path,this,this._paramsChanged));var a=this.queryParamsObject;if(a){var l=a.values;for(var d in l)l.hasOwnProperty(d)&&"ID"===a.types[d]&&(i=I.normalizePath(r.context,l[d],r.options.data),this.registerObserver(i.root,i.path,this,this._paramsChanged))}},afterRender:function(){this._super.apply(this,arguments),this._setupPathObservers()},concreteView:F(function(){return E(this,"parentView")}).property("parentView"),disabled:F(function(e,t){return void 0!==t&&this.set("_isDisabled",t),t?E(this,"disabledClass"):!1}),active:F(function(){if(E(this,"loading"))return!1;var e=E(this,"router"),t=E(this,"routeArgs"),i=t.slice(1),r=(E(this,"resolvedParams"),this.currentWhen||t[0]),n=L(r,e.router.recognizer.handlersFor(r));i.length>n&&(r=t[0]);var o=e.isActive.apply(e,[r].concat(i));return o?E(this,"activeClass"):void 0}).property("resolvedParams","routeArgs"),loading:F(function(){return E(this,"routeArgs")?void 0:E(this,"loadingClass")}).property("routeArgs"),router:F(function(){return E(this,"controller").container.lookup("router:main")}),_invoke:function(e){if(!R(e))return!0;if(this.preventDefault!==!1&&e.preventDefault(),this.bubbles===!1&&e.stopPropagation(),E(this,"_isDisabled"))return!1;if(E(this,"loading"))return T.Logger.warn("This link-to is in an inactive loading state because at least one of its parameters presently has a null/undefined value, or the provided route name is invalid."),!1;var t,i=E(this,"router"),r=E(this,"routeArgs");t=E(this,"replace")?i.replaceWith.apply(i,r):i.transitionTo.apply(i,r);var n=i.router.generate.apply(i.router,y(this));S.scheduleOnce("routerTransitions",this,this._eagerUpdateUrl,t,n)},_eagerUpdateUrl:function(e,t){if(e.isActive&&e.urlMethod){0===t.indexOf("#")&&(t=t.slice(1));var i=E(this,"router.router");"update"===e.urlMethod?i.updateURL(t):"replace"===e.urlMethod&&i.replaceURL(t),e.method(null)}},resolvedParams:F(function(){var e=this.parameters,t=e.options,i=t.types,r=t.data;if(0===e.params.length){var n=this.container.lookup("controller:application");return[E(n,"currentRouteName")]}return k(e.context,e.params,{types:i,data:r})}).property("router.url"),routeArgs:F(function(){var e=E(this,"resolvedParams").slice(0),t=E(this,"router"),i=e[0];if(i){T.assert(M("The attempt to link-to route '%@' failed. The router did not find '%@' in its possible routes: '%@'",[i,i,N(t.router.recognizer.names).join("', '")]),t.hasRoute(i));var r=t.router.recognizer.handlersFor(i),n=r[r.length-1].handler;i!==n&&(this.currentWhen||this.set("currentWhen",i),i=r[r.length-1].handler,e[0]=i);for(var o=1,s=e.length;s>o;++o){var a=e[o];if(null===a||"undefined"==typeof a)return}return e}}).property("resolvedParams","queryParams"),queryParamsObject:null,queryParams:F(function(){return v(this,!1)}).property("resolvedParams.[]"),href:F(function(){if("a"===E(this,"tagName")){var e=E(this,"router"),t=E(this,"routeArgs");return t?e.generate.apply(e,t):E(this,"loadingHref")}}).property("routeArgs"),loadingHref:"#"});U.toString=function(){return"LinkView"},g.LinkView=U,g.deprecatedLinkToHelper=w,g.linkToHelper=x}),e("ember-routing/helpers/outlet",["ember-metal/core","ember-metal/property_get","ember-metal/property_set","ember-runtime/system/lazy_load","ember-views/views/container_view","ember-handlebars/views/metamorph_view","ember-handlebars/helpers/view","exports"],function(e,t,i,r,n,o,s,a){"use strict";function l(e,t){var i,r,n,o,s;for(e&&e.data&&e.data.isRenderData&&(t=e,e="main"),r=t.data.view.container,i=t.data.view;!i.get("template.isTop");)i=i.get("_parentView");return n=t.hash.view,n&&(s="view:"+n,d.assert("Using a quoteless view parameter with {{outlet}} is not supported. Please update to quoted usage '{{outlet \""+n+'"}}.',"ID"!==t.hashTypes.view),d.assert("The view name you supplied '"+n+"' did not resolve to a view.",r.has(s))),o=n?r.lookupFactory(s):t.hash.viewClass||f,t.data.view.set("outletSource",i),t.hash.currentViewBinding="_view.outletSource._outlets."+e,t.helperName=t.helperName||"outlet",c.call(this,o,t)}var d=e["default"],h=(t.get,i.set,r.onLoad,n["default"]),u=o._Metamorph,c=s.viewHelper,f=h.extend(u);a.outletHelper=l,a.OutletView=f}),e("ember-routing/helpers/render",["ember-metal/core","ember-metal/error","ember-metal/property_get","ember-metal/property_set","ember-runtime/system/string","ember-routing/system/controller_for","ember-handlebars/ext","ember-handlebars/helpers/view","exports"],function(e,t,i,r,n,o,s,a,l){"use strict";function d(e,t,i){var r,n,o,s,a,l=arguments.length;if(r=(i||t).data.keywords.controller.container,n=r.lookup("router:main"),2===l)i=t,t=void 0,h.assert('You can only use the {{render}} helper once without a model object as its second argument, as in {{render "post" post}}.',!n||!n._lookupActiveView(e));else{if(3!==l)throw u("You must pass a templateName to render");a=p(i.contexts[1],t,i)}h.deprecate("Using a quoteless parameter with {{render}} is deprecated. Please update to quoted usage '{{render \""+e+'"}}.',"ID"!==i.types[0]),e=e.replace(/\//g,"."),s=r.lookup("view:"+e)||r.lookup("view:default");var d=i.hash.controller||e,g="controller:"+d;i.hash.controller&&h.assert("The controller name you supplied '"+d+"' did not resolve to a controller.",r.has(g));var v=i.data.keywords.controller;if(l>2){var y=r.lookupFactory(g)||f(r,d,a);o=y.create({model:a,parentController:v,target:v}),s.one("willDestroyElement",function(){o.destroy()})}else o=r.lookup(g)||m(r,d),o.setProperties({target:v,parentController:v});var b=i.contexts[1];b&&s.registerObserver(b,t,function(){o.set("model",p(b,t,i))}),i.hash.viewName=c(e);var x="template:"+e;h.assert("You used `{{render '"+e+"'}}`, but '"+e+"' can not be found as either a template or a view.",r.has("view:"+e)||r.has(x)||i.fn),i.hash.template=r.lookup(x),i.hash.controller=o,n&&!a&&n._connectActiveView(e,s),i.helperName=i.helperName||'render "'+e+'"',_.call(this,s,i)}var h=e["default"],u=t["default"],c=(i.get,r.set,n.camelize),f=o.generateControllerFactory,m=o.generateController,p=s.handlebarsGet,_=a.viewHelper;l["default"]=d}),e("ember-routing/helpers/shared",["ember-metal/property_get","ember-metal/array","ember-runtime/system/lazy_load","ember-runtime/controllers/controller","ember-routing/system/router","ember-handlebars/ext","exports"],function(e,t,i,r,n,o,s){"use strict";function a(e,t,i){return h.call(l(e,t,i),function(r,n){return null===r?t[n]:f(e,r,i)})}function l(e,t,i){function r(e,t){return"controller"===t?t:u.detect(e)?r(d(e,"model"),t?t+".model":"model"):t}var n=c(e,t,i),o=i.types;return h.call(n,function(e,i){return"ID"===o[i]?r(e,t[i]):null})}var d=e.get,h=t.map,u=(i.onLoad,r.ControllerMixin),c=(n["default"],o.resolveParams),f=o.handlebarsGet;s.resolveParams=a,s.resolvePaths=l}),e("ember-routing/location/api",["ember-metal/core","ember-metal/property_get","ember-metal/property_set","exports"],function(e,t,i,r){"use strict";var n=e["default"],o=(t.get,i.set,{create:function(e){var t=e&&e.implementation;n.assert("Ember.Location.create: you must specify a 'implementation' option",!!t);var i=this.implementations[t];return n.assert("Ember.Location.create: "+t+" is not a valid implementation",!!i),i.create.apply(i,arguments)},registerImplementation:function(e,t){n.deprecate("Using the Ember.Location.registerImplementation is no longer supported. Register your custom location implementation with the container instead.",!1),this.implementations[e]=t},implementations:{},_location:window.location,_getHash:function(){var e=(this._location||this.location).href,t=e.indexOf("#");return-1===t?"":e.substr(t)}});r["default"]=o}),e("ember-routing/location/auto_location",["ember-metal/core","ember-metal/property_get","ember-metal/property_set","ember-routing/location/api","ember-routing/location/history_location","ember-routing/location/hash_location","ember-routing/location/none_location","exports"],function(e,t,i,r,n,o,s,a){"use strict";var l=e["default"],d=(t.get,i.set),h=r["default"],u=n["default"],c=o["default"],f=s["default"],m={cancelRouterSetup:!1,rootURL:"/",_window:window,_location:window.location,_history:window.history,_HistoryLocation:u,_HashLocation:c,_NoneLocation:f,_getOrigin:function(){var e=this._location,t=e.origin;return t||(t=e.protocol+"//"+e.hostname,e.port&&(t+=":"+e.port)),t},_getSupportsHistory:function(){var e=this._window.navigator.userAgent;return-1!==e.indexOf("Android 2")&&-1!==e.indexOf("Mobile Safari")&&-1===e.indexOf("Chrome")?!1:!!(this._history&&"pushState"in this._history)},_getSupportsHashChange:function(){var e=this._window,t=e.document.documentMode;return"onhashchange"in e&&(void 0===t||t>7)},_replacePath:function(e){this._location.replace(this._getOrigin()+e)},_getRootURL:function(){return this.rootURL},_getPath:function(){var e=this._location.pathname;return"/"!==e.charAt(0)&&(e="/"+e),e},_getHash:h._getHash,_getQuery:function(){return this._location.search},_getFullPath:function(){return this._getPath()+this._getQuery()+this._getHash()},_getHistoryPath:function(){var e,t,i=this._getRootURL(),r=this._getPath(),n=this._getHash(),o=this._getQuery(),s=r.indexOf(i);return l.assert("Path "+r+" does not start with the provided rootURL "+i,0===s),"#/"===n.substr(0,2)?(t=n.substr(1).split("#"),e=t.shift(),"/"===r.slice(-1)&&(e=e.substr(1)),r+=e,r+=o,t.length&&(r+="#"+t.join("#"))):(r+=o,r+=n),r},_getHashPath:function(){var e=this._getRootURL(),t=e,i=this._getHistoryPath(),r=i.substr(e.length);return""!==r&&("/"!==r.charAt(0)&&(r="/"+r),t+="#"+r),t},create:function(e){e&&e.rootURL&&(l.assert('rootURL must end with a trailing forward slash e.g. "/app/"',"/"===e.rootURL.charAt(e.rootURL.length-1)),this.rootURL=e.rootURL);var t,i,r=!1,n=this._NoneLocation,o=this._getFullPath();this._getSupportsHistory()?(t=this._getHistoryPath(),o===t?n=this._HistoryLocation:(r=!0,this._replacePath(t))):this._getSupportsHashChange()&&(i=this._getHashPath(),o===i||"/"===o&&"/#/"===i?n=this._HashLocation:(r=!0,this._replacePath(i)));var s=n.create.apply(n,arguments);return r&&d(s,"cancelRouterSetup",!0),s}};a["default"]=m}),e("ember-routing/location/hash_location",["ember-metal/property_get","ember-metal/property_set","ember-metal/run_loop","ember-metal/utils","ember-runtime/system/object","ember-routing/location/api","ember-views/system/jquery","exports"],function(e,t,i,r,n,o,s,a){"use strict";var l=e.get,d=t.set,h=i["default"],u=r.guidFor,c=n["default"],f=o["default"],m=s["default"],p=c.extend({implementation:"hash",init:function(){d(this,"location",l(this,"_location")||window.location)},getHash:f._getHash,getURL:function(){return this.getHash().substr(1)},setURL:function(e){l(this,"location").hash=e,d(this,"lastSetURL",e)},replaceURL:function(e){l(this,"location").replace("#"+e),d(this,"lastSetURL",e)},onUpdateURL:function(e){var t=this,i=u(this);m(window).on("hashchange.ember-location-"+i,function(){h(function(){var i=t.getURL();l(t,"lastSetURL")!==i&&(d(t,"lastSetURL",null),e(i))})})},formatURL:function(e){return"#"+e},willDestroy:function(){var e=u(this);m(window).off("hashchange.ember-location-"+e)}});a["default"]=p}),e("ember-routing/location/history_location",["ember-metal/core","ember-metal/property_get","ember-metal/property_set","ember-metal/utils","ember-runtime/system/object","ember-views/system/jquery","exports"],function(e,t,i,r,n,o,s){"use strict";var a=(e["default"],t.get),l=i.set,d=r.guidFor,h=n["default"],u=o["default"],c=!1,f=window.history&&"state"in window.history,m=h.extend({implementation:"history",init:function(){l(this,"location",a(this,"location")||window.location),l(this,"baseURL",u("base").attr("href")||"")},initState:function(){l(this,"history",a(this,"history")||window.history),this.replaceState(this.formatURL(this.getURL()))},rootURL:"/",getURL:function(){var e=a(this,"rootURL"),t=a(this,"location"),i=t.pathname,r=a(this,"baseURL");e=e.replace(/\/$/,""),r=r.replace(/\/$/,"");var n=i.replace(r,"").replace(e,"");return n},setURL:function(e){var t=this.getState();e=this.formatURL(e),t&&t.path===e||this.pushState(e)},replaceURL:function(e){var t=this.getState();e=this.formatURL(e),t&&t.path===e||this.replaceState(e)},getState:function(){return f?a(this,"history").state:this._historyState},pushState:function(e){var t={path:e};a(this,"history").pushState(t,null,e),f||(this._historyState=t),this._previousURL=this.getURL()},replaceState:function(e){var t={path:e};a(this,"history").replaceState(t,null,e),f||(this._historyState=t),this._previousURL=this.getURL()},onUpdateURL:function(e){var t=d(this),i=this;u(window).on("popstate.ember-location-"+t,function(){(c||(c=!0,i.getURL()!==i._previousURL))&&e(i.getURL())})},formatURL:function(e){var t=a(this,"rootURL"),i=a(this,"baseURL");return""!==e?(t=t.replace(/\/$/,""),i=i.replace(/\/$/,"")):i.match(/^\//)&&t.match(/^\//)&&(i=i.replace(/\/$/,"")),i+t+e},willDestroy:function(){var e=d(this);u(window).off("popstate.ember-location-"+e)}});s["default"]=m}),e("ember-routing/location/none_location",["ember-metal/property_get","ember-metal/property_set","ember-runtime/system/object","exports"],function(e,t,i,r){"use strict";var n=e.get,o=t.set,s=i["default"],a=s.extend({implementation:"none",path:"",getURL:function(){return n(this,"path")},setURL:function(e){o(this,"path",e)},onUpdateURL:function(e){this.updateCallback=e},handleURL:function(e){o(this,"path",e),this.updateCallback(e)},formatURL:function(e){return e}});r["default"]=a}),e("ember-routing",["ember-handlebars","ember-metal/core","ember-routing/ext/run_loop","ember-routing/ext/controller","ember-routing/ext/view","ember-routing/helpers/shared","ember-routing/helpers/link_to","ember-routing/location/api","ember-routing/location/none_location","ember-routing/location/hash_location","ember-routing/location/history_location","ember-routing/location/auto_location","ember-routing/system/controller_for","ember-routing/system/dsl","ember-routing/system/router","ember-routing/system/route","ember-routing/helpers/outlet","ember-routing/helpers/render","ember-routing/helpers/action","exports"],function(e,t,i,r,n,o,s,a,l,d,h,u,c,f,m,p,_,g,v,y){"use strict";var b=e["default"],x=t["default"],w=o.resolvePaths,T=o.resolveParams,E=s.deprecatedLinkToHelper,C=s.linkToHelper,S=s.LinkView,F=a["default"],M=l["default"],A=d["default"],N=h["default"],R=u["default"],D=c.controllerFor,I=c.generateControllerFactory,P=c.generateController,k=f["default"],V=m["default"],O=p["default"],L=_.outletHelper,B=_.OutletView,U=g["default"],z=v.ActionHelper,j=v.actionHelper;x.Location=F,x.AutoLocation=R,x.HashLocation=A,x.HistoryLocation=N,x.NoneLocation=M,x.controllerFor=D,x.generateControllerFactory=I,x.generateController=P,x.RouterDSL=k,x.Router=V,x.Route=O,x.LinkView=S,V.resolveParams=T,V.resolvePaths=w,b.ActionHelper=z,b.OutletView=B,b.registerHelper("render",U),b.registerHelper("action",j),b.registerHelper("outlet",L),b.registerHelper("link-to",C),b.registerHelper("linkTo",E),y["default"]=x}),e("ember-routing/system/controller_for",["ember-metal/core","ember-metal/property_get","ember-metal/utils","exports"],function(e,t,i,r){"use strict";var n=e["default"],o=t.get,s=i.isArray,a=function(e,t,i){return e.lookup("controller:"+t,i)},l=function(e,t,i){var r,n,o,a;return a=i&&s(i)?"array":i?"object":"basic",o="controller:"+a,r=e.lookupFactory(o).extend({isGenerated:!0,toString:function(){return"(generated "+t+" controller)"}}),n="controller:"+t,e.register(n,r),r},d=function(e,t,i){l(e,t,i);var r="controller:"+t,s=e.lookup(r);return o(s,"namespace.LOG_ACTIVE_GENERATION")&&n.Logger.info("generated -> "+r,{fullName:r}),s};r.controllerFor=a,r.generateControllerFactory=l,r.generateController=d}),e("ember-routing/system/dsl",["ember-metal/core","exports"],function(e,t){"use strict";function i(e){this.parent=e,this.matches=[]}function r(e,t,i){n.assert("You must use `this.resource` to nest","function"!=typeof i),i=i||{},"string"!=typeof i.path&&(i.path="/"+t),e.parent&&"application"!==e.parent&&(t=e.parent+"."+t),e.push(i.path,t,null)}var n=e["default"];i.prototype={resource:function(e,t,o){if(n.assert("'basic' cannot be used as a resource name.","basic"!==e),2===arguments.length&&"function"==typeof t&&(o=t,t={}),1===arguments.length&&(t={}),"string"!=typeof t.path&&(t.path="/"+e),o){var s=new i(e);r(s,"loading"),r(s,"error",{path:"/_unused_dummy_error_path_route_"+e+"/:error"}),o.call(s),this.push(t.path,e,s.generate())}else this.push(t.path,e,null)},push:function(e,t,i){var r=t.split(".");(""===e||"/"===e||"index"===r[r.length-1])&&(this.explicitIndex=!0),this.matches.push([e,t,i])},route:function(e,t){n.assert("'basic' cannot be used as a route name.","basic"!==e),r(this,e,t)},generate:function(){var e=this.matches;return this.explicitIndex||this.route("index",{path:"/"}),function(t){for(var i=0,r=e.length;r>i;i++){var n=e[i];t(n[0]).to(n[1],n[2])}}}},i.map=function(e){var t=new i;return e.call(t),t},t["default"]=i}),e("ember-routing/system/route",["ember-metal/core","ember-metal/error","ember-metal/property_get","ember-metal/property_set","ember-metal/get_properties","ember-metal/enumerable_utils","ember-metal/is_none","ember-metal/computed","ember-metal/utils","ember-metal/run_loop","ember-runtime/keys","ember-runtime/copy","ember-runtime/system/string","ember-runtime/system/object","ember-runtime/mixins/action_handler","ember-routing/system/controller_for","exports"],function(e,t,i,r,n,o,s,a,l,d,h,u,c,f,m,p,_){"use strict";function g(e){var t=e.router.router.state.handlerInfos;if(t)for(var i,r,n=0,o=t.length;o>n;n++){if(r=t[n].handler,r===e)return i;i=r}}function v(e){var t,i=g(e);if(i)return(t=i.lastRenderedTemplate)?t:v(i)}function y(e,t,i,r){r=r||{},r.into=r.into?r.into.replace(/\//g,"."):v(e),r.outlet=r.outlet||"main",r.name=t,r.template=i,r.LOG_VIEW_LOOKUPS=S(e.router,"namespace.LOG_VIEW_LOOKUPS"),E.assert("An outlet ("+r.outlet+") was specified but was not found.","main"===r.outlet||r.into);var n,o=r.controller,s=r.model;if(o=r.controller?r.controller:(n=e.container.lookup("controller:"+t))?n:e.controllerName||e.routeName,"string"==typeof o){var a=o;if(o=e.container.lookup("controller:"+a),!o)throw new C("You passed `controller: '"+a+"'` into the `render` method, but no such controller could be found.")}return s&&o.set("model",s),r.controller=o,r}function b(e,t,i){if(e)i.LOG_VIEW_LOOKUPS&&E.Logger.info("Rendering "+i.name+" with "+e,{fullName:"view:"+i.name});else{var r=i.into?"view:default":"view:toplevel";e=t.lookup(r),i.LOG_VIEW_LOOKUPS&&E.Logger.info("Rendering "+i.name+" with default view "+e,{fullName:"view:"+i.name})}return S(e,"templateName")||(F(e,"template",i.template),F(e,"_debugTemplateName",i.name)),F(e,"renderedName",i.name),F(e,"controller",i.controller),e}function x(e,t,i){if(i.into){var r=e.router._lookupActiveView(i.into),n=T(r,i.outlet);e.teardownOutletViews||(e.teardownOutletViews=[]),L(e.teardownOutletViews,0,0,[n]),r.connectOutlet(i.outlet,t)}else{var o=S(e,"router.namespace.rootElement");e.teardownTopLevelView&&e.teardownTopLevelView(),e.router._connectActiveView(i.name,t),e.teardownTopLevelView=w(t),t.appendTo(o)}}function w(e){return function(){e.destroy()}}function T(e,t){return function(){e.disconnectOutlet(t)}}var E=e["default"],C=t["default"],S=i.get,F=r.set,M=n["default"],A=o["default"],N=s.isNone,R=a.computed,D=(l.typeOf,d["default"],h["default"],u["default"]),I=c.classify,P=(c.fmt,f["default"]),k=m["default"],V=p.generateController,O=A.forEach,L=A.replace,B=P.extend(k,{exit:function(){this.deactivate(),this.teardownViews()},enter:function(){this.activate()},viewName:null,templateName:null,controllerName:null,_actions:{queryParamsDidChange:function(){},finalizeQueryParamChange:function(){}},events:null,mergedProperties:["events"],deactivate:E.K,activate:E.K,transitionTo:function(){var e=this.router;
return e.transitionTo.apply(e,arguments)},intermediateTransitionTo:function(){var e=this.router;e.intermediateTransitionTo.apply(e,arguments)},refresh:function(){return this.router.router.refresh(this)},replaceWith:function(){var e=this.router;return e.replaceWith.apply(e,arguments)},send:function(){return this.router.send.apply(this.router,arguments)},setup:function(e){var t=this.controllerName||this.routeName,i=this.controllerFor(t,!0);i||(i=this.generateController(t,e)),this.controller=i,this.setupControllers?(E.deprecate("Ember.Route.setupControllers is deprecated. Please use Ember.Route.setupController(controller, model) instead."),this.setupControllers(i,e)):this.setupController(i,e),this.renderTemplates?(E.deprecate("Ember.Route.renderTemplates is deprecated. Please use Ember.Route.renderTemplate(controller, model) instead."),this.renderTemplates(e)):this.renderTemplate(i,e)},beforeModel:E.K,afterModel:E.K,redirect:E.K,contextDidChange:function(){this.currentModel=this.context},model:function(e,t){var i,r,n,o;for(var s in e)"queryParams"!==s&&((i=s.match(/^(.*)_id$/))&&(r=i[1],o=e[s]),n=!0);if(!r&&n)return D(e);if(!r){if(t.resolveIndex!==t.state.handlerInfos.length-1)return;var a=t.state.handlerInfos[t.resolveIndex-1].context;return a}return this.findModel(r,o)},deserialize:function(e,t){return this.model(e,t)},findModel:function(){var e=S(this,"store");return e.find.apply(e,arguments)},store:R(function(){var e=this.container,t=this.routeName,i=S(this,"router.namespace");return{find:function(r,n){var o=e.lookupFactory("model:"+r);return E.assert("You used the dynamic segment "+r+"_id in your route "+t+", but "+i+"."+I(r)+" did not exist and you did not override your route's `model` hook.",o),o?(E.assert(I(r)+" has no method `find`.","function"==typeof o.find),o.find(n)):void 0}}}),serialize:function(e,t){if(!(t.length<1)&&e){var i=t[0],r={};return/_id$/.test(i)&&1===t.length?r[i]=S(e,"id"):r=M(e,t),r}},setupController:function(e,t){e&&void 0!==t&&F(e,"model",t)},controllerFor:function(e,t){var i,r=this.container,n=r.lookup("route:"+e);return n&&n.controllerName&&(e=n.controllerName),i=r.lookup("controller:"+e),E.assert("The controller named '"+e+"' could not be found. Make sure that this route exists and has already been entered at least once. If you are accessing a controller not associated with a route, make sure the controller class is explicitly defined.",i||t===!0),i},generateController:function(e,t){var i=this.container;return t=t||this.modelFor(e),V(i,e,t)},modelFor:function(e){var t=this.container.lookup("route:"+e),i=this.router?this.router.router.activeTransition:null;if(i){var r=t&&t.routeName||e;if(i.resolvedModels.hasOwnProperty(r))return i.resolvedModels[r]}return t&&t.currentModel},renderTemplate:function(){this.render()},render:function(e,t){E.assert("The name in the given arguments is undefined",arguments.length>0?!N(arguments[0]):!0);var i="string"==typeof e&&!!e;"object"!=typeof e||t||(t=e,e=this.routeName),t=t||{};var r;e?(e=e.replace(/\//g,"."),r=e):(e=this.routeName,r=this.templateName||e);var n=t.view||i&&e||this.viewName||e,o=this.container,s=o.lookup("view:"+n),a=s?s.get("template"):null;return a||(a=o.lookup("template:"+r)),s||a?(t=y(this,e,a,t),s=b(s,o,t),"main"===t.outlet&&(this.lastRenderedTemplate=e),void x(this,s,t)):(E.assert('Could not find "'+e+'" template or view.',E.isEmpty(arguments[0])),void(S(this.router,"namespace.LOG_VIEW_LOOKUPS")&&E.Logger.info('Could not find "'+e+'" template or view. Nothing will be rendered',{fullName:"template:"+e})))},disconnectOutlet:function(e){if(!e||"string"==typeof e){var t=e;e={},e.outlet=t}e.parentView=e.parentView?e.parentView.replace(/\//g,"."):v(this),e.outlet=e.outlet||"main";var i=this.router._lookupActiveView(e.parentView);i&&i.disconnectOutlet(e.outlet)},willDestroy:function(){this.teardownViews()},teardownViews:function(){this.teardownTopLevelView&&this.teardownTopLevelView();var e=this.teardownOutletViews||[];O(e,function(e){e()}),delete this.teardownTopLevelView,delete this.teardownOutletViews,delete this.lastRenderedTemplate}});_["default"]=B}),e("ember-routing/system/router",["ember-metal/core","ember-metal/error","ember-metal/property_get","ember-metal/property_set","ember-metal/array","ember-metal/properties","ember-metal/computed","ember-metal/merge","ember-metal/run_loop","ember-metal/enumerable_utils","ember-runtime/system/string","ember-runtime/system/object","ember-runtime/mixins/evented","ember-routing/system/dsl","ember-views/views/view","ember-routing/location/api","ember-handlebars/views/metamorph_view","exports"],function(e,i,r,n,o,s,a,l,d,h,u,c,f,m,p,_,g,v){"use strict";function y(e,t,i){for(var r=t.state.handlerInfos,n=!1,o=r.length-1;o>=0;--o){var s=r[o],a=s.handler;if(n){if(i(a,r[o+1].handler)!==!0)return!1}else e===a&&(n=!0)}return!0}function b(e,t){var i=[];t&&i.push(t),e&&(e.message&&i.push(e.message),e.stack&&i.push(e.stack),"string"==typeof e&&i.push(e)),C.Logger.error.apply(this,i)}function x(e,t,i){var r,n=e.router,o=(t.routeName.split(".").pop(),"application"===e.routeName?"":e.routeName+".");return r=o+i,w(n,r)?r:void 0}function w(e,t){var i=e.container;return e.hasRoute(t)&&(i.has("template:"+t)||i.has("route:"+t))}function T(e,t,i){var r=i.shift();if(!e){if(t)return;throw new S("Can't trigger action '"+r+"' because your app hasn't finished transitioning into its first route. To trigger an action on destination routes during a transition, you can call `.send()` on the `Transition` object passed to the `model/beforeModel/afterModel` hooks.")}for(var n=!1,o=e.length-1;o>=0;o--){var s=e[o],a=s.handler;if(a._actions&&a._actions[r]){if(a._actions[r].apply(a,i)!==!0)return;n=!0}}if(X[r])return void X[r].apply(null,i);if(!n&&!t)throw new S("Nothing handled the action '"+r+"'. If you did handle the action, this error can be caused by returning true from an action handler in a controller, causing the action to bubble.")}function E(e){var t=e.container.lookup("controller:application");if(t){var i=e.router.currentHandlerInfos,r=G._routePath(i);"currentPath"in t||A(t,"currentPath"),M(t,"currentPath",r),"currentRouteName"in t||A(t,"currentRouteName"),M(t,"currentRouteName",i[i.length-1].name)}}var C=e["default"],S=i["default"],F=r.get,M=n.set,A=(o.forEach,s.defineProperty),N=a.computed,R=l["default"],D=d["default"],I=h["default"],P=(u.fmt,c["default"]),k=f["default"],V=m["default"],O=p.View,L=_["default"],B=g._MetamorphView,U=t("router")["default"],z=(t("router/transition").Transition,[].slice),j=(I.forEach,B),G=P.extend(k,{location:"hash",rootURL:"/",init:function(){this.router=this.constructor.router||this.constructor.map(C.K),this._activeViews={},this._setupLocation(),this._qpCache={},this._queuedQPChanges={},F(this,"namespace.LOG_TRANSITIONS_INTERNAL")&&(this.router.log=C.Logger.debug)},url:N(function(){return F(this,"location").getURL()}),startRouting:function(){this.router=this.router||this.constructor.map(C.K);var e=this.router,t=F(this,"location"),i=this.container,r=this,n=F(this,"initialURL");F(t,"cancelRouterSetup")||(this._setupRouter(e,t),i.register("view:default",j),i.register("view:toplevel",O.extend()),t.onUpdateURL(function(e){r.handleURL(e)}),"undefined"==typeof n&&(n=t.getURL()),this.handleURL(n))},didTransition:function(e){E(this),this._cancelLoadingEvent(),this.notifyPropertyChange("url"),D.once(this,this.trigger,"didTransition"),F(this,"namespace").LOG_TRANSITIONS&&C.Logger.log("Transitioned into '"+G._routePath(e)+"'")},handleURL:function(e){return this._doTransition("handleURL",[e])},transitionTo:function(){return this._doTransition("transitionTo",arguments)},intermediateTransitionTo:function(){this.router.intermediateTransitionTo.apply(this.router,arguments),E(this);var e=this.router.currentHandlerInfos;F(this,"namespace").LOG_TRANSITIONS&&C.Logger.log("Intermediate-transitioned into '"+G._routePath(e)+"'")},replaceWith:function(){return this._doTransition("replaceWith",arguments)},generate:function(){var e=this.router.generate.apply(this.router,arguments);return this.location.formatURL(e)},isActive:function(){var e=this.router;return e.isActive.apply(e,arguments)},send:function(){this.router.trigger.apply(this.router,arguments)},hasRoute:function(e){return this.router.hasRoute(e)},reset:function(){this.router.reset()},_lookupActiveView:function(e){var t=this._activeViews[e];return t&&t[0]},_connectActiveView:function(e,t){function i(){delete this._activeViews[e]}var r=this._activeViews[e];r&&r[0].off("willDestroyElement",this,r[1]),this._activeViews[e]=[t,i],t.one("willDestroyElement",this,i)},_setupLocation:function(){var e=F(this,"location"),t=F(this,"rootURL");if(t&&!this.container.has("-location-setting:root-url")&&this.container.register("-location-setting:root-url",t,{instantiate:!1}),"string"==typeof e&&this.container){var i=this.container.lookup("location:"+e);if("undefined"!=typeof i)e=M(this,"location",i);else{var r={implementation:e};e=M(this,"location",L.create(r))}}t&&"string"==typeof t&&(e.rootURL=t),"function"==typeof e.initState&&e.initState()},_getHandlerFunction:function(){var e={},t=this.container,i=t.lookupFactory("route:basic"),r=this;return function(n){var o="route:"+n,s=t.lookup(o);return e[n]?s:(e[n]=!0,s||(t.register(o,i.extend()),s=t.lookup(o),F(r,"namespace.LOG_ACTIVE_GENERATION")&&C.Logger.info("generated -> "+o,{fullName:o})),s.routeName=n,s)}},_setupRouter:function(e,t){var i,r=this;e.getHandler=this._getHandlerFunction();var n=function(){t.setURL(i)};if(e.updateURL=function(e){i=e,D.once(n)},t.replaceURL){var o=function(){t.replaceURL(i)};e.replaceURL=function(e){i=e,D.once(o)}}e.didTransition=function(e){r.didTransition(e)}},_doTransition:function(e,t){t=z.call(t),t[0]=t[0]||"/";var i,r=t[0],n=!1;if(n||"/"===r.charAt(0)||C.assert("The route "+r+" was not found",this.router.hasRoute(r)),i){if(!r){var o=this.router.activeTransition?this.router.activeTransition.state.handlerInfos:this.router.state.handlerInfos;r=o[o.length-1].name,t.unshift(r)}var s=this._queryParamsFor(r),a=(s.qps,{});for(var l in i)if(i.hasOwnProperty(l)){var d=i[l],h=s.map[l];if(!h)throw new S("Unrecognized query param "+l+" provided as transition argument");a[h.urlKey]=h.route.serializeQueryParam(d,h.urlKey,h.type)}t[t.length-1].queryParams=a}var u=this.router[e].apply(this.router,t);return u.then(null,function(e){return e&&e.name?("UnrecognizedURLError"===e.name?C.assert("The URL '"+e.message+"' did not match any routes in your application"):"TransitionAborted"===e.name||b(e),e):void 0},"Ember: Process errors from Router"),u},_queryParamsFor:function(e){if(this._qpCache[e])return this._qpCache[e];for(var t={},i=[],r=(this._qpCache[e]={map:t,qps:i},this.router),n=r.recognizer.handlersFor(e),o=0,s=n.length;s>o;++o){var a=n[o],l=r.getHandler(a.handler),d=F(l,"_qp");d&&(R(t,d.map),i.push.apply(i,d.qps))}return{qps:i,map:t}},_scheduleLoadingEvent:function(e,t){this._cancelLoadingEvent(),this._loadingStateTimer=D.scheduleOnce("routerTransitions",this,"_fireLoadingEvent",e,t)},_fireLoadingEvent:function(e,t){this.router.activeTransition&&e.trigger(!0,"loading",e,t)},_cancelLoadingEvent:function(){this._loadingStateTimer&&D.cancel(this._loadingStateTimer),this._loadingStateTimer=null}}),X={willResolveModel:function(e,t){t.router._scheduleLoadingEvent(e,t)},error:function(e,t,i){var r=i.router,n=y(i,t,function(t,i){var n=x(t,i,"error");return n?void r.intermediateTransitionTo(n,e):!0});return n?w(i.router,"application_error")?void r.intermediateTransitionTo("application_error",e):void b(e,"Error while processing route: "+t.targetName):void 0},loading:function(e,t){var i=t.router,r=y(t,e,function(t,r){var n=x(t,r,"loading");return n?void i.intermediateTransitionTo(n):e.pivotHandler!==t?!0:void 0});return r&&w(t.router,"application_loading")?void i.intermediateTransitionTo("application_loading"):void 0}};G.reopenClass({router:null,map:function(e){var t=this.router;t||(t=new U,t.callbacks=[],t.triggerEvent=T,this.reopenClass({router:t}));var i=V.map(function(){this.resource("application",{path:"/"},function(){for(var i=0;i<t.callbacks.length;i++)t.callbacks[i].call(this);e.call(this)})});return t.callbacks.push(e),t.map(i.generate()),t},_routePath:function(e){function t(e,t){for(var i=0,r=e.length;r>i;++i)if(e[i]!==t[i])return!1;return!0}for(var i=[],r=1,n=e.length;n>r;r++){for(var o=e[r].name,s=o.split("."),a=z.call(i);a.length&&!t(a,s);)a.shift();i.push.apply(i,s.slice(a.length))}return i.join(".")}}),v["default"]=G}),e("route-recognizer",["exports"],function(e){"use strict";function t(e){return"[object Array]"===Object.prototype.toString.call(e)}function i(e){this.string=e}function r(e){this.name=e}function n(e){this.name=e}function o(){}function s(e,t,s){"/"===e.charAt(0)&&(e=e.substr(1));for(var a=e.split("/"),l=[],d=0,h=a.length;h>d;d++){var u,c=a[d];(u=c.match(/^:([^\/]+)$/))?(l.push(new r(u[1])),t.push(u[1]),s.dynamics++):(u=c.match(/^\*([^\/]+)$/))?(l.push(new n(u[1])),t.push(u[1]),s.stars++):""===c?l.push(new o):(l.push(new i(c)),s.statics++)}return l}function a(e){this.charSpec=e,this.nextStates=[]}function l(e){return e.sort(function(e,t){if(e.types.stars!==t.types.stars)return e.types.stars-t.types.stars;if(e.types.stars){if(e.types.statics!==t.types.statics)return t.types.statics-e.types.statics;if(e.types.dynamics!==t.types.dynamics)return t.types.dynamics-e.types.dynamics}return e.types.dynamics!==t.types.dynamics?e.types.dynamics-t.types.dynamics:e.types.statics!==t.types.statics?t.types.statics-e.types.statics:0})}function d(e,t){for(var i=[],r=0,n=e.length;n>r;r++){var o=e[r];i=i.concat(o.match(t))}return i}function h(e){this.queryParams=e||{}}function u(e,t,i){for(var r=e.handlers,n=e.regex,o=t.match(n),s=1,a=new h(i),l=0,d=r.length;d>l;l++){for(var u=r[l],c=u.names,f={},m=0,p=c.length;p>m;m++)f[c[m]]=o[s++];a.push({handler:u.handler,params:f,isDynamic:!!c.length})}return a}function c(e,t){return t.eachChar(function(t){e=e.put(t)}),e}function f(e,t,i){this.path=e,this.matcher=t,this.delegate=i}function m(e){this.routes={},this.children={},this.target=e}function p(e,t,i){return function(r,n){var o=e+r;return n?void n(p(o,t,i)):new f(e+r,t,i)}}function _(e,t,i){for(var r=0,n=0,o=e.length;o>n;n++)r+=e[n].path.length;t=t.substr(r);var s={path:t,handler:i};e.push(s)}function g(e,t,i,r){var n=t.routes;for(var o in n)if(n.hasOwnProperty(o)){var s=e.slice();_(s,o,n[o]),t.children[o]?g(s,t.children[o],i,r):i.call(r,s)}}var v=["/",".","*","+","?","|","(",")","[","]","{","}","\\"],y=new RegExp("(\\"+v.join("|\\")+")","g");i.prototype={eachChar:function(e){for(var t,i=this.string,r=0,n=i.length;n>r;r++)t=i.charAt(r),e({validChars:t})},regex:function(){return this.string.replace(y,"\\$1")},generate:function(){return this.string}},r.prototype={eachChar:function(e){e({invalidChars:"/",repeat:!0})},regex:function(){return"([^/]+)"},generate:function(e){return e[this.name]}},n.prototype={eachChar:function(e){e({invalidChars:"",repeat:!0})},regex:function(){return"(.+)"},generate:function(e){return e[this.name]}},o.prototype={eachChar:function(){},regex:function(){return""},generate:function(){return""}},a.prototype={get:function(e){for(var t=this.nextStates,i=0,r=t.length;r>i;i++){var n=t[i],o=n.charSpec.validChars===e.validChars;if(o=o&&n.charSpec.invalidChars===e.invalidChars)return n}},put:function(e){var t;return(t=this.get(e))?t:(t=new a(e),this.nextStates.push(t),e.repeat&&t.nextStates.push(t),t)},match:function(e){for(var t,i,r,n=this.nextStates,o=[],s=0,a=n.length;a>s;s++)t=n[s],i=t.charSpec,"undefined"!=typeof(r=i.validChars)?-1!==r.indexOf(e)&&o.push(t):"undefined"!=typeof(r=i.invalidChars)&&-1===r.indexOf(e)&&o.push(t);return o}};var b=Object.create||function(e){function t(){}return t.prototype=e,new t};h.prototype=b({splice:Array.prototype.splice,slice:Array.prototype.slice,push:Array.prototype.push,length:0,queryParams:null});var x=function(){this.rootState=new a,this.names={}};x.prototype={add:function(e,t){for(var i,r=this.rootState,n="^",a={statics:0,dynamics:0,stars:0},l=[],d=[],h=!0,u=0,f=e.length;f>u;u++){var m=e[u],p=[],_=s(m.path,p,a);d=d.concat(_);for(var g=0,v=_.length;v>g;g++){var y=_[g];y instanceof o||(h=!1,r=r.put({validChars:"/"}),n+="/",r=c(r,y),n+=y.regex())}var b={handler:m.handler,names:p};l.push(b)}h&&(r=r.put({validChars:"/"}),n+="/"),r.handlers=l,r.regex=new RegExp(n+"$"),r.types=a,(i=t&&t.as)&&(this.names[i]={segments:d,handlers:l})},handlersFor:function(e){var t=this.names[e],i=[];if(!t)throw new Error("There is no route named "+e);for(var r=0,n=t.handlers.length;n>r;r++)i.push(t.handlers[r]);return i},hasRoute:function(e){return!!this.names[e]},generate:function(e,t){var i=this.names[e],r="";if(!i)throw new Error("There is no route named "+e);for(var n=i.segments,s=0,a=n.length;a>s;s++){var l=n[s];l instanceof o||(r+="/",r+=l.generate(t))}return"/"!==r.charAt(0)&&(r="/"+r),t&&t.queryParams&&(r+=this.generateQueryString(t.queryParams,i.handlers)),r},generateQueryString:function(e){var i=[],r=[];for(var n in e)e.hasOwnProperty(n)&&r.push(n);r.sort();for(var o=0,s=r.length;s>o;o++){n=r[o];var a=e[n];if(null!=a){var l=n;if(t(a))for(var d=0,h=a.length;h>d;d++){var u=n+"[]="+encodeURIComponent(a[d]);i.push(u)}else l+="="+encodeURIComponent(a),i.push(l)}}return 0===i.length?"":"?"+i.join("&")},parseQueryString:function(e){for(var t=e.split("&"),i={},r=0;r<t.length;r++){var n,o=t[r].split("="),s=decodeURIComponent(o[0]),a=s.length,l=!1;1===o.length?n="true":(a>2&&"[]"===s.slice(a-2)&&(l=!0,s=s.slice(0,a-2),i[s]||(i[s]=[])),n=o[1]?decodeURIComponent(o[1]):""),l?i[s].push(n):i[s]=decodeURIComponent(n)}return i},recognize:function(e){var t,i,r,n,o=[this.rootState],s={},a=!1;if(e=decodeURI(e),n=e.indexOf("?"),-1!==n){var h=e.substr(n+1,e.length);e=e.substr(0,n),s=this.parseQueryString(h)}for("/"!==e.charAt(0)&&(e="/"+e),t=e.length,t>1&&"/"===e.charAt(t-1)&&(e=e.substr(0,t-1),a=!0),i=0,r=e.length;r>i&&(o=d(o,e.charAt(i)),o.length);i++);var c=[];for(i=0,r=o.length;r>i;i++)o[i].handlers&&c.push(o[i]);o=l(c);var f=c[0];return f&&f.handlers?(a&&"(.+)$"===f.regex.source.slice(-5)&&(e+="/"),u(f,e,s)):void 0}},e["default"]=x,f.prototype={to:function(e,t){var i=this.delegate;if(i&&i.willAddRoute&&(e=i.willAddRoute(this.matcher.target,e)),this.matcher.add(this.path,e),t){if(0===t.length)throw new Error("You must have an argument in the function passed to `to`");this.matcher.addChild(this.path,e,t,this.delegate)}return this}},m.prototype={add:function(e,t){this.routes[e]=t},addChild:function(e,t,i,r){var n=new m(t);this.children[e]=n;var o=p(e,n,r);r&&r.contextEntered&&r.contextEntered(t,o),i(o)}},x.prototype.map=function(e,t){var i=new m;e(p("",i,this.delegate)),g([],i,function(e){t?t(this,e):this.add(e)},this)}}),e("router/handler-info",["./utils","rsvp/promise","exports"],function(e,t,i){"use strict";function r(e){var t=e||{};s(this,t),this.initialize(t)}function n(e,t){if(!e^!t)return!1;if(!e)return!0;for(var i in e)if(e.hasOwnProperty(i)&&e[i]!==t[i])return!1;return!0}var o=e.bind,s=e.merge,a=(e.serialize,e.promiseLabel),l=t["default"];r.prototype={name:null,handler:null,params:null,context:null,factory:null,initialize:function(){},log:function(e,t){e.log&&e.log(this.name+": "+t)},promiseLabel:function(e){return a("'"+this.name+"' "+e)},getUnresolved:function(){return this},serialize:function(){return this.params||{}},resolve:function(e,t){var i=o(this,this.checkForAbort,e),r=o(this,this.runBeforeModelHook,t),n=o(this,this.getModel,t),s=o(this,this.runAfterModelHook,t),a=o(this,this.becomeResolved,t);return l.resolve(void 0,this.promiseLabel("Start handler")).then(i,null,this.promiseLabel("Check for abort")).then(r,null,this.promiseLabel("Before model")).then(i,null,this.promiseLabel("Check if aborted during 'beforeModel' hook")).then(n,null,this.promiseLabel("Model")).then(i,null,this.promiseLabel("Check if aborted in 'model' hook")).then(s,null,this.promiseLabel("After model")).then(i,null,this.promiseLabel("Check if aborted in 'afterModel' hook")).then(a,null,this.promiseLabel("Become resolved"))},runBeforeModelHook:function(e){return e.trigger&&e.trigger(!0,"willResolveModel",e,this.handler),this.runSharedModelHook(e,"beforeModel",[])},runAfterModelHook:function(e,t){var i=this.name;return this.stashResolvedModel(e,t),this.runSharedModelHook(e,"afterModel",[t]).then(function(){return e.resolvedModels[i]},null,this.promiseLabel("Ignore fulfillment value and return model value"))},runSharedModelHook:function(e,t,i){this.log(e,"calling "+t+" hook"),this.queryParams&&i.push(this.queryParams),i.push(e);var r=this.handler,n=r[t]&&r[t].apply(r,i);return n&&n.isTransition&&(n=null),l.resolve(n,null,this.promiseLabel("Resolve value returned from one of the model hooks"))},getModel:null,checkForAbort:function(e,t){return l.resolve(e(),this.promiseLabel("Check for abort")).then(function(){return t},null,this.promiseLabel("Ignore fulfillment value and continue"))},stashResolvedModel:function(e,t){e.resolvedModels=e.resolvedModels||{},e.resolvedModels[this.name]=t},becomeResolved:function(e,t){var i=this.serialize(t);return e&&(this.stashResolvedModel(e,t),e.params=e.params||{},e.params[this.name]=i),this.factory("resolved",{context:t,name:this.name,handler:this.handler,params:i})},shouldSupercede:function(e){if(!e)return!0;var t=e.context===this.context;return e.name!==this.name||this.hasOwnProperty("context")&&!t||this.hasOwnProperty("params")&&!n(this.params,e.params)}},i["default"]=r}),e("router/handler-info/factory",["router/handler-info/resolved-handler-info","router/handler-info/unresolved-handler-info-by-object","router/handler-info/unresolved-handler-info-by-param","exports"],function(e,t,i,r){"use strict";function n(e,t){var i=n.klasses[e],r=new i(t||{});return r.factory=n,r}var o=e["default"],s=t["default"],a=i["default"];n.klasses={resolved:o,param:a,object:s},r["default"]=n}),e("router/handler-info/resolved-handler-info",["../handler-info","router/utils","rsvp/promise","exports"],function(e,t,i,r){"use strict";var n=e["default"],o=t.subclass,s=(t.promiseLabel,i["default"]),a=o(n,{resolve:function(e,t){return t&&t.resolvedModels&&(t.resolvedModels[this.name]=this.context),s.resolve(this,this.promiseLabel("Resolve"))},getUnresolved:function(){return this.factory("param",{name:this.name,handler:this.handler,params:this.params})},isResolved:!0});r["default"]=a}),e("router/handler-info/unresolved-handler-info-by-object",["../handler-info","router/utils","rsvp/promise","exports"],function(e,t,i,r){"use strict";var n=e["default"],o=(t.merge,t.subclass),s=(t.promiseLabel,t.isParam),a=i["default"],l=o(n,{getModel:function(e){return this.log(e,this.name+": resolving provided model"),a.resolve(this.context)},initialize:function(e){this.names=e.names||[],this.context=e.context},serialize:function(e){var t=e||this.context,i=this.names,r=this.handler,n={};if(s(t))return n[i[0]]=t,n;if(r.serialize)return r.serialize(t,i);if(1===i.length){var o=i[0];return n[o]=/_id$/.test(o)?t.id:t,n}}});r["default"]=l}),e("router/handler-info/unresolved-handler-info-by-param",["../handler-info","router/utils","exports"],function(e,t,i){"use strict";var r=e["default"],n=t.merge,o=t.subclass,s=(t.promiseLabel,o(r,{initialize:function(e){this.params=e.params||{}},getModel:function(e){var t=this.params;e&&e.queryParams&&(t={},n(t,this.params),t.queryParams=e.queryParams);var i="function"==typeof this.handler.deserialize?"deserialize":"model";return this.runSharedModelHook(e,i,[t])}}));i["default"]=s}),e("router/router",["route-recognizer","rsvp/promise","./utils","./transition-state","./transition","./transition-intent/named-transition-intent","./transition-intent/url-transition-intent","exports"],function(e,t,i,r,n,o,s,a){"use strict";function l(){this.recognizer=new g,this.reset()}function d(e,t,i){var r=u(e.state,t);w(r.exited,function(e){var t=e.handler;delete t.context,t.exit&&t.exit()});var n=e.oldState=e.state;e.state=t;var o=e.currentHandlerInfos=r.unchanged.slice();try{w(r.updatedContext,function(e){return h(o,e,!1,i)}),w(r.entered,function(e){return h(o,e,!0,i)})}catch(s){throw e.state=n,e.currentHandlerInfos=n.handlerInfos,s}e.state.queryParams=_(e,o,t.queryParams,i)}function h(e,t,i,r){var n=t.handler,o=t.context;if(i&&n.enter&&n.enter(r),r&&r.isAborted)throw new N;if(n.context=o,n.contextDidChange&&n.contextDidChange(),n.setup&&n.setup(o,r),r&&r.isAborted)throw new N;return e.push(t),!0}function u(e,t){var i,r,n,o,s,a=e.handlerInfos,l=t.handlerInfos,d={updatedContext:[],exited:[],entered:[],unchanged:[]};for(o=0,s=l.length;s>o;o++){var h=a[o],u=l[o];h&&h.handler===u.handler||(i=!0),i?(d.entered.push(u),h&&d.exited.unshift(h)):r||h.context!==u.context||n?(r=!0,d.updatedContext.push(u)):d.unchanged.push(h)}for(o=l.length,s=a.length;s>o;o++)d.exited.unshift(a[o]);return d}function c(e,t){var i=e.urlMethod;if(i){for(var r=e.router,n=t.handlerInfos,o=n[n.length-1].name,s={},a=n.length-1;a>=0;--a){var l=n[a];T(s,l.params),l.handler.inaccessibleByURL&&(i=null)}if(i){s.queryParams=e._visibleQueryParams||t.queryParams;var d=r.recognizer.generate(o,s);"replace"===i?r.replaceURL(d):r.updateURL(d)}}}function f(e,t){try{b(e.router,e.sequence,"Resolved all models on destination route; finalizing transition.");{var i=e.router,r=t.handlerInfos;e.sequence}return d(i,t,e),e.isAborted?(i.state.handlerInfos=i.currentHandlerInfos,v.reject(M(e))):(c(e,t,e.intent.url),e.isActive=!1,i.activeTransition=null,y(i,i.currentHandlerInfos,!0,["didTransition"]),i.didTransition&&i.didTransition(i.currentHandlerInfos),b(i,e.sequence,"TRANSITION COMPLETE."),r[r.length-1].handler)}catch(n){if(!(n instanceof N)){var o=e.state.handlerInfos;e.trigger(!0,"error",n,e,o[o.length-1].handler),e.abort()}throw n}}function m(e,t,i){var r=t[0]||"/",n=t[t.length-1],o={};n&&n.hasOwnProperty("queryParams")&&(o=I.call(t).queryParams);var s;if(0===t.length){b(e,"Updating query params");var a=e.state.handlerInfos;s=new R({name:a[a.length-1].name,contexts:[],queryParams:o})}else"/"===r.charAt(0)?(b(e,"Attempting URL transition to "+r),s=new D({url:r})):(b(e,"Attempting transition to "+r),s=new R({name:t[0],contexts:x.call(t,1),queryParams:o}));return e.transitionByIntent(s,i)}function p(e,t){if(e.length!==t.length)return!1;for(var i=0,r=e.length;r>i;++i)if(e[i]!==t[i])return!1;return!0}function _(e,t,i,r){for(var n in i)i.hasOwnProperty(n)&&null===i[n]&&delete i[n];var o=[];y(e,t,!0,["finalizeQueryParamChange",i,o,r]),r&&(r._visibleQueryParams={});for(var s={},a=0,l=o.length;l>a;++a){var d=o[a];s[d.key]=d.value,r&&d.visible!==!1&&(r._visibleQueryParams[d.key]=d.value)}return s}var g=e["default"],v=t["default"],y=i.trigger,b=i.log,x=i.slice,w=i.forEach,T=i.merge,E=(i.serialize,i.extractQueryParams),C=i.getChangelist,S=i.promiseLabel,F=r["default"],M=n.logAbort,A=n.Transition,N=n.TransitionAborted,R=o["default"],D=s["default"],I=Array.prototype.pop;l.prototype={map:function(e){this.recognizer.delegate=this.delegate,this.recognizer.map(e,function(e,t){for(var i=t.length-1,r=!0;i>=0&&r;--i){var n=t[i];e.add(t,{as:n.handler}),r="/"===n.path||""===n.path||".index"===n.handler.slice(-6)}})},hasRoute:function(e){return this.recognizer.hasRoute(e)},transitionByIntent:function(e,t){var i,r=!!this.activeTransition,n=r?this.activeTransition.state:this.state,o=this;try{var s=e.applyToState(n,this.recognizer,this.getHandler,t);if(p(s.handlerInfos,n.handlerInfos)){var a=C(n.queryParams,s.queryParams);if(a){this._changedQueryParams=a.changed;for(var l in a.removed)a.removed.hasOwnProperty(l)&&(this._changedQueryParams[l]=null);return y(this,s.handlerInfos,!0,["queryParamsDidChange",a.changed,a.all,a.removed]),this._changedQueryParams=null,!r&&this.activeTransition?this.activeTransition:(i=new A(this),n.queryParams=_(this,s.handlerInfos,s.queryParams,i),i.promise=i.promise.then(function(e){return c(i,n,!0),o.didTransition&&o.didTransition(o.currentHandlerInfos),e},null,S("Transition complete")),i)}return new A(this)}return t?void d(this,s):(i=new A(this,e,s),this.activeTransition&&this.activeTransition.abort(),this.activeTransition=i,i.promise=i.promise.then(function(e){return f(i,e.state)},null,S("Settle transition promise when transition is finalized")),r||y(this,this.state.handlerInfos,!0,["willTransition",i]),i)}catch(h){return new A(this,e,null,h)}},reset:function(){this.state&&w(this.state.handlerInfos,function(e){var t=e.handler;t.exit&&t.exit()}),this.state=new F,this.currentHandlerInfos=null},activeTransition:null,handleURL:function(e){var t=x.call(arguments);return"/"!==e.charAt(0)&&(t[0]="/"+e),m(this,t).method(null)},updateURL:function(){throw new Error("updateURL is not implemented")},replaceURL:function(e){this.updateURL(e)},transitionTo:function(){return m(this,arguments)},intermediateTransitionTo:function(){m(this,arguments,!0)},refresh:function(e){for(var t=this.activeTransition?this.activeTransition.state:this.state,i=t.handlerInfos,r={},n=0,o=i.length;o>n;++n){var s=i[n];r[s.name]=s.params||{}}b(this,"Starting a refresh transition");var a=new R({name:i[i.length-1].name,pivotHandler:e||i[0].handler,contexts:[],queryParams:this._changedQueryParams||t.queryParams||{}});return this.transitionByIntent(a,!1)},replaceWith:function(){return m(this,arguments).method("replace")},generate:function(e){for(var t=E(x.call(arguments,1)),i=t[0],r=t[1],n=new R({name:e,contexts:i}),o=n.applyToState(this.state,this.recognizer,this.getHandler),s={},a=0,l=o.handlerInfos.length;l>a;++a){var d=o.handlerInfos[a],h=d.serialize();T(s,h)}return s.queryParams=r,this.recognizer.generate(e,s)},isActive:function(e){var t,i,r=E(x.call(arguments,1)),n=r[0],o=r[1],s=this.state.queryParams,a=this.state.handlerInfos;if(!a.length)return!1;var l=a[a.length-1].name,d=this.recognizer.handlersFor(l),h=0;for(i=d.length;i>h&&(t=a[h],t.name!==e);++h);if(h===d.length)return!1;var u=new F;u.handlerInfos=a.slice(0,h+1),d=d.slice(0,h+1);var c=new R({name:l,contexts:n}),f=c.applyToHandlers(u,d,this.getHandler,l,!0,!0),m={};T(m,o);for(var _ in s)s.hasOwnProperty(_)&&m.hasOwnProperty(_)&&(m[_]=s[_]);return p(f.handlerInfos,u.handlerInfos)&&!C(m,o)},trigger:function(){var e=x.call(arguments);y(this,this.currentHandlerInfos,!1,e)},log:null},a["default"]=l}),e("router/transition-intent",["./utils","exports"],function(e,t){"use strict";function i(e){this.initialize(e),this.data=this.data||{}}e.merge;i.prototype={initialize:null,applyToState:null},t["default"]=i}),e("router/transition-intent/named-transition-intent",["../transition-intent","../transition-state","../handler-info/factory","../utils","exports"],function(e,t,i,r,n){"use strict";var o=e["default"],s=t["default"],a=i["default"],l=r.isParam,d=r.extractQueryParams,h=r.merge,u=r.subclass;n["default"]=u(o,{name:null,pivotHandler:null,contexts:null,queryParams:null,initialize:function(e){this.name=e.name,this.pivotHandler=e.pivotHandler,this.contexts=e.contexts||[],this.queryParams=e.queryParams},applyToState:function(e,t,i,r){var n=d([this.name].concat(this.contexts)),o=n[0],s=(n[1],t.handlersFor(o[0])),a=s[s.length-1].handler;return this.applyToHandlers(e,s,i,a,r)},applyToHandlers:function(e,t,i,r,n,o){var a,l=new s,d=this.contexts.slice(0),u=t.length;if(this.pivotHandler)for(a=0;a<t.length;++a)if(i(t[a].handler)===this.pivotHandler){u=a;break}!this.pivotHandler;for(a=t.length-1;a>=0;--a){var c=t[a],f=c.handler,m=i(f),p=e.handlerInfos[a],_=null;if(_=c.names.length>0?a>=u?this.createParamHandlerInfo(f,m,c.names,d,p):this.getHandlerInfoForDynamicSegment(f,m,c.names,d,p,r,a):this.createParamHandlerInfo(f,m,c.names,d,p),o){_=_.becomeResolved(null,_.context);var g=p&&p.context;c.names.length>0&&_.context===g&&(_.params=p&&p.params),_.context=g}var v=p;(a>=u||_.shouldSupercede(p))&&(u=Math.min(a,u),v=_),n&&!o&&(v=v.becomeResolved(null,v.context)),l.handlerInfos.unshift(v)}if(d.length>0)throw new Error("More context objects were passed than there are dynamic segments for the route: "+r);return n||this.invalidateChildren(l.handlerInfos,u),h(l.queryParams,e.queryParams),h(l.queryParams,this.queryParams||{}),l},invalidateChildren:function(e,t){for(var i=t,r=e.length;r>i;++i){{e[i]
}e[i]=e[i].getUnresolved()}},getHandlerInfoForDynamicSegment:function(e,t,i,r,n,o,s){{var d;i.length}if(r.length>0){if(d=r[r.length-1],l(d))return this.createParamHandlerInfo(e,t,i,r,n);r.pop()}else{if(n&&n.name===e)return n;if(!this.preTransitionState)return n;var h=this.preTransitionState.handlerInfos[s];d=h&&h.context}return a("object",{name:e,handler:t,context:d,names:i})},createParamHandlerInfo:function(e,t,i,r,n){for(var o={},s=i.length;s--;){var d=n&&e===n.name&&n.params||{},h=r[r.length-1],u=i[s];if(l(h))o[u]=""+r.pop();else{if(!d.hasOwnProperty(u))throw new Error("You didn't provide enough string/numeric parameters to satisfy all of the dynamic segments for route "+e);o[u]=d[u]}}return a("param",{name:e,handler:t,params:o})}})}),e("router/transition-intent/url-transition-intent",["../transition-intent","../transition-state","../handler-info/factory","../utils","exports"],function(e,t,i,r,n){"use strict";function o(e){this.message=e||"UnrecognizedURLError",this.name="UnrecognizedURLError"}var s=e["default"],a=t["default"],l=i["default"],d=(r.oCreate,r.merge),h=r.subclass;n["default"]=h(s,{url:null,initialize:function(e){this.url=e.url},applyToState:function(e,t,i){var r,n,s=new a,h=t.recognize(this.url);if(!h)throw new o(this.url);var u=!1;for(r=0,n=h.length;n>r;++r){var c=h[r],f=c.handler,m=i(f);if(m.inaccessibleByURL)throw new o(this.url);var p=l("param",{name:f,handler:m,params:c.params}),_=e.handlerInfos[r];u||p.shouldSupercede(_)?(u=!0,s.handlerInfos[r]=p):s.handlerInfos[r]=_}return d(s.queryParams,h.queryParams),s}})}),e("router/transition-state",["./handler-info","./utils","rsvp/promise","exports"],function(e,t,i,r){"use strict";function n(){this.handlerInfos=[],this.queryParams={},this.params={}}var o=(e.ResolvedHandlerInfo,t.forEach),s=t.promiseLabel,a=i["default"];n.prototype={handlerInfos:null,queryParams:null,params:null,promiseLabel:function(e){var t="";return o(this.handlerInfos,function(e){""!==t&&(t+="."),t+=e.name}),s("'"+t+"': "+e)},resolve:function(e,t){function i(){return a.resolve(e(),s("Check if should continue"))["catch"](function(e){return u=!0,a.reject(e)},s("Handle abort"))}function r(e){var i=h.handlerInfos,r=t.resolveIndex>=i.length?i.length-1:t.resolveIndex;return a.reject({error:e,handlerWithError:h.handlerInfos[r].handler,wasAborted:u,state:h})}function n(e){var r=h.handlerInfos[t.resolveIndex].isResolved;if(h.handlerInfos[t.resolveIndex++]=e,!r){var n=e.handler;n&&n.redirect&&n.redirect(e.context,t)}return i().then(l,null,s("Resolve handler"))}function l(){if(t.resolveIndex===h.handlerInfos.length)return{error:null,state:h};var e=h.handlerInfos[t.resolveIndex];return e.resolve(i,t).then(n,null,s("Proceed"))}var d=this.params;o(this.handlerInfos,function(e){d[e.name]=e.params||{}}),t=t||{},t.resolveIndex=0;var h=this,u=!1;return a.resolve(null,this.promiseLabel("Start transition")).then(l,null,this.promiseLabel("Resolve handler"))["catch"](r,this.promiseLabel("Handle error"))}},r["default"]=n}),e("router/transition",["rsvp/promise","./handler-info","./utils","exports"],function(e,t,i,r){"use strict";function n(e,t,i,r){function s(){return l.isAborted?a.reject(void 0,u("Transition aborted - reject")):void 0}var l=this;if(this.state=i||e.state,this.intent=t,this.router=e,this.data=this.intent&&this.intent.data||{},this.resolvedModels={},this.queryParams={},r)return void(this.promise=a.reject(r));if(i){this.params=i.params,this.queryParams=i.queryParams;var d=i.handlerInfos.length;d&&(this.targetName=i.handlerInfos[i.handlerInfos.length-1].name);for(var h=0;d>h;++h){var c=i.handlerInfos[h];if(!c.isResolved)break;this.pivotHandler=c.handler}this.sequence=n.currentSequence++,this.promise=i.resolve(s,this)["catch"](function(e){return e.wasAborted||l.isAborted?a.reject(o(l)):(l.trigger("error",e.error,l,e.handlerWithError),l.abort(),a.reject(e.error))},u("Handle Abort"))}else this.promise=a.resolve(this.state),this.params={}}function o(e){return h(e.router,e.sequence,"detected abort."),new s}function s(e){this.message=e||"TransitionAborted",this.name="TransitionAborted"}var a=e["default"],l=(t.ResolvedHandlerInfo,i.trigger),d=i.slice,h=i.log,u=i.promiseLabel;n.currentSequence=0,n.prototype={targetName:null,urlMethod:"update",intent:null,params:null,pivotHandler:null,resolveIndex:0,handlerInfos:null,resolvedModels:null,isActive:!0,state:null,isTransition:!0,promise:null,data:null,then:function(e,t){return this.promise.then(e,t)},abort:function(){return this.isAborted?this:(h(this.router,this.sequence,this.targetName+": transition was aborted"),this.intent.preTransitionState=this.router.state,this.isAborted=!0,this.isActive=!1,this.router.activeTransition=null,this)},retry:function(){return this.abort(),this.router.transitionByIntent(this.intent,!1)},method:function(e){return this.urlMethod=e,this},trigger:function(e){var t=d.call(arguments);"boolean"==typeof e?t.shift():e=!1,l(this.router,this.state.handlerInfos.slice(0,this.resolveIndex+1),e,t)},followRedirects:function(){var e=this.router;return this.promise["catch"](function(t){return e.activeTransition?e.activeTransition.followRedirects():a.reject(t)})},toString:function(){return"Transition (sequence "+this.sequence+")"},log:function(e){h(this.router,this.sequence,e)}},n.prototype.send=n.prototype.trigger,r.Transition=n,r.logAbort=o,r.TransitionAborted=s}),e("router/utils",["exports"],function(e){"use strict";function t(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])}function i(e){var t,i,r=e&&e.length;return r&&r>0&&e[r-1]&&e[r-1].hasOwnProperty("queryParams")?(i=e[r-1].queryParams,t=f.call(e,0,r-1),[t,i]):[e,null]}function r(e){for(var t in e)if("number"==typeof e[t])e[t]=""+e[t];else if(m(e[t]))for(var i=0,r=e[t].length;r>i;i++)e[t][i]=""+e[t][i]}function n(e,t,i){e.log&&(3===arguments.length?e.log("Transition #"+t+": "+i):(i=t,e.log(i)))}function o(e,t){var i=arguments;return function(r){var n=f.call(i,2);return n.push(r),t.apply(e,n)}}function s(e){return"string"==typeof e||e instanceof String||"number"==typeof e||e instanceof Number}function a(e,t){for(var i=0,r=e.length;r>i&&!1!==t(e[i]);i++);}function l(e,t,i,r){if(e.triggerEvent)return void e.triggerEvent(t,i,r);var n=r.shift();if(!t){if(i)return;throw new Error("Could not trigger event '"+n+"'. There are no active handlers")}for(var o=!1,s=t.length-1;s>=0;s--){var a=t[s],l=a.handler;if(l.events&&l.events[n]){if(l.events[n].apply(l,r)!==!0)return;o=!0}}if(!o&&!i)throw new Error("Nothing handled the event '"+n+"'.")}function d(e,i){var n,o={all:{},changed:{},removed:{}};t(o.all,i);var s=!1;r(e),r(i);for(n in e)e.hasOwnProperty(n)&&(i.hasOwnProperty(n)||(s=!0,o.removed[n]=e[n]));for(n in i)if(i.hasOwnProperty(n))if(m(e[n])&&m(i[n]))if(e[n].length!==i[n].length)o.changed[n]=i[n],s=!0;else for(var a=0,l=e[n].length;l>a;a++)e[n][a]!==i[n][a]&&(o.changed[n]=i[n],s=!0);else e[n]!==i[n]&&(o.changed[n]=i[n],s=!0);return s&&o}function h(e){return"Router: "+e}function u(e,i){function r(t){e.call(this,t||{})}return r.prototype=p(e.prototype),t(r.prototype,i),r}var c,f=Array.prototype.slice;c=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)};var m=c;e.isArray=m;var p=Object.create||function(e){function t(){}return t.prototype=e,new t};e.oCreate=p,e.extractQueryParams=i,e.log=n,e.bind=o,e.forEach=a,e.trigger=l,e.getChangelist=d,e.promiseLabel=h,e.subclass=u,e.merge=t,e.slice=f,e.isParam=s,e.coerceQueryParamsToString=r}),e("router",["./router/router","exports"],function(e,t){"use strict";var i=e["default"];t["default"]=i})}(),function(){e("ember-application/ext/controller",["ember-metal/core","ember-metal/property_get","ember-metal/property_set","ember-metal/error","ember-metal/utils","ember-metal/computed","ember-runtime/controllers/controller","ember-routing/system/controller_for","exports"],function(e,t,i,r,n,o,s,a,l){"use strict";function d(e,t,i){var r,n,o,s=[];for(n=0,o=i.length;o>n;n++)r=i[n],h.assert(f(e)+"#needs must not specify dependencies with periods in their names ("+r+")",-1===r.indexOf(".")),-1===r.indexOf(":")&&(r="controller:"+r),t.has(r)||s.push(r);if(s.length)throw new c(f(e)+" needs [ "+s.join(", ")+" ] but "+(s.length>1?"they":"it")+" could not be found")}var h=e["default"],u=t.get,c=(i.set,r["default"]),f=n.inspect,m=o.computed,p=s.ControllerMixin,_=n.meta,g=a.controllerFor,_=n.meta,v=m(function(){var e=this;return{needs:u(e,"needs"),container:u(e,"container"),unknownProperty:function(t){var i,r,n,o=this.needs;for(r=0,n=o.length;n>r;r++)if(i=o[r],i===t)return this.container.lookup("controller:"+t);var s=f(e)+"#needs does not include `"+t+"`. To access the "+t+" controller from "+f(e)+", "+f(e)+" should have a `needs` property that is an array of the controllers it has access to.";throw new ReferenceError(s)},setUnknownProperty:function(t){throw new Error("You cannot overwrite the value of `controllers."+t+"` of "+f(e))}}});p.reopen({concatenatedProperties:["needs"],needs:[],init:function(){var e=u(this,"needs"),t=u(e,"length");t>0&&(h.assert(" `"+f(this)+" specifies `needs`, but does not have a container. Please ensure this controller was instantiated with a container.",this.container||_(this,!1).descs.controllers!==v),this.container&&d(this,this.container,e),u(this,"controllers")),this._super.apply(this,arguments)},controllerFor:function(e){return h.deprecate("Controller#controllerFor is deprecated, please use Controller#needs instead"),g(u(this,"container"),e)},controllers:v}),l["default"]=p}),e("ember-application",["ember-metal/core","ember-runtime/system/lazy_load","ember-application/system/dag","ember-application/system/resolver","ember-application/system/application","ember-application/ext/controller"],function(e,t,i,r,n){"use strict";var o=e["default"],s=t.runLoadHooks,a=i["default"],l=r.Resolver,d=r.DefaultResolver,h=n["default"];o.Application=h,o.DAG=a,o.Resolver=l,o.DefaultResolver=d,s("Ember.Application",h)}),e("ember-application/system/application",["ember-metal","ember-metal/property_get","ember-metal/property_set","ember-runtime/system/lazy_load","ember-application/system/dag","ember-runtime/system/namespace","ember-runtime/mixins/deferred","ember-application/system/resolver","ember-metal/platform","ember-metal/run_loop","ember-metal/utils","container/container","ember-runtime/controllers/controller","ember-metal/enumerable_utils","ember-runtime/controllers/object_controller","ember-runtime/controllers/array_controller","ember-views/system/event_dispatcher","ember-extension-support/container_debug_adapter","ember-views/system/jquery","ember-routing/system/route","ember-routing/system/router","ember-routing/location/hash_location","ember-routing/location/history_location","ember-routing/location/auto_location","ember-routing/location/none_location","ember-handlebars-compiler","exports"],function(e,i,r,n,o,s,a,l,d,h,u,c,f,m,p,_,g,v,y,b,x,w,T,E,C,S,F){"use strict";function M(e){this._container=e}function A(e){function t(e){return r.resolve(e)}e.get("resolver")&&N.deprecate("Application.resolver is deprecated in favor of Application.Resolver",!1);var i=e.get("resolver")||e.get("Resolver")||O,r=i.create({namespace:e});return t.describe=function(e){return r.lookupDescription(e)},t.makeToString=function(e,t){return r.makeToString(e,t)},t.normalize=function(e){return r.normalize?r.normalize(e):(N.deprecate("The Resolver should now provide a 'normalize' function",!1),e)},t.__resolver__=r,t}var N=e["default"],R=i.get,D=r.set,I=n.runLoadHooks,P=o["default"],k=s["default"],V=a["default"],O=l.DefaultResolver,L=d.create,B=h["default"],U=u.canInvoke,z=c["default"],j=f.Controller,G=m["default"],X=p["default"],H=_["default"],Y=g["default"],W=v["default"],q=y["default"],K=b["default"],$=x["default"],Q=w["default"],Z=T["default"],J=E["default"],et=C["default"],tt=S["default"],it=N.K;M.deprecate=function(e){return function(){var t=this._container;return N.deprecate("Using the defaultContainer is no longer supported. [defaultContainer#"+e+"] see: http://git.io/EKPpnA",!1),t[e].apply(t,arguments)}},M.prototype={_container:null,lookup:M.deprecate("lookup"),resolve:M.deprecate("resolve"),register:M.deprecate("register")};var rt=k.extend(V,{rootElement:"body",eventDispatcher:null,customEvents:null,_readinessDeferrals:1,init:function(){if(this.$||(this.$=q),this.__container__=this.buildContainer(),this.Router=this.defaultRouter(),this._super(),this.scheduleInitialize(),N.libraries.registerCoreLibrary("Handlebars",tt.VERSION),N.libraries.registerCoreLibrary("jQuery",q().jquery),N.LOG_VERSION){N.LOG_VERSION=!1;var e=G.map(N.libraries,function(e){return R(e,"name.length")}),t=Math.max.apply(this,e);N.debug("-------------------------------"),N.libraries.each(function(e,i){var r=new Array(t-e.length+1).join(" ");N.debug([e,r," : ",i].join(""))}),N.debug("-------------------------------")}},buildContainer:function(){var e=this.__container__=rt.buildContainer(this);return e},defaultRouter:function(){if(this.Router!==!1){var e=this.__container__;return this.Router&&(e.unregister("router:main"),e.register("router:main",this.Router)),e.lookupFactory("router:main")}},scheduleInitialize:function(){var e=this;!this.$||this.$.isReady?B.schedule("actions",e,"_initialize"):this.$().ready(function(){B(e,"_initialize")})},deferReadiness:function(){N.assert("You must call deferReadiness on an instance of Ember.Application",this instanceof rt),N.assert("You cannot defer readiness since the `ready()` hook has already been called.",this._readinessDeferrals>0),this._readinessDeferrals++},advanceReadiness:function(){N.assert("You must call advanceReadiness on an instance of Ember.Application",this instanceof rt),this._readinessDeferrals--,0===this._readinessDeferrals&&B.once(this,this.didBecomeReady)},register:function(){var e=this.__container__;e.register.apply(e,arguments)},inject:function(){var e=this.__container__;e.injection.apply(e,arguments)},initialize:function(){N.deprecate("Calling initialize manually is not supported. Please see Ember.Application#advanceReadiness and Ember.Application#deferReadiness")},_initialize:function(){if(!this.isDestroyed){if(this.Router){var e=this.__container__;e.unregister("router:main"),e.register("router:main",this.Router)}return this.runInitializers(),I("application",this),this.advanceReadiness(),this}},reset:function(){function e(){var e=this.__container__.lookup("router:main");e.reset(),B(this.__container__,"destroy"),this.buildContainer(),B.schedule("actions",this,function(){this._initialize()})}this._readinessDeferrals=1,B.join(this,e)},runInitializers:function(){var e,t,i=R(this.constructor,"initializers"),r=this.__container__,n=new P,o=this;for(e in i)t=i[e],n.addEdges(t.name,t.initialize,t.before,t.after);n.topsort(function(e){var t=e.value;N.assert("No application initializer named '"+e.name+"'",t),t(r,o)})},didBecomeReady:function(){this.setupEventDispatcher(),this.ready(),this.startRouting(),N.testing||(N.Namespace.processAll(),N.BOOTED=!0),this.resolve(this)},setupEventDispatcher:function(){var e=R(this,"customEvents"),t=R(this,"rootElement"),i=this.__container__.lookup("event_dispatcher:main");D(this,"eventDispatcher",i),i.setup(e,t)},startRouting:function(){var e=this.__container__.lookup("router:main");e&&e.startRouting()},handleURL:function(e){var t=this.__container__.lookup("router:main");t.handleURL(e)},ready:it,resolver:null,Resolver:null,willDestroy:function(){N.BOOTED=!1,this.__container__.lookup("router:main").reset(),this.__container__.destroy()},initializer:function(e){this.constructor.initializer(e)}});rt.reopenClass({initializers:{},initializer:function(e){void 0!==this.superclass.initializers&&this.superclass.initializers===this.initializers&&this.reopenClass({initializers:L(this.initializers)}),N.assert("The initializer '"+e.name+"' has already been registered",!this.initializers[e.name]),N.assert("An initializer cannot be registered without an initialize function",U(e,"initialize")),this.initializers[e.name]=e},buildContainer:function(e){var i=new z;return z.defaultContainer=new M(i),i.set=D,i.resolver=A(e),i.normalize=i.resolver.normalize,i.describe=i.resolver.describe,i.makeToString=i.resolver.makeToString,i.optionsForType("component",{singleton:!1}),i.optionsForType("view",{singleton:!1}),i.optionsForType("template",{instantiate:!1}),i.optionsForType("helper",{instantiate:!1}),i.register("application:main",e,{instantiate:!1}),i.register("controller:basic",j,{instantiate:!1}),i.register("controller:object",X,{instantiate:!1}),i.register("controller:array",H,{instantiate:!1}),i.register("route:basic",K,{instantiate:!1}),i.register("event_dispatcher:main",Y),i.register("router:main",$),i.injection("router:main","namespace","application:main"),i.register("location:auto",J),i.register("location:hash",Q),i.register("location:history",Z),i.register("location:none",et),i.injection("controller","target","router:main"),i.injection("controller","namespace","application:main"),i.injection("route","router","router:main"),i.injection("location","rootURL","-location-setting:root-url"),i.register("resolver-for-debugging:main",i.resolver.__resolver__,{instantiate:!1}),i.injection("container-debug-adapter:main","resolver","resolver-for-debugging:main"),i.injection("data-adapter:main","containerDebugAdapter","container-debug-adapter:main"),t("ember-extension-support"),i.register("container-debug-adapter:main",W),i}}),F["default"]=rt}),e("ember-application/system/dag",["exports"],function(e){"use strict";function t(e,i,r,n){var o,s=e.name,a=e.incoming,l=e.incomingNames,d=l.length;if(r||(r={}),n||(n=[]),!r.hasOwnProperty(s)){for(n.push(s),r[s]=!0,o=0;d>o;o++)t(a[l[o]],i,r,n);i(e,n),n.pop()}}function i(){this.names=[],this.vertices={}}i.prototype.add=function(e){if(e){if(this.vertices.hasOwnProperty(e))return this.vertices[e];var t={name:e,incoming:{},incomingNames:[],hasOutgoing:!1,value:null};return this.vertices[e]=t,this.names.push(e),t}},i.prototype.map=function(e,t){this.add(e).value=t},i.prototype.addEdge=function(e,i){function r(e,t){if(e.name===i)throw new EmberError("cycle detected: "+i+" <- "+t.join(" <- "))}if(e&&i&&e!==i){var n=this.add(e),o=this.add(i);o.incoming.hasOwnProperty(e)||(t(n,r),n.hasOutgoing=!0,o.incoming[e]=n,o.incomingNames.push(e))}},i.prototype.topsort=function(e){var i,r,n={},o=this.vertices,s=this.names,a=s.length;for(i=0;a>i;i++)r=o[s[i]],r.hasOutgoing||t(r,e,n)},i.prototype.addEdges=function(e,t,i,r){var n;if(this.map(e,t),i)if("string"==typeof i)this.addEdge(e,i);else for(n=0;n<i.length;n++)this.addEdge(e,i[n]);if(r)if("string"==typeof r)this.addEdge(r,e);else for(n=0;n<r.length;n++)this.addEdge(r[n],e)},e["default"]=i}),e("ember-application/system/resolver",["ember-metal/core","ember-metal/property_get","ember-metal/logger","ember-runtime/system/string","ember-runtime/system/object","ember-runtime/system/namespace","ember-handlebars","exports"],function(e,t,i,r,n,o,s,a){"use strict";var l=e["default"],d=t.get,h=i["default"],u=r.classify,c=r.capitalize,f=r.decamelize,m=n["default"],p=o["default"],_=s["default"],g=m.extend({namespace:null,normalize:function(){throw new Error("Invalid call to `resolver.normalize(fullName)`. Please override the 'normalize' method in subclass of `Ember.Resolver` to prevent falling through to this error.")},resolve:function(){throw new Error("Invalid call to `resolver.resolve(parsedName)`. Please override the 'resolve' method in subclass of `Ember.Resolver` to prevent falling through to this error.")},parseName:function(){throw new Error("Invalid call to `resolver.resolveByType(parsedName)`. Please override the 'resolveByType' method in subclass of `Ember.Resolver` to prevent falling through to this error.")},lookupDescription:function(){throw new Error("Invalid call to `resolver.lookupDescription(fullName)`. Please override the 'lookupDescription' method in subclass of `Ember.Resolver` to prevent falling through to this error.")},makeToString:function(){throw new Error("Invalid call to `resolver.makeToString(factory, fullName)`. Please override the 'makeToString' method in subclass of `Ember.Resolver` to prevent falling through to this error.")},resolveOther:function(){throw new Error("Invalid call to `resolver.resolveOther(parsedName)`. Please override the 'resolveOther' method in subclass of `Ember.Resolver` to prevent falling through to this error.")},_logLookup:function(){throw new Error("Invalid call to `resolver._logLookup(found, parsedName)`. Please override the '_logLookup' method in subclass of `Ember.Resolver` to prevent falling through to this error.")}}),v=m.extend({namespace:null,normalize:function(e){var t=e.split(":",2),i=t[0],r=t[1];if(l.assert("Tried to normalize a container name without a colon (:) in it. You probably tried to lookup a name that did not contain a type, a colon, and a name. A proper lookup name would be `view:post`.",2===t.length),"template"!==i){var n=r;return n.indexOf(".")>-1&&(n=n.replace(/\.(.)/g,function(e){return e.charAt(1).toUpperCase()})),r.indexOf("_")>-1&&(n=n.replace(/_(.)/g,function(e){return e.charAt(1).toUpperCase()})),i+":"+n}return e},resolve:function(e){var t,i=this.parseName(e),r=i.resolveMethodName;if(!i.name||!i.type)throw new TypeError("Invalid fullName: `"+e+"`, must be of the form `type:name` ");return this[r]&&(t=this[r](i)),t||(t=this.resolveOther(i)),i.root&&i.root.LOG_RESOLVER&&this._logLookup(t,i),t},parseName:function(e){var t=e.split(":"),i=t[0],r=t[1],n=r,o=d(this,"namespace"),s=o;if("template"!==i&&-1!==n.indexOf("/")){var a=n.split("/");n=a[a.length-1];var h=c(a.slice(0,-1).join("."));s=p.byName(h),l.assert("You are looking for a "+n+" "+i+" in the "+h+" namespace, but the namespace could not be found",s)}return{fullName:e,type:i,fullNameWithoutType:r,name:n,root:s,resolveMethodName:"resolve"+u(i)}},lookupDescription:function(e){var t=this.parseName(e);if("template"===t.type)return"template at "+t.fullNameWithoutType.replace(/\./g,"/");var i=t.root+"."+u(t.name);return"model"!==t.type&&(i+=u(t.type)),i},makeToString:function(e){return e.toString()},useRouterNaming:function(e){e.name=e.name.replace(/\./g,"_"),"basic"===e.name&&(e.name="")},resolveTemplate:function(e){var t=e.fullNameWithoutType.replace(/\./g,"/");return l.TEMPLATES[t]?l.TEMPLATES[t]:(t=f(t),l.TEMPLATES[t]?l.TEMPLATES[t]:void 0)},resolveView:function(e){return this.useRouterNaming(e),this.resolveOther(e)},resolveController:function(e){return this.useRouterNaming(e),this.resolveOther(e)},resolveRoute:function(e){return this.useRouterNaming(e),this.resolveOther(e)},resolveModel:function(e){var t=u(e.name),i=d(e.root,t);return i?i:void 0},resolveHelper:function(e){return this.resolveOther(e)||_.helpers[e.fullNameWithoutType]},resolveOther:function(e){var t=u(e.name)+u(e.type),i=d(e.root,t);return i?i:void 0},_logLookup:function(e,t){var i,r;i=e?"[✓]":"[ ]",r=t.fullName.length>60?".":new Array(60-t.fullName.length).join("."),h.info(i,t.fullName,r,this.lookupDescription(t.fullName))}});a.Resolver=g,a.DefaultResolver=v})}(),function(){e("ember-extension-support/container_debug_adapter",["ember-metal/core","ember-metal/utils","ember-runtime/system/string","ember-runtime/system/namespace","ember-runtime/system/object","exports"],function(e,t,i,r,n,o){"use strict";var s=e["default"],a=t.typeOf,l=i.dasherize,d=i.classify,h=r["default"],u=n["default"],c=u.extend({container:null,resolver:null,canCatalogEntriesByType:function(e){return"model"===e||"template"===e?!1:!0},catalogEntriesByType:function(e){var t=s.A(h.NAMESPACES),i=s.A(),r=new RegExp(d(e)+"$");return t.forEach(function(e){if(e!==s)for(var t in e)if(e.hasOwnProperty(t)&&r.test(t)){var n=e[t];"class"===a(n)&&i.push(l(t.replace(r,"")))}}),i}});o["default"]=c}),e("ember-extension-support/data_adapter",["ember-metal/core","ember-metal/property_get","ember-metal/run_loop","ember-runtime/system/string","ember-runtime/system/namespace","ember-runtime/system/object","ember-runtime/system/native_array","ember-application/system/application","exports"],function(e,t,i,r,n,o,s,a,l){"use strict";var d=e["default"],h=t.get,u=i["default"],c=r.dasherize,f=n["default"],m=o["default"],p=s.A,_=a["default"],g=m.extend({init:function(){this._super(),this.releaseMethods=p()},container:null,containerDebugAdapter:void 0,attributeLimit:3,releaseMethods:p(),getFilters:function(){return p()},watchModelTypes:function(e,t){var i,r=this.getModelTypes(),n=this,o=p();i=r.map(function(e){var i=e.klass,r=n.wrapModelType(i,e.name);return o.push(n.observeModelType(i,t)),r}),e(i);var s=function(){o.forEach(function(e){e()}),n.releaseMethods.removeObject(s)};return this.releaseMethods.pushObject(s),s},_nameToClass:function(e){return"string"==typeof e&&(e=this.container.lookupFactory("model:"+e)),e},watchRecords:function(e,t,i,r){var n,o=this,s=p(),a=this.getRecords(e),l=function(e){i([e])},h=a.map(function(e){return s.push(o.observeRecord(e,l)),o.wrapRecord(e)}),u=function(e,i,n,a){for(var d=i;i+a>d;d++){var h=e.objectAt(d),u=o.wrapRecord(h);s.push(o.observeRecord(h,l)),t([u])}n&&r(i,n)},c={didChange:u,willChange:d.K};return a.addArrayObserver(o,c),n=function(){s.forEach(function(e){e()}),a.removeArrayObserver(o,c),o.releaseMethods.removeObject(n)},t(h),this.releaseMethods.pushObject(n),n},willDestroy:function(){this._super(),this.releaseMethods.forEach(function(e){e()})},detect:function(){return!1},columnsForType:function(){return p()},observeModelType:function(e,t){var i=this,r=this.getRecords(e),n=function(){t([i.wrapModelType(e)])},o={didChange:function(){u.scheduleOnce("actions",this,n)},willChange:d.K};r.addArrayObserver(this,o);var s=function(){r.removeArrayObserver(i,o)};return s},wrapModelType:function(e,t){var i,r=this.getRecords(e);return i={name:t||e.toString(),count:h(r,"length"),columns:this.columnsForType(e),object:e}},getModelTypes:function(){var e,t=this,i=this.get("containerDebugAdapter");return e=i.canCatalogEntriesByType("model")?i.catalogEntriesByType("model"):this._getObjectsOnNamespaces(),e=p(e).map(function(e){return{klass:t._nameToClass(e),name:e}}),e=p(e).filter(function(e){return t.detect(e.klass)}),p(e)},_getObjectsOnNamespaces:function(){var e=p(f.NAMESPACES),t=p(),i=this;return e.forEach(function(e){for(var r in e)if(e.hasOwnProperty(r)&&i.detect(e[r])){var n=c(r);e instanceof _||!e.toString()||(n=e+"/"+n),t.push(n)}}),t},getRecords:function(){return p()},wrapRecord:function(e){var t={object:e};return t.columnValues=this.getRecordColumnValues(e),t.searchKeywords=this.getRecordKeywords(e),t.filterValues=this.getRecordFilterValues(e),t.color=this.getRecordColor(e),t},getRecordColumnValues:function(){return{}},getRecordKeywords:function(){return p()},getRecordFilterValues:function(){return{}},getRecordColor:function(){return null},observeRecord:function(){return function(){}}});l["default"]=g}),e("ember-extension-support/initializers",[],function(){"use strict"}),e("ember-extension-support",["ember-metal/core","ember-extension-support/data_adapter","ember-extension-support/container_debug_adapter"],function(e,t,i){"use strict";var r=e["default"],n=t["default"],o=i["default"];r.DataAdapter=n,r.ContainerDebugAdapter=o})}(),function(){e("ember-testing/adapters/adapter",["ember-metal/core","ember-metal/utils","ember-runtime/system/object","exports"],function(e,t,i,r){"use strict";var n=e["default"],o=(t.inspect,i["default"]),s=o.extend({asyncStart:n.K,asyncEnd:n.K,exception:function(e){throw e}});r["default"]=s}),e("ember-testing/adapters/qunit",["ember-testing/adapters/adapter","ember-metal/utils","exports"],function(e,t,i){"use strict";var r=e["default"],n=t.inspect,o=r.extend({asyncStart:function(){QUnit.stop()},asyncEnd:function(){QUnit.start()},exception:function(e){ok(!1,n(e))}});i["default"]=o}),e("ember-testing/helpers",["ember-metal/property_get","ember-metal/error","ember-metal/run_loop","ember-views/system/jquery","ember-testing/test"],function(e,t,i,r,n){"use strict";function o(e){var t=e.__container__.lookup("controller:application");return g(t,"currentRouteName")}function s(e){var t=e.__container__.lookup("controller:application");return g(t,"currentPath")}function a(e){var t=e.__container__.lookup("router:main");return g(t,"location").getURL()}function l(e,t){var i=e.__container__.lookup("router:main");return i.location.setURL(t),e._readinessDeferrals>0?(i.initialURL=t,y(e,"advanceReadiness"),delete i.initialURL):y(e,e.handleURL,t),_(e)}function d(e,t,i){var r=f(e,t,i);if(y(r,"mousedown"),r.is(":input")){var n=r.prop("type");"checkbox"!==n&&"radio"!==n&&"hidden"!==n&&y(r,function(){!document.hasFocus||document.hasFocus()?this.focus():this.trigger("focusin")})}return y(r,"mouseup"),y(r,"click"),_(e)}function h(e,t,i,r,n){3===arguments.length&&(r=i,i=null),"undefined"==typeof n&&(n={});var o=f(e,t,i),s=b.Event(r,n);return y(o,"trigger",s),_(e)}function u(e,t,i,r,n){return"undefined"==typeof n&&(n=r,r=i,i=null),h(e,t,i,r,{keyCode:n,which:n})}function c(e,t,i,r){var n;return"undefined"==typeof r&&(r=i,i=null),n=f(e,t,i),y(function(){n.val(r).change()}),_(e)}function f(e,t,i){var r=m(e,t,i);if(0===r.length)throw new v("Element "+t+" not found.");return r}function m(e,t,i){var r;return i=i||g(e,"rootElement"),r=e.$(t,i)}function p(e,t){return _(e,t(e))}function _(e,t){return x.promise(function(i){1===++E&&x.adapter.asyncStart();var r=setInterval(function(){var n=!!e.__container__.lookup("router:main").router.activeTransition;n||x.pendingAjaxRequests||y.hasScheduledTimers()||y.currentRunLoop||x.waiters&&x.waiters.any(function(e){var t=e[0],i=e[1];return!i.call(t)})||(clearInterval(r),0===--E&&x.adapter.asyncEnd(),y(null,i,t))},10)})}var g=e.get,v=t["default"],y=i["default"],b=r["default"],x=n["default"],w=x.registerHelper,T=x.registerAsyncHelper,E=0;T("visit",l),T("click",d),T("keyEvent",u),T("fillIn",c),w("find",m),w("findWithAssert",f),T("wait",_),T("andThen",p),w("currentRouteName",o),w("currentPath",s),w("currentURL",a),T("triggerEvent",h)}),e("ember-testing/initializers",["ember-runtime/system/lazy_load"],function(e){"use strict";var t=e.onLoad,i="deferReadiness in `testing` mode";t("Ember.Application",function(e){e.initializers[i]||e.initializer({name:i,initialize:function(e,t){t.testing&&t.deferReadiness()}})})}),e("ember-testing",["ember-metal/core","ember-testing/initializers","ember-testing/support","ember-testing/setup_for_testing","ember-testing/test","ember-testing/adapters/adapter","ember-testing/adapters/qunit","ember-testing/helpers"],function(e,t,i,r,n,o,s){"use strict";var a=e["default"],l=r["default"],d=n["default"],h=o["default"],u=s["default"];a.Test=d,a.Test.Adapter=h,a.Test.QUnitAdapter=u,a.setupForTesting=l}),e("ember-testing/setup_for_testing",["ember-metal/core","ember-testing/adapters/qunit","ember-views/system/jquery","exports"],function(e,i,r,n){"use strict";function o(){l.pendingAjaxRequests++}function s(){d.assert("An ajaxComplete event which would cause the number of pending AJAX requests to be negative has been triggered. This is most likely caused by AJAX events that were started before calling `injectTestHelpers()`.",0!==l.pendingAjaxRequests),l.pendingAjaxRequests--}function a(){l||(l=t("ember-testing/test")["default"]),d.testing=!0,l.adapter||(l.adapter=h.create()),l.pendingAjaxRequests||(l.pendingAjaxRequests=0),u(document).off("ajaxSend",o),u(document).off("ajaxComplete",s),u(document).on("ajaxSend",o),u(document).on("ajaxComplete",s)}var l,d=e["default"],h=i["default"],u=r["default"];n["default"]=a}),e("ember-testing/support",["ember-metal/core","ember-views/system/jquery"],function(e,t){"use strict";function i(e){o('<input type="checkbox">').css({position:"absolute",left:"-1000px",top:"-1000px"}).appendTo("body").on("click",e).trigger("click").remove()}var r=e["default"],n=t["default"],o=n;o(function(){i(function(){this.checked||o.event.special.click||(o.event.special.click={trigger:function(){return o.nodeName(this,"input")&&"checkbox"===this.type&&this.click?(this.click(),!1):void 0}})}),i(function(){r.warn("clicked checkboxes should be checked! the jQuery patch didn't work",this.checked)
})})}),e("ember-testing/test",["ember-metal/core","ember-metal/run_loop","ember-metal/platform","ember-runtime/compare","ember-runtime/ext/rsvp","ember-testing/setup_for_testing","ember-application/system/application","exports"],function(e,t,i,r,n,o,s,a){"use strict";function l(e,t){var i=b[t].method,r=b[t].meta;return function(){var t=y.call(arguments),n=w.lastPromise;return t.unshift(e),r.wait?(n?d(function(){n=w.resolve(n).then(function(){return i.apply(e,t)})}):n=i.apply(e,t),n):i.apply(e,t)}}function d(e){f.currentRunLoop?e():f(e)}function h(e,t,i,r){e[t]=function(){var e=arguments;return r?i.apply(this,e):this.then(function(){return i.apply(this,e)})}}function u(e,t){var i,r;return w.lastPromise=null,i=e(t),r=w.lastPromise,i&&i instanceof w.Promise||!r?i:(d(function(){r=w.resolve(r).then(function(){return i})}),r)}var c=e["default"],f=t["default"],m=i.create,p=r["default"],_=n["default"],g=o["default"],v=s["default"],y=[].slice,b={},x=[],w={registerHelper:function(e,t){b[e]={method:t,meta:{wait:!1}}},registerAsyncHelper:function(e,t){b[e]={method:t,meta:{wait:!0}}},unregisterHelper:function(e){delete b[e],delete w.Promise.prototype[e]},onInjectHelpers:function(e){x.push(e)},promise:function(e){return new w.Promise(e)},adapter:null,resolve:function(e){return w.promise(function(t){return t(e)})},registerWaiter:function(e,t){1===arguments.length&&(t=e,e=null),this.waiters||(this.waiters=c.A()),this.waiters.push([e,t])},unregisterWaiter:function(e,t){var i;this.waiters&&(1===arguments.length&&(t=e,e=null),i=[e,t],this.waiters=c.A(this.waiters.filter(function(e){return 0!==p(e,i)})))}};v.reopen({testHelpers:{},originalMethods:{},testing:!1,setupForTesting:function(){g(),this.testing=!0,this.Router.reopen({location:"none"})},helperContainer:window,injectTestHelpers:function(e){e&&(this.helperContainer=e),this.testHelpers={};for(var t in b)this.originalMethods[t]=this.helperContainer[t],this.testHelpers[t]=this.helperContainer[t]=l(this,t),h(w.Promise.prototype,t,l(this,t),b[t].meta.wait);for(var i=0,r=x.length;r>i;i++)x[i](this)},removeTestHelpers:function(){for(var e in b)this.helperContainer[e]=this.originalMethods[e],delete this.testHelpers[e],delete this.originalMethods[e]}}),w.Promise=function(){_.Promise.apply(this,arguments),w.lastPromise=this},w.Promise.prototype=m(_.Promise.prototype),w.Promise.prototype.constructor=w.Promise;var T=_.Promise.prototype.then;w.Promise.prototype.then=function(e,t){return T.call(this,function(t){return u(e,t)},t)},a["default"]=w})}(),e("container/container",["container/inheriting_dict","exports"],function(e,t){"use strict";function i(e){this.parent=e,this.children=[],this.resolver=e&&e.resolver||function(){},this.registry=new y(e&&e.registry),this.cache=new y(e&&e.cache),this.factoryCache=new y(e&&e.factoryCache),this.resolveCache=new y(e&&e.resolveCache),this.typeInjections=new y(e&&e.typeInjections),this.injections={},this.factoryTypeInjections=new y(e&&e.factoryTypeInjections),this.factoryInjections={},this._options=new y(e&&e._options),this._typeOptions=new y(e&&e._typeOptions)}function r(e,t){return e.cache.has(t)?!0:!!e.resolve(t)}function o(e,t,i){if(i=i||{},e.cache.has(t)&&i.singleton!==!1)return e.cache.get(t);var r=f(e,t);return void 0!==r?(a(e,t)&&i.singleton!==!1&&e.cache.set(t,r),r):void 0}function s(e){throw new Error(e+" is not currently supported on child containers")}function a(e,t){var i=d(e,t,"singleton");return i!==!1}function l(e,t){var i={};if(!t)return i;for(var r,n,s=0,a=t.length;a>s;s++){if(r=t[s],n=o(e,r.fullName),void 0===n)throw new Error("Attempting to inject an unknown injection: `"+r.fullName+"`");i[r.property]=n}return i}function d(e,t,i){var r=e._options.get(t);if(r&&void 0!==r[i])return r[i];var n=t.split(":")[0];return r=e._typeOptions.get(n),r?r[i]:void 0}function h(e,t){var i,r=t,o=e.resolve(r),s=e.factoryCache,a=t.split(":")[0];if(void 0!==o){if(s.has(t))return s.get(t);if(!o||"function"!=typeof o.extend||!n.MODEL_FACTORY_INJECTIONS&&"model"===a)return o;var l=u(e,t),d=c(e,t);return d._toString=e.makeToString(o,t),i=o.extend(l),i.reopenClass(d),s.set(t,i),i}}function u(e,t){var i=t.split(":"),r=i[0],n=[];return n=n.concat(e.typeInjections.get(r)||[]),n=n.concat(e.injections[t]||[]),n=l(e,n),n._debugContainerKey=t,n.container=e,n}function c(e,t){var i=t.split(":"),r=i[0],n=[];return n=n.concat(e.factoryTypeInjections.get(r)||[]),n=n.concat(e.factoryInjections[t]||[]),n=l(e,n),n._debugContainerKey=t,n}function f(e,t){var i=h(e,t);return d(e,t,"instantiate")===!1?i:i?"function"==typeof i.extend?i.create():i.create(u(e,t)):void 0}function m(e,t){e.cache.eachLocal(function(i,r){d(e,i,"instantiate")!==!1&&t(r)})}function p(e){e.cache.eachLocal(function(t,i){d(e,t,"instantiate")!==!1&&i.destroy()}),e.cache.dict={}}function _(e,t,i,r){var n=e.get(t);n||(n=[],e.set(t,n)),n.push({property:i,fullName:r})}function g(e){if(!b.test(e))throw new TypeError("Invalid Fullname, expected: `type:name` got: "+e)}function v(e,t,i,r){var n=e[t]=e[t]||[];n.push({property:i,fullName:r})}var y=e["default"];i.prototype={parent:null,children:null,resolver:null,registry:null,cache:null,typeInjections:null,injections:null,_options:null,_typeOptions:null,child:function(){var e=new i(this);return this.children.push(e),e},set:function(e,t,i){e[t]=i},register:function(e,t,i){if(g(e),void 0===t)throw new TypeError("Attempting to register an unknown factory: `"+e+"`");var r=this.normalize(e);if(this.cache.has(r))throw new Error("Cannot re-register: `"+e+"`, as it has already been looked up.");this.registry.set(r,t),this._options.set(r,i||{})},unregister:function(e){g(e);var t=this.normalize(e);this.registry.remove(t),this.cache.remove(t),this.factoryCache.remove(t),this.resolveCache.remove(t),this._options.remove(t)},resolve:function(e){g(e);var t=this.normalize(e),i=this.resolveCache.get(t);if(i)return i;var r=this.resolver(t)||this.registry.get(t);return this.resolveCache.set(t,r),r},describe:function(e){return e},normalize:function(e){return e},makeToString:function(e){return e.toString()},lookup:function(e,t){return g(e),o(this,this.normalize(e),t)},lookupFactory:function(e){return g(e),h(this,this.normalize(e))},has:function(e){return g(e),r(this,this.normalize(e))},optionsForType:function(e,t){this.parent&&s("optionsForType"),this._typeOptions.set(e,t)},options:function(e,t){this.optionsForType(e,t)},typeInjection:function(e,t,i){g(i),this.parent&&s("typeInjection");var r=i.split(":")[0];if(r===e)throw new Error("Cannot inject a `"+i+"` on other "+e+"(s). Register the `"+i+"` as a different type and perform the typeInjection.");_(this.typeInjections,e,t,i)},injection:function(e,t,i){this.parent&&s("injection"),g(i);var r=this.normalize(i);if(-1===e.indexOf(":"))return this.typeInjection(e,t,r);g(e);var n=this.normalize(e);v(this.injections,n,t,r)},factoryTypeInjection:function(e,t,i){this.parent&&s("factoryTypeInjection"),_(this.factoryTypeInjections,e,t,this.normalize(i))},factoryInjection:function(e,t,i){this.parent&&s("injection");var r=this.normalize(e),n=this.normalize(i);return g(i),-1===e.indexOf(":")?this.factoryTypeInjection(r,t,n):(g(e),void v(this.factoryInjections,r,t,n))},destroy:function(){for(var e=0,t=this.children.length;t>e;e++)this.children[e].destroy();this.children=[],m(this,function(e){e.destroy()}),this.parent=void 0,this.isDestroyed=!0},reset:function(){for(var e=0,t=this.children.length;t>e;e++)p(this.children[e]);p(this)}};var b=/^[^:]+.+:[^:]+$/;t["default"]=i}),e("ember-runtime/ext/rsvp",["ember-metal/core","ember-metal/logger","exports"],function(e,i,r){"use strict";var n,o=e["default"],s=i["default"],a=t("rsvp"),l="ember-testing/test";a.onerrorDefault=function(e){if(e instanceof Error)if(o.testing){if(!n&&o.__loader.registry[l]&&(n=t(l)["default"]),!n||!n.adapter)throw e;n.adapter.exception(e)}else o.onerror?o.onerror(e):(s.error(e.stack),o.assert(e,!1))},a.on("error",a.onerrorDefault),r["default"]=a}),e("ember-runtime/system/container",["ember-metal/property_set","exports"],function(e,i){"use strict";var r=e["default"],n=t("container")["default"];n.set=r,i["default"]=n}),function(){function e(e){return function(){throw new n.Error(e)}}function i(t){var i=" has been moved into a plugin: https://github.com/emberjs/ember-states";return{extend:e(t+i),create:e(t+i)}}t("ember-metal"),t("ember-runtime"),t("ember-handlebars"),t("ember-views"),t("ember-routing"),t("ember-application"),t("ember-extension-support"),n.__loader.registry["ember-testing"]&&t("ember-testing"),n.StateManager=i("Ember.StateManager"),n.State=i("Ember.State")}()}(),function(){var e,t;!function(){var i={},r={};e=function(e,t,r){i[e]={deps:t,callback:r}},t=function(e){if(r[e])return r[e];r[e]={};var n,o,s,a,l;if(n=i[e],!n)throw new Error("Module '"+e+"' not found.");o=n.deps,s=n.callback,a=[];for(var d=0,h=o.length;h>d;d++)a.push("exports"===o[d]?l={}:t(o[d]));var u=s.apply(this,a);return r[e]=l||u}}(),function(){var e;"undefined"==typeof e&&(e=Ember.Namespace.create({VERSION:"1.0.0-beta.5"}),"undefined"!=typeof window&&(window.DS=e),Ember.libraries&&Ember.libraries.registerCoreLibrary("Ember Data",e.VERSION))}(),function(){function e(e){return function(){return this[e].apply(this,arguments)}}var t=Ember.get,i=(Ember.set,Ember.isNone);DS.JSONSerializer=Ember.Object.extend({primaryKey:"id",applyTransforms:function(e,t){return e.eachTransformedAttribute(function(e,i){var r=this.transformFor(i);t[e]=r.deserialize(t[e])},this),t},normalize:function(e,t){return t?(this.applyTransforms(e,t),t):t},serialize:function(e,i){var r={};if(i&&i.includeId){var n=t(e,"id");n&&(r[t(this,"primaryKey")]=n)}return e.eachAttribute(function(t,i){this.serializeAttribute(e,r,t,i)},this),e.eachRelationship(function(t,i){"belongsTo"===i.kind?this.serializeBelongsTo(e,r,i):"hasMany"===i.kind&&this.serializeHasMany(e,r,i)},this),r},serializeAttribute:function(e,i,r,n){var o=t(this,"attrs"),s=t(e,r),a=n.type;if(a){var l=this.transformFor(a);s=l.serialize(s)}r=o&&o[r]||(this.keyForAttribute?this.keyForAttribute(r):r),i[r]=s},serializeBelongsTo:function(e,r,n){var o=n.key,s=t(e,o);o=this.keyForRelationship?this.keyForRelationship(o,"belongsTo"):o,r[o]=i(s)?s:t(s,"id"),n.options.polymorphic&&this.serializePolymorphicType(e,r,n)},serializeHasMany:function(e,i,r){var n=r.key,o=DS.RelationshipChange.determineRelationshipType(e.constructor,r);("manyToNone"===o||"manyToMany"===o)&&(i[n]=t(e,n).mapBy("id"))},serializePolymorphicType:Ember.K,extract:function(e,t,i,r,n){this.extractMeta(e,t,i);var o="extract"+n.charAt(0).toUpperCase()+n.substr(1);return this[o](e,t,i,r,n)},extractFindAll:e("extractArray"),extractFindQuery:e("extractArray"),extractFindMany:e("extractArray"),extractFindHasMany:e("extractArray"),extractCreateRecord:e("extractSave"),extractUpdateRecord:e("extractSave"),extractDeleteRecord:e("extractSave"),extractFind:e("extractSingle"),extractFindBelongsTo:e("extractSingle"),extractSave:e("extractSingle"),extractSingle:function(e,t,i){return this.normalize(t,i)},extractArray:function(e,t,i){return this.normalize(t,i)},extractMeta:function(e,t,i){i&&i.meta&&(e.metaForType(t,i.meta),delete i.meta)},transformFor:function(e,t){var i=this.container.lookup("transform:"+e);return Ember.assert("Unable to find transform for '"+e+"'",t||!!i),i}})}(),function(){var e=Ember.get,t=Ember.String.capitalize,i=Ember.String.underscore,r=window.DS;r.DebugAdapter=Ember.DataAdapter.extend({getFilters:function(){return[{name:"isNew",desc:"New"},{name:"isModified",desc:"Modified"},{name:"isClean",desc:"Clean"}]},detect:function(e){return e!==r.Model&&r.Model.detect(e)},columnsForType:function(r){var n=[{name:"id",desc:"Id"}],o=0,s=this;return e(r,"attributes").forEach(function(e){if(o++>s.attributeLimit)return!1;var r=t(i(e).replace("_"," "));n.push({name:e,desc:r})}),n},getRecords:function(e){return this.get("store").all(e)},getRecordColumnValues:function(t){var i=this,r=0,n={id:e(t,"id")};return t.eachAttribute(function(o){if(r++>i.attributeLimit)return!1;var s=e(t,o);n[o]=s}),n},getRecordKeywords:function(t){var i=[],r=Ember.A(["id"]);return t.eachAttribute(function(e){r.push(e)}),r.forEach(function(r){i.push(e(t,r))}),i},getRecordFilterValues:function(e){return{isNew:e.get("isNew"),isModified:e.get("isDirty")&&!e.get("isNew"),isClean:!e.get("isDirty")}},getRecordColor:function(e){var t="black";return e.get("isNew")?t="green":e.get("isDirty")&&(t="blue"),t},observeRecord:function(e,t){var i=Ember.A(),r=this,n=Ember.A(["id","isNew","isDirty"]);e.eachAttribute(function(e){n.push(e)}),n.forEach(function(n){var o=function(){t(r.wrapRecord(e))};Ember.addObserver(e,n,o),i.push(function(){Ember.removeObserver(e,n,o)})});var o=function(){i.forEach(function(e){e()})};return o}})}(),function(){DS.Transform=Ember.Object.extend({serialize:Ember.required(),deserialize:Ember.required()})}(),function(){DS.BooleanTransform=DS.Transform.extend({deserialize:function(e){var t=typeof e;return"boolean"===t?e:"string"===t?null!==e.match(/^true$|^t$|^1$/i):"number"===t?1===e:!1},serialize:function(e){return Boolean(e)}})}(),function(){DS.DateTransform=DS.Transform.extend({deserialize:function(e){var t=typeof e;return"string"===t?new Date(Ember.Date.parse(e)):"number"===t?new Date(e):null===e||void 0===e?e:null},serialize:function(e){if(e instanceof Date){var t=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],i=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],r=function(e){return 10>e?"0"+e:""+e},n=e.getUTCFullYear(),o=e.getUTCMonth(),s=e.getUTCDate(),a=e.getUTCDay(),l=e.getUTCHours(),d=e.getUTCMinutes(),h=e.getUTCSeconds(),u=t[a],c=r(s),f=i[o];return u+", "+c+" "+f+" "+n+" "+r(l)+":"+r(d)+":"+r(h)+" GMT"}return null}})}(),function(){var e=Ember.isEmpty;DS.NumberTransform=DS.Transform.extend({deserialize:function(t){return e(t)?null:Number(t)},serialize:function(t){return e(t)?null:Number(t)}})}(),function(){var e=Ember.isNone;DS.StringTransform=DS.Transform.extend({deserialize:function(t){return e(t)?null:String(t)},serialize:function(t){return e(t)?null:String(t)}})}(),function(){Ember.set;Ember.onLoad("Ember.Application",function(e){e.initializer({name:"store",initialize:function(e,t){t.register("store:main",t.Store||DS.Store),t.register("serializer:_default",DS.JSONSerializer),t.register("serializer:_rest",DS.RESTSerializer),t.register("adapter:_rest",DS.RESTAdapter),e.lookup("store:main")}}),e.initializer({name:"transforms",before:"store",initialize:function(e,t){t.register("transform:boolean",DS.BooleanTransform),t.register("transform:date",DS.DateTransform),t.register("transform:number",DS.NumberTransform),t.register("transform:string",DS.StringTransform)}}),e.initializer({name:"dataAdapter",before:"store",initialize:function(e,t){t.register("dataAdapter:main",DS.DebugAdapter)}}),e.initializer({name:"injectStore",before:"store",initialize:function(e,t){t.inject("controller","store","store:main"),t.inject("route","store","store:main"),t.inject("serializer","store","store:main"),t.inject("dataAdapter","store","store:main")}})})}(),function(){Ember.Date=Ember.Date||{};var e=Date.parse,t=[1,4,5,6,7,10,11];Ember.Date.parse=function(i){var r,n,o=0;if(n=/^(\d{4}|[+\-]\d{6})(?:-(\d{2})(?:-(\d{2}))?)?(?:T(\d{2}):(\d{2})(?::(\d{2})(?:\.(\d{3}))?)?(?:(Z)|([+\-])(\d{2})(?::(\d{2}))?)?)?$/.exec(i)){for(var s,a=0;s=t[a];++a)n[s]=+n[s]||0;n[2]=(+n[2]||1)-1,n[3]=+n[3]||1,"Z"!==n[8]&&void 0!==n[9]&&(o=60*n[10]+n[11],"+"===n[9]&&(o=0-o)),r=Date.UTC(n[1],n[2],n[3],n[4],n[5]+o,n[6],n[7])}else r=e?e(i):0/0;return r},(Ember.EXTEND_PROTOTYPES===!0||Ember.EXTEND_PROTOTYPES.Date)&&(Date.parse=Ember.Date.parse)}(),function(){{var e=Ember.get;Ember.set}DS.RecordArray=Ember.ArrayProxy.extend(Ember.Evented,{type:null,content:null,isLoaded:!1,isUpdating:!1,store:null,objectAtContent:function(t){var i=e(this,"content");return i.objectAt(t)},update:function(){if(!e(this,"isUpdating")){var t=e(this,"store"),i=e(this,"type");t.fetchAll(i,this)}},addRecord:function(t){e(this,"content").addObject(t)},removeRecord:function(t){e(this,"content").removeObject(t)},save:function(){var t="DS: RecordArray#save "+e(this,"type"),i=Ember.RSVP.all(this.invoke("save"),t).then(function(e){return Ember.A(e)},null,"DS: RecordArray#save apply Ember.NativeArray");return DS.PromiseArray.create({promise:i})}})}(),function(){var e=Ember.get;DS.FilteredRecordArray=DS.RecordArray.extend({filterFunction:null,isLoaded:!0,replace:function(){var t=e(this,"type").toString();throw new Error("The result of a client-side filter (on "+t+") is immutable.")},updateFilter:Ember.observer(function(){var t=e(this,"manager");t.updateFilter(this,e(this,"type"),e(this,"filterFunction"))},"filterFunction")})}(),function(){{var e=Ember.get;Ember.set}DS.AdapterPopulatedRecordArray=DS.RecordArray.extend({query:null,replace:function(){var t=e(this,"type").toString();throw new Error("The result of a server query (on "+t+") is immutable.")},load:function(t){var i=e(this,"store"),r=e(this,"type"),n=i.pushMany(r,t),o=i.metadataFor(r);this.setProperties({content:Ember.A(n),isLoaded:!0,meta:o}),Ember.run.once(this,"trigger","didLoad")}})}(),function(){var e=Ember.get,t=Ember.set,i=Ember.EnumerableUtils.map;DS.ManyArray=DS.RecordArray.extend({init:function(){this._super.apply(this,arguments),this._changesToSync=Ember.OrderedSet.create()},name:null,owner:null,isPolymorphic:!1,isLoaded:!1,promise:null,loadingRecordsCount:function(e){this.loadingRecordsCount=e},loadedRecord:function(){this.loadingRecordsCount--,0===this.loadingRecordsCount&&(t(this,"isLoaded",!0),this.trigger("didLoad"))},fetch:function(){var t=e(this,"content"),i=e(this,"store"),r=e(this,"owner"),n=Ember.RSVP.defer("DS: ManyArray#fetch "+e(this,"type")),o=t.filterProperty("isEmpty",!0);i.fetchMany(o,r,n)},replaceContent:function(e,t,r){r=i(r,function(e){return Ember.assert("You cannot add '"+e.constructor.typeKey+"' records to this relationship (only '"+this.type.typeKey+"' allowed)",!this.type||e instanceof this.type),e},this),this._super(e,t,r)},arrangedContentDidChange:function(){Ember.run.once(this,"fetch")},arrayContentWillChange:function(t,i){var r=e(this,"owner"),n=e(this,"name");if(!r._suspendedRelationships)for(var o=t;t+i>o;o++){var s=e(this,"content").objectAt(o),a=DS.RelationshipChange.createChange(r,s,e(this,"store"),{parentType:r.constructor,changeType:"remove",kind:"hasMany",key:n});this._changesToSync.add(a)}return this._super.apply(this,arguments)},arrayContentDidChange:function(t,i,r){this._super.apply(this,arguments);var n=e(this,"owner"),o=e(this,"name"),s=e(this,"store");if(!n._suspendedRelationships){for(var a=t;t+r>a;a++){var l=e(this,"content").objectAt(a),d=DS.RelationshipChange.createChange(n,l,s,{parentType:n.constructor,changeType:"add",kind:"hasMany",key:o});d.hasManyName=o,this._changesToSync.add(d)}this._changesToSync.forEach(function(e){e.sync()}),this._changesToSync.clear()}},createRecord:function(t){var i,r=e(this,"owner"),n=e(r,"store"),o=e(this,"type");return Ember.assert("You cannot add '"+o.typeKey+"' records to this polymorphic relationship.",!e(this,"isPolymorphic")),i=n.createRecord.call(n,o,t),this.pushObject(i),i}})}(),function(){function e(e,i,o,s){return i.eachRelationship(function(i,a){if(o.links&&o.links[i])return void(s&&a.options.async&&(s._relationships[i]=null));var l=a.kind,d=o[i];null!=d&&("belongsTo"===l?t(e,o,i,a,d):"hasMany"===l&&(r(e,o,i,a,d),n(s,i,d)))}),o}function t(e,t,r,n,o){if(!(x(o)||o instanceof DS.Model)){var s;"number"==typeof o||"string"==typeof o?(s=i(n,r,t),t[r]=e.recordForId(s,o)):"object"==typeof o&&(t[r]=e.recordForId(o.type,o.id))}}function i(e,t,i){return e.options.polymorphic?i[t+"Type"]:e.type}function r(e,i,r,n,o){for(var s=0,a=o.length;a>s;s++)t(e,o,s,n,o[s])}function n(e,t,i){e&&i.pushObjects(e.get(t).filterBy("isNew"))}function o(e){return DS.PromiseObject.create({promise:e})}function s(e){return DS.PromiseArray.create({promise:e})}function a(e){return e&&"function"==typeof e.then}function l(e,t,i){return e.lookup("serializer:"+t)||e.lookup("serializer:application")||e.lookup("serializer:"+i)||e.lookup("serializer:_default")}function d(e){return e.lookup("serializer:application")||e.lookup("serializer:_default")}function h(e,t){var i=e.serializer,r=e.defaultSerializer,n=e.container;return n&&void 0===i&&(i=l(n,t.typeKey,r)),(null===i||void 0===i)&&(i={extract:function(e,t,i){return i}}),i}function u(e,t,i,r){var n=e.find(t,i,r),o=h(e,i);return C(n,"DS: Handle Adapter#find of "+i+" with id: "+r).then(function(e){return Ember.assert("You made a request for a "+i.typeKey+" with id "+r+", but the adapter's response did not have any data",e),e=o.extract(t,i,e,r,"find"),t.push(i,e)},function(e){var n=t.getById(i,r);throw n.notFound(),e},"DS: Extract payload of '"+i+"'")}function c(e,t,i,r,n){var o=e.findMany(t,i,r,n),s=h(e,i);return C(o,"DS: Handle Adapter#findMany of "+i).then(function(e){e=s.extract(t,i,e,null,"findMany"),Ember.assert("The response from a findMany must be an Array, not "+Ember.inspect(e),"array"===Ember.typeOf(e)),t.pushMany(i,e)},null,"DS: Extract payload of "+i)}function f(e,t,i,r,n){var o=e.findHasMany(t,i,r,n),s=h(e,n.type);return C(o,"DS: Handle Adapter#findHasMany of "+i+" : "+n.type).then(function(e){e=s.extract(t,n.type,e,null,"findHasMany"),Ember.assert("The response from a findHasMany must be an Array, not "+Ember.inspect(e),"array"===Ember.typeOf(e));var r=t.pushMany(n.type,e);i.updateHasMany(n.key,r)},null,"DS: Extract payload of "+i+" : hasMany "+n.type)}function m(e,t,i,r,n){var o=e.findBelongsTo(t,i,r,n),s=h(e,n.type);return C(o,"DS: Handle Adapter#findBelongsTo of "+i+" : "+n.type).then(function(e){e=s.extract(t,n.type,e,null,"findBelongsTo");var i=t.push(n.type,e);return i.updateBelongsTo(n.key,i),i},null,"DS: Extract payload of "+i+" : "+n.type)}function p(e,t,i,r){var n=e.findAll(t,i,r),o=h(e,i);return C(n,"DS: Handle Adapter#findAll of "+i).then(function(e){return e=o.extract(t,i,e,null,"findAll"),Ember.assert("The response from a findAll must be an Array, not "+Ember.inspect(e),"array"===Ember.typeOf(e)),t.pushMany(i,e),t.didUpdateAll(i),t.all(i)},null,"DS: Extract payload of findAll "+i)}function _(e,t,i,r,n){var o=e.findQuery(t,i,r,n),s=h(e,i);return C(o,"DS: Handle Adapter#findQuery of "+i).then(function(e){return e=s.extract(t,i,e,null,"findQuery"),Ember.assert("The response from a findQuery must be an Array, not "+Ember.inspect(e),"array"===Ember.typeOf(e)),n.load(e),n},null,"DS: Extract payload of findQuery "+i)}function g(e,t,i,r){var n=r.constructor,o=e[i](t,n,r),s=h(e,n);return Ember.assert("Your adapter's '"+i+"' method must return a promise, but it returned "+o,a(o)),o.then(function(e){return e&&(e=s.extract(t,n,e,v(r,"id"),i)),t.didSaveRecord(r,e),r},function(e){throw e instanceof DS.InvalidError?t.recordWasInvalid(r,e.errors):t.recordWasError(r,e),e},"DS: Extract and notify about "+i+" completion of "+r)}var v=Ember.get,y=Ember.set,b=Ember.run.once,x=Ember.isNone,w=Ember.EnumerableUtils.forEach,T=Ember.EnumerableUtils.indexOf,E=Ember.EnumerableUtils.map,C=Ember.RSVP.resolve,S=Ember.copy,F=function(e){return null==e?null:e+""};DS.Store=Ember.Object.extend({init:function(){this.typeMaps={},this.recordArrayManager=DS.RecordArrayManager.create({store:this}),this._relationshipChanges={},this._pendingSave=[]},adapter:"_rest",serialize:function(e,t){return this.serializerFor(e.constructor.typeKey).serialize(e,t)},defaultAdapter:Ember.computed("adapter",function(){var e=v(this,"adapter");return Ember.assert("You tried to set `adapter` property to an instance of `DS.Adapter`, where it should be a name or a factory",!(e instanceof DS.Adapter)),"string"==typeof e&&(e=this.container.lookup("adapter:"+e)||this.container.lookup("adapter:application")||this.container.lookup("adapter:_rest")),DS.Adapter.detect(e)&&(e=e.create({container:this.container})),e}),createRecord:function(e,t){e=this.modelFor(e),t=S(t)||{},x(t.id)&&(t.id=this._generateId(e)),t.id=F(t.id);var i=this.buildRecord(e,t.id);return i.loadedData(),i.setProperties(t),i},_generateId:function(e){var t=this.adapterFor(e);return t&&t.generateIdForRecord?t.generateIdForRecord(this):null},deleteRecord:function(e){e.deleteRecord()},unloadRecord:function(e){e.unloadRecord()},find:function(e,t){return void 0===t?this.findAll(e):"object"===Ember.typeOf(t)?this.findQuery(e,t):this.findById(e,F(t))},findById:function(e,t){e=this.modelFor(e);var i=this.recordForId(e,t),r=this.fetchRecord(i)||C(i,"DS: Store#findById "+e+" with id: "+t);return o(r)},findByIds:function(e,t){var i=this;return s(Ember.RSVP.all(E(t,function(t){return i.findById(e,t)})).then(Ember.A,null,"DS: Store#findByIds of "+e+" complete"))},fetchRecord:function(e){if(x(e))return null;if(e._loadingPromise)return e._loadingPromise;if(!v(e,"isEmpty"))return null;var t=e.constructor,i=v(e,"id"),r=this.adapterFor(t);Ember.assert("You tried to find a record but you have no adapter (for "+t+")",r),Ember.assert("You tried to find a record but your adapter (for "+t+") does not implement 'find'",r.find);var n=u(r,this,t,i);return e.loadingData(n),n},getById:function(e,t){return this.hasRecordForId(e,t)?this.recordForId(e,t):null},reloadRecord:function(e){var t=e.constructor,i=this.adapterFor(t),r=v(e,"id");return Ember.assert("You cannot reload a record without an ID",r),Ember.assert("You tried to reload a record but you have no adapter (for "+t+")",i),Ember.assert("You tried to reload a record but your adapter does not implement `find`",i.find),u(i,this,t,r)},fetchMany:function(e,t,i){if(e.length){var r=Ember.MapWithDefault.create({defaultValue:function(){return Ember.A()}});w(e,function(e){r.get(e.constructor).push(e)}),w(r,function(e,r){var n=r.mapProperty("id"),o=this.adapterFor(e);Ember.assert("You tried to load many records but you have no adapter (for "+e+")",o),Ember.assert("You tried to load many records but your adapter does not implement `findMany`",o.findMany),i.resolve(c(o,this,e,n,t))},this)}},hasRecordForId:function(e,t){return t=F(t),e=this.modelFor(e),!!this.typeMapFor(e).idToRecord[t]},recordForId:function(e,t){e=this.modelFor(e),t=F(t);var i=this.typeMapFor(e).idToRecord[t];return i||(i=this.buildRecord(e,t)),i},findMany:function(e,t,i,r){i=this.modelFor(i),t=Ember.A(t);var n=t.filterProperty("isEmpty",!0),o=this.recordArrayManager.createManyArray(i,t);return w(n,function(e){e.loadingData()}),o.loadingRecordsCount=n.length,n.length?(w(n,function(e){this.recordArrayManager.registerWaitingRecordArray(e,o)},this),this.fetchMany(n,e,r)):(r&&r.resolve(),o.set("isLoaded",!0),Ember.run.once(o,"trigger","didLoad")),o},findHasMany:function(e,t,i,r){var n=this.adapterFor(e.constructor);Ember.assert("You tried to load a hasMany relationship but you have no adapter (for "+e.constructor+")",n),Ember.assert("You tried to load a hasMany relationship from a specified `link` in the original payload but your adapter does not implement `findHasMany`",n.findHasMany);var o=this.recordArrayManager.createManyArray(i.type,Ember.A([]));return r.resolve(f(n,this,e,t,i)),o},findBelongsTo:function(e,t,i,r){var n=this.adapterFor(e.constructor);Ember.assert("You tried to load a belongsTo relationship but you have no adapter (for "+e.constructor+")",n),Ember.assert("You tried to load a belongsTo relationship from a specified `link` in the original payload but your adapter does not implement `findBelongsTo`",n.findBelongsTo),r.resolve(m(n,this,e,t,i))},findQuery:function(e,t){e=this.modelFor(e);var i=this.recordArrayManager.createAdapterPopulatedRecordArray(e,t),r=this.adapterFor(e),n="DS: Store#findQuery "+e,o=Ember.RSVP.defer(n);return Ember.assert("You tried to load a query but you have no adapter (for "+e+")",r),Ember.assert("You tried to load a query but your adapter does not implement `findQuery`",r.findQuery),o.resolve(_(r,this,e,t,i)),s(o.promise)},findAll:function(e){return e=this.modelFor(e),this.fetchAll(e,this.all(e))},fetchAll:function(e,t){var i=this.adapterFor(e),r=this.typeMapFor(e).metadata.since;return y(t,"isUpdating",!0),Ember.assert("You tried to load all records but you have no adapter (for "+e+")",i),Ember.assert("You tried to load all records but your adapter does not implement `findAll`",i.findAll),s(p(i,this,e,r))},didUpdateAll:function(e){var t=this.typeMapFor(e).findAllCache;y(t,"isUpdating",!1)},all:function(e){e=this.modelFor(e);var t=this.typeMapFor(e),i=t.findAllCache;if(i)return i;var r=this.recordArrayManager.createRecordArray(e);return t.findAllCache=r,r},unloadAll:function(e){e=this.modelFor(e);for(var t,i=this.typeMapFor(e),r=i.records;t=r.pop();)t.unloadRecord();i.findAllCache=null},filter:function(e,t,i){var r;3===arguments.length?r=this.findQuery(e,t):2===arguments.length&&(i=t),e=this.modelFor(e);var n=this.recordArrayManager.createFilteredRecordArray(e,i);return r=r||C(n),s(r.then(function(){return n},null,"DS: Store#filter of "+e))},recordIsLoaded:function(e,t){return this.hasRecordForId(e,t)?!v(this.recordForId(e,t),"isEmpty"):!1},metadataFor:function(e){return e=this.modelFor(e),this.typeMapFor(e).metadata},dataWasUpdated:function(e,t){this.recordArrayManager.recordDidChange(t)},scheduleSave:function(e,t){e.adapterWillCommit(),this._pendingSave.push([e,t]),b(this,"flushPendingSave")},flushPendingSave:function(){var e=this._pendingSave.slice();this._pendingSave=[],w(e,function(e){var t,i=e[0],r=e[1],n=this.adapterFor(i.constructor);t=v(i,"isNew")?"createRecord":v(i,"isDeleted")?"deleteRecord":"updateRecord",r.resolve(g(n,this,t,i))},this)},didSaveRecord:function(t,i){i&&(i=e(this,t.constructor,i,t),this.updateId(t,i)),t.adapterDidCommit(i)},recordWasInvalid:function(e,t){e.adapterDidInvalidate(t)},recordWasError:function(e){e.adapterDidError()},updateId:function(e,t){var i=v(e,"id"),r=F(t.id);Ember.assert("An adapter cannot assign a new id to a record that already has an id. "+e+" had id: "+i+" and you tried to update it with "+r+". This likely happened because your server returned data in response to a find or update that had a different id than the one you sent.",null===i||r===i),this.typeMapFor(e.constructor).idToRecord[r]=e,y(e,"id",r)},typeMapFor:function(e){var t,i=v(this,"typeMaps"),r=Ember.guidFor(e);return(t=i[r])?t:(t={idToRecord:{},records:[],metadata:{}},i[r]=t,t)},_load:function(e,t,i){var r=F(t.id),n=this.recordForId(e,r);return n.setupData(t,i),this.recordArrayManager.recordDidChange(n),n},modelFor:function(e){var t;if("string"==typeof e){var i=this.container.normalize("model:"+e);if(t=this.container.lookupFactory(i),!t)throw new Ember.Error("No model was found for '"+e+"'");t.typeKey=i.split(":",2)[1]}else t=e;return t.store=this,t},push:function(t,i,r){return Ember.assert("You must include an `id` in a hash passed to `push`",null!=i.id),t=this.modelFor(t),i=e(this,t,i),this._load(t,i,r),this.recordForId(t,i.id)},pushPayload:function(e,t){var i;t?i=this.serializerFor(e):(t=e,i=d(this.container),Ember.assert("You cannot use `store#pushPayload` without a type unless your default serializer defines `pushPayload`",i.pushPayload)),i.pushPayload(this,t)},update:function(e,t){return Ember.assert("You must include an `id` in a hash passed to `update`",null!=t.id),this.push(e,t,!0)},pushMany:function(e,t){return E(t,function(t){return this.push(e,t)},this)},metaForType:function(e,t){e=this.modelFor(e),Ember.merge(this.typeMapFor(e).metadata,t)},buildRecord:function(e,t,i){var r=this.typeMapFor(e),n=r.idToRecord;Ember.assert("The id "+t+" has already been used with another record of type "+e.toString()+".",!t||!n[t]);var o=e._create({id:t,store:this,container:this.container});return i&&o.setupData(i),t&&(n[t]=o),r.records.push(o),o},dematerializeRecord:function(e){var t=e.constructor,i=this.typeMapFor(t),r=v(e,"id");e.updateRecordArrays(),r&&delete i.idToRecord[r];var n=T(i.records,e);i.records.splice(n,1)},addRelationshipChangeFor:function(e,t,i,r,n){var o=e.clientId,s=i?i:i,a=t+r,l=this._relationshipChanges;o in l||(l[o]={}),s in l[o]||(l[o][s]={}),a in l[o][s]||(l[o][s][a]={}),l[o][s][a][n.changeType]=n},removeRelationshipChangeFor:function(e,t,i,r,n){var o=e.clientId,s=i?i.clientId:i,a=this._relationshipChanges,l=t+r;
o in a&&s in a[o]&&l in a[o][s]&&delete a[o][s][l][n]},relationshipChangePairsFor:function(e){var t=[];if(!e)return t;var i=this._relationshipChanges[e.clientId];for(var r in i)if(i.hasOwnProperty(r))for(var n in i[r])i[r].hasOwnProperty(n)&&t.push(i[r][n]);return t},adapterFor:function(e){var t,i=this.container;return i&&(t=i.lookup("adapter:"+e.typeKey)||i.lookup("adapter:application")),t||v(this,"defaultAdapter")},serializerFor:function(e){e=this.modelFor(e);var t=this.adapterFor(e);return l(this.container,e.typeKey,t&&t.defaultSerializer)}}),DS.PromiseArray=Ember.ArrayProxy.extend(Ember.PromiseProxyMixin),DS.PromiseObject=Ember.ObjectProxy.extend(Ember.PromiseProxyMixin)}(),function(){function e(t){var i,r={};for(var n in t)i=t[n],r[n]=i&&"object"==typeof i?e(i):i;return r}function t(e,t){for(var i in t)e[i]=t[i];return e}function i(i){var r=e(a);return t(r,i)}function r(e,i,n){e=t(i?Ember.create(i):{},e),e.parentState=i,e.stateName=n;for(var o in e)e.hasOwnProperty(o)&&"parentState"!==o&&"stateName"!==o&&"object"==typeof e[o]&&(e[o]=r(e[o],e,n+"."+o));return e}var n=Ember.get,o=Ember.set,s=function(e,t){t.value===t.originalValue?(delete e._attributes[t.name],e.send("propertyWasReset",t.name)):t.value!==t.oldValue&&e.send("becomeDirty"),e.updateRecordArraysLater()},a={initialState:"uncommitted",isDirty:!0,uncommitted:{didSetProperty:s,propertyWasReset:function(e){var t=!1;for(var i in e._attributes){t=!0;break}t||e.send("rolledBack")},pushedData:Ember.K,becomeDirty:Ember.K,willCommit:function(e){e.transitionTo("inFlight")},reloadRecord:function(e,t){t(n(e,"store").reloadRecord(e))},rolledBack:function(e){e.transitionTo("loaded.saved")},becameInvalid:function(e){e.transitionTo("invalid")},rollback:function(e){e.rollback()}},inFlight:{isSaving:!0,didSetProperty:s,becomeDirty:Ember.K,pushedData:Ember.K,willCommit:Ember.K,didCommit:function(e){var t=n(this,"dirtyType");e.transitionTo("saved"),e.send("invokeLifecycleCallbacks",t)},becameInvalid:function(e){e.transitionTo("invalid"),e.send("invokeLifecycleCallbacks")},becameError:function(e){e.transitionTo("uncommitted"),e.triggerLater("becameError",e)}},invalid:{isValid:!1,deleteRecord:function(e){e.transitionTo("deleted.uncommitted"),e.clearRelationships()},didSetProperty:function(e,t){n(e,"errors").remove(t.name),s(e,t)},becomeDirty:Ember.K,rolledBack:function(e){n(e,"errors").clear()},becameValid:function(e){e.transitionTo("uncommitted")},invokeLifecycleCallbacks:function(e){e.triggerLater("becameInvalid",e)}}},l=i({dirtyType:"created",isNew:!0});l.uncommitted.rolledBack=function(e){e.transitionTo("deleted.saved")};var d=i({dirtyType:"updated"});l.uncommitted.deleteRecord=function(e){e.clearRelationships(),e.transitionTo("deleted.saved")},l.uncommitted.rollback=function(e){a.uncommitted.rollback.apply(this,arguments),e.transitionTo("deleted.saved")},d.uncommitted.deleteRecord=function(e){e.transitionTo("deleted.uncommitted"),e.clearRelationships()};var h={isEmpty:!1,isLoading:!1,isLoaded:!1,isDirty:!1,isSaving:!1,isDeleted:!1,isNew:!1,isValid:!0,rolledBack:Ember.K,propertyWasReset:Ember.K,empty:{isEmpty:!0,loadingData:function(e,t){e._loadingPromise=t,e.transitionTo("loading")},loadedData:function(e){e.transitionTo("loaded.created.uncommitted"),e.suspendRelationshipObservers(function(){e.notifyPropertyChange("data")})},pushedData:function(e){e.transitionTo("loaded.saved"),e.triggerLater("didLoad")}},loading:{isLoading:!0,exit:function(e){e._loadingPromise=null},pushedData:function(e){e.transitionTo("loaded.saved"),e.triggerLater("didLoad"),o(e,"isError",!1)},becameError:function(e){e.triggerLater("becameError",e)},notFound:function(e){e.transitionTo("empty")}},loaded:{initialState:"saved",isLoaded:!0,saved:{setup:function(e){var t=e._attributes,i=!1;for(var r in t)if(t.hasOwnProperty(r)){i=!0;break}i&&e.adapterDidDirty()},didSetProperty:s,pushedData:Ember.K,becomeDirty:function(e){e.transitionTo("updated.uncommitted")},willCommit:function(e){e.transitionTo("updated.inFlight")},reloadRecord:function(e,t){t(n(e,"store").reloadRecord(e))},deleteRecord:function(e){e.transitionTo("deleted.uncommitted"),e.clearRelationships()},unloadRecord:function(e){e.clearRelationships(),e.transitionTo("deleted.saved")},didCommit:function(e){e.send("invokeLifecycleCallbacks",n(e,"lastDirtyType"))},notFound:Ember.K},created:l,updated:d},deleted:{initialState:"uncommitted",dirtyType:"deleted",isDeleted:!0,isLoaded:!0,isDirty:!0,setup:function(e){e.updateRecordArrays()},uncommitted:{willCommit:function(e){e.transitionTo("inFlight")},rollback:function(e){e.rollback()},becomeDirty:Ember.K,deleteRecord:Ember.K,rolledBack:function(e){e.transitionTo("loaded.saved")}},inFlight:{isSaving:!0,willCommit:Ember.K,didCommit:function(e){e.transitionTo("saved"),e.send("invokeLifecycleCallbacks")},becameError:function(e){e.transitionTo("uncommitted"),e.triggerLater("becameError",e)}},saved:{isDirty:!1,setup:function(e){var t=n(e,"store");t.dematerializeRecord(e)},invokeLifecycleCallbacks:function(e){e.triggerLater("didDelete",e),e.triggerLater("didCommit",e)}}},invokeLifecycleCallbacks:function(e,t){"created"===t?e.triggerLater("didCreate",e):e.triggerLater("didUpdate",e),e.triggerLater("didCommit",e)}};h=r(h,null,"root"),DS.RootState=h}(),function(){var e=Ember.get,t=Ember.isEmpty;DS.Errors=Ember.Object.extend(Ember.Enumerable,Ember.Evented,{registerHandlers:function(e,t,i){this.on("becameInvalid",e,t),this.on("becameValid",e,i)},errorsByAttributeName:Ember.reduceComputed("content",{initialValue:function(){return Ember.MapWithDefault.create({defaultValue:function(){return Ember.A()}})},addedItem:function(e,t){return e.get(t.attribute).pushObject(t),e},removedItem:function(e,t){return e.get(t.attribute).removeObject(t),e}}),errorsFor:function(t){return e(this,"errorsByAttributeName").get(t)},messages:Ember.computed.mapBy("content","message"),content:Ember.computed(function(){return Ember.A()}),unknownProperty:function(e){var i=this.errorsFor(e);return t(i)?null:i},nextObject:function(t){return e(this,"content").objectAt(t)},length:Ember.computed.oneWay("content.length").readOnly(),isEmpty:Ember.computed.not("length").readOnly(),add:function(t,i){var r=e(this,"isEmpty");i=this._findOrCreateMessages(t,i),e(this,"content").addObjects(i),this.notifyPropertyChange(t),this.enumerableContentDidChange(),r&&!e(this,"isEmpty")&&this.trigger("becameInvalid")},_findOrCreateMessages:function(e,t){var i=this.errorsFor(e);return Ember.makeArray(t).map(function(t){return i.findBy("message",t)||{attribute:e,message:t}})},remove:function(t){if(!e(this,"isEmpty")){var i=e(this,"content").rejectBy("attribute",t);e(this,"content").setObjects(i),this.notifyPropertyChange(t),this.enumerableContentDidChange(),e(this,"isEmpty")&&this.trigger("becameValid")}},clear:function(){e(this,"isEmpty")||(e(this,"content").clear(),this.enumerableContentDidChange(),this.trigger("becameValid"))},has:function(e){return!t(this.errorsFor(e))}})}(),function(){var e=Ember.get,t=Ember.set,i=Ember.merge,r=Ember.run.once,n=Ember.computed("currentState",function(t){return e(e(this,"currentState"),t)}).readOnly();DS.Model=Ember.Object.extend(Ember.Evented,{isEmpty:n,isLoading:n,isLoaded:n,isDirty:n,isSaving:n,isDeleted:n,isNew:n,isValid:n,dirtyType:n,isError:!1,isReloading:!1,clientId:null,id:null,transaction:null,currentState:null,errors:null,serialize:function(t){var i=e(this,"store");return i.serialize(this,t)},toJSON:function(e){var t=DS.JSONSerializer.create({container:this.container});return t.serialize(this,e)},didLoad:Ember.K,didUpdate:Ember.K,didCreate:Ember.K,didDelete:Ember.K,becameInvalid:Ember.K,becameError:Ember.K,data:Ember.computed(function(){return this._data=this._data||{},this._data}).property(),_data:null,init:function(){t(this,"currentState",DS.RootState.empty);var e=DS.Errors.create();e.registerHandlers(this,function(){this.send("becameInvalid")},function(){this.send("becameValid")}),t(this,"errors",e),this._super(),this._setup()},_setup:function(){this._changesToSync={},this._deferredTriggers=[],this._data={},this._attributes={},this._inFlightAttributes={},this._relationships={}},send:function(t,i){var r=e(this,"currentState");return r[t]||this._unhandledEvent(r,t,i),r[t](this,i)},transitionTo:function(i){var r=i.split(".",1),n=e(this,"currentState"),o=n;do o.exit&&o.exit(this),o=o.parentState;while(!o.hasOwnProperty(r));var s,a,l=i.split("."),d=[],h=[];for(s=0,a=l.length;a>s;s++)o=o[l[s]],o.enter&&h.push(o),o.setup&&d.push(o);for(s=0,a=h.length;a>s;s++)h[s].enter(this);for(t(this,"currentState",o),s=0,a=d.length;a>s;s++)d[s].setup(this);this.updateRecordArraysLater()},_unhandledEvent:function(e,t,i){var r="Attempted to handle event `"+t+"` ";throw r+="on "+String(this)+" while in state ",r+=e.stateName+". ",void 0!==i&&(r+="Called with "+Ember.inspect(i)+"."),new Ember.Error(r)},withTransaction:function(t){var i=e(this,"transaction");i&&t(i)},loadingData:function(e){this.send("loadingData",e)},loadedData:function(){this.send("loadedData")},notFound:function(){this.send("notFound")},pushedData:function(){this.send("pushedData")},deleteRecord:function(){this.send("deleteRecord")},destroyRecord:function(){return this.deleteRecord(),this.save()},unloadRecord:function(){Ember.assert("You can only unload a loaded, non-dirty record.",!e(this,"isDirty")),this.send("unloadRecord")},clearRelationships:function(){this.eachRelationship(function(e,i){if("belongsTo"===i.kind)t(this,e,null);else if("hasMany"===i.kind){var r=this._relationships[i.name];r&&r.clear()}},this)},updateRecordArrays:function(){e(this,"store").dataWasUpdated(this.constructor,this)},changedAttributes:function(){var t,i=e(this,"_data"),r=e(this,"_attributes"),n={};for(t in r)n[t]=[i[t],r[t]];return n},adapterWillCommit:function(){this.send("willCommit")},adapterDidCommit:function(e){t(this,"isError",!1),e?this._data=e:Ember.mixin(this._data,this._inFlightAttributes),this._inFlightAttributes={},this.send("didCommit"),this.updateRecordArraysLater(),e&&this.suspendRelationshipObservers(function(){this.notifyPropertyChange("data")})},adapterDidDirty:function(){this.send("becomeDirty"),this.updateRecordArraysLater()},dataDidChange:Ember.observer(function(){this.reloadHasManys()},"data"),reloadHasManys:function(){var t=e(this.constructor,"relationshipsByName");this.updateRecordArraysLater(),t.forEach(function(e,t){this._data.links&&this._data.links[e]||"hasMany"===t.kind&&this.hasManyDidChange(t.key)},this)},hasManyDidChange:function(e){var i=this._relationships[e];if(i){var r=this._data[e]||[];t(i,"content",Ember.A(r)),t(i,"isLoaded",!0),i.trigger("didLoad")}},updateRecordArraysLater:function(){Ember.run.once(this,this.updateRecordArrays)},setupData:function(e,t){t?Ember.merge(this._data,e):this._data=e;var i=this._relationships;this.eachRelationship(function(t,r){e.links&&e.links[t]||r.options.async&&(i[t]=null)}),e&&this.pushedData(),this.suspendRelationshipObservers(function(){this.notifyPropertyChange("data")})},materializeId:function(e){t(this,"id",e)},materializeAttributes:function(e){Ember.assert("Must pass a hash of attributes to materializeAttributes",!!e),i(this._data,e)},materializeAttribute:function(e,t){this._data[e]=t},updateHasMany:function(e,t){this._data[e]=t,this.hasManyDidChange(e)},updateBelongsTo:function(e,t){this._data[e]=t},rollback:function(){this._attributes={},e(this,"isError")&&(this._inFlightAttributes={},t(this,"isError",!1)),e(this,"isValid")||(this._inFlightAttributes={}),this.send("rolledBack"),this.suspendRelationshipObservers(function(){this.notifyPropertyChange("data")})},toStringExtension:function(){return e(this,"id")},suspendRelationshipObservers:function(t,i){var r=e(this.constructor,"relationshipNames").belongsTo,n=this;try{this._suspendedRelationships=!0,Ember._suspendObservers(n,r,null,"belongsToDidChange",function(){Ember._suspendBeforeObservers(n,r,null,"belongsToWillChange",function(){t.call(i||n)})})}finally{this._suspendedRelationships=!1}},save:function(){var e="DS: Model#save "+this,t=Ember.RSVP.defer(e);return this.get("store").scheduleSave(this,t),this._inFlightAttributes=this._attributes,this._attributes={},DS.PromiseObject.create({promise:t.promise})},reload:function(){t(this,"isReloading",!0);var e=this,i="DS: Model#reload of "+this,r=new Ember.RSVP.Promise(function(t){e.send("reloadRecord",t)},i).then(function(){return e.set("isReloading",!1),e.set("isError",!1),e},function(t){throw e.set("isError",!0),t},"DS: Model#reload complete, update flags");return DS.PromiseObject.create({promise:r})},adapterDidUpdateAttribute:function(e,t){void 0!==t?(this._data[e]=t,this.notifyPropertyChange(e)):this._data[e]=this._inFlightAttributes[e],this.updateRecordArraysLater()},adapterDidInvalidate:function(t){function i(e){t[e]&&r.add(e,t[e])}var r=e(this,"errors");this.eachAttribute(i),this.eachRelationship(i)},adapterDidError:function(){this.send("becameError"),t(this,"isError",!0)},trigger:function(e){Ember.tryInvoke(this,e,[].slice.call(arguments,1)),this._super.apply(this,arguments)},triggerLater:function(){this._deferredTriggers.push(arguments),r(this,"_triggerDeferredTriggers")},_triggerDeferredTriggers:function(){for(var e=0,t=this._deferredTriggers.length;t>e;e++)this.trigger.apply(this,this._deferredTriggers[e]);this._deferredTriggers=[]}}),DS.Model.reopenClass({_create:DS.Model.create,create:function(){throw new Ember.Error("You should not call `create` on a model. Instead, call `store.createRecord` with the attributes you would like to set.")}})}(),function(){function e(e,t){return"function"==typeof t.defaultValue?t.defaultValue():t.defaultValue}function t(e,t){return e._attributes.hasOwnProperty(t)||e._inFlightAttributes.hasOwnProperty(t)||e._data.hasOwnProperty(t)}function i(e,t){return e._attributes.hasOwnProperty(t)?e._attributes[t]:e._inFlightAttributes.hasOwnProperty(t)?e._inFlightAttributes[t]:e._data[t]}var r=Ember.get;DS.Model.reopenClass({attributes:Ember.computed(function(){var e=Ember.Map.create();return this.eachComputedProperty(function(t,i){i.isAttribute&&(Ember.assert("You may not set `id` as an attribute on your model. Please remove any lines that look like: `id: DS.attr('<type>')` from "+this.toString(),"id"!==t),i.name=t,e.set(t,i))}),e}),transformedAttributes:Ember.computed(function(){var e=Ember.Map.create();return this.eachAttribute(function(t,i){i.type&&e.set(t,i.type)}),e}),eachAttribute:function(e,t){r(this,"attributes").forEach(function(i,r){e.call(t,i,r)},t)},eachTransformedAttribute:function(e,t){r(this,"transformedAttributes").forEach(function(i,r){e.call(t,i,r)})}}),DS.Model.reopen({eachAttribute:function(e,t){this.constructor.eachAttribute(e,t)}}),DS.attr=function(r,n){n=n||{};var o={type:r,isAttribute:!0,options:n};return Ember.computed(function(r,o){if(arguments.length>1){Ember.assert("You may not set `id` as an attribute on your model. Please remove any lines that look like: `id: DS.attr('<type>')` from "+this.constructor.toString(),"id"!==r);var s=this._attributes[r]||this._inFlightAttributes[r]||this._data[r];return this.send("didSetProperty",{name:r,oldValue:s,originalValue:this._data[r],value:o}),this._attributes[r]=o,o}return t(this,r)?i(this,r):e(this,n,r)}).property("data").meta(o)}}(),function(){var e=DS.AttributeChange=function(e){this.record=e.record,this.store=e.store,this.name=e.name,this.value=e.value,this.oldValue=e.oldValue};e.createChange=function(t){return new e(t)},e.prototype={sync:function(){this.value!==this.oldValue&&(this.record.send("becomeDirty"),this.record.updateRecordArraysLater()),this.destroy()},destroy:function(){delete this.record._changesToSync[this.name]}}}(),function(){function e(e){return"object"==typeof e&&(!e.then||"function"!=typeof e.then)}var t=Ember.get,i=Ember.set,r=Ember.EnumerableUtils.forEach;DS.RelationshipChange=function(e){this.parentRecord=e.parentRecord,this.childRecord=e.childRecord,this.firstRecord=e.firstRecord,this.firstRecordKind=e.firstRecordKind,this.firstRecordName=e.firstRecordName,this.secondRecord=e.secondRecord,this.secondRecordKind=e.secondRecordKind,this.secondRecordName=e.secondRecordName,this.changeType=e.changeType,this.store=e.store,this.committed={}},DS.RelationshipChangeAdd=function(e){DS.RelationshipChange.call(this,e)},DS.RelationshipChangeRemove=function(e){DS.RelationshipChange.call(this,e)},DS.RelationshipChange.create=function(e){return new DS.RelationshipChange(e)},DS.RelationshipChangeAdd.create=function(e){return new DS.RelationshipChangeAdd(e)},DS.RelationshipChangeRemove.create=function(e){return new DS.RelationshipChangeRemove(e)},DS.OneToManyChange={},DS.OneToNoneChange={},DS.ManyToNoneChange={},DS.OneToOneChange={},DS.ManyToManyChange={},DS.RelationshipChange._createChange=function(e){return"add"===e.changeType?DS.RelationshipChangeAdd.create(e):"remove"===e.changeType?DS.RelationshipChangeRemove.create(e):void 0},DS.RelationshipChange.determineRelationshipType=function(e,t){var i,r,n=t.key,o=t.kind,s=e.inverseFor(n);return s&&(i=s.name,r=s.kind),s?"belongsTo"===r?"belongsTo"===o?"oneToOne":"manyToOne":"belongsTo"===o?"oneToMany":"manyToMany":"belongsTo"===o?"oneToNone":"manyToNone"},DS.RelationshipChange.createChange=function(e,t,i,r){var n,o=e.constructor;return n=DS.RelationshipChange.determineRelationshipType(o,r),"oneToMany"===n?DS.OneToManyChange.createChange(e,t,i,r):"manyToOne"===n?DS.OneToManyChange.createChange(t,e,i,r):"oneToNone"===n?DS.OneToNoneChange.createChange(e,t,i,r):"manyToNone"===n?DS.ManyToNoneChange.createChange(e,t,i,r):"oneToOne"===n?DS.OneToOneChange.createChange(e,t,i,r):"manyToMany"===n?DS.ManyToManyChange.createChange(e,t,i,r):void 0},DS.OneToNoneChange.createChange=function(e,t,i,r){var n=r.key,o=DS.RelationshipChange._createChange({parentRecord:t,childRecord:e,firstRecord:e,store:i,changeType:r.changeType,firstRecordName:n,firstRecordKind:"belongsTo"});return i.addRelationshipChangeFor(e,n,t,null,o),o},DS.ManyToNoneChange.createChange=function(e,t,i,r){var n=r.key,o=DS.RelationshipChange._createChange({parentRecord:e,childRecord:t,secondRecord:e,store:i,changeType:r.changeType,secondRecordName:r.key,secondRecordKind:"hasMany"});return i.addRelationshipChangeFor(e,n,t,null,o),o},DS.ManyToManyChange.createChange=function(e,t,i,r){var n=r.key,o=DS.RelationshipChange._createChange({parentRecord:t,childRecord:e,firstRecord:e,secondRecord:t,firstRecordKind:"hasMany",secondRecordKind:"hasMany",store:i,changeType:r.changeType,firstRecordName:n});return i.addRelationshipChangeFor(e,n,t,null,o),o},DS.OneToOneChange.createChange=function(e,t,i,r){var n;r.parentType?n=r.parentType.inverseFor(r.key).name:r.key?n=r.key:Ember.assert("You must pass either a parentType or belongsToName option to OneToManyChange.forChildAndParent",!1);var o=DS.RelationshipChange._createChange({parentRecord:t,childRecord:e,firstRecord:e,secondRecord:t,firstRecordKind:"belongsTo",secondRecordKind:"belongsTo",store:i,changeType:r.changeType,firstRecordName:n});return i.addRelationshipChangeFor(e,n,t,null,o),o},DS.OneToOneChange.maintainInvariant=function(e,i,r,n){if("add"===e.changeType&&i.recordIsMaterialized(r)){var o=t(r,n);if(o){var s=DS.OneToOneChange.createChange(r,o,i,{parentType:e.parentType,hasManyName:e.hasManyName,changeType:"remove",key:e.key});i.addRelationshipChangeFor(r,n,e.parentRecord,null,s),s.sync()}}},DS.OneToManyChange.createChange=function(e,t,i,r){var n;r.parentType?(n=r.parentType.inverseFor(r.key).name,DS.OneToManyChange.maintainInvariant(r,i,e,n)):r.key?n=r.key:Ember.assert("You must pass either a parentType or belongsToName option to OneToManyChange.forChildAndParent",!1);var o=DS.RelationshipChange._createChange({parentRecord:t,childRecord:e,firstRecord:e,secondRecord:t,firstRecordKind:"belongsTo",secondRecordKind:"hasMany",store:i,changeType:r.changeType,firstRecordName:n});return i.addRelationshipChangeFor(e,n,t,o.getSecondRecordName(),o),o},DS.OneToManyChange.maintainInvariant=function(e,i,r,n){if("add"===e.changeType&&r){var o=t(r,n);if(o){var s=DS.OneToManyChange.createChange(r,o,i,{parentType:e.parentType,hasManyName:e.hasManyName,changeType:"remove",key:e.key});i.addRelationshipChangeFor(r,n,e.parentRecord,s.getSecondRecordName(),s),s.sync()}}},DS.RelationshipChange.prototype={getSecondRecordName:function(){var e,t=this.secondRecordName;if(!t){if(e=this.secondRecord,!e)return;var i=this.firstRecord.constructor,r=i.inverseFor(this.firstRecordName);this.secondRecordName=r.name}return this.secondRecordName},getFirstRecordName:function(){var e=this.firstRecordName;return e},destroy:function(){var e=this.childRecord,t=this.getFirstRecordName(),i=this.getSecondRecordName(),r=this.store;r.removeRelationshipChangeFor(e,t,this.parentRecord,i,this.changeType)},getSecondRecord:function(){return this.secondRecord},getFirstRecord:function(){return this.firstRecord},coalesce:function(){var e=this.store.relationshipChangePairsFor(this.firstRecord);r(e,function(e){var t=e.add,i=e.remove;t&&i&&(t.destroy(),i.destroy())})}},DS.RelationshipChangeAdd.prototype=Ember.create(DS.RelationshipChange.create({})),DS.RelationshipChangeRemove.prototype=Ember.create(DS.RelationshipChange.create({})),DS.RelationshipChangeAdd.prototype.changeType="add",DS.RelationshipChangeAdd.prototype.sync=function(){var r=this.getSecondRecordName(),n=this.getFirstRecordName(),o=this.getFirstRecord(),s=this.getSecondRecord();s instanceof DS.Model&&o instanceof DS.Model&&("belongsTo"===this.secondRecordKind?s.suspendRelationshipObservers(function(){i(s,r,o)}):"hasMany"===this.secondRecordKind&&s.suspendRelationshipObservers(function(){var i=t(s,r);e(i)&&i.addObject(o)})),o instanceof DS.Model&&s instanceof DS.Model&&t(o,n)!==s&&("belongsTo"===this.firstRecordKind?o.suspendRelationshipObservers(function(){i(o,n,s)}):"hasMany"===this.firstRecordKind&&o.suspendRelationshipObservers(function(){var i=t(o,n);e(i)&&i.addObject(s)})),this.coalesce()},DS.RelationshipChangeRemove.prototype.changeType="remove",DS.RelationshipChangeRemove.prototype.sync=function(){var r=this.getSecondRecordName(),n=this.getFirstRecordName(),o=this.getFirstRecord(),s=this.getSecondRecord();s instanceof DS.Model&&o instanceof DS.Model&&("belongsTo"===this.secondRecordKind?s.suspendRelationshipObservers(function(){i(s,r,null)}):"hasMany"===this.secondRecordKind&&s.suspendRelationshipObservers(function(){var i=t(s,r);e(i)&&i.removeObject(o)})),o instanceof DS.Model&&t(o,n)&&("belongsTo"===this.firstRecordKind?o.suspendRelationshipObservers(function(){i(o,n,null)}):"hasMany"===this.firstRecordKind&&o.suspendRelationshipObservers(function(){var i=t(o,n);e(i)&&i.removeObject(s)})),this.coalesce()}}(),function(){function e(e,r,n){return Ember.computed(function(r,o){var s=t(this,"data"),a=t(this,"store"),l="DS: Async belongsTo "+this+" : "+r;if(2===arguments.length)return Ember.assert("You can only add a '"+e+"' record to this relationship",!o||o instanceof a.modelFor(e)),void 0===o?null:DS.PromiseObject.create({promise:Ember.RSVP.resolve(o,l)});var d=s.links&&s.links[r],h=s[r];if(i(h)){if(d){var u=Ember.RSVP.defer("DS: Async belongsTo (link) "+this+" : "+r);return a.findBelongsTo(this,d,n,u),DS.PromiseObject.create({promise:u.promise})}return null}var c=a.fetchRecord(h)||Ember.RSVP.resolve(h,l);return DS.PromiseObject.create({promise:c})}).property("data").meta(n)}var t=Ember.get,i=(Ember.set,Ember.isNone);DS.belongsTo=function(r,n){"object"==typeof r?(n=r,r=void 0):Ember.assert("The first argument DS.belongsTo must be a model type or string, like DS.belongsTo(App.Person)",!!r&&("string"==typeof r||DS.Model.detect(r))),n=n||{};var o={type:r,isRelationship:!0,options:n,kind:"belongsTo"};return n.async?e(r,n,o):Ember.computed(function(e,n){var o,s,a=t(this,"data"),l=t(this,"store");return s="string"==typeof r?l.modelFor(r):r,2===arguments.length?(Ember.assert("You can only add a '"+r+"' record to this relationship",!n||n instanceof s),void 0===n?null:n):(o=a[e],i(o)?null:(l.fetchRecord(o),o))}).property("data").meta(o)},DS.Model.reopen({belongsToWillChange:Ember.beforeObserver(function(e,i){if(t(e,"isLoaded")){var r=t(e,i);if(r){var n=t(e,"store"),o=DS.RelationshipChange.createChange(e,r,n,{key:i,kind:"belongsTo",changeType:"remove"});o.sync(),this._changesToSync[i]=o}}}),belongsToDidChange:Ember.immediateObserver(function(e,i){if(t(e,"isLoaded")){var r=t(e,i);if(r){var n=t(e,"store"),o=DS.RelationshipChange.createChange(e,r,n,{key:i,kind:"belongsTo",changeType:"add"});o.sync()}}delete this._changesToSync[i]})})}(),function(){function e(e,i,r){return Ember.computed(function(e){var o=this._relationships[e],s="DS: Async hasMany "+this+" : "+e;if(!o){var a=Ember.RSVP.defer(s);o=t(this,e,i,function(t,i){var o,s=i.links&&i.links[e];return o=s?t.findHasMany(this,s,r,a):t.findMany(this,i[e],r.type,a),n(o,"promise",a.promise),o})}var l=o.get("promise").then(function(){return o},null,"DS: Async hasMany records received");return DS.PromiseArray.create({promise:l})}).property("data").meta(r)}function t(e,t,i,n){var s=e._relationships;if(s[t])return s[t];var a=r(e,"data"),l=r(e,"store"),d=s[t]=n.call(e,l,a);return o(d,{owner:e,name:t,isPolymorphic:i.polymorphic})}function i(i,r){r=r||{};var n={type:i,isRelationship:!0,options:r,kind:"hasMany"};return r.async?e(i,r,n):Ember.computed(function(e){return t(this,e,r,function(t,i){var r=i[e];return Ember.assert("You looked up the '"+e+"' relationship on '"+this+"' but some of the associated records were not loaded. Either make sure they are all loaded together with the parent record, or specify that the relationship is async (`DS.hasMany({ async: true })`)",Ember.A(r).everyProperty("isEmpty",!1)),t.findMany(this,i[e],n.type)})}).property("data").meta(n)}var r=Ember.get,n=Ember.set,o=Ember.setProperties;DS.hasMany=function(e,t){return"object"==typeof e&&(t=e,e=void 0),i(e,t)}}(),function(){{var e=Ember.get;Ember.set}DS.Model.reopen({didDefineProperty:function(e,t,i){if(i instanceof Ember.Descriptor){var r=i.meta();r.isRelationship&&"belongsTo"===r.kind&&(Ember.addObserver(e,t,null,"belongsToDidChange"),Ember.addBeforeObserver(e,t,null,"belongsToWillChange")),r.parentType=e.constructor}}}),DS.Model.reopenClass({typeForRelationship:function(t){var i=e(this,"relationshipsByName").get(t);return i&&i.type},inverseFor:function(t){function i(t,r,n){n=n||[];var o=e(r,"relationships");if(o){var s=o.get(t);return s&&n.push.apply(n,o.get(t)),t.superclass&&i(t.superclass,r,n),n}}var r=this.typeForRelationship(t);if(!r)return null;var n=this.metaForProperty(t).options;if(null===n.inverse)return null;var o,s;if(n.inverse)o=n.inverse,s=Ember.get(r,"relationshipsByName").get(o).kind;else{var a=i(this,r);if(0===a.length)return null;Ember.assert("You defined the '"+t+"' relationship on "+this+", but multiple possible inverse relationships of type "+this+" were found on "+r+". Look at http://emberjs.com/guides/models/defining-models/#toc_explicit-inverses for how to explicitly specify inverses",1===a.length),o=a[0].name,s=a[0].kind}return{type:r,name:o,kind:s}},relationships:Ember.computed(function(){var e=new Ember.MapWithDefault({defaultValue:function(){return[]}});return this.eachComputedProperty(function(t,i){if(i.isRelationship){"string"==typeof i.type&&(i.type=this.store.modelFor(i.type));var r=e.get(i.type);r.push({name:t,kind:i.kind})}}),e}),relationshipNames:Ember.computed(function(){var e={hasMany:[],belongsTo:[]};return this.eachComputedProperty(function(t,i){i.isRelationship&&e[i.kind].push(t)}),e}),relatedTypes:Ember.computed(function(){var t,i=Ember.A();return this.eachComputedProperty(function(r,n){n.isRelationship&&(t=n.type,"string"==typeof t&&(t=e(this,t,!1)||this.store.modelFor(t)),Ember.assert("You specified a hasMany ("+n.type+") on "+n.parentType+" but "+n.type+" was not found.",t),i.contains(t)||(Ember.assert("Trying to sideload "+r+" on "+this.toString()+" but the type doesn't exist.",!!t),i.push(t)))}),i}),relationshipsByName:Ember.computed(function(){var e,t=Ember.Map.create();return this.eachComputedProperty(function(i,r){r.isRelationship&&(r.key=i,e=r.type,e||"hasMany"!==r.kind?e||(e=i):e=Ember.String.singularize(i),"string"==typeof e&&(r.type=this.store.modelFor(e)),t.set(i,r))}),t}),fields:Ember.computed(function(){var e=Ember.Map.create();return this.eachComputedProperty(function(t,i){i.isRelationship?e.set(t,i.kind):i.isAttribute&&e.set(t,"attribute")}),e}),eachRelationship:function(t,i){e(this,"relationshipsByName").forEach(function(e,r){t.call(i,e,r)})},eachRelatedType:function(t,i){e(this,"relatedTypes").forEach(function(e){t.call(i,e)})}}),DS.Model.reopen({eachRelationship:function(e,t){this.constructor.eachRelationship(e,t)}})}(),function(){var e=Ember.get,t=(Ember.set,Ember.run.once),i=Ember.EnumerableUtils.forEach;DS.RecordArrayManager=Ember.Object.extend({init:function(){this.filteredRecordArrays=Ember.MapWithDefault.create({defaultValue:function(){return[]}}),this.changedRecords=[]},recordDidChange:function(e){this.changedRecords.push(e),t(this,this.updateRecordArrays)},recordArraysForRecord:function(e){return e._recordArrays=e._recordArrays||Ember.OrderedSet.create(),e._recordArrays},updateRecordArrays:function(){i(this.changedRecords,function(t){e(t,"isDeleted")?this._recordWasDeleted(t):this._recordWasChanged(t)},this),this.changedRecords=[]},_recordWasDeleted:function(e){var t=e._recordArrays;t&&i(t,function(t){t.removeRecord(e)})},_recordWasChanged:function(t){var r,n=t.constructor,o=this.filteredRecordArrays.get(n);i(o,function(i){r=e(i,"filterFunction"),this.updateRecordArray(i,r,n,t)},this);var s=t._loadingRecordArrays;if(s){for(var a=0,l=s.length;l>a;a++)s[a].loadedRecord();t._loadingRecordArrays=[]}},updateRecordArray:function(e,t,i,r){var n;n=t?t(r):!0;var o=this.recordArraysForRecord(r);n?(o.add(e),e.addRecord(r)):n||(o.remove(e),e.removeRecord(r))},updateFilter:function(t,i,r){for(var n,o=this.store.typeMapFor(i),s=o.records,a=0,l=s.length;l>a;a++)n=s[a],e(n,"isDeleted")||e(n,"isEmpty")||this.updateRecordArray(t,r,i,n)},createManyArray:function(e,t){var r=DS.ManyArray.create({type:e,content:t,store:this.store});return i(t,function(e){var t=this.recordArraysForRecord(e);t.add(r)},this),r},createRecordArray:function(e){var t=DS.RecordArray.create({type:e,content:Ember.A(),store:this.store,isLoaded:!0});return this.registerFilteredRecordArray(t,e),t},createFilteredRecordArray:function(e,t){var i=DS.FilteredRecordArray.create({type:e,content:Ember.A(),store:this.store,manager:this,filterFunction:t});return this.registerFilteredRecordArray(i,e,t),i},createAdapterPopulatedRecordArray:function(e,t){return DS.AdapterPopulatedRecordArray.create({type:e,query:t,content:Ember.A(),store:this.store})},registerFilteredRecordArray:function(e,t,i){var r=this.filteredRecordArrays.get(t);r.push(e),this.updateFilter(e,t,i)},registerWaitingRecordArray:function(e,t){var i=e._loadingRecordArrays||[];i.push(t),e._loadingRecordArrays=i}})}(),function(){var e=Ember.get,t=(Ember.set,Ember.ArrayPolyfills.map),i=["description","fileName","lineNumber","message","name","number","stack"];DS.InvalidError=function(e){var t=Error.prototype.constructor.call(this,"The backend rejected the commit because it was invalid: "+Ember.inspect(e));this.errors=e;for(var r=0,n=i.length;n>r;r++)this[i[r]]=t[i[r]]},DS.InvalidError.prototype=Ember.create(Error.prototype),DS.Adapter=Ember.Object.extend({find:Ember.required(Function),findAll:null,findQuery:null,generateIdForRecord:null,serialize:function(t,i){return e(t,"store").serializerFor(t.constructor.typeKey).serialize(t,i)},createRecord:Ember.required(Function),updateRecord:Ember.required(Function),deleteRecord:Ember.required(Function),findMany:function(e,i,r){var n=t.call(r,function(t){return this.find(e,i,t)},this);return Ember.RSVP.all(n)}})}(),function(){var e=Ember.get,t=Ember.String.fmt,i=Ember.EnumerableUtils.indexOf,r=0;DS.FixtureAdapter=DS.Adapter.extend({serializer:null,simulateRemoteResponse:!0,latency:50,fixturesForType:function(e){if(e.FIXTURES){var i=Ember.A(e.FIXTURES);return i.map(function(e){var i=typeof e.id;if("number"!==i&&"string"!==i)throw new Error(t("the id property must be defined as a number or string for fixture %@",[e]));
return e.id=e.id+"",e})}return null},queryFixtures:function(){Ember.assert("Not implemented: You must override the DS.FixtureAdapter::queryFixtures method to support querying the fixture store.")},updateFixtures:function(e,t){e.FIXTURES||(e.FIXTURES=[]);var i=e.FIXTURES;this.deleteLoadedFixture(e,t),i.push(t)},mockJSON:function(e,t,i){return e.serializerFor(t).serialize(i,{includeId:!0})},generateIdForRecord:function(){return"fixture-"+r++},find:function(e,t,i){var r,n=this.fixturesForType(t);return Ember.assert("Unable to find fixtures for model type "+t.toString(),n),n&&(r=Ember.A(n).findProperty("id",i)),r?this.simulateRemoteCall(function(){return r},this):void 0},findMany:function(e,t,r){var n=this.fixturesForType(t);return Ember.assert("Unable to find fixtures for model type "+t.toString(),n),n&&(n=n.filter(function(e){return-1!==i(r,e.id)})),n?this.simulateRemoteCall(function(){return n},this):void 0},findAll:function(e,t){var i=this.fixturesForType(t);return Ember.assert("Unable to find fixtures for model type "+t.toString(),i),this.simulateRemoteCall(function(){return i},this)},findQuery:function(e,t,i){var r=this.fixturesForType(t);return Ember.assert("Unable to find fixtures for model type "+t.toString(),r),r=this.queryFixtures(r,i,t),r?this.simulateRemoteCall(function(){return r},this):void 0},createRecord:function(e,t,i){var r=this.mockJSON(e,t,i);return this.updateFixtures(t,r),this.simulateRemoteCall(function(){return r},this)},updateRecord:function(e,t,i){var r=this.mockJSON(e,t,i);return this.updateFixtures(t,r),this.simulateRemoteCall(function(){return r},this)},deleteRecord:function(e,t,i){var r=this.mockJSON(e,t,i);return this.deleteLoadedFixture(t,r),this.simulateRemoteCall(function(){return null})},deleteLoadedFixture:function(e,t){var r=this.findExistingFixture(e,t);if(r){var n=i(e.FIXTURES,r);return e.FIXTURES.splice(n,1),!0}},findExistingFixture:function(t,i){var r=this.fixturesForType(t),n=e(i,"id");return this.findFixtureById(r,n)},findFixtureById:function(t,i){return Ember.A(t).find(function(t){return""+e(t,"id")==""+i?!0:!1})},simulateRemoteCall:function(t,i){var r=this;return new Ember.RSVP.Promise(function(n){e(r,"simulateRemoteResponse")?Ember.run.later(function(){n(t.call(i))},e(r,"latency")):Ember.run.schedule("actions",null,function(){n(t.call(i))})},"DS: FixtureAdapter#simulateRemoteCall")}})}(),function(){function e(e){return null==e?null:e+""}var t=Ember.get,i=(Ember.set,Ember.ArrayPolyfills.forEach),r=Ember.ArrayPolyfills.map;DS.RESTSerializer=DS.JSONSerializer.extend({normalize:function(e,t,i){return this.normalizeId(t),this.normalizeAttributes(e,t),this.normalizeRelationships(e,t),this.normalizeUsingDeclaredMapping(e,t),this.normalizeHash&&this.normalizeHash[i]&&this.normalizeHash[i](t),this._super(e,t,i)},normalizePayload:function(e,t){return t},normalizeId:function(e){var i=t(this,"primaryKey");"id"!==i&&(e.id=e[i],delete e[i])},normalizeUsingDeclaredMapping:function(e,i){var r,n,o=t(this,"attrs");if(o)for(n in o)r=o[n],r&&r.key&&(r=r.key),"string"==typeof r&&(i[n]=i[r],delete i[r])},normalizeAttributes:function(e,t){var i;this.keyForAttribute&&e.eachAttribute(function(e){i=this.keyForAttribute(e),e!==i&&(t[e]=t[i],delete t[i])},this)},normalizeRelationships:function(e,t){var i;this.keyForRelationship&&e.eachRelationship(function(e,r){i=this.keyForRelationship(e,r.kind),e!==i&&(t[e]=t[i],delete t[i])},this)},extractSingle:function(t,r,n,o){n=this.normalizePayload(r,n);var s,a=r.typeKey;for(var l in n){var d=this.typeForRoot(l),h=d===a;if(h&&"array"!==Ember.typeOf(n[l]))s=this.normalize(r,n[l],l);else{{t.modelFor(d)}i.call(n[l],function(i){var r=this.typeForRoot(l),n=t.modelFor(r),a=t.serializerFor(n);i=a.normalize(n,i,l);var d=h&&!o&&!s,u=h&&e(i.id)===o;d||u?s=i:t.push(r,i)},this)}}return s},extractArray:function(e,t,i){i=this.normalizePayload(t,i);var n,o=t.typeKey;for(var s in i){var a=s,l=!1;"_"===s.charAt(0)&&(l=!0,a=s.substr(1));var d=this.typeForRoot(a),h=e.modelFor(d),u=e.serializerFor(h),c=!l&&d===o,f=r.call(i[s],function(e){return u.normalize(h,e,s)},this);c?n=f:e.pushMany(d,f)}return n},pushPayload:function(e,t){t=this.normalizePayload(null,t);for(var i in t){var n=this.typeForRoot(i),o=e.modelFor(n),s=r.call(Ember.makeArray(t[i]),function(e){return this.normalize(o,e,i)},this);e.pushMany(n,s)}},typeForRoot:function(e){return Ember.String.singularize(e)},serialize:function(){return this._super.apply(this,arguments)},serializeIntoHash:function(e,t,i,r){e[t.typeKey]=this.serialize(i,r)},serializePolymorphicType:function(e,i,r){var n=r.key,o=t(e,n);n=this.keyForAttribute?this.keyForAttribute(n):n,i[n+"Type"]=o.constructor.typeKey}})}(),function(){var e=Ember.get,t=(Ember.set,Ember.ArrayPolyfills.forEach);DS.RESTAdapter=DS.Adapter.extend({defaultSerializer:"_rest",find:function(e,t,i){return this.ajax(this.buildURL(t.typeKey,i),"GET")},findAll:function(e,t,i){var r;return i&&(r={since:i}),this.ajax(this.buildURL(t.typeKey),"GET",{data:r})},findQuery:function(e,t,i){return this.ajax(this.buildURL(t.typeKey),"GET",{data:i})},findMany:function(e,t,i){return this.ajax(this.buildURL(t.typeKey),"GET",{data:{ids:i}})},findHasMany:function(t,i,r){var n=e(this,"host"),o=e(i,"id"),s=i.constructor.typeKey;return n&&"/"===r.charAt(0)&&"/"!==r.charAt(1)&&(r=n+r),this.ajax(this.urlPrefix(r,this.buildURL(s,o)),"GET")},findBelongsTo:function(t,i,r){var n=e(i,"id"),o=i.constructor.typeKey;return this.ajax(this.urlPrefix(r,this.buildURL(o,n)),"GET")},createRecord:function(e,t,i){var r={},n=e.serializerFor(t.typeKey);return n.serializeIntoHash(r,t,i,{includeId:!0}),this.ajax(this.buildURL(t.typeKey),"POST",{data:r})},updateRecord:function(t,i,r){var n={},o=t.serializerFor(i.typeKey);o.serializeIntoHash(n,i,r);var s=e(r,"id");return this.ajax(this.buildURL(i.typeKey,s),"PUT",{data:n})},deleteRecord:function(t,i,r){var n=e(r,"id");return this.ajax(this.buildURL(i.typeKey,n),"DELETE")},buildURL:function(t,i){var r=[],n=e(this,"host"),o=this.urlPrefix();return t&&r.push(this.pathForType(t)),i&&r.push(i),o&&r.unshift(o),r=r.join("/"),!n&&r&&(r="/"+r),r},urlPrefix:function(t,i){var r=e(this,"host"),n=e(this,"namespace"),o=[];return t?"/"===t.charAt(0)?r&&(t=t.slice(1),o.push(r)):/^http(s)?:\/\//.test(t)||o.push(i):(r&&o.push(r),n&&o.push(n)),t&&o.push(t),o.join("/")},pathForType:function(e){return Ember.String.pluralize(e)},ajaxError:function(e){return e&&(e.then=null),e},ajax:function(e,t,i){var r=this;return new Ember.RSVP.Promise(function(n,o){i=r.ajaxOptions(e,t,i),i.success=function(e){Ember.run(null,n,e)},i.error=function(e){Ember.run(null,o,r.ajaxError(e))},Ember.$.ajax(i)},"DS: RestAdapter#ajax "+t+" to "+e)},ajaxOptions:function(e,i,r){if(r=r||{},r.url=e,r.type=i,r.dataType="json",r.context=this,r.data&&"GET"!==i&&(r.contentType="application/json; charset=utf-8",r.data=JSON.stringify(r.data)),void 0!==this.headers){var n=this.headers;r.beforeSend=function(e){t.call(Ember.keys(n),function(t){e.setRequestHeader(t,n[t])})}}return r}})}(),function(){DS.Model.reopen({_debugInfo:function(){var e=["id"],t={belongsTo:[],hasMany:[]},i=[];this.eachAttribute(function(t){e.push(t)},this),this.eachRelationship(function(e,r){t[r.kind].push(e),i.push(e)});var r=[{name:"Attributes",properties:e,expand:!0},{name:"Belongs To",properties:t.belongsTo,expand:!0},{name:"Has Many",properties:t.hasMany,expand:!0},{name:"Flags",properties:["isLoaded","isDirty","isSaving","isDeleted","isError","isNew","isValid"]}];return{propertyInfo:{includeOtherProperties:!0,groups:r,expensiveProperties:i}}}})}(),function(){Ember.String.pluralize=function(e){return Ember.Inflector.inflector.pluralize(e)},Ember.String.singularize=function(e){return Ember.Inflector.inflector.singularize(e)}}(),function(){function e(e,t){for(var i=0,r=t.length;r>i;i++)e.uncountable[t[i].toLowerCase()]=!0}function t(e,t){for(var i,r=0,n=t.length;n>r;r++)i=t[r],e.irregular[i[0].toLowerCase()]=i[1],e.irregularInverse[i[1].toLowerCase()]=i[0]}function i(i){i=i||{},i.uncountable=i.uncountable||{},i.irregularPairs=i.irregularPairs||{};var r=this.rules={plurals:i.plurals||[],singular:i.singular||[],irregular:{},irregularInverse:{},uncountable:{}};e(r,i.uncountable),t(r,i.irregularPairs)}var r=/^\s*$/;i.prototype={plural:function(e,t){this.rules.plurals.push([e,t.toLowerCase()])},singular:function(e,t){this.rules.singular.push([e,t.toLowerCase()])},uncountable:function(t){e(this.rules,[t.toLowerCase()])},irregular:function(e,i){t(this.rules,[[e,i]])},pluralize:function(e){return this.inflect(e,this.rules.plurals,this.rules.irregular)},singularize:function(e){return this.inflect(e,this.rules.singular,this.rules.irregularInverse)},inflect:function(e,t,i){var n,o,s,a,l,d,h,u;if(l=r.test(e))return e;if(a=e.toLowerCase(),d=this.rules.uncountable[a])return e;if(h=i&&i[a])return h;for(var c=t.length,f=0;c>f&&(n=t[c-1],u=n[0],!u.test(e));c--);return n=n||[],u=n[0],o=n[1],s=e.replace(u,o)}},Ember.Inflector=i}(),function(){Ember.Inflector.defaultRules={plurals:[[/$/,"s"],[/s$/i,"s"],[/^(ax|test)is$/i,"$1es"],[/(octop|vir)us$/i,"$1i"],[/(octop|vir)i$/i,"$1i"],[/(alias|status)$/i,"$1es"],[/(bu)s$/i,"$1ses"],[/(buffal|tomat)o$/i,"$1oes"],[/([ti])um$/i,"$1a"],[/([ti])a$/i,"$1a"],[/sis$/i,"ses"],[/(?:([^f])fe|([lr])f)$/i,"$1$2ves"],[/(hive)$/i,"$1s"],[/([^aeiouy]|qu)y$/i,"$1ies"],[/(x|ch|ss|sh)$/i,"$1es"],[/(matr|vert|ind)(?:ix|ex)$/i,"$1ices"],[/^(m|l)ouse$/i,"$1ice"],[/^(m|l)ice$/i,"$1ice"],[/^(ox)$/i,"$1en"],[/^(oxen)$/i,"$1"],[/(quiz)$/i,"$1zes"]],singular:[[/s$/i,""],[/(ss)$/i,"$1"],[/(n)ews$/i,"$1ews"],[/([ti])a$/i,"$1um"],[/((a)naly|(b)a|(d)iagno|(p)arenthe|(p)rogno|(s)ynop|(t)he)(sis|ses)$/i,"$1sis"],[/(^analy)(sis|ses)$/i,"$1sis"],[/([^f])ves$/i,"$1fe"],[/(hive)s$/i,"$1"],[/(tive)s$/i,"$1"],[/([lr])ves$/i,"$1f"],[/([^aeiouy]|qu)ies$/i,"$1y"],[/(s)eries$/i,"$1eries"],[/(m)ovies$/i,"$1ovie"],[/(x|ch|ss|sh)es$/i,"$1"],[/^(m|l)ice$/i,"$1ouse"],[/(bus)(es)?$/i,"$1"],[/(o)es$/i,"$1"],[/(shoe)s$/i,"$1"],[/(cris|test)(is|es)$/i,"$1is"],[/^(a)x[ie]s$/i,"$1xis"],[/(octop|vir)(us|i)$/i,"$1us"],[/(alias|status)(es)?$/i,"$1"],[/^(ox)en/i,"$1"],[/(vert|ind)ices$/i,"$1ex"],[/(matr)ices$/i,"$1ix"],[/(quiz)zes$/i,"$1"],[/(database)s$/i,"$1"]],irregularPairs:[["person","people"],["man","men"],["child","children"],["sex","sexes"],["move","moves"],["cow","kine"],["zombie","zombies"]],uncountable:["equipment","information","rice","money","species","series","fish","sheep","jeans","police"]}}(),function(){(Ember.EXTEND_PROTOTYPES===!0||Ember.EXTEND_PROTOTYPES.String)&&(String.prototype.pluralize=function(){return Ember.String.pluralize(this)},String.prototype.singularize=function(){return Ember.String.singularize(this)})}(),function(){Ember.Inflector.inflector=new Ember.Inflector(Ember.Inflector.defaultRules)}(),function(){var e=Ember.get,t=Ember.EnumerableUtils.forEach;DS.ActiveModelSerializer=DS.RESTSerializer.extend({keyForAttribute:function(e){return Ember.String.decamelize(e)},keyForRelationship:function(e,t){return e=Ember.String.decamelize(e),"belongsTo"===t?e+"_id":"hasMany"===t?Ember.String.singularize(e)+"_ids":e},serializeHasMany:Ember.K,serializeIntoHash:function(e,t,i,r){var n=Ember.String.decamelize(t.typeKey);e[n]=this.serialize(i,r)},serializePolymorphicType:function(t,i,r){var n=r.key,o=e(t,n);n=this.keyForAttribute(n),i[n+"_type"]=Ember.String.capitalize(o.constructor.typeKey)},typeForRoot:function(e){var t=Ember.String.camelize(e);return Ember.String.singularize(t)},normalize:function(e,t,i){return this.normalizeLinks(t),this._super(e,t,i)},normalizeLinks:function(e){if(e.links){var t=e.links;for(var i in t){var r=Ember.String.camelize(i);r!==i&&(t[r]=t[i],delete t[i])}}},normalizeRelationships:function(e,i){var r,n;this.keyForRelationship&&e.eachRelationship(function(e,o){if(o.options.polymorphic){if(r=this.keyForAttribute(e),n=i[r],n&&n.type)n.type=this.typeForRoot(n.type);else if(n&&"hasMany"===o.kind){var s=this;t(n,function(e){e.type=s.typeForRoot(e.type)})}}else r=this.keyForRelationship(e,o.kind),n=i[r];i[e]=n,e!==r&&delete i[r]},this)}})}(),function(){function e(r,n,o,s,a){var l=t(n,"attrs");l&&o.eachRelationship(function(n,o){var d,h,u,c,f=l[n],m=r.serializerFor(o.type.typeKey),p=t(m,"primaryKey");if("hasMany"===o.kind&&f&&("always"===f.embedded||"load"===f.embedded)){if(h="_"+Ember.String.pluralize(o.type.typeKey),d=this.keyForRelationship(n,o.kind),u=this.keyForAttribute(n),c=[],!s[u])return;a[h]=a[h]||[],i(s[u],function(t){var i=r.modelFor(o.type.typeKey);e(r,m,i,t,a),c.push(t[p]),a[h].push(t)}),s[d]=c,delete s[u]}},n)}var t=Ember.get,i=Ember.EnumerableUtils.forEach;DS.EmbeddedRecordsMixin=Ember.Mixin.create({serializeHasMany:function(e,i,r){var n=r.key,o=t(this,"attrs"),s=o&&o[n]&&"always"===o[n].embedded;s&&(i[this.keyForAttribute(n)]=t(e,n).map(function(e){var i=e.serialize(),r=t(this,"primaryKey");return i[r]=t(e,r),i},this))},extractSingle:function(t,i,r,n,o){var s=this.keyForAttribute(i.typeKey),a=r[s];return e(t,this,i,a,r),this._super(t,i,r,n,o)},extractArray:function(t,r,n){var o=this.keyForAttribute(r.typeKey),s=n[Ember.String.pluralize(o)];return i(s,function(i){e(t,this,r,i,n)},this),this._super(t,r,n)}})}(),function(){var e=Ember.EnumerableUtils.forEach;DS.ActiveModelAdapter=DS.RESTAdapter.extend({defaultSerializer:"_ams",pathForType:function(e){var t=Ember.String.decamelize(e);return Ember.String.pluralize(t)},ajaxError:function(t){var i=this._super(t);if(t&&422===t.status){var r=Ember.$.parseJSON(t.responseText).errors,n={};return e(Ember.keys(r),function(e){n[Ember.String.camelize(e)]=r[e]}),new DS.InvalidError(n)}return i}})}(),function(){Ember.onLoad("Ember.Application",function(e){e.initializer({name:"activeModelAdapter",initialize:function(e,t){t.register("serializer:_ams",DS.ActiveModelSerializer),t.register("adapter:_ams",DS.ActiveModelAdapter)}})})}()}(),!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):"object"==typeof exports?module.exports=e:e(jQuery)}(function(e){function t(t){var s=t||window.event,a=l.call(arguments,1),d=0,u=0,c=0,f=0,m=0,p=0;if(t=e.event.fix(s),t.type="mousewheel","detail"in s&&(c=-1*s.detail),"wheelDelta"in s&&(c=s.wheelDelta),"wheelDeltaY"in s&&(c=s.wheelDeltaY),"wheelDeltaX"in s&&(u=-1*s.wheelDeltaX),"axis"in s&&s.axis===s.HORIZONTAL_AXIS&&(u=-1*c,c=0),d=0===c?u:c,"deltaY"in s&&(c=-1*s.deltaY,d=c),"deltaX"in s&&(u=s.deltaX,0===c&&(d=-1*u)),0!==c||0!==u){if(1===s.deltaMode){var _=e.data(this,"mousewheel-line-height");d*=_,c*=_,u*=_}else if(2===s.deltaMode){var g=e.data(this,"mousewheel-page-height");d*=g,c*=g,u*=g}if(f=Math.max(Math.abs(c),Math.abs(u)),(!o||o>f)&&(o=f,r(s,f)&&(o/=40)),r(s,f)&&(d/=40,u/=40,c/=40),d=Math[d>=1?"floor":"ceil"](d/o),u=Math[u>=1?"floor":"ceil"](u/o),c=Math[c>=1?"floor":"ceil"](c/o),h.settings.normalizeOffset&&this.getBoundingClientRect){var v=this.getBoundingClientRect();m=t.clientX-v.left,p=t.clientY-v.top}return t.deltaX=u,t.deltaY=c,t.deltaFactor=o,t.offsetX=m,t.offsetY=p,t.deltaMode=0,a.unshift(t,d,u,c),n&&clearTimeout(n),n=setTimeout(i,200),(e.event.dispatch||e.event.handle).apply(this,a)}}function i(){o=null}function r(e,t){return h.settings.adjustOldDeltas&&"mousewheel"===e.type&&t%120===0}var n,o,s=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],a="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],l=Array.prototype.slice;if(e.event.fixHooks)for(var d=s.length;d;)e.event.fixHooks[s[--d]]=e.event.mouseHooks;var h=e.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var i=a.length;i;)this.addEventListener(a[--i],t,!1);else this.onmousewheel=t;e.data(this,"mousewheel-line-height",h.getLineHeight(this)),e.data(this,"mousewheel-page-height",h.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var i=a.length;i;)this.removeEventListener(a[--i],t,!1);else this.onmousewheel=null;e.removeData(this,"mousewheel-line-height"),e.removeData(this,"mousewheel-page-height")},getLineHeight:function(t){var i=e(t),r=i["offsetParent"in e.fn?"offsetParent":"parent"]();return r.length||(r=e("body")),parseInt(r.css("fontSize"),10)||parseInt(i.css("fontSize"),10)||16},getPageHeight:function(t){return e(t).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};e.fn.extend({mousewheel:function(e){return e?this.bind("mousewheel",e):this.trigger("mousewheel")},unmousewheel:function(e){return this.unbind("mousewheel",e)}})}),!function(){"use strict";function e(e){return e.split("").reverse().join("")}function t(e,t){return e.substring(0,t.length)===t}function i(e,t){return e.slice(-1*t.length)===t}function r(e,t,i){if((e[t]||e[i])&&e[t]===e[i])throw new Error(t)}function n(e){return"number"==typeof e&&isFinite(e)}function o(e,t){var i=Math.pow(10,t);return(Math.round(e*i)/i).toFixed(t)}function s(t,i,r,s,a,l,d,h,u,c,f,m){var p,_,g,v=m,y="",b="";return l&&(m=l(m)),n(m)?(t!==!1&&0===parseFloat(m.toFixed(t))&&(m=0),0>m&&(p=!0,m=Math.abs(m)),t!==!1&&(m=o(m,t)),m=m.toString(),-1!==m.indexOf(".")?(_=m.split("."),g=_[0],r&&(y=r+_[1])):g=m,i&&(g=e(g).match(/.{1,3}/g),g=e(g.join(e(i)))),p&&h&&(b+=h),s&&(b+=s),p&&u&&(b+=u),b+=g,b+=y,a&&(b+=a),c&&(b=c(b,v)),b):!1}function a(e,r,o,s,a,l,d,h,u,c,f,m){var p,_="";return f&&(m=f(m)),m&&"string"==typeof m?(h&&t(m,h)&&(m=m.replace(h,""),p=!0),s&&t(m,s)&&(m=m.replace(s,"")),u&&t(m,u)&&(m=m.replace(u,""),p=!0),a&&i(m,a)&&(m=m.slice(0,-1*a.length)),r&&(m=m.split(r).join("")),o&&(m=m.replace(o,".")),p&&(_+="-"),_+=m,_=_.replace(/[^0-9\.\-.]/g,""),""===_?!1:(_=Number(_),d&&(_=d(_)),n(_)?_:!1)):!1}function l(e){var t,i,n,o={};for(t=0;t<u.length;t+=1)if(i=u[t],n=e[i],void 0===n)o[i]="negative"!==i||o.negativeBefore?"mark"===i&&"."!==o.thousand?".":!1:"-";else if("decimals"===i){if(!(n>=0&&8>n))throw new Error(i);o[i]=n}else if("encoder"===i||"decoder"===i||"edit"===i||"undo"===i){if("function"!=typeof n)throw new Error(i);o[i]=n}else{if("string"!=typeof n)throw new Error(i);o[i]=n}return r(o,"mark","thousand"),r(o,"prefix","negative"),r(o,"prefix","negativeBefore"),o}function d(e,t,i){var r,n=[];for(r=0;r<u.length;r+=1)n.push(e[u[r]]);return n.push(i),t.apply("",n)}function h(e){return this instanceof h?void("object"==typeof e&&(e=l(e),this.to=function(t){return d(e,s,t)},this.from=function(t){return d(e,a,t)})):new h(e)}var u=["decimals","thousand","mark","prefix","postfix","encoder","decoder","negativeBefore","negative","edit","undo"];window.wNumb=h}(),function(e){"use strict";function t(t){return t instanceof e||e.zepto&&e.zepto.isZ(t)}function i(t,i){return"string"==typeof t&&0===t.indexOf("-inline-")?(this.method=i||"html",this.target=this.el=e(t.replace("-inline-","")||"<div/>"),!0):void 0}function r(t){if("string"==typeof t&&0!==t.indexOf("-")){this.method="val";var i=document.createElement("input");return i.name=t,i.type="hidden",this.target=this.el=e(i),!0}}function n(e){return"function"==typeof e?(this.target=!1,this.method=e,!0):void 0}function o(e,i){return t(e)&&!i?(e.is("input, select, textarea")?(this.method="val",this.target=e.on("change.liblink",this.changeHandler)):(this.target=e,this.method="html"),!0):void 0}function s(e,i){return t(e)&&("function"==typeof i||"string"==typeof i&&e[i])?(this.method=i,this.target=e,!0):void 0}function a(t,i,r){var n=this,o=!1;if(this.changeHandler=function(t){var i=n.formatInstance.from(e(this).val());return i===!1||isNaN(i)?(e(this).val(n.lastSetValue),!1):void n.changeHandlerMethod.call("",t,i)},this.el=!1,this.formatInstance=r,e.each(h,function(e,r){return o=r.call(n,t,i),!o}),!o)throw new RangeError("(Link) Invalid Link.")}function l(e){this.items=[],this.elements=[],this.origin=e}function d(t,i,r,n){0===t&&(t=this.LinkDefaultFlag),this.linkAPI||(this.linkAPI={}),this.linkAPI[t]||(this.linkAPI[t]=new l(this));var o=new a(i,r,n||this.LinkDefaultFormatter);o.target||(o.target=e(this)),o.changeHandlerMethod=this.LinkConfirm(t,o.el),this.linkAPI[t].push(o,o.el),this.LinkUpdate(t)}var h=[i,r,n,o,s];a.prototype.set=function(e){var t=Array.prototype.slice.call(arguments),i=t.slice(1);this.lastSetValue=this.formatInstance.to(e),i.unshift(this.lastSetValue),("function"==typeof this.method?this.method:this.target[this.method]).apply(this.target,i)},l.prototype.push=function(e,t){this.items.push(e),t&&this.elements.push(t)},l.prototype.reconfirm=function(e){var t;for(t=0;t<this.elements.length;t+=1)this.origin.LinkConfirm(e,this.elements[t])},l.prototype.remove=function(){var e;for(e=0;e<this.items.length;e+=1)this.items[e].target.off(".liblink");for(e=0;e<this.elements.length;e+=1)this.elements[e].remove()},l.prototype.change=function(e){if(this.origin.LinkIsEmitting)return!1;this.origin.LinkIsEmitting=!0;var t,i=Array.prototype.slice.call(arguments,1);for(i.unshift(e),t=0;t<this.items.length;t+=1)this.items[t].set.apply(this.items[t],i);this.origin.LinkIsEmitting=!1},e.fn.Link=function(t){var i=this;if(t===!1)return i.each(function(){this.linkAPI&&(e.map(this.linkAPI,function(e){e.remove()}),delete this.linkAPI)});if(void 0===t)t=0;else if("string"!=typeof t)throw new Error("Flag must be string.");return{to:function(e,r,n){return i.each(function(){d.call(this,t,e,r,n)})}}}}(window.jQuery||window.Zepto),function(e){"use strict";function t(t){return e.grep(t,function(i,r){return r===e.inArray(i,t)})}function i(e,t){return Math.round(e/t)*t}function r(e){return"number"==typeof e&&!isNaN(e)&&isFinite(e)}function n(e){var t=Math.pow(10,7);return Number((Math.round(e*t)/t).toFixed(7))}function o(e,t,i){e.addClass(t),setTimeout(function(){e.removeClass(t)},i)}function s(e){return Math.max(Math.min(e,100),0)}function a(t){return e.isArray(t)?t:[t]}function l(e){var t=e.split(".");return t.length>1?t[1].length:0}function d(e,t){return 100/(t-e)}function h(e,t){return 100*t/(e[1]-e[0])}function u(e,t){return h(e,e[0]<0?t+Math.abs(e[0]):t-e[0])}function c(e,t){return t*(e[1]-e[0])/100+e[0]}function f(e,t){for(var i=1;e>=t[i];)i+=1;return i}function m(e,t,i){if(i>=e.slice(-1)[0])return 100;var r,n,o,s,a=f(i,e);return r=e[a-1],n=e[a],o=t[a-1],s=t[a],o+u([r,n],i)/d(o,s)}function p(e,t,i){if(i>=100)return e.slice(-1)[0];var r,n,o,s,a=f(i,t);return r=e[a-1],n=e[a],o=t[a-1],s=t[a],c([r,n],(i-o)*d(o,s))}function _(e,t,r,n){if(100===n)return n;var o,s,a=f(n,e);return r?(o=e[a-1],s=e[a],n-o>(s-o)/2?s:o):t[a-1]?e[a-1]+i(n-e[a-1],t[a-1]):n}function g(e,t,i){var n;if("number"==typeof t&&(t=[t]),"[object Array]"!==Object.prototype.toString.call(t))throw new Error("noUiSlider: 'range' contains invalid value.");if(n="min"===e?0:"max"===e?100:parseFloat(e),!r(n)||!r(t[0]))throw new Error("noUiSlider: 'range' value isn't numeric.");i.xPct.push(n),i.xVal.push(t[0]),n?i.xSteps.push(isNaN(t[1])?!1:t[1]):isNaN(t[1])||(i.xSteps[0]=t[1])}function v(e,t,i){return t?void(i.xSteps[e]=h([i.xVal[e],i.xVal[e+1]],t)/d(i.xPct[e],i.xPct[e+1])):!0}function y(e,t,i,r){this.xPct=[],this.xVal=[],this.xSteps=[r||!1],this.xNumSteps=[!1],this.snap=t,this.direction=i;var n,o=[];for(n in e)e.hasOwnProperty(n)&&o.push([e[n],n]);for(o.sort(function(e,t){return e[0]-t[0]}),n=0;n<o.length;n++)g(o[n][1],o[n][0],this);for(this.xNumSteps=this.xSteps.slice(0),n=0;n<this.xNumSteps.length;n++)v(n,this.xNumSteps[n],this)}function b(e,t){if(!r(t))throw new Error("noUiSlider: 'step' is not numeric.");e.singleStep=t}function x(t,i){if("object"!=typeof i||e.isArray(i))throw new Error("noUiSlider: 'range' is not an object.");if(void 0===i.min||void 0===i.max)throw new Error("noUiSlider: Missing 'min' or 'max' in 'range'.");t.spectrum=new y(i,t.snap,t.dir,t.singleStep)}function w(t,i){if(i=a(i),!e.isArray(i)||!i.length||i.length>2)throw new Error("noUiSlider: 'start' option is incorrect.");t.handles=i.length,t.start=i}function T(e,t){if(e.snap=t,"boolean"!=typeof t)throw new Error("noUiSlider: 'snap' option must be a boolean.")}function E(e,t){if(e.animate=t,"boolean"!=typeof t)throw new Error("noUiSlider: 'animate' option must be a boolean.")}function C(e,t){if("lower"===t&&1===e.handles)e.connect=1;else if("upper"===t&&1===e.handles)e.connect=2;else if(t===!0&&2===e.handles)e.connect=3;else{if(t!==!1)throw new Error("noUiSlider: 'connect' option doesn't match handle count.");e.connect=0}}function S(e,t){switch(t){case"horizontal":e.ort=0;break;case"vertical":e.ort=1;break;default:throw new Error("noUiSlider: 'orientation' option is invalid.")}}function F(e,t){if(!r(t))throw new Error("noUiSlider: 'margin' option must be numeric.");if(e.margin=e.spectrum.getMargin(t),!e.margin)throw new Error("noUiSlider: 'margin' option is only supported on linear sliders.")}function M(e,t){if(!r(t))throw new Error("noUiSlider: 'limit' option must be numeric.");if(e.limit=e.spectrum.getMargin(t),!e.limit)throw new Error("noUiSlider: 'limit' option is only supported on linear sliders.")}function A(e,t){switch(t){case"ltr":e.dir=0;break;case"rtl":e.dir=1,e.connect=[0,2,1,3][e.connect];break;default:throw new Error("noUiSlider: 'direction' option was not recognized.")}}function N(e,t){if("string"!=typeof t)throw new Error("noUiSlider: 'behaviour' must be a string containing options.");var i=t.indexOf("tap")>=0,r=t.indexOf("drag")>=0,n=t.indexOf("fixed")>=0,o=t.indexOf("snap")>=0;e.events={tap:i||o,drag:r,fixed:n,snap:o}}function R(e,t){if(e.format=t,"function"==typeof t.to&&"function"==typeof t.from)return!0;throw new Error("noUiSlider: 'format' requires 'to' and 'from' methods.")}function D(t){var i,r={margin:0,limit:0,animate:!0,format:Q};return i={step:{r:!1,t:b},start:{r:!0,t:w},connect:{r:!0,t:C},direction:{r:!0,t:A},snap:{r:!1,t:T},animate:{r:!1,t:E},range:{r:!0,t:x},orientation:{r:!1,t:S},margin:{r:!1,t:F},limit:{r:!1,t:M},behaviour:{r:!0,t:N},format:{r:!1,t:R}},t=e.extend({connect:!1,direction:"ltr",behaviour:"tap",orientation:"horizontal"},t),e.each(i,function(e,i){if(void 0===t[e]){if(i.r)throw new Error("noUiSlider: '"+e+"' is required.");return!0}i.t(r,t[e])}),r.style=r.ort?"top":"left",r}function I(e,t,i){var r=e+t[0],n=e+t[1];return i?(0>r&&(n+=Math.abs(r)),n>100&&(r-=n-100),[s(r),s(n)]):[r,n]}function P(e){e.preventDefault();var t,i,r=0===e.type.indexOf("touch"),n=0===e.type.indexOf("mouse"),o=0===e.type.indexOf("pointer"),s=e;return 0===e.type.indexOf("MSPointer")&&(o=!0),e.originalEvent&&(e=e.originalEvent),r&&(t=e.changedTouches[0].pageX,i=e.changedTouches[0].pageY),(n||o)&&(o||void 0!==window.pageXOffset||(window.pageXOffset=document.documentElement.scrollLeft,window.pageYOffset=document.documentElement.scrollTop),t=e.clientX+window.pageXOffset,i=e.clientY+window.pageYOffset),s.points=[t,i],s.cursor=n,s}function k(t,i){var r=e("<div><div/></div>").addClass($[2]),n=["-lower","-upper"];return t&&n.reverse(),r.children().addClass($[3]+" "+$[3]+n[i]),r}function V(e,t,i){switch(e){case 1:t.addClass($[7]),i[0].addClass($[6]);break;case 3:i[1].addClass($[6]);case 2:i[0].addClass($[7]);case 0:t.addClass($[6])}}function O(e,t,i){var r,n=[];for(r=0;e>r;r+=1)n.push(k(t,r).appendTo(i));return n}function L(t,i,r){return r.addClass([$[0],$[8+t],$[4+i]].join(" ")),e("<div/>").appendTo(r).addClass($[1])}function B(t,i,r){function n(){return M[["width","height"][i.ort]]()}function d(e){var t,i=[N.val()];for(t=0;t<e.length;t+=1)N.trigger(e[t],i)}function h(e){return 1===e.length?e[0]:i.dir?e.reverse():e}function u(e){return function(t,i){N.val([e?null:i,e?i:null],!0)}}function c(t){var i=e.inArray(t,B);N[0].linkAPI&&N[0].linkAPI[t]&&N[0].linkAPI[t].change(k[i],A[i].children(),N)}function f(t,r){var n=e.inArray(t,B);return r&&r.appendTo(A[n].children()),i.dir&&i.handles>1&&(n=1===n?0:1),u(n)}function m(){var e,t;for(e=0;e<B.length;e+=1)this.linkAPI&&this.linkAPI[t=B[e]]&&this.linkAPI[t].reconfirm(t)}function p(e,t,r,n){return e=e.replace(/\s/g,q+" ")+q,t.on(e,function(e){return N.attr("disabled")?!1:N.hasClass($[14])?!1:(e=P(e),e.calcPoint=e.points[i.ort],void r(e,n))})}function _(e,t){var i,r=t.handles||A,o=!1,s=100*(e.calcPoint-t.start)/n(),a=r[0][0]!==A[0][0]?1:0;i=I(s,t.positions,r.length>1),o=x(r[0],i[a],1===r.length),r.length>1&&(o=x(r[1],i[a?0:1],!1)||o),o&&d(["slide"])}function g(t){e("."+$[15]).removeClass($[15]),t.cursor&&e("body").css("cursor","").off(q),Y.off(q),N.removeClass($[12]),d(["set","change"])}function v(t,i){1===i.handles.length&&i.handles[0].children().addClass($[15]),t.stopPropagation(),p(K.move,Y,_,{start:t.calcPoint,handles:i.handles,positions:[R[0],R[A.length-1]]}),p(K.end,Y,g,null),t.cursor&&(e("body").css("cursor",e(t.target).css("cursor")),A.length>1&&N.addClass($[12]),e("body").on("selectstart"+q,!1))}function y(t){var r,s=t.calcPoint,a=0;t.stopPropagation(),e.each(A,function(){a+=this.offset()[i.style]}),a=a/2>s||1===A.length?0:1,s-=M.offset()[i.style],r=100*s/n(),i.events.snap||o(N,$[14],300),x(A[a],r),d(["slide","set","change"]),i.events.snap&&v(t,{handles:[A[a]]})}function b(e){var t,i;if(!e.fixed)for(t=0;t<A.length;t+=1)p(K.start,A[t].children(),v,{handles:[A[t]]});e.tap&&p(K.start,M,y,{handles:A}),e.drag&&(i=M.find("."+$[7]).addClass($[10]),e.fixed&&(i=i.add(M.children().not(i).children())),p(K.start,i,v,{handles:A}))}function x(e,t,r){var n=e[0]!==A[0][0]?1:0,o=R[0]+i.margin,a=R[1]-i.margin,l=R[0]+i.limit,d=R[1]-i.limit;return A.length>1&&(t=n?Math.max(t,o):Math.min(t,a)),r!==!1&&i.limit&&A.length>1&&(t=n?Math.min(t,l):Math.max(t,d)),t=D.getStep(t),t=s(parseFloat(t.toFixed(7))),t===R[n]?!1:(e.css(i.style,t+"%"),e.is(":first-child")&&e.toggleClass($[17],t>50),R[n]=t,k[n]=D.fromStepping(t),c(B[n]),!0)}function w(e,t){var r,n,o;for(i.limit&&(e+=1),r=0;e>r;r+=1)n=r%2,o=t[n],null!==o&&o!==!1&&("number"==typeof o&&(o=String(o)),o=i.format.from(o),(o===!1||isNaN(o)||x(A[n],D.toStepping(o),r===3-i.dir)===!1)&&c(B[n]))}function T(e){if(N[0].LinkIsEmitting)return this;var t,r=a(e);return i.dir&&i.handles>1&&r.reverse(),i.animate&&-1!==R[0]&&o(N,$[14],300),t=A.length>1?3:1,1===r.length&&(t=1),w(t,r),d(["set"]),this}function E(){var e,t=[];for(e=0;e<i.handles;e+=1)t[e]=i.format.to(k[e]);return h(t)}function C(){return e(this).off(q).removeClass($.join(" ")).empty(),delete this.LinkUpdate,delete this.LinkConfirm,delete this.LinkDefaultFormatter,delete this.LinkDefaultFlag,delete this.reappend,delete this.vGet,delete this.vSet,delete this.getCurrentStep,delete this.getInfo,delete this.destroy,r}function S(){var t=e.map(R,function(e,t){var i=D.getApplicableStep(e),r=l(String(i[2])),n=k[t],o=100===e?null:i[2],s=Number((n-i[2]).toFixed(r)),a=0===e?null:s>=i[1]?i[2]:i[0]||!1;return[[a,o]]});return h(t)}function F(){return r}var M,A,N=e(t),R=[-1,-1],D=i.spectrum,k=[],B=["lower","upper"].slice(0,i.handles);if(i.dir&&B.reverse(),t.LinkUpdate=c,t.LinkConfirm=f,t.LinkDefaultFormatter=i.format,t.LinkDefaultFlag="lower",t.reappend=m,N.hasClass($[0]))throw new Error("Slider was already initialized.");M=L(i.dir,i.ort,N),A=O(i.handles,i.dir,M),V(i.connect,N,A),b(i.events),t.vSet=T,t.vGet=E,t.destroy=C,t.getCurrentStep=S,t.getOriginalOptions=F,t.getInfo=function(){return[D,i.style,i.ort]},N.val(i.start)}function U(e){var t=D(e,this);return this.each(function(){B(this,t,e)})}function z(t){return this.each(function(){if(!this.destroy)return void e(this).noUiSlider(t);var i=e(this).val(),r=this.destroy(),n=e.extend({},r,t);e(this).noUiSlider(n),this.reappend(),r.start===n.start&&e(this).val(i)})}function j(){return this[0][arguments.length?"vSet":"vGet"].apply(this[0],arguments)}function G(t,i,r,n){if("range"===i||"steps"===i)return t.xVal;if("count"===i){var o,s=100/(r-1),a=0;for(r=[];(o=a++*s)<=100;)r.push(o);i="positions"}return"positions"===i?e.map(r,function(e){return t.fromStepping(n?t.getStep(e):e)}):"values"===i?n?e.map(r,function(e){return t.fromStepping(t.getStep(t.toStepping(e)))}):r:void 0}function X(i,r,n,o){var s=i.direction,a={},l=i.xVal[0],d=i.xVal[i.xVal.length-1],h=!1,u=!1,c=0;return i.direction=0,o=t(o.slice().sort(function(e,t){return e-t})),o[0]!==l&&(o.unshift(l),h=!0),o[o.length-1]!==d&&(o.push(d),u=!0),e.each(o,function(t){var s,l,d,f,m,p,_,g,v,y,b=o[t],x=o[t+1];if("steps"===n&&(s=i.xNumSteps[t]),s||(s=x-b),b!==!1&&void 0!==x)for(l=b;x>=l;l+=s){for(f=i.toStepping(l),m=f-c,g=m/r,v=Math.round(g),y=m/v,d=1;v>=d;d+=1)p=c+d*y,a[p.toFixed(5)]=["x",0];
_=e.inArray(l,o)>-1?1:"steps"===n?2:0,!t&&h&&(_=0),l===x&&u||(a[f.toFixed(5)]=[l,_]),c=f}}),i.direction=s,a}function H(t,i,r,n,o,s){function a(e){return["-normal","-large","-sub"][e]}function l(e,i,r){return'class="'+i+" "+i+"-"+h+" "+i+a(r[1],r[0])+'" style="'+t+": "+e+'%"'}function d(e,t){r&&(e=100-e),t[1]=t[1]&&o?o(t[0],t[1]):t[1],u.append("<div "+l(e,"noUi-marker",t)+"></div>"),t[1]&&u.append("<div "+l(e,"noUi-value",t)+">"+s.to(t[0])+"</div>")}var h=["horizontal","vertical"][i],u=e("<div/>");return u.addClass("noUi-pips noUi-pips-"+h),e.each(n,d),u}var Y=e(document),W=e.fn.val,q=".nui",K=window.navigator.pointerEnabled?{start:"pointerdown",move:"pointermove",end:"pointerup"}:window.navigator.msPointerEnabled?{start:"MSPointerDown",move:"MSPointerMove",end:"MSPointerUp"}:{start:"mousedown touchstart",move:"mousemove touchmove",end:"mouseup touchend"},$=["noUi-target","noUi-base","noUi-origin","noUi-handle","noUi-horizontal","noUi-vertical","noUi-background","noUi-connect","noUi-ltr","noUi-rtl","noUi-dragable","","noUi-state-drag","","noUi-state-tap","noUi-active","","noUi-stacking"];y.prototype.getMargin=function(e){return 2===this.xPct.length?h(this.xVal,e):!1},y.prototype.toStepping=function(e){return e=m(this.xVal,this.xPct,e),this.direction&&(e=100-e),e},y.prototype.fromStepping=function(e){return this.direction&&(e=100-e),n(p(this.xVal,this.xPct,e))},y.prototype.getStep=function(e){return this.direction&&(e=100-e),e=_(this.xPct,this.xSteps,this.snap,e),this.direction&&(e=100-e),e},y.prototype.getApplicableStep=function(e){var t=f(e,this.xPct),i=100===e?2:1;return[this.xNumSteps[t-2],this.xVal[t-i],this.xNumSteps[t-i]]},y.prototype.convert=function(e){return this.getStep(this.toStepping(e))};var Q={to:function(e){return e.toFixed(2)},from:Number};e.fn.val=function(t){function i(e){return e.hasClass($[0])?j:W}if(!arguments.length){var r=e(this[0]);return i(r).call(r)}var n=e.isFunction(t);return this.each(function(r){var o=t,s=e(this);n&&(o=t.call(this,r,s.val())),i(s).call(s,o)})},e.fn.noUiSlider=function(e,t){switch(e){case"step":return this[0].getCurrentStep();case"options":return this[0].getOriginalOptions()}return(t?z:U).call(this,e)},e.fn.noUiSlider_pips=function(t){var i=t.mode,r=t.density||1,n=t.filter||!1,o=t.values||!1,s=t.format||{to:Math.round},a=t.stepped||!1;return this.each(function(){var t=this.getInfo(),l=G(t[0],i,o,a),d=X(t[0],r,i,l);return e(this).append(H(t[1],t[2],t[0].direction,d,n,s))})}}(window.jQuery||window.Zepto),function(e){function t(e,t,i){switch(arguments.length){case 2:return null!=e?e:t;case 3:return null!=e?e:null!=t?t:i;default:throw new Error("Implement me")}}function i(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1}}function r(e,t){function i(){ct.suppressDeprecationWarnings===!1&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+e)}var r=!0;return d(function(){return r&&(i(),r=!1),t.apply(this,arguments)},t)}function n(e,t){return function(i){return c(e.call(this,i),t)}}function o(e,t){return function(i){return this.lang().ordinal(e.call(this,i),t)}}function s(){}function a(e){C(e),d(this,e)}function l(e){var t=v(e),i=t.year||0,r=t.quarter||0,n=t.month||0,o=t.week||0,s=t.day||0,a=t.hour||0,l=t.minute||0,d=t.second||0,h=t.millisecond||0;this._milliseconds=+h+1e3*d+6e4*l+36e5*a,this._days=+s+7*o,this._months=+n+3*r+12*i,this._data={},this._bubble()}function d(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return t.hasOwnProperty("toString")&&(e.toString=t.toString),t.hasOwnProperty("valueOf")&&(e.valueOf=t.valueOf),e}function h(e){var t,i={};for(t in e)e.hasOwnProperty(t)&&St.hasOwnProperty(t)&&(i[t]=e[t]);return i}function u(e){return 0>e?Math.ceil(e):Math.floor(e)}function c(e,t,i){for(var r=""+Math.abs(e),n=e>=0;r.length<t;)r="0"+r;return(n?i?"+":"":"-")+r}function f(e,t,i,r){var n=t._milliseconds,o=t._days,s=t._months;r=null==r?!0:r,n&&e._d.setTime(+e._d+n*i),o&&at(e,"Date",st(e,"Date")+o*i),s&&ot(e,st(e,"Month")+s*i),r&&ct.updateOffset(e,o||s)}function m(e){return"[object Array]"===Object.prototype.toString.call(e)}function p(e){return"[object Date]"===Object.prototype.toString.call(e)||e instanceof Date}function _(e,t,i){var r,n=Math.min(e.length,t.length),o=Math.abs(e.length-t.length),s=0;for(r=0;n>r;r++)(i&&e[r]!==t[r]||!i&&b(e[r])!==b(t[r]))&&s++;return s+o}function g(e){if(e){var t=e.toLowerCase().replace(/(.)s$/,"$1");e=ti[e]||ii[t]||t}return e}function v(e){var t,i,r={};for(i in e)e.hasOwnProperty(i)&&(t=g(i),t&&(r[t]=e[i]));return r}function y(t){var i,r;if(0===t.indexOf("week"))i=7,r="day";else{if(0!==t.indexOf("month"))return;i=12,r="month"}ct[t]=function(n,o){var s,a,l=ct.fn._lang[t],d=[];if("number"==typeof n&&(o=n,n=e),a=function(e){var t=ct().utc().set(r,e);return l.call(ct.fn._lang,t,n||"")},null!=o)return a(o);for(s=0;i>s;s++)d.push(a(s));return d}}function b(e){var t=+e,i=0;return 0!==t&&isFinite(t)&&(i=t>=0?Math.floor(t):Math.ceil(t)),i}function x(e,t){return new Date(Date.UTC(e,t+1,0)).getUTCDate()}function w(e,t,i){return tt(ct([e,11,31+t-i]),t,i).week}function T(e){return E(e)?366:365}function E(e){return e%4===0&&e%100!==0||e%400===0}function C(e){var t;e._a&&-2===e._pf.overflow&&(t=e._a[yt]<0||e._a[yt]>11?yt:e._a[bt]<1||e._a[bt]>x(e._a[vt],e._a[yt])?bt:e._a[xt]<0||e._a[xt]>23?xt:e._a[wt]<0||e._a[wt]>59?wt:e._a[Tt]<0||e._a[Tt]>59?Tt:e._a[Et]<0||e._a[Et]>999?Et:-1,e._pf._overflowDayOfYear&&(vt>t||t>bt)&&(t=bt),e._pf.overflow=t)}function S(e){return null==e._isValid&&(e._isValid=!isNaN(e._d.getTime())&&e._pf.overflow<0&&!e._pf.empty&&!e._pf.invalidMonth&&!e._pf.nullInput&&!e._pf.invalidFormat&&!e._pf.userInvalidated,e._strict&&(e._isValid=e._isValid&&0===e._pf.charsLeftOver&&0===e._pf.unusedTokens.length)),e._isValid}function F(e){return e?e.toLowerCase().replace("_","-"):e}function M(e,t){return t._isUTC?ct(e).zone(t._offset||0):ct(e).local()}function A(e,t){return t.abbr=e,Ct[e]||(Ct[e]=new s),Ct[e].set(t),Ct[e]}function N(e){delete Ct[e]}function R(e){var t,i,r,n,o=0,s=function(e){if(!Ct[e]&&Ft)try{require("./lang/"+e)}catch(t){}return Ct[e]};if(!e)return ct.fn._lang;if(!m(e)){if(i=s(e))return i;e=[e]}for(;o<e.length;){for(n=F(e[o]).split("-"),t=n.length,r=F(e[o+1]),r=r?r.split("-"):null;t>0;){if(i=s(n.slice(0,t).join("-")))return i;if(r&&r.length>=t&&_(n,r,!0)>=t-1)break;t--}o++}return ct.fn._lang}function D(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function I(e){var t,i,r=e.match(Rt);for(t=0,i=r.length;i>t;t++)r[t]=ai[r[t]]?ai[r[t]]:D(r[t]);return function(n){var o="";for(t=0;i>t;t++)o+=r[t]instanceof Function?r[t].call(n,e):r[t];return o}}function P(e,t){return e.isValid()?(t=k(t,e.lang()),ri[t]||(ri[t]=I(t)),ri[t](e)):e.lang().invalidDate()}function k(e,t){function i(e){return t.longDateFormat(e)||e}var r=5;for(Dt.lastIndex=0;r>=0&&Dt.test(e);)e=e.replace(Dt,i),Dt.lastIndex=0,r-=1;return e}function V(e,t){var i,r=t._strict;switch(e){case"Q":return Gt;case"DDDD":return Ht;case"YYYY":case"GGGG":case"gggg":return r?Yt:kt;case"Y":case"G":case"g":return qt;case"YYYYYY":case"YYYYY":case"GGGGG":case"ggggg":return r?Wt:Vt;case"S":if(r)return Gt;case"SS":if(r)return Xt;case"SSS":if(r)return Ht;case"DDD":return Pt;case"MMM":case"MMMM":case"dd":case"ddd":case"dddd":return Lt;case"a":case"A":return R(t._l)._meridiemParse;case"X":return zt;case"Z":case"ZZ":return Bt;case"T":return Ut;case"SSSS":return Ot;case"MM":case"DD":case"YY":case"GG":case"gg":case"HH":case"hh":case"mm":case"ss":case"ww":case"WW":return r?Xt:It;case"M":case"D":case"d":case"H":case"h":case"m":case"s":case"w":case"W":case"e":case"E":return It;case"Do":return jt;default:return i=new RegExp(H(X(e.replace("\\","")),"i"))}}function O(e){e=e||"";var t=e.match(Bt)||[],i=t[t.length-1]||[],r=(i+"").match(Jt)||["-",0,0],n=+(60*r[1])+b(r[2]);return"+"===r[0]?-n:n}function L(e,t,i){var r,n=i._a;switch(e){case"Q":null!=t&&(n[yt]=3*(b(t)-1));break;case"M":case"MM":null!=t&&(n[yt]=b(t)-1);break;case"MMM":case"MMMM":r=R(i._l).monthsParse(t),null!=r?n[yt]=r:i._pf.invalidMonth=t;break;case"D":case"DD":null!=t&&(n[bt]=b(t));break;case"Do":null!=t&&(n[bt]=b(parseInt(t,10)));break;case"DDD":case"DDDD":null!=t&&(i._dayOfYear=b(t));break;case"YY":n[vt]=ct.parseTwoDigitYear(t);break;case"YYYY":case"YYYYY":case"YYYYYY":n[vt]=b(t);break;case"a":case"A":i._isPm=R(i._l).isPM(t);break;case"H":case"HH":case"h":case"hh":n[xt]=b(t);break;case"m":case"mm":n[wt]=b(t);break;case"s":case"ss":n[Tt]=b(t);break;case"S":case"SS":case"SSS":case"SSSS":n[Et]=b(1e3*("0."+t));break;case"X":i._d=new Date(1e3*parseFloat(t));break;case"Z":case"ZZ":i._useUTC=!0,i._tzm=O(t);break;case"dd":case"ddd":case"dddd":r=R(i._l).weekdaysParse(t),null!=r?(i._w=i._w||{},i._w.d=r):i._pf.invalidWeekday=t;break;case"w":case"ww":case"W":case"WW":case"d":case"e":case"E":e=e.substr(0,1);case"gggg":case"GGGG":case"GGGGG":e=e.substr(0,2),t&&(i._w=i._w||{},i._w[e]=b(t));break;case"gg":case"GG":i._w=i._w||{},i._w[e]=ct.parseTwoDigitYear(t)}}function B(e){var i,r,n,o,s,a,l,d;i=e._w,null!=i.GG||null!=i.W||null!=i.E?(s=1,a=4,r=t(i.GG,e._a[vt],tt(ct(),1,4).year),n=t(i.W,1),o=t(i.E,1)):(d=R(e._l),s=d._week.dow,a=d._week.doy,r=t(i.gg,e._a[vt],tt(ct(),s,a).year),n=t(i.w,1),null!=i.d?(o=i.d,s>o&&++n):o=null!=i.e?i.e+s:s),l=it(r,n,o,a,s),e._a[vt]=l.year,e._dayOfYear=l.dayOfYear}function U(e){var i,r,n,o,s=[];if(!e._d){for(n=j(e),e._w&&null==e._a[bt]&&null==e._a[yt]&&B(e),e._dayOfYear&&(o=t(e._a[vt],n[vt]),e._dayOfYear>T(o)&&(e._pf._overflowDayOfYear=!0),r=Q(o,0,e._dayOfYear),e._a[yt]=r.getUTCMonth(),e._a[bt]=r.getUTCDate()),i=0;3>i&&null==e._a[i];++i)e._a[i]=s[i]=n[i];for(;7>i;i++)e._a[i]=s[i]=null==e._a[i]?2===i?1:0:e._a[i];e._d=(e._useUTC?Q:$).apply(null,s),null!=e._tzm&&e._d.setUTCMinutes(e._d.getUTCMinutes()+e._tzm)}}function z(e){var t;e._d||(t=v(e._i),e._a=[t.year,t.month,t.day,t.hour,t.minute,t.second,t.millisecond],U(e))}function j(e){var t=new Date;return e._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}function G(e){if(e._f===ct.ISO_8601)return void W(e);e._a=[],e._pf.empty=!0;var t,i,r,n,o,s=R(e._l),a=""+e._i,l=a.length,d=0;for(r=k(e._f,s).match(Rt)||[],t=0;t<r.length;t++)n=r[t],i=(a.match(V(n,e))||[])[0],i&&(o=a.substr(0,a.indexOf(i)),o.length>0&&e._pf.unusedInput.push(o),a=a.slice(a.indexOf(i)+i.length),d+=i.length),ai[n]?(i?e._pf.empty=!1:e._pf.unusedTokens.push(n),L(n,i,e)):e._strict&&!i&&e._pf.unusedTokens.push(n);e._pf.charsLeftOver=l-d,a.length>0&&e._pf.unusedInput.push(a),e._isPm&&e._a[xt]<12&&(e._a[xt]+=12),e._isPm===!1&&12===e._a[xt]&&(e._a[xt]=0),U(e),C(e)}function X(e){return e.replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,t,i,r,n){return t||i||r||n})}function H(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function Y(e){var t,r,n,o,s;if(0===e._f.length)return e._pf.invalidFormat=!0,void(e._d=new Date(0/0));for(o=0;o<e._f.length;o++)s=0,t=d({},e),t._pf=i(),t._f=e._f[o],G(t),S(t)&&(s+=t._pf.charsLeftOver,s+=10*t._pf.unusedTokens.length,t._pf.score=s,(null==n||n>s)&&(n=s,r=t));d(e,r||t)}function W(e){var t,i,r=e._i,n=Kt.exec(r);if(n){for(e._pf.iso=!0,t=0,i=Qt.length;i>t;t++)if(Qt[t][1].exec(r)){e._f=Qt[t][0]+(n[6]||" ");break}for(t=0,i=Zt.length;i>t;t++)if(Zt[t][1].exec(r)){e._f+=Zt[t][0];break}r.match(Bt)&&(e._f+="Z"),G(e)}else e._isValid=!1}function q(e){W(e),e._isValid===!1&&(delete e._isValid,ct.createFromInputFallback(e))}function K(t){var i=t._i,r=Mt.exec(i);i===e?t._d=new Date:r?t._d=new Date(+r[1]):"string"==typeof i?q(t):m(i)?(t._a=i.slice(0),U(t)):p(i)?t._d=new Date(+i):"object"==typeof i?z(t):"number"==typeof i?t._d=new Date(i):ct.createFromInputFallback(t)}function $(e,t,i,r,n,o,s){var a=new Date(e,t,i,r,n,o,s);return 1970>e&&a.setFullYear(e),a}function Q(e){var t=new Date(Date.UTC.apply(null,arguments));return 1970>e&&t.setUTCFullYear(e),t}function Z(e,t){if("string"==typeof e)if(isNaN(e)){if(e=t.weekdaysParse(e),"number"!=typeof e)return null}else e=parseInt(e,10);return e}function J(e,t,i,r,n){return n.relativeTime(t||1,!!i,e,r)}function et(e,t,i){var r=gt(Math.abs(e)/1e3),n=gt(r/60),o=gt(n/60),s=gt(o/24),a=gt(s/365),l=r<ni.s&&["s",r]||1===n&&["m"]||n<ni.m&&["mm",n]||1===o&&["h"]||o<ni.h&&["hh",o]||1===s&&["d"]||s<=ni.dd&&["dd",s]||s<=ni.dm&&["M"]||s<ni.dy&&["MM",gt(s/30)]||1===a&&["y"]||["yy",a];return l[2]=t,l[3]=e>0,l[4]=i,J.apply({},l)}function tt(e,t,i){var r,n=i-t,o=i-e.day();return o>n&&(o-=7),n-7>o&&(o+=7),r=ct(e).add("d",o),{week:Math.ceil(r.dayOfYear()/7),year:r.year()}}function it(e,t,i,r,n){var o,s,a=Q(e,0,1).getUTCDay();return a=0===a?7:a,i=null!=i?i:n,o=n-a+(a>r?7:0)-(n>a?7:0),s=7*(t-1)+(i-n)+o+1,{year:s>0?e:e-1,dayOfYear:s>0?s:T(e-1)+s}}function rt(t){var i=t._i,r=t._f;return null===i||r===e&&""===i?ct.invalid({nullInput:!0}):("string"==typeof i&&(t._i=i=R().preparse(i)),ct.isMoment(i)?(t=h(i),t._d=new Date(+i._d)):r?m(r)?Y(t):G(t):K(t),new a(t))}function nt(e,t){var i,r;if(1===t.length&&m(t[0])&&(t=t[0]),!t.length)return ct();for(i=t[0],r=1;r<t.length;++r)t[r][e](i)&&(i=t[r]);return i}function ot(e,t){var i;return"string"==typeof t&&(t=e.lang().monthsParse(t),"number"!=typeof t)?e:(i=Math.min(e.date(),x(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,i),e)}function st(e,t){return e._d["get"+(e._isUTC?"UTC":"")+t]()}function at(e,t,i){return"Month"===t?ot(e,i):e._d["set"+(e._isUTC?"UTC":"")+t](i)}function lt(e,t){return function(i){return null!=i?(at(this,e,i),ct.updateOffset(this,t),this):st(this,e)}}function dt(e){ct.duration.fn[e]=function(){return this._data[e]}}function ht(e,t){ct.duration.fn["as"+e]=function(){return+this/t}}function ut(e){"undefined"==typeof ender&&(ft=_t.moment,_t.moment=e?r("Accessing Moment through the global scope is deprecated, and will be removed in an upcoming release.",ct):ct)}for(var ct,ft,mt,pt="2.7.0",_t="undefined"!=typeof global?global:this,gt=Math.round,vt=0,yt=1,bt=2,xt=3,wt=4,Tt=5,Et=6,Ct={},St={_isAMomentObject:null,_i:null,_f:null,_l:null,_strict:null,_tzm:null,_isUTC:null,_offset:null,_pf:null,_lang:null},Ft="undefined"!=typeof module&&module.exports,Mt=/^\/?Date\((\-?\d+)/i,At=/(\-)?(?:(\d*)\.)?(\d+)\:(\d+)(?:\:(\d+)\.?(\d{3})?)?/,Nt=/^(-)?P(?:(?:([0-9,.]*)Y)?(?:([0-9,.]*)M)?(?:([0-9,.]*)D)?(?:T(?:([0-9,.]*)H)?(?:([0-9,.]*)M)?(?:([0-9,.]*)S)?)?|([0-9,.]*)W)$/,Rt=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Q|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|mm?|ss?|S{1,4}|X|zz?|ZZ?|.)/g,Dt=/(\[[^\[]*\])|(\\)?(LT|LL?L?L?|l{1,4})/g,It=/\d\d?/,Pt=/\d{1,3}/,kt=/\d{1,4}/,Vt=/[+\-]?\d{1,6}/,Ot=/\d+/,Lt=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,Bt=/Z|[\+\-]\d\d:?\d\d/gi,Ut=/T/i,zt=/[\+\-]?\d+(\.\d{1,3})?/,jt=/\d{1,2}/,Gt=/\d/,Xt=/\d\d/,Ht=/\d{3}/,Yt=/\d{4}/,Wt=/[+-]?\d{6}/,qt=/[+-]?\d+/,Kt=/^\s*(?:[+-]\d{6}|\d{4})-(?:(\d\d-\d\d)|(W\d\d$)|(W\d\d-\d)|(\d\d\d))((T| )(\d\d(:\d\d(:\d\d(\.\d+)?)?)?)?([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,$t="YYYY-MM-DDTHH:mm:ssZ",Qt=[["YYYYYY-MM-DD",/[+-]\d{6}-\d{2}-\d{2}/],["YYYY-MM-DD",/\d{4}-\d{2}-\d{2}/],["GGGG-[W]WW-E",/\d{4}-W\d{2}-\d/],["GGGG-[W]WW",/\d{4}-W\d{2}/],["YYYY-DDD",/\d{4}-\d{3}/]],Zt=[["HH:mm:ss.SSSS",/(T| )\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss",/(T| )\d\d:\d\d:\d\d/],["HH:mm",/(T| )\d\d:\d\d/],["HH",/(T| )\d\d/]],Jt=/([\+\-]|\d\d)/gi,ei=("Date|Hours|Minutes|Seconds|Milliseconds".split("|"),{Milliseconds:1,Seconds:1e3,Minutes:6e4,Hours:36e5,Days:864e5,Months:2592e6,Years:31536e6}),ti={ms:"millisecond",s:"second",m:"minute",h:"hour",d:"day",D:"date",w:"week",W:"isoWeek",M:"month",Q:"quarter",y:"year",DDD:"dayOfYear",e:"weekday",E:"isoWeekday",gg:"weekYear",GG:"isoWeekYear"},ii={dayofyear:"dayOfYear",isoweekday:"isoWeekday",isoweek:"isoWeek",weekyear:"weekYear",isoweekyear:"isoWeekYear"},ri={},ni={s:45,m:45,h:22,dd:25,dm:45,dy:345},oi="DDD w W M D d".split(" "),si="M D H h m s w W".split(" "),ai={M:function(){return this.month()+1},MMM:function(e){return this.lang().monthsShort(this,e)},MMMM:function(e){return this.lang().months(this,e)},D:function(){return this.date()},DDD:function(){return this.dayOfYear()},d:function(){return this.day()},dd:function(e){return this.lang().weekdaysMin(this,e)},ddd:function(e){return this.lang().weekdaysShort(this,e)},dddd:function(e){return this.lang().weekdays(this,e)},w:function(){return this.week()},W:function(){return this.isoWeek()},YY:function(){return c(this.year()%100,2)},YYYY:function(){return c(this.year(),4)},YYYYY:function(){return c(this.year(),5)},YYYYYY:function(){var e=this.year(),t=e>=0?"+":"-";return t+c(Math.abs(e),6)},gg:function(){return c(this.weekYear()%100,2)},gggg:function(){return c(this.weekYear(),4)},ggggg:function(){return c(this.weekYear(),5)},GG:function(){return c(this.isoWeekYear()%100,2)},GGGG:function(){return c(this.isoWeekYear(),4)},GGGGG:function(){return c(this.isoWeekYear(),5)},e:function(){return this.weekday()},E:function(){return this.isoWeekday()},a:function(){return this.lang().meridiem(this.hours(),this.minutes(),!0)},A:function(){return this.lang().meridiem(this.hours(),this.minutes(),!1)},H:function(){return this.hours()},h:function(){return this.hours()%12||12},m:function(){return this.minutes()},s:function(){return this.seconds()},S:function(){return b(this.milliseconds()/100)},SS:function(){return c(b(this.milliseconds()/10),2)},SSS:function(){return c(this.milliseconds(),3)},SSSS:function(){return c(this.milliseconds(),3)},Z:function(){var e=-this.zone(),t="+";return 0>e&&(e=-e,t="-"),t+c(b(e/60),2)+":"+c(b(e)%60,2)},ZZ:function(){var e=-this.zone(),t="+";return 0>e&&(e=-e,t="-"),t+c(b(e/60),2)+c(b(e)%60,2)},z:function(){return this.zoneAbbr()},zz:function(){return this.zoneName()},X:function(){return this.unix()},Q:function(){return this.quarter()}},li=["months","monthsShort","weekdays","weekdaysShort","weekdaysMin"];oi.length;)mt=oi.pop(),ai[mt+"o"]=o(ai[mt],mt);for(;si.length;)mt=si.pop(),ai[mt+mt]=n(ai[mt],2);for(ai.DDDD=n(ai.DDD,3),d(s.prototype,{set:function(e){var t,i;for(i in e)t=e[i],"function"==typeof t?this[i]=t:this["_"+i]=t},_months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),months:function(e){return this._months[e.month()]},_monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),monthsShort:function(e){return this._monthsShort[e.month()]},monthsParse:function(e){var t,i,r;for(this._monthsParse||(this._monthsParse=[]),t=0;12>t;t++)if(this._monthsParse[t]||(i=ct.utc([2e3,t]),r="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[t]=new RegExp(r.replace(".",""),"i")),this._monthsParse[t].test(e))return t},_weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdays:function(e){return this._weekdays[e.day()]},_weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysShort:function(e){return this._weekdaysShort[e.day()]},_weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),weekdaysMin:function(e){return this._weekdaysMin[e.day()]},weekdaysParse:function(e){var t,i,r;for(this._weekdaysParse||(this._weekdaysParse=[]),t=0;7>t;t++)if(this._weekdaysParse[t]||(i=ct([2e3,1]).day(t),r="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[t]=new RegExp(r.replace(".",""),"i")),this._weekdaysParse[t].test(e))return t},_longDateFormat:{LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D YYYY",LLL:"MMMM D YYYY LT",LLLL:"dddd, MMMM D YYYY LT"},longDateFormat:function(e){var t=this._longDateFormat[e];return!t&&this._longDateFormat[e.toUpperCase()]&&(t=this._longDateFormat[e.toUpperCase()].replace(/MMMM|MM|DD|dddd/g,function(e){return e.slice(1)}),this._longDateFormat[e]=t),t},isPM:function(e){return"p"===(e+"").toLowerCase().charAt(0)},_meridiemParse:/[ap]\.?m?\.?/i,meridiem:function(e,t,i){return e>11?i?"pm":"PM":i?"am":"AM"},_calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},calendar:function(e,t){var i=this._calendar[e];return"function"==typeof i?i.apply(t):i},_relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},relativeTime:function(e,t,i,r){var n=this._relativeTime[i];return"function"==typeof n?n(e,t,i,r):n.replace(/%d/i,e)},pastFuture:function(e,t){var i=this._relativeTime[e>0?"future":"past"];return"function"==typeof i?i(t):i.replace(/%s/i,t)},ordinal:function(e){return this._ordinal.replace("%d",e)},_ordinal:"%d",preparse:function(e){return e},postformat:function(e){return e},week:function(e){return tt(e,this._week.dow,this._week.doy).week},_week:{dow:0,doy:6},_invalidDate:"Invalid date",invalidDate:function(){return this._invalidDate}}),ct=function(t,r,n,o){var s;return"boolean"==typeof n&&(o=n,n=e),s={},s._isAMomentObject=!0,s._i=t,s._f=r,s._l=n,s._strict=o,s._isUTC=!1,s._pf=i(),rt(s)},ct.suppressDeprecationWarnings=!1,ct.createFromInputFallback=r("moment construction falls back to js Date. This is discouraged and will be removed in upcoming major release. Please refer to https://github.com/moment/moment/issues/1407 for more info.",function(e){e._d=new Date(e._i)}),ct.min=function(){var e=[].slice.call(arguments,0);return nt("isBefore",e)},ct.max=function(){var e=[].slice.call(arguments,0);return nt("isAfter",e)},ct.utc=function(t,r,n,o){var s;return"boolean"==typeof n&&(o=n,n=e),s={},s._isAMomentObject=!0,s._useUTC=!0,s._isUTC=!0,s._l=n,s._i=t,s._f=r,s._strict=o,s._pf=i(),rt(s).utc()},ct.unix=function(e){return ct(1e3*e)},ct.duration=function(e,t){var i,r,n,o=e,s=null;return ct.isDuration(e)?o={ms:e._milliseconds,d:e._days,M:e._months}:"number"==typeof e?(o={},t?o[t]=e:o.milliseconds=e):(s=At.exec(e))?(i="-"===s[1]?-1:1,o={y:0,d:b(s[bt])*i,h:b(s[xt])*i,m:b(s[wt])*i,s:b(s[Tt])*i,ms:b(s[Et])*i}):(s=Nt.exec(e))&&(i="-"===s[1]?-1:1,n=function(e){var t=e&&parseFloat(e.replace(",","."));return(isNaN(t)?0:t)*i},o={y:n(s[2]),M:n(s[3]),d:n(s[4]),h:n(s[5]),m:n(s[6]),s:n(s[7]),w:n(s[8])}),r=new l(o),ct.isDuration(e)&&e.hasOwnProperty("_lang")&&(r._lang=e._lang),r},ct.version=pt,ct.defaultFormat=$t,ct.ISO_8601=function(){},ct.momentProperties=St,ct.updateOffset=function(){},ct.relativeTimeThreshold=function(t,i){return ni[t]===e?!1:(ni[t]=i,!0)},ct.lang=function(e,t){var i;return e?(t?A(F(e),t):null===t?(N(e),e="en"):Ct[e]||R(e),i=ct.duration.fn._lang=ct.fn._lang=R(e),i._abbr):ct.fn._lang._abbr},ct.langData=function(e){return e&&e._lang&&e._lang._abbr&&(e=e._lang._abbr),R(e)},ct.isMoment=function(e){return e instanceof a||null!=e&&e.hasOwnProperty("_isAMomentObject")},ct.isDuration=function(e){return e instanceof l},mt=li.length-1;mt>=0;--mt)y(li[mt]);ct.normalizeUnits=function(e){return g(e)},ct.invalid=function(e){var t=ct.utc(0/0);return null!=e?d(t._pf,e):t._pf.userInvalidated=!0,t},ct.parseZone=function(){return ct.apply(null,arguments).parseZone()},ct.parseTwoDigitYear=function(e){return b(e)+(b(e)>68?1900:2e3)},d(ct.fn=a.prototype,{clone:function(){return ct(this)},valueOf:function(){return+this._d+6e4*(this._offset||0)},unix:function(){return Math.floor(+this/1e3)},toString:function(){return this.clone().lang("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},toDate:function(){return this._offset?new Date(+this):this._d},toISOString:function(){var e=ct(this).utc();return 0<e.year()&&e.year()<=9999?P(e,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):P(e,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]")},toArray:function(){var e=this;return[e.year(),e.month(),e.date(),e.hours(),e.minutes(),e.seconds(),e.milliseconds()]},isValid:function(){return S(this)},isDSTShifted:function(){return this._a?this.isValid()&&_(this._a,(this._isUTC?ct.utc(this._a):ct(this._a)).toArray())>0:!1},parsingFlags:function(){return d({},this._pf)},invalidAt:function(){return this._pf.overflow},utc:function(){return this.zone(0)},local:function(){return this.zone(0),this._isUTC=!1,this},format:function(e){var t=P(this,e||ct.defaultFormat);return this.lang().postformat(t)},add:function(e,t){var i;return i="string"==typeof e&&"string"==typeof t?ct.duration(isNaN(+t)?+e:+t,isNaN(+t)?t:e):"string"==typeof e?ct.duration(+t,e):ct.duration(e,t),f(this,i,1),this},subtract:function(e,t){var i;return i="string"==typeof e&&"string"==typeof t?ct.duration(isNaN(+t)?+e:+t,isNaN(+t)?t:e):"string"==typeof e?ct.duration(+t,e):ct.duration(e,t),f(this,i,-1),this},diff:function(e,t,i){var r,n,o=M(e,this),s=6e4*(this.zone()-o.zone());return t=g(t),"year"===t||"month"===t?(r=432e5*(this.daysInMonth()+o.daysInMonth()),n=12*(this.year()-o.year())+(this.month()-o.month()),n+=(this-ct(this).startOf("month")-(o-ct(o).startOf("month")))/r,n-=6e4*(this.zone()-ct(this).startOf("month").zone()-(o.zone()-ct(o).startOf("month").zone()))/r,"year"===t&&(n/=12)):(r=this-o,n="second"===t?r/1e3:"minute"===t?r/6e4:"hour"===t?r/36e5:"day"===t?(r-s)/864e5:"week"===t?(r-s)/6048e5:r),i?n:u(n)},from:function(e,t){return ct.duration(this.diff(e)).lang(this.lang()._abbr).humanize(!t)},fromNow:function(e){return this.from(ct(),e)},calendar:function(e){var t=e||ct(),i=M(t,this).startOf("day"),r=this.diff(i,"days",!0),n=-6>r?"sameElse":-1>r?"lastWeek":0>r?"lastDay":1>r?"sameDay":2>r?"nextDay":7>r?"nextWeek":"sameElse";return this.format(this.lang().calendar(n,this))},isLeapYear:function(){return E(this.year())},isDST:function(){return this.zone()<this.clone().month(0).zone()||this.zone()<this.clone().month(5).zone()},day:function(e){var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=e?(e=Z(e,this.lang()),this.add({d:e-t})):t},month:lt("Month",!0),startOf:function(e){switch(e=g(e)){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===e?this.weekday(0):"isoWeek"===e&&this.isoWeekday(1),"quarter"===e&&this.month(3*Math.floor(this.month()/3)),this},endOf:function(e){return e=g(e),this.startOf(e).add("isoWeek"===e?"week":e,1).subtract("ms",1)},isAfter:function(e,t){return t="undefined"!=typeof t?t:"millisecond",+this.clone().startOf(t)>+ct(e).startOf(t)},isBefore:function(e,t){return t="undefined"!=typeof t?t:"millisecond",+this.clone().startOf(t)<+ct(e).startOf(t)},isSame:function(e,t){return t=t||"ms",+this.clone().startOf(t)===+M(e,this).startOf(t)},min:r("moment().min is deprecated, use moment.min instead. https://github.com/moment/moment/issues/1548",function(e){return e=ct.apply(null,arguments),this>e?this:e}),max:r("moment().max is deprecated, use moment.max instead. https://github.com/moment/moment/issues/1548",function(e){return e=ct.apply(null,arguments),e>this?this:e}),zone:function(e,t){var i=this._offset||0;return null==e?this._isUTC?i:this._d.getTimezoneOffset():("string"==typeof e&&(e=O(e)),Math.abs(e)<16&&(e=60*e),this._offset=e,this._isUTC=!0,i!==e&&(!t||this._changeInProgress?f(this,ct.duration(i-e,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,ct.updateOffset(this,!0),this._changeInProgress=null)),this)},zoneAbbr:function(){return this._isUTC?"UTC":""},zoneName:function(){return this._isUTC?"Coordinated Universal Time":""},parseZone:function(){return this._tzm?this.zone(this._tzm):"string"==typeof this._i&&this.zone(this._i),this},hasAlignedHourOffset:function(e){return e=e?ct(e).zone():0,(this.zone()-e)%60===0},daysInMonth:function(){return x(this.year(),this.month())},dayOfYear:function(e){var t=gt((ct(this).startOf("day")-ct(this).startOf("year"))/864e5)+1;return null==e?t:this.add("d",e-t)},quarter:function(e){return null==e?Math.ceil((this.month()+1)/3):this.month(3*(e-1)+this.month()%3)},weekYear:function(e){var t=tt(this,this.lang()._week.dow,this.lang()._week.doy).year;return null==e?t:this.add("y",e-t)},isoWeekYear:function(e){var t=tt(this,1,4).year;return null==e?t:this.add("y",e-t)},week:function(e){var t=this.lang().week(this);return null==e?t:this.add("d",7*(e-t))},isoWeek:function(e){var t=tt(this,1,4).week;return null==e?t:this.add("d",7*(e-t))},weekday:function(e){var t=(this.day()+7-this.lang()._week.dow)%7;return null==e?t:this.add("d",e-t)},isoWeekday:function(e){return null==e?this.day()||7:this.day(this.day()%7?e:e-7)},isoWeeksInYear:function(){return w(this.year(),1,4)},weeksInYear:function(){var e=this._lang._week;return w(this.year(),e.dow,e.doy)},get:function(e){return e=g(e),this[e]()},set:function(e,t){return e=g(e),"function"==typeof this[e]&&this[e](t),this},lang:function(t){return t===e?this._lang:(this._lang=R(t),this)}}),ct.fn.millisecond=ct.fn.milliseconds=lt("Milliseconds",!1),ct.fn.second=ct.fn.seconds=lt("Seconds",!1),ct.fn.minute=ct.fn.minutes=lt("Minutes",!1),ct.fn.hour=ct.fn.hours=lt("Hours",!0),ct.fn.date=lt("Date",!0),ct.fn.dates=r("dates accessor is deprecated. Use date instead.",lt("Date",!0)),ct.fn.year=lt("FullYear",!0),ct.fn.years=r("years accessor is deprecated. Use year instead.",lt("FullYear",!0)),ct.fn.days=ct.fn.day,ct.fn.months=ct.fn.month,ct.fn.weeks=ct.fn.week,ct.fn.isoWeeks=ct.fn.isoWeek,ct.fn.quarters=ct.fn.quarter,ct.fn.toJSON=ct.fn.toISOString,d(ct.duration.fn=l.prototype,{_bubble:function(){var e,t,i,r,n=this._milliseconds,o=this._days,s=this._months,a=this._data;a.milliseconds=n%1e3,e=u(n/1e3),a.seconds=e%60,t=u(e/60),a.minutes=t%60,i=u(t/60),a.hours=i%24,o+=u(i/24),a.days=o%30,s+=u(o/30),a.months=s%12,r=u(s/12),a.years=r},weeks:function(){return u(this.days()/7)},valueOf:function(){return this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*b(this._months/12)},humanize:function(e){var t=+this,i=et(t,!e,this.lang());return e&&(i=this.lang().pastFuture(t,i)),this.lang().postformat(i)},add:function(e,t){var i=ct.duration(e,t);return this._milliseconds+=i._milliseconds,this._days+=i._days,this._months+=i._months,this._bubble(),this},subtract:function(e,t){var i=ct.duration(e,t);return this._milliseconds-=i._milliseconds,this._days-=i._days,this._months-=i._months,this._bubble(),this},get:function(e){return e=g(e),this[e.toLowerCase()+"s"]()},as:function(e){return e=g(e),this["as"+e.charAt(0).toUpperCase()+e.slice(1)+"s"]()},lang:ct.fn.lang,toIsoString:function(){var e=Math.abs(this.years()),t=Math.abs(this.months()),i=Math.abs(this.days()),r=Math.abs(this.hours()),n=Math.abs(this.minutes()),o=Math.abs(this.seconds()+this.milliseconds()/1e3);return this.asSeconds()?(this.asSeconds()<0?"-":"")+"P"+(e?e+"Y":"")+(t?t+"M":"")+(i?i+"D":"")+(r||n||o?"T":"")+(r?r+"H":"")+(n?n+"M":"")+(o?o+"S":""):"P0D"}});for(mt in ei)ei.hasOwnProperty(mt)&&(ht(mt,ei[mt]),dt(mt.toLowerCase()));ht("Weeks",6048e5),ct.duration.fn.asMonths=function(){return(+this-31536e6*this.years())/2592e6+12*this.years()},ct.lang("en",{ordinal:function(e){var t=e%10,i=1===b(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th";return e+i}}),Ft?module.exports=ct:"function"==typeof define&&define.amd?(define("moment",function(e,t,i){return i.config&&i.config()&&i.config().noGlobal===!0&&(_t.moment=ft),ct}),ut(!0)):ut()}.call(this),Array.forEach||(Array.forEach=function(e,t,i){for(var r=e.length,n=0;r>n;n++)n in e&&t.call(i,e[n],n,e)}),Array.map||(Array.map=function(e,t,i){for(var r=e.length,n=[],o=0;r>o;o++)o in e&&(n[o]=t.call(i,e[o],o,e));return n}),Array.filter||(Array.filter=function(e,t,i){for(var r=e.length,n=[],o=0;r>o;o++)if(o in e){var s=e[o];t.call(i,s,o,e)&&n.push(s)}return n});var x3dom={canvases:[]};x3dom.x3dNS="http://www.web3d.org/specifications/x3d-namespace",x3dom.x3dextNS="http://philip.html5.org/x3d/ext",x3dom.xsltNS="http://www.w3.org/1999/XSL/x3dom.Transform",x3dom.xhtmlNS="http://www.w3.org/1999/xhtml",x3dom.nodeTypes={},x3dom.nodeTypesLC={},x3dom.components={},x3dom.geoCache=[],x3dom.caps={PLATFORM:navigator.platform,AGENT:navigator.userAgent},x3dom.registerNodeType=function(e,t,i){x3dom.debug.logInfo("Registering nodetype ["+e+"] in component ["+t+"]"),void 0===x3dom.components[t]?(x3dom.debug.logInfo("Adding new component ["+t+"]"),x3dom.components[t]={}):x3dom.debug.logInfo("Using component ["+t+"]"),i._typeName=e,i._compName=t,x3dom.components[t][e]=i,x3dom.nodeTypes[e]=i,x3dom.nodeTypesLC[e.toLowerCase()]=i
},x3dom.isX3DElement=function(e){return e.nodeType===Node.ELEMENT_NODE&&e.localName&&(x3dom.nodeTypes[e.localName]||x3dom.nodeTypesLC[e.localName.toLowerCase()]||"x3d"===e.localName.toLowerCase()||"websg"===e.localName.toLowerCase()||"scene"===e.localName.toLowerCase()||"route"===e.localName.toLowerCase())},x3dom.extend=function(e){function t(){}return t.prototype=e.prototype||e,new t},x3dom.getStyle=function(e,t){var i;return window&&window.getComputedStyle&&window.getComputedStyle(e,"")?i=window.getComputedStyle(e,"")[t]:e.currentStyle&&(t=t.replace(/\-(\w)/g,function(e,t){return t.toUpperCase()}),i=e.currentStyle[t]),i},x3dom.isa=function(e,t){function i(e){return e===t?!0:e.prototype&&e.prototype.constructor&&e.prototype.constructor.superClass?i(e.prototype.constructor.superClass):!1}return e?e.constructor===t?!0:void 0===e.constructor.superClass?!1:i(e.constructor.superClass):!1},x3dom.getGlobal=function(){return function(){return this}.call(null)},x3dom.isNumber=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},x3dom.loadJS=function(src,path_prefix,blocking){var blocking=blocking===!1?blocking:!0;if(blocking){var req,url=path_prefix?path_prefix.trim()+src:src;req=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),req&&(req.open("GET",url,!1),req.send(null),eval(req.responseText))}else{var head=document.getElementsByTagName("HEAD").item(0),script=document.createElement("script"),loadpath=path_prefix?path_prefix.trim()+src:src;head?(x3dom.debug.logError("Trying to load external JS file: "+loadpath),script.type="text/javascript",script.src=loadpath,head.appendChild(script,head.firstChild)):alert("No document object found. Can't load components")}},window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)}}(),x3dom.debug={INFO:"INFO",WARNING:"WARNING",ERROR:"ERROR",EXCEPTION:"EXCEPTION",isActive:!1,isFirebugAvailable:!1,isSetup:!1,isAppend:!1,numLinesLogged:0,maxLinesToLog:400,logContainer:null,setup:function(){if(!x3dom.debug.isSetup){try{void 0!==window.console.firebug&&(x3dom.debug.isFirebugAvailable=!0)}catch(e){x3dom.debug.isFirebugAvailable=!1}x3dom.debug.setupLogContainer(),x3dom.debug.isSetup=!0}},activate:function(e){x3dom.debug.isActive=!0,x3dom.debug.logContainer.style.display=e?"block":"none",x3dom.debug.isAppend||("Microsoft Internet Explorer"==navigator.appName?(x3dom.debug.logContainer.style.marginLeft="8px",document.documentElement.appendChild(x3dom.debug.logContainer)):document.body.appendChild(x3dom.debug.logContainer),x3dom.debug.isAppend=!0)},setupLogContainer:function(){x3dom.debug.logContainer=document.createElement("div"),x3dom.debug.logContainer.id="x3dom_logdiv",x3dom.debug.logContainer.style.border="2px solid olivedrab",x3dom.debug.logContainer.style.height="180px",x3dom.debug.logContainer.style.padding="4px",x3dom.debug.logContainer.style.overflow="auto",x3dom.debug.logContainer.style.whiteSpace="pre-wrap",x3dom.debug.logContainer.style.fontFamily="sans-serif",x3dom.debug.logContainer.style.fontSize="x-small",x3dom.debug.logContainer.style.color="#00ff00",x3dom.debug.logContainer.style.backgroundColor="black",x3dom.debug.logContainer.style.clear="both",x3dom.debug.logContainer.style.marginRight="10px"},doLog:function(e,t){if(x3dom.debug.isActive&&(x3dom.debug.numLinesLogged===x3dom.debug.maxLinesToLog&&(e="Maximum number of log lines (="+x3dom.debug.maxLinesToLog+") reached. Deactivating logging..."),!(x3dom.debug.numLinesLogged>x3dom.debug.maxLinesToLog))){var i=document.createElement("p");switch(i.style.margin=0,t){case x3dom.debug.INFO:i.style.color="#00ff00";break;case x3dom.debug.WARNING:i.style.color="#cd853f";break;case x3dom.debug.ERROR:i.style.color="#ff4500";break;case x3dom.debug.EXCEPTION:i.style.color="#ffff00";break;default:i.style.color="#00ff00"}try{i.innerHTML=t+": "+e,x3dom.debug.logContainer.insertBefore(i,x3dom.debug.logContainer.firstChild)}catch(r){void 0!==window.console.firebug&&window.console.warn(e)}if(x3dom.debug.isFirebugAvailable)switch(t){case x3dom.debug.INFO:window.console.info(e);break;case x3dom.debug.WARNING:window.console.warn(e);break;case x3dom.debug.ERROR:window.console.error(e);break;case x3dom.debug.EXCEPTION:window.console.debug(e)}x3dom.debug.numLinesLogged++}},logInfo:function(e){x3dom.debug.doLog(e,x3dom.debug.INFO)},logWarning:function(e){x3dom.debug.doLog(e,x3dom.debug.WARNING)},logError:function(e){x3dom.debug.doLog(e,x3dom.debug.ERROR)},logException:function(e){x3dom.debug.doLog(e,x3dom.debug.EXCEPTION)},assert:function(e,t){e||x3dom.debug.doLog("Assertion failed in "+x3dom.debug.assert.caller.name+": "+t,x3dom.debug.ERROR)},typeOf:function(e){var t=typeof e;return"object"!==t||e?t:"null"},exists:function(e,t,i){return i=i||"function",(e?this.typeOf(e[t]):"null")===i}},x3dom.debug.setup(),x3dom.ImageLoadManager={heap:[],complete:!1,activeDownloads:0,push:function(e){"webgl"==x3dom.caps.BACKEND&&void 0!=e._vf.url[0]&&(x3dom.debug.logInfo("[ImageLoadManager] Push image to queue: URL = "+e._vf.url[0]+" | Priority = "+e._vf.priority),x3dom.ImageLoadManager.heapUp(x3dom.ImageLoadManager.heap.push({priority:e._vf.priority,image:e._image,url:e._vf.url[0]})-1),x3dom.ImageLoadManager.complete&&(x3dom.ImageLoadManager.complete=!1,x3dom.ImageLoadManager.load()))},pop:function(){if(!x3dom.ImageLoadManager.isEmpty()){var e=x3dom.ImageLoadManager.heap[0],t=x3dom.ImageLoadManager.heap.pop();return x3dom.ImageLoadManager.heap.length>0&&(x3dom.ImageLoadManager.heap[0]=t,x3dom.ImageLoadManager.heapDown(0)),e}},load:function(){if("webgl"==x3dom.caps.BACKEND){for(x3dom.debug.logInfo("[ImageLoadManager] Start loading...");!x3dom.ImageLoadManager.isEmpty();){var e=x3dom.ImageLoadManager.pop();e.image.crossOrigin="",e.image.src=e.url,e.image.onload=x3dom.ImageLoadManager.onLoadFnc,x3dom.ImageLoadManager.activeDownloads++}x3dom.ImageLoadManager.complete=!0}},onLoadFnc:function(){var e=document.createEvent("HTMLEvents");e.initEvent("ImageLoadManager_Load",!0,!0),this.dispatchEvent(e)},getLeftChildIndex:function(e){return parseInt(2*e+1)},getRightChildIndex:function(e){return parseInt(2*e+2)},getParentIndex:function(e){return parseInt((e-1)/2)},heapUp:function(e){var t,i;0!=e&&(t=x3dom.ImageLoadManager.getParentIndex(e),x3dom.ImageLoadManager.heap[t].priority>x3dom.ImageLoadManager.heap[e].priority&&(i=x3dom.ImageLoadManager.heap[t],x3dom.ImageLoadManager.heap[t]=x3dom.ImageLoadManager.heap[e],x3dom.ImageLoadManager.heap[e]=i,x3dom.ImageLoadManager.heapUp(t)))},heapDown:function(e){var t,i,r,n;if(t=x3dom.ImageLoadManager.getLeftChildIndex(e),i=x3dom.ImageLoadManager.getRightChildIndex(e),i>=x3dom.ImageLoadManager.heap.length){if(t>=x3dom.ImageLoadManager.heap.length)return;r=t}else r=x3dom.ImageLoadManager.heap[t].priority<=x3dom.ImageLoadManager.heap[i].priority?t:i;x3dom.ImageLoadManager.heap[e].priority>x3dom.ImageLoadManager.heap[r].priority&&(n=x3dom.ImageLoadManager.heap[r],x3dom.ImageLoadManager.heap[r]=x3dom.ImageLoadManager.heap[e],x3dom.ImageLoadManager.heap[e]=n,x3dom.ImageLoadManager.heapDown(r))},isEmpty:function(){return 0==x3dom.ImageLoadManager.heap.length},toString:function(){for(var e="ImageLoadManager("+x3dom.ImageLoadManager.heap.length+") [",t=0;t<x3dom.ImageLoadManager.heap.length;t++)0!=t&&(e+=", "),e+=x3dom.ImageLoadManager.heap[t].priority+" - "+x3dom.ImageLoadManager.heap[t].url;return e+="]"},length:function(){return x3dom.ImageLoadManager.heap.length}},x3dom.Properties=function(){this.properties={}},x3dom.Properties.prototype.setProperty=function(e,t){x3dom.debug.logInfo("Properties: Setting property '"+e+"' to value '"+t+"'"),this.properties[e]=t},x3dom.Properties.prototype.getProperty=function(e,t){return this.properties[e]?this.properties[e]:t},x3dom.Properties.prototype.merge=function(e){for(var t in e.properties)this.properties[t]=e.properties[t]},x3dom.Properties.prototype.toString=function(){var e="";for(var t in this.properties)e+="Name: "+t+" Value: "+this.properties[t]+"\n";return e},x3dom.DoublyLinkedList=function(){this.length=0,this.first=null,this.last=null},x3dom.DoublyLinkedList.ListNode=function(e,t,i,r,n){this.point=e,this.point_index=t,this.normals=i,this.colors=r,this.texCoords=n,this.next=null,this.prev=null},x3dom.DoublyLinkedList.prototype.appendNode=function(e){null===this.first?(e.prev=e,e.next=e,this.first=e,this.last=e):(e.prev=this.last,e.next=this.first,this.first.prev=e,this.last.next=e,this.last=e),this.length++},x3dom.DoublyLinkedList.prototype.insertAfterNode=function(e,t){t.prev=e,t.next=e.next,e.next.prev=t,e.next=t,t.prev==this.last&&(this.last=t),this.length++},x3dom.DoublyLinkedList.prototype.deleteNode=function(e){this.length>1?(e.prev.next=e.next,e.next.prev=e.prev,e==this.first&&(this.first=e.next),e==this.last&&(this.last=e.prev)):(this.first=null,this.last=null),e.prev=null,e.next=null,this.length--},x3dom.DoublyLinkedList.prototype.getNode=function(e){var t=null;if(e>this.length)return t;for(var i=0;i<this.length;i++)if(t=0==i?this.first:t.next,i==e)return t},x3dom.DoublyLinkedList.prototype.invert=function(){var e=null,t=null;e=this.first;for(var i=0;i<this.length;i++)t=e.prev,e.prev=e.next,e.next=t,e=e.prev;t=this.first,this.first=this.last,this.last=t},x3dom.EarClipping={reversePointDirection:function(e,t){var i,r,n,o,s,a,l=0;if(e.length<3)return!1;for(var d=0;d<e.length;d++)i=(d+1)%e.length,r=(d+2)%e.length,o=e.getNode(d),s=e.getNode(i),a=e.getNode(r),"YZ"==t?(n=(s.point.y-o.point.y)*(a.point.z-s.point.z),n-=(s.point.z-o.point.z)*(a.point.y-s.point.y)):"XZ"==t?(n=(s.point.z-o.point.z)*(a.point.x-s.point.x),n-=(s.point.x-o.point.x)*(a.point.z-s.point.z)):(n=(s.point.x-o.point.x)*(a.point.y-s.point.y),n-=(s.point.y-o.point.y)*(a.point.x-s.point.x)),0>n?l--:n>0&&l++;return 0>l?(e.invert(),!0):!1},getIndexes:function(e){var t=e.first.next,i=this.identifyPlane(t.prev.point,t.point,t.next.point),r=this.reversePointDirection(e,i),n=[];t=e.first.next;for(var o=null,s=0,a=!0;e.length>=3&&10>s;){o=t.next;for(var l=0;l<e.length;l++)this.isNotEar(e.getNode(l).point,t.prev.point,t.point,t.next.point,i)&&(a=!1);if(a&&(this.isKonvex(t.prev.point,t.point,t.next.point,i)?(n.push(t.prev.point_index,t.point_index,t.next.point_index),e.deleteNode(t)):s++),3==s&&this.reversePointDirection(e))for(var d=this.getIndexes(e).reverse(),l=0;l<d.length;l++)n.push(d[l]);t=o,a=!0}return r?n.reverse():n},getMultiIndexes:function(e){var t=e.first.next,i=this.identifyPlane(t.prev.point,t.point,t.next.point),r=this.reversePointDirection(e,i),n=new Object;n.indices=[],n.point=[],n.normals=[],n.colors=[],n.texCoords=[],t=e.first.next;for(var o=null,s=0,a=!0;e.length>=3&&10>s;){o=t.next;for(var l=0;l<e.length;l++)this.isNotEar(e.getNode(l).point,t.prev.point,t.point,t.next.point,i)&&(a=!1);if(a&&(this.isKonvex(t.prev.point,t.point,t.next.point,i)?(n.indices.push(t.prev.point_index,t.point_index,t.next.point_index),n.point.push(t.prev.point,t.point,t.next.point),t.normals&&n.normals.push(t.prev.normals,t.normals,t.next.normals),t.colors&&n.colors.push(t.prev.colors,t.colors,t.next.colors),t.texCoords&&n.texCoords.push(t.prev.texCoords,t.texCoords,t.next.texCoords),e.deleteNode(t)):s++),3==s&&this.reversePointDirection(e)){var d=this.getMultiIndexes(e);n.indices=n.indices.concat(d.indices.reverse()),n.point=n.point.concat(d.point.reverse()),n.normals=n.normals.concat(d.normals.reverse()),n.colors=n.colors.concat(d.colors.reverse()),n.texCoords=n.texCoords.concat(d.texCoords.reverse())}t=o,a=!0}return r?(n.indices=n.indices.reverse(),n.point=n.point.reverse(),n.normals=n.normals.reverse(),n.colors=n.colors.reverse(),n.texCoords=n.texCoords.reverse(),n):n},isNotEar:function(e,t,i,r,n){var o,s,a,l,d,h,u,c,f,m,p,_;return"YZ"==n?(d=e.y,h=e.z,u=t.y,c=t.z,f=i.y,m=i.z,p=r.y,_=r.z):"XZ"==n?(d=e.z,h=e.x,u=t.z,c=t.x,f=i.z,m=i.x,p=r.z,_=r.x):(d=e.x,h=e.y,u=t.x,c=t.y,f=i.x,m=i.y,p=r.x,_=r.y),o=(f-u)*(_-c)-(p-u)*(m-c),0!=o?(s=((f-d)*(_-h)-(p-d)*(m-h))/o,a=((p-d)*(c-h)-(u-d)*(_-h))/o,l=1-s-a,s>0&&a>0&&l>0):!1},isKonvex:function(e,t,i,r){var n,o,s,a,l,d;"YZ"==r?(n=e.y,o=e.z,s=t.y,a=t.z,l=i.y,d=i.z):"XZ"==r?(n=e.z,o=e.x,s=t.z,a=t.x,l=i.z,d=i.x):(n=e.x,o=e.y,s=t.x,a=t.y,l=i.x,d=i.y);var h=(s-n)*(d-o)-(a-o)*(l-n);return 0>h?!1:!0},identifyPlane:function(e,t,i){var r,n,o,s,a,l,d,h,u;r=t.x-e.x,n=t.y-e.y,o=t.z-e.z,s=i.x-e.x,a=i.y-e.y,l=i.z-e.z,d=n*l-o*a,h=o*s-r*l,u=r*a-n*s;var c=Math.max(Math.abs(d),Math.abs(h),Math.abs(u));return c==Math.abs(d)?"YZ":c==Math.abs(h)?"XZ":c==Math.abs(u)?"XY":"fehler"}},x3dom.X3DCanvas=function(e,t){var i=this;this.canvasIdx=t,this.initContext=function(e){x3dom.debug.logInfo("Initializing X3DCanvas for ["+e.id+"]");var t=x3dom.gfx_webgl(e);return t?t:(x3dom.debug.logError("No 3D context found..."),this.x3dElem.removeChild(e),null)},this.initFlashContext=function(e){x3dom.debug.logInfo("Initializing X3DObject for ["+e.id+"]");var t=x3dom.gfx_flash(e);return t},this.appendParam=function(e,t,i){var r=document.createElement("param");r.setAttribute("name",t),r.setAttribute("value",i),e.appendChild(r)},this.detectFlash=function(e,t){var i=e,r=t,n=0;if("object"==typeof navigator.plugins["Shockwave Flash"]){var o=navigator.plugins["Shockwave Flash"].description;n=o.substr(16,o.indexOf(".",16)-16)}else if("function"==typeof ActiveXObject)for(var s=10;r+1>s;s++)try{"object"==typeof new ActiveXObject("ShockwaveFlash.ShockwaveFlash."+s)&&(n=s+1)}catch(a){}return[n,i]},this.createInitFailedDiv=function(e){var t=document.createElement("div");t.style.width=e.getAttribute("width"),t.style.height=e.getAttribute("height"),t.style.backgroundColor="#C00",t.style.color="#FFF",t.style.fontSize="20px",t.style.fontWidth="bold",t.style.padding="10px 10px 10px 10px",t.style.display="inline-block",t.style.fontFamily="Arial",t.style.textAlign="center",t.appendChild(document.createTextNode("Your Browser does not support X3DOM")),t.appendChild(document.createElement("br")),t.appendChild(document.createTextNode("Read more about X3DOM Browser support on:")),t.appendChild(document.createElement("br"));var i=document.createElement("a");i.setAttribute("href","http://www.x3dom.org/?page_id=9"),i.appendChild(document.createTextNode("X3DOM | Browser Support")),t.appendChild(i),e.appendChild(t),x3dom.debug.logError("Your Browser does not support X3DOM!")},this.createFlashObject=function(e){var t=this.detectFlash(11,11);if(!t[0]||t[0]<t[1])return null;x3dom.debug.logInfo("Creating FlashObject for (X)3D element...");var i=e.getAttribute("id");if(null!==i)i="x3dom-"+i+"-object";else{var r=(new Date).getTime();i="x3dom-"+r+"-object"}var n=e.getAttribute("swfpath");null===n&&(n="x3dom.swf");var o=e.getAttribute("width");if(null==o)o=550;else{var s=o.indexOf("px");-1!=s&&(o=o.substr(0,s))}var a=e.getAttribute("height");if(null==a)a=400;else{var s=a.indexOf("px");-1!=s&&(a=a.substr(0,s))}var l=document.createElement("object");return l.setAttribute("width",o),l.setAttribute("height",a),l.setAttribute("id",i),this.appendParam(l,"menu","false"),this.appendParam(l,"quality","high"),this.appendParam(l,"wmode","gpu"),this.appendParam(l,"allowScriptAccess","always"),this.appendParam(l,"flashvars","width="+o+"&height="+a+"&canvasIdx="+this.canvasIdx),this.appendParam(l,"movie",n),e.appendChild(l),"Microsoft Internet Explorer"==navigator.appName?l.setAttribute("classid","clsid:d27cdb6e-ae6d-11cf-96b8-444553540000"):(l.setAttribute("type","application/x-shockwave-flash"),l.setAttribute("data",n)),l},this.createHTMLCanvas=function(e){x3dom.debug.logInfo("Creating canvas for (X)3D element...");var t=document.createElement("canvas");t.setAttribute("class","x3dom-canvas");var r=e.getAttribute("style");r&&x3dom.debug.logInfo("Inline X3D styles detected");for(var n=["onmousedown","onmousemove","onmouseout","onmouseover","onmouseup","onclick","ondblclick","onkeydown","onkeypress","onkeyup","ontouchstart","ontouchmove","ontouchend","ontouchcancel","touchleave","ongesturestart","ongesturechange","ongestureend","MozTouchDown","MozTouchMove","MozTouchUp"],o=0;o<n.length;o++){var s=n[o],a=e.getAttribute(s);a&&(x3dom.debug.logInfo(s+", "+a),t.setAttribute(s,a))}e.__addEventListener||e.__removeEventListener||(e.__addEventListener=e.addEventListener,e.__removeEventListener=e.removeEventListener,e.addEventListener=function(e,t,r){var o,s=!1;for(o=0;o<n.length&&!s;o++)n[o]===e&&(s=!0);s?(x3dom.debug.logInfo("addEventListener for div.on"+e),i.canvas.addEventListener(e,t,r)):(x3dom.debug.logInfo("addEventListener for X3D.on"+e),this.__addEventListener(e,t,r))},e.removeEventListener=function(e,t,r){var o,s=!1;for(o=0;o<n.length&&!s;o++)n[o]===e&&(s=!0);s?(x3dom.debug.logInfo("removeEventListener for div.on"+e),i.canvas.removeEventListener(e,t,r)):(x3dom.debug.logInfo("removeEventListener for X3D.on"+e),this.__removeEventListener(e,t,r))}),e.appendChild(t);var l=e.getAttribute("id");if(null!==l)t.id="x3dom-"+l+"-canvas";else{var d=(new Date).getTime();t.id="x3dom-"+d+"-canvas"}var h=2,u=2;return null!==(h=e.getAttribute("width"))&&(t.style.width=h,t.setAttribute("width",h)),null!==(u=e.getAttribute("height"))&&(t.style.height=u,t.setAttribute("height",u)),t.setAttribute("tabindex","0"),t.focus(),t};var r=[0,0];if(this.watchForResize=function(){var e=[x3dom.getStyle(i.canvas,"width"),x3dom.getStyle(i.canvas,"height")];(r[0]!=e[0]||r[1]!=e[1])&&(r=e,i.x3dElem.setAttribute("width",e[0]),i.x3dElem.setAttribute("height",e[1]))},this.createStatDiv=function(){var e=document.createElement("div");return e.setAttribute("class","x3dom-statdiv"),e.innerHTML="0 fps",this.x3dElem.appendChild(e),e.oncontextmenu=e.onmousedown=function(e){return e.preventDefault(),e.stopPropagation(),e.returnValue=!1,!1},e},this.createProgressDiv=function(){var e=document.createElement("div");e.setAttribute("class","x3dom-progress");var t=document.createElement("strong");t.appendChild(document.createTextNode("Loading...")),e.appendChild(t);var i=document.createElement("span");return i.setAttribute("style","width: 25%;"),i.appendChild(document.createTextNode(" ")),e.appendChild(i),this.x3dElem.appendChild(e),e.oncontextmenu=e.onmousedown=function(e){return e.preventDefault(),e.stopPropagation(),e.returnValue=!1,!1},e},this.isFlashReady=!1,this.x3dElem=e,this.backend="none","flash"==this.x3dElem.getAttribute("backend")){if(this.backend="flash",this.canvas=this.createFlashObject(e),null==this.canvas)return this.createInitFailedDiv(e),null;this.canvas.parent=this,this.gl=this.initFlashContext(this.canvas)}else if(this.backend="webgl",this.canvas=this.createHTMLCanvas(e),this.canvas.parent=this,this.gl=this.initContext(this.canvas),null==this.gl){if(x3dom.debug.logInfo("Fallback to Flash Renderer"),this.backend="flash",this.canvas=this.createFlashObject(e),null==this.canvas)return this.createInitFailedDiv(e),null;this.canvas.parent=this,this.gl=this.initFlashContext(this.canvas)}x3dom.caps.BACKEND=this.backend,this.fps_t0=(new Date).getTime(),this.doc=null,e.__setAttribute=e.setAttribute,e.setAttribute=function(e,t){switch(this.__setAttribute(e,t),e){case"width":i.canvas.setAttribute("width",t),i.doc._viewarea&&(i.doc._viewarea._width=parseInt(i.canvas.getAttribute("width"),0));break;case"height":i.canvas.setAttribute("height",t),i.doc._viewarea&&(i.doc._viewarea._height=parseInt(i.canvas.getAttribute("height"),0))}i.doc.needRender=!0};var n=e.getAttribute("runtimeEnabled");if(this.hasRuntime=null!==n?"true"==n.toLowerCase():e.hasRuntime,null===this.gl&&(this.hasRuntime=!1),this.showStat=e.getAttribute("showStat"),this.statDiv=this.createStatDiv(),this.statDiv.style.display=null!==this.showStat&&"true"==this.showStat?"inline":"none",this.showProgress=e.getAttribute("showProgress"),this.progressDiv=this.createProgressDiv(),this.progressDiv.style.display="inline",null!==this.canvas&&null!==this.gl&&this.hasRuntime&&"flash"!==this.backend){this.canvas.mouse_dragging=!1,this.canvas.mouse_button=0,this.canvas.mouse_drag_x=0,this.canvas.mouse_drag_y=0,this.canvas.isMulti=!1,this.canvas.oncontextmenu=function(e){return e.preventDefault(),e.stopPropagation(),e.returnValue=!1,!1},this.canvas.addEventListener("mousedown",function(e){switch(this.focus(),e.button){case 0:this.mouse_button=1;break;case 1:this.mouse_button=4;break;case 2:this.mouse_button=2;break;default:this.mouse_button=0}this.mouse_drag_x=e.offsetX||e.layerX||e.x,this.mouse_drag_y=e.offsetY||e.layerY||e.y,this.mouse_dragging=!0,e.shiftKey&&(this.mouse_button=1),e.ctrlKey&&(this.mouse_button=4),e.altKey&&(this.mouse_button=2),this.parent.doc.onMousePress(i.gl,this.mouse_drag_x,this.mouse_drag_y,this.mouse_button),this.parent.doc.needRender=!0,window.status=this.id+" DOWN: "+(e.offsetX||e.layerX||e.x)+", "+(e.offsetY||e.layerY||e.y),e.returnValue=!0},!1),this.canvas.addEventListener("mouseup",function(e){this.mouse_button=0,this.mouse_dragging=!1,this.parent.doc.onMouseRelease(i.gl,this.mouse_drag_x,this.mouse_drag_y,this.mouse_button),this.parent.doc.needRender=!0,e.returnValue=!0},!1),this.canvas.addEventListener("mouseover",function(e){this.mouse_button=0,this.mouse_dragging=!1,this.parent.doc.onMouseOver(i.gl,this.mouse_drag_x,this.mouse_drag_y,this.mouse_button),this.parent.doc.needRender=!0,e.returnValue=!0},!1),this.canvas.addEventListener("mouseout",function(e){this.mouse_button=0,this.mouse_dragging=!1,this.parent.doc.onMouseOut(i.gl,this.mouse_drag_x,this.mouse_drag_y,this.mouse_button),this.parent.doc.needRender=!0,e.returnValue=!0},!1),this.canvas.addEventListener("dblclick",function(e){this.mouse_button=0,this.mouse_drag_x=e.offsetX||e.layerX||e.x,this.mouse_drag_y=e.offsetY||e.layerY||e.y,this.mouse_dragging=!1,this.parent.doc.onDoubleClick(i.gl,this.mouse_drag_x,this.mouse_drag_y),this.parent.doc.needRender=!0,window.status=this.id+" DBL: "+(e.offsetX||e.layerX||e.x)+", "+(e.offsetY||e.layerY||e.y),e.returnValue=!0},!1),this.canvas.addEventListener("mousemove",function(e){e.shiftKey&&(this.mouse_button=1),e.ctrlKey&&(this.mouse_button=4),e.altKey&&(this.mouse_button=2),this.isMulti||(this.mouse_drag_x=e.offsetX||e.layerX||e.x,this.mouse_drag_y=e.offsetY||e.layerY||e.y,this.mouse_dragging?this.parent.doc.onDrag(i.gl,this.mouse_drag_x,this.mouse_drag_y,this.mouse_button):this.parent.doc.onMove(i.gl,this.mouse_drag_x,this.mouse_drag_y,this.mouse_button)),this.parent.doc.needRender=!0,e.returnValue=!0},!1),this.canvas.addEventListener("DOMMouseScroll",function(e){this.mouse_drag_y+=2*e.detail,this.parent.doc.onDrag(i.gl,this.mouse_drag_x,this.mouse_drag_y,2),this.parent.doc.needRender=!0,window.status=this.id+" SCROLL: "+e.detail,e.returnValue=!0},!1),this.canvas.addEventListener("mousewheel",function(e){this.mouse_drag_y-=.1*e.wheelDeltaY,this.parent.doc.onDrag(i.gl,this.mouse_drag_x,this.mouse_drag_y,2),this.parent.doc.needRender=!0,window.status=this.id+" SCROLL: "+e.detail,e.returnValue=!0},!1),this.canvas.addEventListener("keypress",function(e){var t=this.parent.x3dElem.getAttribute("keysEnabled");t&&"true"!==t.toLowerCase()||this.parent.doc.onKeyPress(e.charCode),this.parent.doc.needRender=!0,e.returnValue=!0},!0),this.canvas.addEventListener("keyup",function(e){var t=this.parent.x3dElem.getAttribute("keysEnabled");t&&"true"!==t.toLowerCase()||this.parent.doc.onKeyUp(e.keyCode),this.parent.doc.needRender=!0,e.returnValue=!0},!0),this.canvas.addEventListener("keydown",function(e){var t=this.parent.x3dElem.getAttribute("keysEnabled");t&&"true"!==t.toLowerCase()||this.parent.doc.onKeyDown(e.keyCode),this.parent.doc.needRender=!0,e.returnValue=!0},!0);var o={numTouches:0,lastDrag:new x3dom.fields.SFVec2f,lastMiddle:new x3dom.fields.SFVec2f,lastDistance:new x3dom.fields.SFVec2f,lastSquareDistance:0,lastAngle:0,calcAngle:function(e){var t=e.normalize().dot(new x3dom.fields.SFVec2f(1,0));return t=Math.acos(t),e.y<0&&(t=Math.PI+(Math.PI-t)),t}},s=[],a={touches:[],preventDefault:function(){}},l=function(e){if(e.preventDefault(),o.numTouches<1&&1==e.touches.length)o.numTouches=1,o.lastDrag=new x3dom.fields.SFVec2f(e.touches[0].screenX,e.touches[0].screenY);else if(o.numTouches<2&&e.touches.length>=2){o.numTouches=2;var t=new x3dom.fields.SFVec2f(e.touches[0].screenX,e.touches[0].screenY),i=new x3dom.fields.SFVec2f(e.touches[1].screenX,e.touches[1].screenY),r=i.subtract(t),n=r.multiply(.5).add(t),s=r.dot(r);o.lastDistance=r,o.lastMiddle=n,o.lastSquareDistance=s,o.lastAngle=o.calcAngle(r)}},d=function(e){e.preventDefault();for(var t=!0,i=0;i<s.length;++i)s[i]==e.streamId&&(t=!1);1==t&&(e.identifier=e.streamId,s.push(e.streamId),a.touches.push(e)),l(a)},h=function(e,t){if(e.preventDefault(),1==e.touches.length){var r=new x3dom.fields.SFVec2f(e.touches[0].screenX,e.touches[0].screenY),n=r.subtract(o.lastDrag);o.lastDrag=r;var s=x3dom.fields.SFMatrix4f.rotationY(n.x/100),a=x3dom.fields.SFMatrix4f.rotationX(n.y/100),l=s.mult(a);t.onMoveView(i.gl,null,l),t.needRender=!0}else if(e.touches.length>=2){var d=new x3dom.fields.SFVec2f(e.touches[0].screenX,e.touches[0].screenY),h=new x3dom.fields.SFVec2f(e.touches[1].screenX,e.touches[1].screenY),u=h.subtract(d),c=u.multiply(.5).add(d),f=u.dot(u),m=c.subtract(o.lastMiddle),p=f-o.lastSquareDistance,_=new x3dom.fields.SFVec3f(m.x/500,-m.y/500,p/1e5),g=o.calcAngle(u),v=o.lastAngle-g;o.lastAngle=g;var l=x3dom.fields.SFMatrix4f.rotationZ(v);o.lastMiddle=c,o.lastDistance=u,o.lastSquareDistance=f,t.onMoveView(i.gl,_,l),t.needRender=!0}};touchMoveHandlerW3C=function(e){h(e,this.parent.doc)};var u=function(e){e.preventDefault();for(var t=0;t<s.length;++t)s[t]==e.streamId&&(a.touches[t]=e);h(a,e.view.myThat.doc)},c=function(e){e.preventDefault(),2==o.numTouches&&1==e.touches.length&&(o.lastDrag=new x3dom.fields.SFVec2f(e.touches[0].screenX,e.touches[0].screenY)),e.touches.length<2&&(o.numTouches=e.touches.length)},f=function(e){e.preventDefault();for(var t=-1,i=0;i<s.length;++i)s[i]==e.streamId&&(t=i);-1!=t&&(s.splice(t,1),a.touches.splice(t,1)),c(a)};this.canvas.addEventListener("MozTouchDown",d,!0),this.canvas.addEventListener("MozTouchMove",u,!0),this.canvas.addEventListener("MozTouchUp",f,!0),this.canvas.addEventListener("touchstart",l,!0),this.canvas.addEventListener("touchmove",touchMoveHandlerW3C,!0),this.canvas.addEventListener("touchend",c,!0)}},x3dom.X3DCanvas.prototype.tick=function(){var e=(new Date).getTime(),t=1e3/(e-this.fps_t0);this.fps_t0=e;try{this.doc.advanceTime(e/1e3);var i=(new Date).getTime()-e;this.doc.needRender&&(1==this.x3dElem.runtime.isReady?this.x3dElem.runtime.enterFrame():(this.x3dElem.runtime.ready(),this.x3dElem.runtime.isReady=!0,this.x3dElem.runtime.enterFrame()),this.statDiv&&(this.statDiv.textContent=t.toFixed(2)+" fps",this.statDiv.appendChild(document.createElement("br")),this.statDiv.appendChild(document.createTextNode("anim: "+i))),"flash"==this.backend?this.isFlashReady&&(this.canvas.setFPS({fps:t}),this.doc.needRender=!1,this.doc.render(this.gl)):(this.doc.needRender=!1,this.doc.render(this.gl))),(this.statDiv||this.progressDiv)&&(this.statDiv&&this.doc.downloadCount&&(this.doc.needRender?(this.statDiv.appendChild(document.createElement("br")),this.statDiv.appendChild(document.createTextNode("#Loading: "+this.doc.downloadCount))):this.statDiv.textContent="#Loading: "+this.doc.downloadCount),this.progressDiv&&(this.progressDiv.childNodes[0].textContent="Loading: "+this.doc.downloadCount,this.progressDiv.style.display=this.doc.downloadCount>0?"inline":"none",window.myThat=this,window.myStopProgress=function(){window.myThat.doc.downloadCount=0,window.myThat.progressDiv.style.display="none"},window.setTimeout("window.myStopProgress()",1500)))}catch(r){throw x3dom.debug.logException(r),r}},x3dom.X3DCanvas.prototype.load=function(e,t,i){this.doc=new x3dom.X3DDocument(this.canvas,this.gl,i);var r=this;this.doc.onload=function(){x3dom.debug.logInfo("loaded '"+e+"'"),r.hasRuntime?!function t(){r.watchForResize(),r.tick(),window.requestAnimFrame(t,r)}():r.tick()},this.x3dElem.render=function(){r.hasRuntime?r.doc.needRender=!0:r.doc.render(r.gl)},this.x3dElem.context=r.gl.ctx3d,this.doc.onerror=function(){alert("Failed to load X3D document")},this.doc.load(e,t)},x3dom.runtime={},x3dom.Runtime=function(e,t){this.doc=e,this.canvas=t,this.isReady=!1},x3dom.Runtime.prototype.initialize=function(e,t){this.doc=e,this.canvas=t,this.config={},this.isReady=!1},x3dom.Runtime.prototype.ready=function(){x3dom.debug.logInfo("System ready.")},x3dom.Runtime.prototype.enterFrame=function(){},x3dom.Runtime.prototype.getActiveBindable=function(e){var t,i,r,n,o;if(t=this.canvas.doc._bindableBag._stacks,n=[],o=x3dom.nodeTypesLC[e.toLowerCase()],!o)return x3dom.debug.logError('No node of type "'+e+'" found'),null;for(i=0;i<t.length;i++)r=t[i].getActive(),void 0!==r._xmlNode&&x3dom.isa(r,o)&&n.push(r);return n[0]?n[0]._xmlNode:null},x3dom.Runtime.prototype.nextView=function(){var e=this.canvas.doc._scene.getViewpoint()._stack;e?e.switchTo("next"):x3dom.debug.logError("No valid ViewBindable stack.")},x3dom.Runtime.prototype.prevView=function(){var e=this.canvas.doc._scene.getViewpoint()._stack;e?e.switchTo("prev"):x3dom.debug.logError("No valid ViewBindable stack.")},x3dom.Runtime.prototype.viewpoint=function(){return this.canvas.doc._scene.getViewpoint()},x3dom.Runtime.prototype.pojectionMatrix=function(){return this.canvas.doc._viewarea.getProjectionMatrix()},x3dom.Runtime.prototype.lightMatrix=function(){this.canvas.doc._viewarea.getLightMatrix()},x3dom.Runtime.prototype.resetView=function(){this.canvas.doc._viewarea.resetView()},x3dom.Runtime.prototype.lightView=function(){return this.canvas.doc._nodeBag.lights.length>0?(this.canvas.doc._viewarea.animateTo(this.canvas.doc._viewarea.getLightMatrix()[0],this.canvas.doc._scene.getViewpoint()),!0):(x3dom.debug.logInfo("No lights to navigate to"),!1)},x3dom.Runtime.prototype.uprightView=function(){this.canvas.doc._viewarea.uprightView()},x3dom.Runtime.prototype.showAll=function(){this.canvas.doc._viewarea.showAll()},x3dom.Runtime.prototype.debug=function(e){return e===!0&&(this.canvas.doc._viewarea._visDbgBuf=!0,x3dom.debug.logContainer.style.display="block",this.canvas.doc.needRender=!0),e===!1&&(this.canvas.doc._viewarea._visDbgBuf=!1,x3dom.debug.logContainer.style.display="none",this.canvas.doc.needRender=!0),this.canvas.doc._viewarea._visDbgBuf},x3dom.Runtime.prototype.navigationType=function(){return this.canvas.doc._scene.getNavigationInfo().getType()},x3dom.Runtime.prototype.examine=function(){this.canvas.doc._scene.getNavigationInfo().setType("examine")},x3dom.Runtime.prototype.fly=function(){this.canvas.doc._scene.getNavigationInfo().setType("fly")},x3dom.Runtime.prototype.lookAt=function(){this.canvas.doc._scene.getNavigationInfo().setType("lookat")},x3dom.Runtime.prototype.lookAround=function(){this.canvas.doc._scene.getNavigationInfo().setType("lookaround")},x3dom.Runtime.prototype.walk=function(){this.canvas.doc._scene.getNavigationInfo().setType("walk")},x3dom.Runtime.prototype.game=function(){this.canvas.doc._scene.getNavigationInfo().setType("game")},x3dom.Runtime.prototype.togglePoints=function(){this.canvas.doc._viewarea._points=!this.canvas.doc._viewarea._points,this.canvas.doc.needRender=!0},x3dom.Runtime.prototype.pickMode=function(e){return e&&e.internal===!0?this.canvas.doc._scene._vf.pickMode:this.canvas.doc._scene._vf.pickMode.toLowerCase()},x3dom.Runtime.prototype.changePickMode=function(e){switch(e=e.toLowerCase()){case"idbuf":e="idBuf";break;case"textcoord":e="textCoord";break;case"color":e="color";break;case"box":e="box";break;default:x3dom.debug.logWarning("Switch pickMode to "+e+"unknown intersect type"),e=void 0}return void 0!==e?(this.canvas.doc._scene._vf.pickMode=e,x3dom.debug.logInfo("Switched pickMode to '"+e+"'."),!1):!0},x3dom.Runtime.prototype.speed=function(e){return e&&(this.canvas.doc._scene.getNavigationInfo()._vf.speed=e,x3dom.debug.logInfo("Changed navigation speed to "+this.canvas.doc._scene.getNavigationInfo()._vf.speed)),this.canvas.doc._scene.getNavigationInfo()._vf.speed},x3dom.Runtime.prototype.statistics=function(e){var t=this.canvas.statDiv;
return t?e===!0?(t.style.display="inline",!0):e===!1?(t.style.display="none",!1):"none"!=t.style.display:void 0},x3dom.Runtime.prototype.processIndicator=function(e){var t=this.canvas.processDiv;return t?e===!0?(t.style.display="inline",!0):e===!1?(t.style.display="none",!1):"none"!=t.style.display:void 0},x3dom.Runtime.prototype.properties=function(){return this.canvas.doc.properties},x3dom.Runtime.prototype.backendName=function(){return this.canvas.backend},x3dom.detectActiveX=function(){var e=!1;if(window.ActiveXObject){var t=null;try{t=new ActiveXObject("AVALONATX.InstantPluginATXCtrl.1")}catch(i){}t&&(e=!0)}return e},x3dom.rerouteSetAttribute=function(e,t){e._setAttribute=e.setAttribute,e.setAttribute=function(i,r){var n=e.getAttribute("_x3domNode"),o=t.findNode(n);return o?o.parseField(i,r):0};for(var i=0;i<e.childNodes.length;i++){var r=e.childNodes[i];x3dom.rerouteSetAttribute(r,t)}},x3dom.insertActiveX=function(e){"undefined"==typeof x3dom.atxCtrlCounter&&(x3dom.atxCtrlCounter=0);var t=e.getAttribute("height"),i=e.getAttribute("width"),r=e.parentNode,n=document.createElement("div");n.setAttribute("id","x3dplaceholder");var o=r.insertBefore(n,e),s=document.createElement("div");s.style.display="none",r.appendChild(s),r.removeChild(e),s.appendChild(e);var a=document.createElement("object"),l="Avalon"+x3dom.atxCtrlCounter;x3dom.atxCtrlCounter++,a.setAttribute("id",l),a.setAttribute("classid","CLSID:F3254BA0-99FF-4D14-BD81-EDA9873A471E"),a.setAttribute("width",i?i:"500"),a.setAttribute("height",t?t:"500"),o.appendChild(a);var d=document.getElementById(l),h=d.getBrowser(),u=h.importDocument(e);h.replaceWorld(u),e.getBrowser=function(){return d.getBrowser()},x3dom.rerouteSetAttribute(e,h)},x3dom.userAgentFeature={supportsDOMAttrModified:!1},function(){var e=function(){var e,t,i,r,n,o=document.getElementsByTagName("X3D"),s=document.getElementsByTagName("webSG"),a=new x3dom.Properties,l=array_to_object(["showLog","showStat","showProgress","PrimitiveQuality","component","loadpath","disableDoubleClick","disableRightDrag","maxActiveDownloads"]);for(e=0;e<o.length;e++){for(a.setProperty("showLog",o[e].getAttribute("showLog")||"false"),a.setProperty("showStat",o[e].getAttribute("showStat")||"false"),a.setProperty("showProgress",o[e].getAttribute("showProgress")||"true"),a.setProperty("PrimitiveQuality",o[e].getAttribute("PrimitiveQuality")||"High"),i=o[e].getElementsByTagName("PARAM"),t=0;t<i.length;t++)i[t].getAttribute("name")in l&&a.setProperty(i[t].getAttribute("name"),i[t].getAttribute("value"));if(x3dom.debug.activate("true"===a.getProperty("showLog")?!0:!1),"undefined"!=typeof X3DOM_SECURITY_OFF&&X3DOM_SECURITY_OFF===!0&&(r=a.getProperty("components",o[e].getAttribute("components"))))for(n=a.getProperty("loadpath",o[e].getAttribute("loadpath")),r=r.trim().split(","),t=0;t<r.length;t++)x3dom.loadJS(r[t]+".js",n);if("undefined"!=typeof X3DOM_SECURITY_OFF&&X3DOM_SECURITY_OFF===!0&&o[e].getAttribute("src")){var d=document.createElement("scene"),h=document.createElement("Inline");h.setAttribute("url",o[e].getAttribute("src")),d.appendChild(h),o[e].appendChild(d)}}for(window.navigator.userAgent.match(/webkit/i)&&(x3dom.debug.logInfo("Active DOMAttrModifiedEvent workaround for webkit "),x3dom.userAgentFeature.supportsDOMAttrModified=!1),o=Array.map(o,function(e){return e.runtime=new x3dom.Runtime,e.hasRuntime=!0,e}),s=Array.map(s,function(e){return e.hasRuntime=!1,e}),e=0;e<s.length;e++)o.push(s[e]);void 0!==x3dom.versionInfo&&x3dom.debug.logInfo("X3Dom Version "+x3dom.versionInfo.version+", Revison "+x3dom.versionInfo.revision+", Date "+x3dom.versionInfo.date),x3dom.debug.logInfo("Found "+(o.length-s.length)+" X3D and "+s.length+" (experimental) WebSG nodes...");var u,c,f,m,p,_,g,v,y;for(e=0;e<o.length;e++)u=o[e],x3dom.detectActiveX()?x3dom.insertActiveX(u):(c=new x3dom.X3DCanvas(u,e),null!==c.gl?(v=(new Date).getTime(),o[e].runtime=new x3dom.Runtime(o[e],c),o[e].runtime.initialize(o[e],c),x3dom.runtime.ready&&(o[e].runtime.ready=x3dom.runtime.ready),c.load(o[e],e,a),o[e].runtime.statistics("true"===a.getProperty("showStat")?!0:!1),"true"===a.getProperty("showProgress")?("bar"===a.getProperty("showProgress")&&c.progressDiv.setAttribute("class","x3dom-progress bar"),o[e].runtime.processIndicator(!0)):o[e].runtime.processIndicator(!1),x3dom.canvases.push(c),y=(new Date).getTime()-v,x3dom.debug.logInfo("Time for setup and init of GL element no. "+e+": "+y+" ms.")):(f=document.createElement("div"),f.setAttribute("class","x3dom-nox3d"),m=document.createElement("p"),m.appendChild(document.createTextNode("WebGL is not yet supported in your browser. ")),p=document.createElement("a"),p.setAttribute("href","http://www.x3dom.org/?page_id=9"),p.appendChild(document.createTextNode("Follow link for a list of supported browsers... ")),f.appendChild(m),f.appendChild(p),c.x3dElem.appendChild(f),c.statDiv&&u.removeChild(c.statDiv),_=o[e].getAttribute("altImg")||null,_&&(g=new Image,g.src=_,u.style.backgroundImage="url("+_+")")));!function(e){var t=null;document.createEvent?(t=document.createEvent("Events"),t.initEvent(e,!0,!0),document.dispatchEvent(t)):document.createEventObject&&(t=document.createEventObject(),document.body.fireEvent("on"+e,t))}("load")},t=function(){for(var e=0;e<x3dom.canvases.length;e++)x3dom.canvases[e].doc.shutdown(x3dom.canvases[e].gl)};window.location.pathname.lastIndexOf(".xhtml")>0&&(document.__getElementById=document.getElementById,document.getElementById=function(e){var t=this.__getElementById(e);if(!t)for(var i=this.getElementsByTagName("*"),r=0;r<i.length&&!t;r++)i[r].getAttribute("id")===e&&(t=i[r]);return t}),window.addEventListener?(window.addEventListener("load",e,!1),window.addEventListener("unload",t,!1),window.addEventListener("reload",t,!1)):window.attachEvent&&(window.attachEvent("onload",e),window.attachEvent("onunload",t),window.attachEvent("onreload",t))}(),x3dom.gfx_webgl=function(){function e(e,t,i){this.ctx3d=e,this.canvas=t,this.name=i,this.cached_shader_programs={},this.cached_shaders={}}function t(t){for(var i=["moz-webgl","webkit-3d","experimental-webgl","webgl"],r=null,n={alpha:!0,depth:!0,stencil:!0,antialias:!0,premultipliedAlpha:!1},o=0;o<i.length;o++)try{if(r=t.getContext(i[o],n)){var s=new e(r,t,"webgl");try{r.getString?x3dom.debug.logInfo("\nVendor: "+r.getString(r.VENDOR)+", Renderer: "+r.getString(r.RENDERER)+", Version: "+r.getString(r.VERSION)+", ShadingLangV.: "+r.getString(r.SHADING_LANGUAGE_VERSION)+", \nExtensions: "+r.getString(r.EXTENSIONS)):(x3dom.debug.logInfo("\nVendor: "+r.getParameter(r.VENDOR)+", Renderer: "+r.getParameter(r.RENDERER)+", Version: "+r.getParameter(r.VERSION)+", ShadingLangV.: "+r.getParameter(r.SHADING_LANGUAGE_VERSION)),x3dom.caps.VENDOR=r.getParameter(r.VENDOR),x3dom.caps.VERSION=r.getParameter(r.VERSION),x3dom.caps.RENDERER=r.getParameter(r.RENDERER),x3dom.caps.SHADING_LANGUAGE_VERSION=r.getParameter(r.SHADING_LANGUAGE_VERSION),x3dom.caps.RED_BITS=r.getParameter(r.RED_BITS),x3dom.caps.GREEN_BITS=r.getParameter(r.GREEN_BITS),x3dom.caps.BLUE_BITS=r.getParameter(r.BLUE_BITS),x3dom.caps.ALPHA_BITS=r.getParameter(r.ALPHA_BITS),x3dom.caps.MAX_VERTEX_ATTRIBS=r.getParameter(r.MAX_VERTEX_ATTRIBS),x3dom.caps.MAX_VERTEX_TEXTURE_IMAGE_UNITS=r.getParameter(r.MAX_VERTEX_TEXTURE_IMAGE_UNITS),x3dom.caps.MAX_VARYING_VECTORS=r.getParameter(r.MAX_VARYING_VECTORS),x3dom.caps.MAX_VERTEX_UNIFORM_VECTORS=r.getParameter(r.MAX_VERTEX_UNIFORM_VECTORS),x3dom.caps.MAX_COMBINED_TEXTURE_IMAGE_UNITS=r.getParameter(r.MAX_COMBINED_TEXTURE_IMAGE_UNITS),x3dom.caps.MAX_TEXTURE_SIZE=r.getParameter(r.MAX_TEXTURE_SIZE),x3dom.caps.MAX_CUBE_MAP_TEXTURE_SIZE=r.getParameter(r.MAX_CUBE_MAP_TEXTURE_SIZE),x3dom.caps.NUM_COMPRESSED_TEXTURE_FORMATS=r.getParameter(r.NUM_COMPRESSED_TEXTURE_FORMATS),x3dom.caps.MAX_RENDERBUFFER_SIZE=r.getParameter(r.MAX_RENDERBUFFER_SIZE),x3dom.caps.MAX_VIEWPORT_DIMS=r.getParameter(r.MAX_VIEWPORT_DIMS),x3dom.caps.ALIASED_LINE_WIDTH_RANGE=r.getParameter(r.ALIASED_LINE_WIDTH_RANGE),x3dom.caps.ALIASED_POINT_SIZE_RANGE=r.getParameter(r.ALIASED_POINT_SIZE_RANGE),x3dom.caps.EXTENSIONS=r.getSupportedExtensions(),x3dom.caps.MOBILE=function(e){return/android.+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|e\-|e\/|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(di|rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|xda(\-|2|g)|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))?!0:!1}(navigator.userAgent||navigator.vendor||window.opera),x3dom.caps.MOBILE&&x3dom.debug.logWarning("Detect mobile Browser! Using low quality shaders!"))}catch(a){x3dom.debug.logWarning("Your browser probably supports an older WebGL version. Please try the mobile runtime instead:\nhttp://www.x3dom.org/x3dom/src_mobile/x3dom.js")}return s}}catch(l){}return null}function i(e,t){var i=e.createProgram(),r=e.createShader(e.VERTEX_SHADER),n=e.createShader(e.FRAGMENT_SHADER);e.shaderSource(r,l["vs-x3d-"+t].data),e.shaderSource(n,l["fs-x3d-"+t].data),e.compileShader(r),e.getShaderParameter(r,e.COMPILE_STATUS)||x3dom.debug.logError("VertexShader "+e.getShaderInfoLog(r)),e.compileShader(n),e.getShaderParameter(n,e.COMPILE_STATUS)||x3dom.debug.logError("FragmentShader "+e.getShaderInfoLog(n)),e.attachShader(i,r),e.attachShader(i,n),e.linkProgram(i);var o=e.getProgramInfoLog(i);return o&&x3dom.debug.logError(o),s(e,i)}function r(e){if(!n(e.width)||!n(e.height)){var t=document.createElement("canvas");t.width=o(e.width),t.height=o(e.height);var i=t.getContext("2d");i.drawImage(e,0,0,e.width,e.height,0,0,t.width,t.height),e=t}return e}function n(e){return 0===(e&e-1)}function o(e){--e;for(var t=1;32>t;t<<=1)e|=e>>t;return e+1}function s(e,t){var i={};i.bind=function(){e.useProgram(t)};var r,n=null,o=null,s=0,a=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(s=0;a>s;++s){try{o=e.getActiveUniform(t,s)}catch(l){}r=e.getError(),0!==r&&x3dom.debug.logError("GL-Error: "+r),n=e.getUniformLocation(t,o.name);var d=o.name;switch(o.name.lastIndexOf("[0]")==o.name.length-3&&(x3dom.debug.logInfo(o.name),d=o.name.substr(0,o.name.length-3)),o.type){case e.SAMPLER_2D:i.__defineSetter__(d,function(t){return function(i){e.uniform1i(t,i)}}(n));break;case e.SAMPLER_CUBE:i.__defineSetter__(d,function(t){return function(i){e.uniform1i(t,i)}}(n));break;case e.BOOL:i.__defineSetter__(d,function(t){return function(i){e.uniform1i(t,i)}}(n));break;case e.FLOAT:i.__defineSetter__(d,function(t){return function(i){e.uniform1f(t,i)}}(n));break;case e.FLOAT_VEC2:i.__defineSetter__(d,function(t){return function(i){e.uniform2f(t,i[0],i[1])}}(n));break;case e.FLOAT_VEC3:i.__defineSetter__(d,function(t){return function(i){e.uniform3f(t,i[0],i[1],i[2])}}(n));break;case e.FLOAT_VEC4:i.__defineSetter__(d,function(t){return function(i){e.uniform4f(t,i[0],i[1],i[2],i[3])}}(n));break;case e.FLOAT_MAT2:i.__defineSetter__(d,function(t){return function(i){e.uniformMatrix2fv(t,!1,new Float32Array(i))}}(n));break;case e.FLOAT_MAT3:i.__defineSetter__(d,function(t){return function(i){e.uniformMatrix3fv(t,!1,new Float32Array(i))}}(n));break;case e.FLOAT_MAT4:i.__defineSetter__(d,function(t){return function(i){e.uniformMatrix4fv(t,!1,new Float32Array(i))}}(n));break;case e.INT:i.__defineSetter__(d,function(t){return function(i){e.uniform1i(t,i)}}(n));break;default:x3dom.debug.logWarning("GLSL program variable "+o.name+" has unknown type "+o.type)}}var h=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES);for(s=0;h>s;++s){try{o=e.getActiveAttrib(t,s)}catch(u){}r=e.getError(),0!==r&&x3dom.debug.logError("GL-Error: "+r),n=e.getAttribLocation(t,o.name),i[o.name]=n}return i}function a(e){var t=[0,!1],i=e.getLights(),r=i.length;r>0&&(t[0]=r>8?8:r);for(var n=0;r>n;n++)i[n]._vf.shadowIntensity>0&&(t[1]=!0);var o=e._scene.getNavigationInfo();return o._vf.headlight&&(t[0]+=1),t}e.prototype.getName=function(){return this.name};var l={};return l["vs-x3d-bg-texture"]={type:"vertex",data:"attribute vec3 position;varying vec2 fragTexCoord;void main(void) {    vec2 texCoord = (position.xy + 1.0) * 0.5;    fragTexCoord = texCoord;    gl_Position = vec4(position.xy, 0.0, 1.0);}"},l["vs-x3d-bg-texture-bgnd"]={type:"vertex",data:"attribute vec3 position;attribute vec2 texcoord;uniform mat4 modelViewProjectionMatrix;varying vec2 fragTexCoord;void main(void) {    fragTexCoord = texcoord.xy;    gl_Position = modelViewProjectionMatrix * vec4(position, 1.0);}"},l["fs-x3d-bg-texture"]={type:"fragment",data:"#ifdef GL_ES             \n  precision highp float; \n#endif                   \n\nuniform sampler2D tex;\nvarying vec2 fragTexCoord;\n\nvoid main(void) {\n    gl_FragColor = texture2D(tex, fragTexCoord);\n}"},l["vs-x3d-bg-textureCube"]={type:"vertex",data:"attribute vec3 position;uniform mat4 modelViewProjectionMatrix;varying vec3 fragNormal;void main(void) {    fragNormal = (vec4(normalize(position), 0.0)).xyz;    gl_Position = modelViewProjectionMatrix * vec4(position, 1.0);}"},l["fs-x3d-bg-textureCube"]={type:"fragment",data:"#ifdef GL_ES             \n  precision highp float; \n#endif                   \n\nuniform samplerCube tex;varying vec3 fragNormal;void main(void) {    vec3 normal = -reflect(normalize(fragNormal), vec3(0.0,0.0,1.0));    if (abs(normal.y) >= abs(normal.x) && abs(normal.y) >= abs(normal.z))        normal.x *= -1.0;    gl_FragColor = textureCube(tex, normal);}"},l["vs-x3d-vertexcolorUnlit"]={type:"vertex",data:"attribute vec3 position;attribute vec3 color;varying vec3 fragColor;uniform mat4 modelViewProjectionMatrix;void main(void) {    gl_Position = modelViewProjectionMatrix * vec4(position, 1.0);    gl_PointSize = 2.0;    fragColor = color;}"},l["fs-x3d-vertexcolorUnlit"]={type:"fragment",data:"#ifdef GL_ES             \n  precision highp float; \n#endif                   \n\nuniform vec3 diffuseColor;uniform float alpha;uniform float lightOn;varying vec3 fragColor;void main(void) {    gl_FragColor = vec4(fragColor, alpha);}"},l["vs-x3d-default"]={type:"vertex",data:"attribute vec3 position;uniform mat4 modelViewProjectionMatrix;void main(void) {    gl_Position = modelViewProjectionMatrix * vec4(position, 1.0);}"},l["fs-x3d-default"]={type:"fragment",data:"#ifdef GL_ES             \n  precision highp float; \n#endif                   \n\nstruct Material {   vec3  diffuseColor;   vec3  specularColor;   vec3  emissiveColor;   float shininess;   float transparency;   float ambientIntensity;};uniform Material material;void main(void) {    gl_FragColor = vec4(material.emissiveColor, 1.0);}"},l["vs-x3d-texcoordUnlit"]={type:"vertex",data:"attribute vec3 position;attribute vec2 texcoord;varying vec3 fragColor;uniform mat4 modelViewProjectionMatrix;void main(void) {    gl_Position = modelViewProjectionMatrix * vec4(position, 1.0);    fragColor = vec3(abs(texcoord.x), abs(texcoord.y), 0.0);}"},l["fs-x3d-texcoordUnlit"]={type:"fragment",data:"#ifdef GL_ES             \n  precision highp float; \n#endif                   \n\nuniform float alpha;varying vec3 fragColor;void main(void) {    gl_FragColor = vec4(fragColor, alpha);}"},l["vs-x3d-pick"]={type:"vertex",data:"attribute vec3 position;uniform mat4 modelMatrix;uniform mat4 modelViewProjectionMatrix;uniform vec3 wcMin;uniform vec3 wcMax;varying vec3 worldCoord;void main(void) {    worldCoord = (modelMatrix * vec4(position, 1.0)).xyz;    vec3 dia = wcMax - wcMin;    worldCoord = worldCoord - wcMin;    worldCoord.x /= dia.x;    worldCoord.y /= dia.y;    worldCoord.z /= dia.z;    gl_Position = modelViewProjectionMatrix * vec4(position, 1.0);}"},l["vs-x3d-pickIG"]={type:"vertex",data:"attribute vec3 position;uniform mat4 modelMatrix;uniform mat4 modelViewProjectionMatrix;uniform vec3 wcMin;uniform vec3 wcMax;varying vec3 worldCoord;uniform float indexed;uniform float imageGeometry;uniform vec3 IG_bboxMin;uniform vec3 IG_bboxMax;uniform float IG_coordTextureWidth;uniform float IG_coordTextureHeight;uniform float IG_indexTextureWidth;uniform float IG_indexTextureHeight;uniform sampler2D IG_indexTexture;uniform sampler2D IG_coordinateTexture;void main(void) {  if(imageGeometry == 1.0) {   vec2 IG_texCoord;  if(indexed == 1.0) {   vec2 halfPixel = vec2(0.5/IG_indexTextureWidth,0.5/IG_indexTextureHeight);   IG_texCoord = vec2(position.x*(256.0/IG_indexTextureWidth), position.y*(256.0/IG_indexTextureHeight)) + halfPixel;   vec2 IG_index = texture2D( IG_indexTexture, IG_texCoord ).rg;   IG_texCoord = IG_index * 0.996108948;  } else {    vec2 halfPixel = vec2(0.5/IG_coordTextureWidth, 0.5/IG_coordTextureHeight);   IG_texCoord = vec2(position.x*(256.0/IG_coordTextureWidth), position.y*(256.0/IG_coordTextureHeight)) + halfPixel;  }  vec3 pos = texture2D( IG_coordinateTexture, IG_texCoord ).rgb;   pos = pos * (IG_bboxMax - IG_bboxMin) + IG_bboxMin;     worldCoord = (modelMatrix * vec4(pos, 1.0)).xyz;  gl_Position = modelViewProjectionMatrix * vec4(pos, 1.0);  } else {      worldCoord = (modelMatrix * vec4(position, 1.0)).xyz;  gl_Position = modelViewProjectionMatrix * vec4(position, 1.0);  }    vec3 dia = wcMax - wcMin;    worldCoord = worldCoord - wcMin;    worldCoord.x /= dia.x;    worldCoord.y /= dia.y;    worldCoord.z /= dia.z;}"},l["fs-x3d-pick"]={type:"fragment",data:"#ifdef GL_ES             \n  precision highp float; \n#endif                   \n\nuniform float alpha;varying vec3 worldCoord;void main(void) {    gl_FragColor = vec4(worldCoord, alpha);}"},l["vs-x3d-shadow"]={type:"vertex",data:"attribute vec3 position;uniform mat4 modelViewProjectionMatrix;varying vec4 projCoord;void main(void) {   projCoord = modelViewProjectionMatrix * vec4(position, 1.0);   gl_Position = projCoord;}"},l["fs-x3d-shadow"]={type:"fragment",data:"#ifdef GL_ES             \n  precision highp float; \n#endif                   \n\nvarying vec4 projCoord;void main(void) {    vec3 proj = (projCoord.xyz / projCoord.w);    vec4 outVal = vec4(0.0);    float toFixed = 255.0 / 256.0;    outVal.r = fract(proj.z * toFixed);    outVal.g = fract(proj.z * toFixed * 255.0);    outVal.b = fract(proj.z * toFixed * 255.0 * 255.0);    outVal.a = fract(proj.z * toFixed * 255.0 * 255.0 * 255.0);    gl_FragColor = outVal;}"},e.prototype.getShaderProgram=function(e,t){var i=[],r=null;if(this.cached_shader_programs[t[0]+t[1]])r=this.cached_shader_programs[t[0]+t[1]];else{for(var n=0;2>n;n++){if(!l[t[n]])return void x3dom.debug.logError("Cannot find shader "+t[n]);if(this.cached_shaders[t[n]])i[n]=this.cached_shaders[t[n]];else{if("vertex"==l[t[n]].type)i[n]=e.createShader(e.VERTEX_SHADER);else{if("fragment"!=l[t[n]].type)return void x3dom.debug.logError("Invalid shader type "+l[n].type);i[n]=e.createShader(e.FRAGMENT_SHADER)}e.shaderSource(i[n],l[t[n]].data),e.compileShader(i[n]),e.getShaderParameter(i[n],e.COMPILE_STATUS)||x3dom.debug.logError(0==n?"VertexShader "+e.getShaderInfoLog(i[n]):"FragmentShader "+e.getShaderInfoLog(i[n])),this.cached_shaders[t[n]]=i[n]}}r=e.createProgram(),e.attachShader(r,i[0]),e.attachShader(r,i[1]),e.linkProgram(r);var o=e.getProgramInfoLog(r);o&&x3dom.debug.logError(o),this.cached_shader_programs[t[0]+t[1]]=s(e,r),r=this.cached_shader_programs[t[0]+t[1]]}return r},e.prototype.generateVSMobile=function(e,t){var i=t._cf.appearance.node._cf.texture.node||x3dom.isa(t._cf.geometry.node,x3dom.nodeTypes.Text)?1:0,r=null!==t._cf.appearance.node._cf.textureTransform.node?1:0,n=void 0!==t._cf.geometry.node._cf.texCoord&&null!==t._cf.geometry.node._cf.texCoord.node&&t._cf.geometry.node._cf.texCoord.node._vf.mode&&"sphere"==t._cf.geometry.node._cf.texCoord.node._vf.mode.toLowerCase()?1:0,o=t._cf.appearance.node._cf.texture.node&&x3dom.isa(t._cf.appearance.node._cf.texture.node,x3dom.nodeTypes.X3DEnvironmentTextureNode)?1:0,s=x3dom.isa(t._cf.geometry.node,x3dom.nodeTypes.Text)||o||t._cf.appearance.node._cf.texture.node&&(1==t._cf.appearance.node._cf.texture.node._vf.origChannelCount||2==t._cf.appearance.node._cf.texture.node._vf.origChannelCount)?1:0,a=t._cf.geometry.node._mesh._colors[0].length>0||t._cf.geometry.node.getColorTexture()?t._cf.geometry.node._mesh._numColComponents:0,d=e.getLights().length+e._scene.getNavigationInfo()._vf.headlight,h=t.isSolid()?1:0,u=e._scene.getFog()._vf.visibilityRange>0?1:0,c=x3dom.isa(t._cf.geometry.node,x3dom.nodeTypes.ImageGeometry)?1:0,f=c?t._cf.geometry.node.numCoordinateTextures():0,m=c&&null!=t._cf.geometry.node.getIndexTexture()?1:0,p="vs-x3d-mobil-"+a+i+r+n+s+o+h+u+d+c+f+m;if(!l[p]){var _="";if(_+="attribute vec3 position;\n",_+="attribute vec3 normal;\n",_+="uniform mat4 modelViewMatrix;\n",_+="uniform mat4 normalMatrix;\n",_+="uniform mat4 modelViewProjectionMatrix;\n",_+="uniform vec3  diffuseColor;\n",_+="uniform vec3  specularColor;\n",_+="uniform vec3  emissiveColor;\n",_+="uniform float shininess;\n",_+="uniform float transparency;\n",_+="uniform float ambientIntensity;\n",_+="varying vec4 fragColor;\n",c){_+="uniform vec3 IG_bboxMin;",_+="uniform vec3 IG_bboxMax;",_+="uniform float IG_coordTextureWidth;",_+="uniform float IG_coordTextureHeight;",_+="uniform sampler2D IG_normalTexture;";for(var g=0;f>g;g++)_+="uniform sampler2D IG_coordinateTexture"+g+";";m&&(_+="uniform sampler2D IG_indexTexture;",_+="uniform float IG_indexTextureWidth;",_+="uniform float IG_indexTextureHeight;")}if(u&&(_+="uniform vec3  fogColor;\nuniform float fogType;\nuniform float fogRange;\nfloat calcFog(in vec3 eye) {\n   float f0 = 0.0;\n   if(fogType == 0.0) {\n       if(length(eye) < fogRange){\n           f0 = (fogRange-length(eye)) / fogRange;\n       }\n   }else{\n       if(length(eye) < fogRange){\n           f0 = exp(-length(eye) / (fogRange-length(eye) ) );\n       }\n   }\n   f0 = clamp(f0, 0.0, 1.0);\n   return f0;\n}"),d){for(var v=0;d>v;v++)_+="uniform float Light"+v+"_On;\n",_+="uniform float Light"+v+"_Type;\n",_+="uniform vec3  Light"+v+"_Location;\n",_+="uniform vec3  Light"+v+"_Direction;\n",_+="uniform vec3  Light"+v+"_Color;\n",_+="uniform vec3  Light"+v+"_Attenuation;\n",_+="uniform float Light"+v+"_Intensity;\n",_+="uniform float Light"+v+"_AmbientIntensity;\n",_+="uniform float Light"+v+"_BeamWidth;\n",_+="uniform float Light"+v+"_CutOffAngle;\n",_+="uniform float Light"+v+"_ShadowIntensity;\n";_+="void lighting(in float lType, in vec3 lLocation, in vec3 lDirection, in vec3 lColor, in vec3 lAttenuation,       in float lIntensity, in float lAmbientIntensity, in float lBeamWidth, in float lCutOffAngle,       in vec3 N, in vec3 V, inout vec3 ambient, inout vec3 diffuse, inout vec3 specular) {   vec3 L;\n   float spot = 1.0, attentuation = 1.0;\n   if(lType == 0.0) {\n       L = -normalize(lDirection);\n   }else{\n       L = normalize(lLocation - (-V));       float distance = length(L);       L /= distance;\n       attentuation = 1.0 / (lAttenuation.x + lAttenuation.y * distance + lAttenuation.z * (distance * distance));       attentuation *= max(0.0, dot(N, L));       if(lType == 2.0) {           float spotAngle = acos(max(0.0, dot(-L, normalize(lDirection))));           if(spotAngle >= lCutOffAngle) spot = 0.0;           else if(spotAngle <= lBeamWidth) spot = 1.0;           else spot = (spotAngle - lCutOffAngle ) / (lBeamWidth - lCutOffAngle);       }   }   vec3  H = normalize( L + V );\n   float NdotL = max(0.0, dot(N, L));\n   float NdotH = max(0.0, dot(N, H));\n   float ambientFactor  = lAmbientIntensity * ambientIntensity;   float diffuseFactor  = lIntensity * NdotL;   float specularFactor = lIntensity * NdotL * pow(NdotH, shininess*128.0);   ambient  += lColor * ambientFactor * attentuation * spot;   diffuse  += lColor * diffuseFactor * attentuation * spot;   specular += lColor * specularFactor * attentuation * spot;}"}if(a&&(_+=c?"uniform sampler2D IG_colorTexture;":3==a?"attribute vec3 color;":"attribute vec4 color;"),i&&(_+=c?"uniform sampler2D IG_texCoordTexture;":"attribute vec2 texcoord;\n",_+="varying vec2 fragTexcoord;\n",r&&(_+="uniform mat4 texTrafoMatrix;\n"),s||(_+="varying vec3 fragAmbient;\n",_+="varying vec3 fragDiffuse;\n"),o&&(_+="varying vec3 fragViewDir;\n",_+="varying vec3 fragNormal;\n",_+="uniform mat4 viewMatrix;\n")),_+="void main(void) {\n",c){m?(_+="vec2 halfPixel = vec2(0.5/IG_indexTextureWidth,0.5/IG_indexTextureHeight);",_+="vec2 IG_texCoord = vec2(position.x*(256.0/IG_indexTextureWidth), position.y*(256.0/IG_indexTextureHeight)) + halfPixel;",_+="vec2 IG_index = texture2D( IG_indexTexture, IG_texCoord ).rg;",_+="halfPixel = vec2(0.5/IG_coordTextureWidth,0.5/IG_coordTextureHeight);",_+="IG_texCoord = (IG_index * 0.996108948) + halfPixel;"):(_+="vec2 halfPixel = vec2(0.5/IG_coordTextureWidth, 0.5/IG_coordTextureHeight);",_+="vec2 IG_texCoord = vec2(position.x*(256.0/IG_coordTextureWidth), position.y*(256.0/IG_coordTextureHeight)) + halfPixel;"),_+="vec3 temp = vec3(0.0, 0.0, 0.0);",_+="vec3 vertPosition = vec3(0.0, 0.0, 0.0);";for(var g=0;f>g;g++)_+="temp = texture2D( IG_coordinateTexture"+g+", IG_texCoord ).rgb;",g&&(_+="temp /= ("+g+".0 * 256.0);"),_+="vertPosition += temp;";_+="vertPosition = vertPosition * (IG_bboxMax - IG_bboxMin) + IG_bboxMin;",_+="vec3 vertNormal = texture2D( IG_normalTexture, IG_texCoord ).rgb;",_+="vertNormal = vertNormal * 2.0 - 1.0;",i&&(_+="vec4 IG_doubleTexCoords = texture2D( IG_texCoordTexture, IG_texCoord );",_+="vec2 vertTexCoord;",_+="vertTexCoord.r = (IG_doubleTexCoords.r * 0.996108948) + (IG_doubleTexCoords.b * 0.003891051);",_+="vertTexCoord.g = (IG_doubleTexCoords.g * 0.996108948) + (IG_doubleTexCoords.a * 0.003891051);"),3==a?_+="vec3 vertColor = texture2D( IG_colorTexture, IG_texCoord ).rgb;":4==a&&(_+="vec4 vertColor = texture2D( IG_colorTexture, IG_texCoord ).rgba;")}else _+="vec3 vertNormal = normal;",_+="vec3 vertPosition = position;",3==a?_+="vec3 vertColor = color;":4==a&&(_+="vec4 vertColor = color;"),i&&(_+="vec2 vertTexCoord = texcoord;");if(_+="vec3 positionMV = (modelViewMatrix * vec4(vertPosition, 1.0)).xyz;\n",_+="vec3 normalMV = normalize( (normalMatrix * vec4(vertNormal, 0.0)).xyz );\n",_+="vec3 eye = -positionMV;\n",i&&(o?(_+="fragViewDir = (viewMatrix[3].xyz);\n",_+="fragNormal = normalMV;\n"):_+=n?" fragTexcoord = 0.5 + normalMV.xy / 2.0;\n":r?" fragTexcoord = (texTrafoMatrix * vec4(vertTexCoord, 1.0, 1.0)).xy;\n":" fragTexcoord = vertTexCoord;\n"),d){_+="vec3 ambient   = vec3(0.07, 0.07, 0.07);\n",_+="vec3 diffuse   = vec3(0.0, 0.0, 0.0);\n",_+="vec3 specular  = vec3(0.0, 0.0, 0.0);\n",h||(_+="if (dot(normalMV, eye) < 0.0) {\n",_+=" normalMV *= -1.0;\n",_+="}\n");for(var g=0;d>g;g++)_+=" lighting(Light"+g+"_Type,Light"+g+"_Location,Light"+g+"_Direction,Light"+g+"_Color,Light"+g+"_Attenuation,Light"+g+"_Intensity,Light"+g+"_AmbientIntensity,Light"+g+"_BeamWidth,Light"+g+"_CutOffAngle,normalMV, eye, ambient, diffuse, specular);\n";i&&s?(_+="fragColor.rgb = (emissiveColor + ambient*diffuseColor + diffuse*diffuseColor + specular*specularColor);\n",_+="fragColor.a = 1.0 - transparency;\n"):i&&!s?(_+="fragAmbient = ambient;\n",_+="fragDiffuse = diffuse;\n",_+="fragColor.rgb = (emissiveColor + specular*specularColor);\n",_+="fragColor.a = 1.0 - transparency;\n"):3==a?(_+="fragColor.rgb = vertColor;\n",_+="fragColor.a = 1.0 - transparency;\n"):4==a?_+="fragColor.rgba = vertColor;\n":(_+="fragColor.rgb = (emissiveColor + ambient*diffuseColor + diffuse*diffuseColor + specular*specularColor);\n",_+="fragColor.a = 1.0-transparency;\n")}else i&&!s?(_+="fragAmbient = vec3(1.0);\n",_+="fragDiffuse = vec3(1.0);\n",_+="fragColor.rgb = vec3(0.0);\n",_+="fragColor.a = 1.0 - transparency;\n"):3==a?(_+="fragColor.rgb = vertColor;\n",_+="fragColor.a = 1.0 - transparency;\n"):4==a?_+="fragColor.rgba = vertColor;\n":(_+="fragColor.rgb = diffuseColor + emissiveColor;\n;\n",_+="fragColor.a = 1.0-transparency;\n");u&&(_+="float f0 = calcFog(-positionMV);\n",_+="fragColor.rgb = fogColor * (1.0-f0) + f0 * (fragColor.rgb);\n"),_+="gl_Position = modelViewProjectionMatrix * vec4(vertPosition, 1.0);\n",_+="}\n",l[p]={},l[p].type="vertex",l[p].data=_}return p},e.prototype.generateFSMobile=function(e,t){var i=t._cf.appearance.node._cf.texture.node||x3dom.isa(t._cf.geometry.node,x3dom.nodeTypes.Text)?1:0,r=t._cf.appearance.node._cf.texture.node&&x3dom.isa(t._cf.appearance.node._cf.texture.node,x3dom.nodeTypes.X3DEnvironmentTextureNode)?1:0,n=x3dom.isa(t._cf.geometry.node,x3dom.nodeTypes.Text)||r||t._cf.appearance.node._cf.texture.node&&(1==t._cf.appearance.node._cf.texture.node._vf.origChannelCount||2==t._cf.appearance.node._cf.texture.node._vf.origChannelCount)?1:0,o="fs-x3d-mobil-"+i+r+n;if(!l[o]){var s="";s+="#ifdef GL_ES \n",s+="  precision highp float;\n",s+="#endif\n",s+="\n",i&&(r?(s+="uniform samplerCube tex;\n",s+="varying vec3 fragViewDir;\n",s+="varying vec3 fragNormal;\n",s+="uniform mat4 modelViewMatrixInverse;\n"):(s+="uniform sampler2D tex;           \n",s+="varying vec2 fragTexcoord;       \n"),n||(s+="varying vec3 fragAmbient;\n",s+="varying vec3 fragDiffuse;\n")),s+="varying vec4 fragColor;\n",s+="void main(void) {\n",s+="vec4 color = fragColor;\n",i&&(r?(s+="vec3 normal = normalize(fragNormal);\n",s+="vec3 viewDir = normalize(fragViewDir);\n",s+="vec3 reflected = reflect(viewDir, normal);\n",s+="reflected = (modelViewMatrixInverse * vec4(reflected,0.0)).xyz;\n",s+="vec4 texColor = textureCube(tex, reflected);\n"):s+="vec4 texColor = texture2D(tex, vec2(fragTexcoord.s, 1.0-fragTexcoord.t));\n",n?r?(s+="color.rgb = mix(color.rgb, texColor.rgb, vec3(0.75));\n",s+="color.a = texColor.a;\n"):(s+="color.rgb *= texColor.rgb;\n",s+="color.a *= texColor.a;\n"):(s+="color.rgb += fragAmbient*texColor.rgb + fragDiffuse*texColor.rgb;\n",s+="color.a *= texColor.a;\n")),s+="if (color.a <= 0.1) discard;\n",s+="gl_FragColor = color;\n",s+="}\n",l[o]={},l[o].type="fragment",l[o].data=s}return o},e.prototype.generateVS=function(e,t){var i=t._cf.appearance.node._shader&&x3dom.isa(t._cf.appearance.node._shader,x3dom.nodeTypes.CommonSurfaceShader)?1:0,r=t._cf.appearance.node._cf.texture.node||i||x3dom.isa(t._cf.geometry.node,x3dom.nodeTypes.Text)?1:0,n=i&&t._cf.appearance.node._shader.getNormalMap()?1:0,o=null!==t._cf.appearance.node._cf.textureTransform.node?1:0,s=void 0!==t._cf.geometry.node._cf.texCoord&&null!==t._cf.geometry.node._cf.texCoord.node&&t._cf.geometry.node._cf.texCoord.node._vf.mode&&"sphere"==t._cf.geometry.node._cf.texCoord.node._vf.mode.toLowerCase()?1:0,a=t._cf.appearance.node._cf.texture.node&&x3dom.isa(t._cf.appearance.node._cf.texture.node,x3dom.nodeTypes.X3DEnvironmentTextureNode)?1:0,d=t._cf.geometry.node._mesh._colors[0].length>0||t._cf.geometry.node.getColorTexture()?t._cf.geometry.node._mesh._numColComponents:0,h=e.getLights().length+e._scene.getNavigationInfo()._vf.headlight,u=e.getLightsShadow()?1:0,c=e._scene.getFog()._vf.visibilityRange>0?1:0,f=x3dom.isa(t._cf.geometry.node,x3dom.nodeTypes.ImageGeometry)?1:0,m=f?t._cf.geometry.node.numCoordinateTextures():0,p=f&&null!=t._cf.geometry.node.getIndexTexture()?1:0,_="vs-x3d-"+d+r+n+o+s+a+c+h+u+f+m+p;
if(!l[_]){var i="";if(i+="attribute vec3 position;",i+="attribute vec3 normal;",i+="uniform mat4 modelViewMatrix;",i+="uniform mat4 normalMatrix;",i+="uniform mat4 modelViewProjectionMatrix;",i+="varying vec3 fragNormal;",f){i+="uniform vec3 IG_bboxMin;",i+="uniform vec3 IG_bboxMax;",i+="uniform float IG_coordTextureWidth;",i+="uniform float IG_coordTextureHeight;",p&&(i+="uniform sampler2D IG_indexTexture;",i+="uniform float IG_indexTextureWidth;",i+="uniform float IG_indexTextureHeight;");for(var g=0;m>g;g++)i+="uniform sampler2D IG_coordinateTexture"+g+";";i+="uniform sampler2D IG_normalTexture;",i+="uniform sampler2D IG_texCoordTexture;",i+="uniform sampler2D IG_colorTexture;"}if(d&&(3==d?(i+="attribute vec3 color;",i+="varying vec3 fragColor;"):(i+="attribute vec4 color;",i+="varying vec4 fragColor;")),r&&(i+="attribute vec2 texcoord;",i+="varying vec2 fragTexcoord;",o&&(i+="uniform mat4 texTrafoMatrix;"),n&&(i+="attribute vec3 tangent;",i+="attribute vec3 binormal;",i+="varying vec3 fragTangent;",i+="varying vec3 fragBinormal;"),a&&(i+="varying vec3 fragViewDir;\n",i+="uniform mat4 viewMatrix;\n")),(h||c)&&(i+="uniform vec3 eyePosition;",i+="varying vec3 fragEyePosition;",i+="varying vec3 fragPosition;",u&&(i+="uniform mat4 matPV;",i+="varying vec4 projCoord;")),i+="void main(void) {",f){p?(i+="vec2 halfPixel = vec2(0.5/IG_indexTextureWidth,0.5/IG_indexTextureHeight);",i+="vec2 IG_texCoord = vec2(position.x*(256.0/IG_indexTextureWidth), position.y*(256.0/IG_indexTextureHeight)) + halfPixel;",i+="vec2 IG_index = texture2D( IG_indexTexture, IG_texCoord ).rg;",i+="halfPixel = vec2(0.5/IG_coordTextureWidth,0.5/IG_coordTextureHeight);",i+="IG_texCoord = (IG_index * 0.996108948) + halfPixel;"):(i+="vec2 halfPixel = vec2(0.5/IG_coordTextureWidth, 0.5/IG_coordTextureHeight);",i+="vec2 IG_texCoord = vec2(position.x*(256.0/IG_coordTextureWidth), position.y*(256.0/IG_coordTextureHeight)) + halfPixel;"),i+="vec3 temp = vec3(0.0, 0.0, 0.0);",i+="vec3 vertPosition = vec3(0.0, 0.0, 0.0);";for(var g=0;m>g;g++)i+="temp = texture2D( IG_coordinateTexture"+g+", IG_texCoord ).rgb;",g&&(i+="temp /= ("+g+".0 * 256.0);"),i+="vertPosition += temp;";i+="vertPosition = vertPosition * (IG_bboxMax - IG_bboxMin) + IG_bboxMin;",i+="vec3 vertNormal = texture2D( IG_normalTexture, IG_texCoord ).rgb;",i+="vertNormal = vertNormal * 2.0 - 1.0;",r&&(i+="vec4 IG_doubleTexCoords = texture2D( IG_texCoordTexture, IG_texCoord );",i+="vec2 vertTexCoord;",i+="vertTexCoord.r = (IG_doubleTexCoords.r * 0.996108948) + (IG_doubleTexCoords.b * 0.003891051);",i+="vertTexCoord.g = (IG_doubleTexCoords.g * 0.996108948) + (IG_doubleTexCoords.a * 0.003891051);"),d&&(i+="fragColor = texture2D( IG_colorTexture, IG_texCoord ).rgb;"),i+="gl_PointSize = 2.0;"}else i+="vec3 vertNormal = normal;",r&&(i+="vec2 vertTexCoord = texcoord;"),i+="vec3 vertPosition = position;",i+="gl_PointSize = 2.0;",d&&(i+="fragColor = color;");i+="fragNormal = (normalMatrix * vec4(vertNormal, 0.0)).xyz;",(h||c)&&(i+="fragPosition = (modelViewMatrix * vec4(vertPosition, 1.0)).xyz;",i+="fragEyePosition = eyePosition - fragPosition;",u&&(i+="projCoord = matPV * vec4(vertPosition+0.5*normalize(vertNormal), 1.0);")),r&&(i+=a?"fragViewDir = (viewMatrix[3].xyz);\n":s?" fragTexcoord = 0.5 + fragNormal.xy / 2.0;":o?" fragTexcoord = (texTrafoMatrix * vec4(vertTexCoord, 1.0, 1.0)).xy;":" fragTexcoord = vertTexCoord;",n&&(i+="fragTangent  = (normalMatrix * vec4(tangent, 0.0)).xyz;",i+="fragBinormal = (normalMatrix * vec4(binormal, 0.0)).xyz;")),i+="gl_Position = modelViewProjectionMatrix * vec4(vertPosition, 1.0);",i+="}",l[_]={},l[_].type="vertex",l[_].data=i}return _},e.prototype.generateFS=function(e,t){var i=t._cf.geometry.node._mesh._colors[0].length>0||t._cf.geometry.node.getColorTexture()?t._cf.geometry.node._mesh._numColComponents:0,r=e.getLights().length+e._scene.getNavigationInfo()._vf.headlight,n=e.getLightsShadow()?1:0,o=e._scene.getFog()._vf.visibilityRange>0?1:0,s=(t.isSolid()?1:0,t._cf.appearance.node._cf.texture.node||x3dom.isa(t._cf.geometry.node,x3dom.nodeTypes.Text)?1:0),a=t._cf.appearance.node._cf.texture.node&&x3dom.isa(t._cf.appearance.node._cf.texture.node,x3dom.nodeTypes.X3DEnvironmentTextureNode)?1:0,d=x3dom.isa(t._cf.geometry.node,x3dom.nodeTypes.Text)||a||t._cf.appearance.node._cf.texture.node&&(1==t._cf.appearance.node._cf.texture.node._vf.origChannelCount||2==t._cf.appearance.node._cf.texture.node._vf.origChannelCount)?1:0,h=t._cf.appearance.node._shader&&x3dom.isa(t._cf.appearance.node._shader,x3dom.nodeTypes.CommonSurfaceShader)?1:0,u=h&&t._cf.appearance.node._shader.getDiffuseMap()?1:0,c=h&&t._cf.appearance.node._shader.getNormalMap()?1:0,f=h&&t._cf.appearance.node._shader.getSpecularMap()?1:0,m="fs-x3d-"+i+s+a+o+r+n+d+h+u+c+f;if(!l[m]){var p="struct Fog {   vec3  color;   float fogType;   float visibilityRange;};uniform Fog fog;float calcFog() {   float f0 = 0.0;   if(fog.fogType == 0.0) {       if(length(fragEyePosition) < fog.visibilityRange){           f0 = (fog.visibilityRange-length(fragEyePosition)) / fog.visibilityRange;       }   }else{       if(length(fragEyePosition) < fog.visibilityRange){           f0 = exp(-length(fragEyePosition) / (fog.visibilityRange-length(fragEyePosition) ) );       }   }   f0 = clamp(f0, 0.0, 1.0);   return f0;}",_="struct Light {\n   float on;\n   float type;\n   vec3  location;\n   vec3  direction;\n   vec3  color;\n   vec3  attenuation;\n   float intensity;\n   float ambientIntensity;\n   float beamWidth;\n   float cutOffAngle;\n   float shadowIntensity;\n};\nconst int NUMLIGHTS = "+r+";\nuniform Light light[9];\nvoid lighting(in Light light, in vec3 N, in vec3 V, inout vec3 ambient, inout vec3 diffuse, inout vec3 specular){   vec3 L;\n   float spot = 1.0, attentuation = 1.0;\n   if(light.type == 0.0) {\n       L = -normalize(light.direction);\n   }else{\n       L = normalize(light.location - fragPosition);       float distance = length(L);       L /= distance;\n       attentuation = 1.0 / (light.attenuation.x + light.attenuation.y * distance + light.attenuation.z * distance * distance);       attentuation *= max(0.0, dot(N, L));       if(light.type == 2.0) {           float spotAngle = acos(max(0.0, dot(-L, normalize(light.direction))));           if(spotAngle >= light.cutOffAngle) spot = 0.0;           else if(spotAngle <= light.beamWidth) spot = 1.0;           else spot = (spotAngle - light.cutOffAngle ) / (light.beamWidth - light.cutOffAngle);       }   }   vec3  H = normalize( L + V );\n   float NdotL = max(0.0, dot(N, L));\n   float NdotH = max(0.0, dot(N, H));\n   float ambientFactor  = light.ambientIntensity * material.ambientIntensity;   float diffuseFactor  = light.intensity * NdotL;   float specularFactor = light.intensity * NdotL * pow(NdotH, material.shininess*128.0);   ambient  += light.color * ambientFactor * attentuation * spot;   diffuse  += light.color * diffuseFactor * attentuation * spot;   specular += light.color * specularFactor * attentuation * spot;}",g="uniform sampler2D sh_tex;varying vec4 projCoord;float PCF_Filter(Light light, vec3 projectiveBiased, float filterWidth){    float stepSize = 2.0 * filterWidth / 3.0;    float blockerCount = 0.0;    projectiveBiased.x -= filterWidth;    projectiveBiased.y -= filterWidth;    for (float i=0.0; i<3.0; i++)    {        for (float j=0.0; j<3.0; j++)        {            projectiveBiased.x += (j*stepSize);            projectiveBiased.y += (i*stepSize);            vec4 zCol = texture2D(sh_tex, (1.0+projectiveBiased.xy)*0.5);            float fromFixed = 256.0 / 255.0;            float z = zCol.r * fromFixed;            z += zCol.g * fromFixed / (255.0);            z += zCol.b * fromFixed / (255.0 * 255.0);            z += zCol.a * fromFixed / (255.0 * 255.0 * 255.0);            if (z < projectiveBiased.z) blockerCount += 1.0;            projectiveBiased.x -= (j*stepSize);            projectiveBiased.y -= (i*stepSize);        }    }    float result = 1.0 - light.shadowIntensity * blockerCount / 9.0;    return result;}",v="struct Material {          \n   vec3  diffuseColor;     \n   vec3  specularColor;    \n   vec3  emissiveColor;    \n   float shininess;        \n   float transparency;     \n   float ambientIntensity; \n};                         \nuniform Material material; \n",h="";h+="#ifdef GL_ES             \n",h+="  precision highp float; \n",h+="#endif                   \n",h+="\n",h+=v,h+="uniform mat4 modelMatrix;",h+="uniform mat4 modelViewMatrix;",i&&(h+=3==i?"varying vec3 fragColor;  \n":"varying vec4 fragColor;  \n"),(s||h)&&(h+="varying vec2 fragTexcoord;       \n",!s&&!u||a?a&&(h+="uniform samplerCube tex;\n",h+="varying vec3 fragViewDir;\n",h+="uniform mat4 modelViewMatrixInverse;\n"):h+="uniform sampler2D tex;           \n",c&&(h+="uniform sampler2D bump;      \n",h+="varying vec3 fragTangent;    \n",h+="varying vec3 fragBinormal;   \n"),f&&(h+="uniform sampler2D spec;      \n")),r&&(h+="uniform float solid;             \n",h+="varying vec3 fragNormal;         \n",h+="varying vec3 fragPosition;       \n",h+="varying vec3 fragEyePosition;    \n",h+=_,n&&(h+=g)),o&&(h+=p,r||(h+="varying vec3 fragEyePosition;    \n")),h+="void main(void) {    \n",h+="vec3 rgb      = vec3(0.0, 0.0, 0.0); \n",h+="float alpha = 1.0 - material.transparency;\n",r?(h+="vec3 ambient   = vec3(0.07, 0.07, 0.07);\n",h+="vec3 diffuse   = vec3(0.0, 0.0, 0.0);\n",h+="vec3 specular  = vec3(0.0, 0.0, 0.0);\n",n&&(h+="float shadowed = 1.0;\n",h+="float oneShadowAlreadyExists = 0.0;\n"),h+="vec3 eye = normalize(-fragPosition);\n",h+="vec3 normal = normalize(fragNormal);\n",c&&(h+="vec3 t = normalize( fragTangent );\n",h+="vec3 b = normalize( fragBinormal );\n",h+="vec3 n = normalize( fragNormal );\n",h+="mat3 tangentToWorld = mat3(t, b, n);\n",h+="normal = texture2D( bump, vec2(fragTexcoord.x, 1.0-fragTexcoord.y) ).rgb;\n",h+="normal = 2.0 * normal - 1.0;\n",h+="normal = normalize( normal * tangentToWorld );\n",h+="normal.y = -normal.y;",h+="normal.x = -normal.x;"),h+="if (solid == 0.0 && dot(normal, eye) < 0.0) {\n",h+=" normal *= -1.0;\n",h+="}\n",h+="for(int i=0; i<NUMLIGHTS; i++) {\n",h+=" lighting(light[i], normal, eye, ambient, diffuse, specular);\n",n&&(h+=" if(light[i].shadowIntensity > 0.0 && oneShadowAlreadyExists == 0.0){\n",h+="     vec3 projectiveBiased = projCoord.xyz / projCoord.w;\n",h+="     shadowed = PCF_Filter(light[i], projectiveBiased, 0.002);\n",h+="     oneShadowAlreadyExists = 1.0;\n",h+=" }\n"),h+="}\n",f&&(h+="specular *= texture2D( spec, vec2(fragTexcoord.x, 1.0-fragTexcoord.y) ).rgb;\n"),s||u?(a?(h+="vec3 viewDir = normalize(fragViewDir);\n",h+="vec3 reflected = reflect(viewDir, normal);\n",h+="reflected = (modelViewMatrixInverse * vec4(reflected,0.0)).xyz;\n",h+="vec4 texColor = textureCube(tex, reflected);\n",h+="alpha *= texColor.a;\n"):(h+="vec2 texCoord = vec2(fragTexcoord.x, 1.0-fragTexcoord.y);\n",h+="vec4 texColor = texture2D(tex, texCoord);\n",h+="alpha *= texColor.a;\n"),d?(h+="   rgb = (material.emissiveColor + ambient*material.diffuseColor + diffuse*material.diffuseColor + specular*material.specularColor);\n",h+=a?"rgb = mix(rgb, texColor.rgb, vec3(0.75));\n":"rgb *= texColor.rgb;\n"):h+="   rgb = (material.emissiveColor + ambient*texColor.rgb + diffuse*texColor.rgb + specular*material.specularColor);\n"):i?(h+="rgb = diffuse*fragColor.rgb;\n",4==i&&(h+="alpha = fragColor.a;\n")):h+="rgb = (material.emissiveColor + ambient*material.diffuseColor + diffuse*material.diffuseColor + specular*material.specularColor);\n",n&&(h+="rgb *= shadowed;\n")):s?(h+="vec2 texCoord = vec2(fragTexcoord.x, 1.0-fragTexcoord.y);\n",h+="vec4 texColor = texture2D(tex, texCoord);\n",h+="rgb = texColor.rgb;\n",h+="alpha *= texColor.a;\n"):i?(h+="rgb = fragColor.rgb;\n",4==i&&(h+="alpha = fragColor.a;\n")):h+="rgb = material.diffuseColor + material.emissiveColor;\n",o&&(h+="float f0 = calcFog();\n",h+="rgb = fog.color * (1.0-f0) + f0 * (rgb);\n"),h+="if (alpha <= 0.1) discard;\n",h+="gl_FragColor = vec4(rgb, alpha);\n",h+="}\n",l[m]={},l[m].type="fragment",l[m].data=h}return m},e.prototype.setupShape=function(e,t,n){var o,s,d,h,u=0,c=null;if(void 0!==t._webgl){var f=t._webgl.lightsAndShadow;t._webgl.lightsAndShadow=a(n);var m=t._webgl.lightsAndShadow[0]!=f[0]||t._webgl.lightsAndShadow[1]!=f[1]||t._dirty.shader;if(t._dirty.colors===!0&&void 0===t._webgl.shader.color&&t._cf.geometry.node._mesh._colors[0].length&&(m=!0),t._dirty.texture===!0||m)if(c=t._cf.appearance.node._cf.texture.node,void 0!==t._webgl.texture&&c&&!m)t.updateTexture(c,0,"false"),t._dirty.texture=!1;else{m=!0;var p=t._webgl.shader,_=0;for(_=0;void 0!==t._webgl.texture&&_<t._webgl.texture.length;_++)t._webgl.texture[_]&&e.deleteTexture(t._webgl.texture[_]);for(u=0;u<t._webgl.positions.length;u++)void 0!==p.position&&(e.deleteBuffer(t._webgl.buffers[5*u+1]),e.deleteBuffer(t._webgl.buffers[5*u+0])),void 0!==p.normal&&e.deleteBuffer(t._webgl.buffers[5*u+2]),void 0!==p.texcoord&&e.deleteBuffer(t._webgl.buffers[5*u+3]),void 0!==p.color&&e.deleteBuffer(t._webgl.buffers[5*u+4]);for(_=0;_<t._webgl.dynamicFields.length;_++){var g=t._webgl.dynamicFields[_];void 0!==p[g.name]&&e.deleteBuffer(g.buf)}}for(u=0;u<t._webgl.positions.length;u++)m||t._dirty.positions!==!0||(void 0!==t._webgl.shader.position&&(t._webgl.positions[u]=t._cf.geometry.node._mesh._positions[u],e.deleteBuffer(t._webgl.buffers[5*u+1]),h=e.createBuffer(),t._webgl.buffers[5*u+1]=h,e.bindBuffer(e.ARRAY_BUFFER,h),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t._webgl.buffers[5*u+0]),s=new Float32Array(t._webgl.positions[u]),e.bufferData(e.ARRAY_BUFFER,s,e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,h),e.vertexAttribPointer(t._webgl.shader.position,3,e.FLOAT,!1,0,0),s=null),t._dirty.positions=!1),m||t._dirty.colors!==!0||(void 0!==t._webgl.shader.color&&(t._webgl.colors[u]=t._cf.geometry.node._mesh._colors[u],e.deleteBuffer(t._webgl.buffers[5*u+4]),o=e.createBuffer(),t._webgl.buffers[5*u+4]=o,d=new Float32Array(t._webgl.colors[u]),e.bindBuffer(e.ARRAY_BUFFER,o),e.bufferData(e.ARRAY_BUFFER,d,e.STATIC_DRAW),e.vertexAttribPointer(t._webgl.shader.color,3,e.FLOAT,!1,0,0),d=null),t._dirty.colors=!1);if(!m)return}else if(!x3dom.isa(t._cf.geometry.node,x3dom.nodeTypes.Text)&&(!t._cf.geometry.node||t._cf.geometry.node._mesh._positions[0].length<1))return void x3dom.debug.logError("NO VALID MESH OR NO VERTEX POSITIONS SET!");if(t._dirty.positions=!1,t._dirty.normals=!1,t._dirty.texcoords=!1,t._dirty.colors=!1,t._dirty.indexes=!1,t._dirty.texture=!1,x3dom.isa(t._cf.geometry.node,x3dom.nodeTypes.Text)){var v=t._cf.geometry.node._cf.fontStyle.node,y=["SERIF"],b=32,x="PLAIN",w=1,T=!0,E="BEGIN",C="",S=!0,F=!0;if(null!==v){var M=v._vf.family.toString();switch(M=M.trim().replace(/\'/g,"").replace(/\,/," "),M=M.split(" "),y=Array.map(M,function(e){return"SANS"==e?"sans-serif":"SERIF"==e?"serif":"TYPEWRITER"==e?"monospace":""+e}).join(","),x=v._vf.style.toString().replace(/\'/g,""),x.toUpperCase()){case"PLAIN":x="normal";break;case"BOLD":x="bold";break;case"ITALIC":x="italic";break;case"BOLDITALIC":x="italic bold";break;default:x="normal"}switch(S=v._vf.leftToRight?"ltr":"rtl",F=v._vf.topToBottom,E=v._vf.justify.toString().replace(/\'/g,""),E.toUpperCase()){case"BEGIN":E="left";break;case"END":E="right";break;case"FIRST":E="left";break;case"MIDDLE":E="center";break;default:E="left"}b=v._vf.size,w=v._vf.spacing,T=v._vf.horizontal,C=v._vf.language}var A=t._cf.geometry.node._vf.string,N=document.createElement("canvas");N.dir=S,N.width=n._width,N.height=b,N.display="none",document.body.appendChild(N);var R=N.getContext("2d");R.font=x+" "+b+"px "+y;var D=R.measureText(A).width,I=R.measureText(A).height||N.height;N.width=Math.pow(2,Math.ceil(Math.log(D)/Math.log(2))),N.height=Math.pow(2,Math.ceil(Math.log(I)/Math.log(2))),R.fillStyle="rgba(0,0,0,0)",R.fillRect(0,0,R.canvas.width,R.canvas.height),R.fillStyle="white",R.lineWidth=2.5,R.strokeStyle="grey",R.textBaseline="top",R.font=x+" "+b+"px "+y,R.textAlign=E;var P=(R.canvas.width-D)/2,k=(R.canvas.height-b)/2;R.fillText(A,P,k);var V=e.createTexture();e.bindTexture(e.TEXTURE_2D,V),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,N),document.body.removeChild(N),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.bindTexture(e.TEXTURE_2D,null);var O=D/100,L=I/100,B=1,U=0,z=1,j=0;t._cf.geometry.node._mesh._positions[0]=[-O,-L,0,O,-L,0,O,L,0,-O,L,0],t._cf.geometry.node._mesh._normals[0]=[0,0,1,0,0,1,0,0,1,0,0,1],t._cf.geometry.node._mesh._texCoords[0]=[U,j,z,j,z,B,U,B],t._cf.geometry.node._mesh._colors[0]=[],t._cf.geometry.node._mesh._indices[0]=[0,1,2,2,3,0],t._cf.geometry.node._mesh._invalidate=!0,t._cf.geometry.node._mesh._numFaces=2,t._cf.geometry.node._mesh._numCoords=4,t._webgl={positions:t._cf.geometry.node._mesh._positions,normals:t._cf.geometry.node._mesh._normals,texcoords:t._cf.geometry.node._mesh._texCoords,colors:t._cf.geometry.node._mesh._colors,indexes:t._cf.geometry.node._mesh._indices,texture:[V],textureFilter:[e.LINEAR],lightsAndShadow:a(n),imageGeometry:0,indexedImageGeometry:0},t._webgl.primType=e.TRIANGLES,t._webgl.shader=x3dom.caps.MOBILE?this.getShaderProgram(e,[this.generateVSMobile(n,t),this.generateFSMobile(n,t)]):this.getShaderProgram(e,[this.generateVS(n,t),this.generateFS(n,t)])}else{var G=this;c=t._cf.appearance.node._cf.texture.node,t.updateTexture=function(t,i,n){var o,s=this,a=void 0!==t._video&&null!==t._video&&void 0!==t._needPerFrameUpdate&&t._needPerFrameUpdate===!0;if(void 0===this._webgl.texture&&(this._webgl.texture=[]),void 0===this._webgl.textureFilter&&(s._webgl.textureFilter=[],s._webgl.textureFilter[i]=e.LINEAR),t._isCanvas&&t._canvas)o=e.createTexture(),s._webgl.texture[i]=o,e.bindTexture(e.TEXTURE_2D,o),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t._canvas),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.bindTexture(e.TEXTURE_2D,null);else if(x3dom.isa(t,x3dom.nodeTypes.RenderedTexture))s._webgl.texture[i]=t._webgl.fbo.tex,e.bindTexture(e.TEXTURE_2D,t._webgl.fbo.tex),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.bindTexture(e.TEXTURE_2D,null);else if(x3dom.isa(t,x3dom.nodeTypes.PixelTexture)){var l=new Uint8Array(t._vf.image.toGL()),d=e.NONE;switch(t._vf.image.comp){case 1:d=e.LUMINANCE;break;case 2:d=e.LUMINANCE_ALPHA;break;case 3:d=e.RGB;break;case 4:d=e.RGBA}o=e.createTexture(),s._webgl.texture[i]=o,e.bindTexture(e.TEXTURE_2D,o),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.pixelStorei(e.UNPACK_ALIGNMENT,1),e.texImage2D(e.TEXTURE_2D,0,d,t._vf.image.width,t._vf.image.height,0,d,e.UNSIGNED_BYTE,l)}else if(x3dom.isa(t,x3dom.nodeTypes.MultiTexture))for(var h=0;h<t.size();h++){var u=t.getTexture(h);if(!u)break;s.updateTexture(u,h,"false")}else if(x3dom.isa(t,x3dom.nodeTypes.MovieTexture)||a){if(o=e.createTexture(),!a){t._video=document.createElement("video"),t._video.setAttribute("autobuffer","true");var c=document.getElementsByTagName("body")[0];c.appendChild(t._video),t._video.style.visibility="hidden"}for(var f=0;f<t._vf.url.length;f++){var m=t._nameSpace.getURL(t._vf.url[f]);x3dom.debug.logInfo("Adding video file: "+m);var p=document.createElement("source");p.setAttribute("src",m),t._video.appendChild(p)}var _=function(){s._nameSpace.doc.needRender=!0,("index"==n||"coord"==n||"normal"==n||"texCoord"==n)&&(s._webgl.textureFilter[i]=e.NEAREST),e.bindTexture(e.TEXTURE_2D,o),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t._video),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,s._webgl.textureFilter[i]),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,s._webgl.textureFilter[i]),e.bindTexture(e.TEXTURE_2D,null)},g=function(){s._nameSpace.doc.needRender=!0,s._webgl.texture[i]=o,"coord"==n?(s._webgl.coordTextureWidth=t._video.clientWidth,s._webgl.coordTextureHeight=t._video.clientHeight):"index"==n&&(s._webgl.indexTextureWidth=t._video.clientWidth,s._webgl.indexTextureHeight=t._video.clientHeight),x3dom.debug.logInfo(o+" video tex url: "+t._vf.url),t._video.play(),t._intervalID=setInterval(_,16)},v=function(){clearInterval(t._intervalID),t._vf.loop===!0&&(t._video.play(),t._intervalID=setInterval(_,16))};t._video.addEventListener("canplaythrough",g,!0),t._video.addEventListener("ended",v,!0)}else if(x3dom.isa(t,x3dom.nodeTypes.X3DEnvironmentTextureNode))o=G.loadCubeMap(e,t.getTexUrl(),s._nameSpace.doc,!1),s._webgl.texture[i]=o;else{o=e.createTexture();var y=new Image;y.crossOrigin="",y.src=t._nameSpace.getURL(t._vf.url[0]),s._nameSpace.doc.downloadCount+=1,y.onload=function(){x3dom.ImageLoadManager.activeDownloads--,s._nameSpace.doc.needRender=!0,s._nameSpace.doc.downloadCount-=1,t._vf.scale&&(y=r(y)),s._webgl.texture[i]=o,"coord"==n?(s._webgl.coordTextureWidth=y.width,s._webgl.coordTextureHeight=y.height):"index"==n&&(s._webgl.indexTextureWidth=y.width,s._webgl.indexTextureHeight=y.height),s._webgl.textureFilter[i]="index"==n||"coord"==n||"normal"==n||"texCoord"==n||"color"==n?e.NEAREST:e.LINEAR,x3dom.debug.logInfo(o+" bind tex url: "+t._vf.url+"at unit: "+i),e.bindTexture(e.TEXTURE_2D,o),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,y),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,s._webgl.textureFilter[i]),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,s._webgl.textureFilter[i]),e.bindTexture(e.TEXTURE_2D,null),t._complete=!0},y.onerror=function(){s._nameSpace.doc.downloadCount-=1,x3dom.debug.logError("Can't load tex url: "+t._vf.url+" (at unit "+i+").")}}};var X=0,H=0;if(x3dom.isa(t._cf.geometry.node,x3dom.nodeTypes.ImageGeometry)&&(H=t._cf.geometry.node.numCoordinateTextures(),X=null!=t._cf.geometry.node.getIndexTexture()?1:0),n._scene._webgl.imageGeometry=H,t._webgl={positions:t._cf.geometry.node._mesh._positions,normals:t._cf.geometry.node._mesh._normals,texcoords:t._cf.geometry.node._mesh._texCoords,colors:t._cf.geometry.node._mesh._colors,indexes:t._cf.geometry.node._mesh._indices,lightsAndShadow:a(n),imageGeometry:H,indexedImageGeometry:X},c&&t.updateTexture(c,0,"false"),t._webgl.imageGeometry){var Y=1,W=t._cf.geometry.node.getIndexTexture();W&&t.updateTexture(W,Y++,"index");for(var q=0;H>q;q++){var K=t._cf.geometry.node.getCoordinateTexture(q);K&&t.updateTexture(K,Y++,"coord")}var $=t._cf.geometry.node.getNormalTexture(0);$&&t.updateTexture($,Y++,"normal");var Q=t._cf.geometry.node.getTexCoordTexture();Q&&t.updateTexture(Q,Y++,"texCoord");var Z=t._cf.geometry.node.getColorTexture();Z&&t.updateTexture(Z,Y++,"color")}if(x3dom.isa(t._cf.geometry.node,x3dom.nodeTypes.PointSet)||x3dom.isa(t._cf.geometry.node,x3dom.nodeTypes.Polypoint2D))t._webgl.primType=e.POINTS,t._webgl.shader=t._webgl.colors[0].length?this.getShaderProgram(e,["vs-x3d-vertexcolorUnlit","fs-x3d-vertexcolorUnlit"]):this.getShaderProgram(e,["vs-x3d-default","fs-x3d-default"]);else if(x3dom.isa(t._cf.geometry.node,x3dom.nodeTypes.IndexedLineSet)||x3dom.isa(t._cf.geometry.node,x3dom.nodeTypes.Circle2D)||x3dom.isa(t._cf.geometry.node,x3dom.nodeTypes.Arc2D)||x3dom.isa(t._cf.geometry.node,x3dom.nodeTypes.Polyline2D))t._webgl.primType=e.LINES,t._webgl.shader=t._webgl.colors[0].length?this.getShaderProgram(e,["vs-x3d-vertexcolorUnlit","fs-x3d-vertexcolorUnlit"]):this.getShaderProgram(e,["vs-x3d-default","fs-x3d-default"]);else{if(x3dom.isa(t._cf.geometry.node,x3dom.nodeTypes.ImageGeometry)){t._webgl.primType=[];for(var q=0;q<t._cf.geometry.node._vf.primType.length;q++)t._webgl.primType.push("POINTS"==t._cf.geometry.node._vf.primType[q].toUpperCase()?e.POINTS:"TRIANGLESTRIP"==t._cf.geometry.node._vf.primType[q].toUpperCase()?e.TRIANGLE_STRIP:e.TRIANGLES)}else t._webgl.primType=e.TRIANGLES;if(null!==t._cf.appearance.node._shader)if(x3dom.isa(t._cf.appearance.node._shader,x3dom.nodeTypes.CommonSurfaceShader)){var J=0,et=t._cf.appearance.node._shader,tt=et.getDiffuseMap(),it=et.getNormalMap(),rt=et.getSpecularMap();null!=tt&&t.updateTexture(tt,J++,"false"),null!=it&&t.updateTexture(it,J++,"false"),null!=rt&&t.updateTexture(rt,J++,"false"),x3dom.caps.MOBILE&&x3dom.debug.logWarning("No mobile shader for CommonSurfaceShader! Using high quality shader!"),t._webgl.shader=this.getShaderProgram(e,[this.generateVS(n,t),this.generateFS(n,t)])}else{var nt="HACK"+t._objectID;l["vs-x3d-"+nt]={},l["vs-x3d-"+nt].type="vertex",l["vs-x3d-"+nt].data=t._cf.appearance.node._shader._vertex._vf.url[0],l["fs-x3d-"+nt]={},l["fs-x3d-"+nt].type="fragment",l["fs-x3d-"+nt].data=t._cf.appearance.node._shader._fragment._vf.url[0],x3dom.debug.logInfo("6"),t._webgl.shader=i(e,nt),t._dirty.shader=!1}else t._webgl.shader=x3dom.caps.MOBILE?this.getShaderProgram(e,[this.generateVSMobile(n,t),this.generateFSMobile(n,t)]):this.getShaderProgram(e,[this.generateVS(n,t),this.generateFS(n,t)])}}t._dirty.shader=!1;var ot=t._webgl.shader;for(t._webgl.buffers=[],u=0;u<t._webgl.positions.length;u++){if(void 0!==ot.position){var st=e.createBuffer();t._webgl.buffers[5*u+0]=st;var at=new Uint16Array(t._webgl.indexes[u]);e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,st),e.bufferData(e.ELEMENT_ARRAY_BUFFER,at,e.STATIC_DRAW),at=null,h=e.createBuffer(),t._webgl.buffers[5*u+1]=h,e.bindBuffer(e.ARRAY_BUFFER,h),s=new Float32Array(t._webgl.positions[u]),e.bufferData(e.ARRAY_BUFFER,s,e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,h),e.vertexAttribPointer(ot.position,3,e.FLOAT,!1,0,0),e.enableVertexAttribArray(ot.position),s=null}if(void 0!==ot.normal){var lt=e.createBuffer();t._webgl.buffers[5*u+2]=lt;var dt=new Float32Array(t._webgl.normals[u]);e.bindBuffer(e.ARRAY_BUFFER,lt),e.bufferData(e.ARRAY_BUFFER,dt,e.STATIC_DRAW),e.vertexAttribPointer(ot.normal,3,e.FLOAT,!1,0,0),e.enableVertexAttribArray(ot.normal),dt=null}if(void 0!==ot.texcoord){var ht=e.createBuffer();t._webgl.buffers[5*u+3]=ht;var ut=new Float32Array(t._webgl.texcoords[u]);e.bindBuffer(e.ARRAY_BUFFER,ht),e.bufferData(e.ARRAY_BUFFER,ut,e.STATIC_DRAW),e.vertexAttribPointer(ot.texcoord,t._cf.geometry.node._mesh._numTexComponents,e.FLOAT,!1,0,0),e.enableVertexAttribArray(ot.texcoord),ut=null}void 0!==ot.color&&(o=e.createBuffer(),t._webgl.buffers[5*u+4]=o,d=new Float32Array(t._webgl.colors[u]),e.bindBuffer(e.ARRAY_BUFFER,o),e.bufferData(e.ARRAY_BUFFER,d,e.STATIC_DRAW),e.vertexAttribPointer(ot.color,t._cf.geometry.node._mesh._numColComponents,e.FLOAT,!1,0,0),e.enableVertexAttribArray(ot.color),d=null)}var ct=0;t._webgl.dynamicFields=[];for(var ft in t._cf.geometry.node._mesh._dynamicFields){var mt=t._cf.geometry.node._mesh._dynamicFields[ft];if(t._webgl.dynamicFields[ct]={buf:{},name:ft,numComponents:mt.numComponents},void 0!==ot[ft]){var pt=e.createBuffer();t._webgl.dynamicFields[ct++].buf=pt;var _t=new Float32Array(mt.value);e.bindBuffer(e.ARRAY_BUFFER,pt),e.bufferData(e.ARRAY_BUFFER,_t,e.STATIC_DRAW),e.vertexAttribPointer(ot[ft],mt.numComponents,e.FLOAT,!1,0,0),_t=null}}t._webgl._minFilterDic={NEAREST:e.NEAREST,LINEAR:e.LINEAR,NEAREST_MIPMAP_NEAREST:e.NEAREST_MIPMAP_NEAREST,NEAREST_MIPMAP_LINEAR:e.NEAREST_MIPMAP_LINEAR,LINEAR_MIPMAP_NEAREST:e.LINEAR_MIPMAP_NEAREST,LINEAR_MIPMAP_LINEAR:e.LINEAR_MIPMAP_LINEAR,AVG_PIXEL:e.LINEAR,AVG_PIXEL_AVG_MIPMAP:e.LINEAR_MIPMAP_LINEAR,AVG_PIXEL_NEAREST_MIPMAP:e.LINEAR_MIPMAP_NEAREST,DEFAULT:e.LINEAR_MIPMAP_LINEAR,FASTEST:e.NEAREST,NEAREST_PIXEL:e.NEAREST,NEAREST_PIXEL_AVG_MIPMAP:e.NEAREST_MIPMAP_LINEAR,NEAREST_PIXEL_NEAREST_MIPMAP:e.NEAREST_MIPMAP_NEAREST,NICEST:e.LINEAR_MIPMAP_LINEAR},t._webgl._magFilterDic={NEAREST:e.NEAREST,LINEAR:e.LINEAR,AVG_PIXEL:e.LINEAR,DEFAULT:e.LINEAR,FASTEST:e.NEAREST,NEAREST_PIXEL:e.NEAREST,NICEST:e.LINEAR},t._webgl._boundaryModesDic={CLAMP:e.CLAMP_TO_EDGE,CLAMP_TO_EDGE:e.CLAMP_TO_EDGE,CLAMP_TO_BOUNDARY:e.CLAMP_TO_EDGE,MIRRORED_REPEAT:e.MIRRORED_REPEAT,REPEAT:e.REPEAT}},e.prototype.setupScene=function(e,t){var i,r;if(void 0!==t._webgl){if(!t._dirty)return;void 0!==t._webgl.texture&&t._webgl.texture&&e.deleteTexture(t._webgl.texture),void 0!==t._webgl.shader.position&&(e.deleteBuffer(t._webgl.buffers[1]),e.deleteBuffer(t._webgl.buffers[0])),void 0!==t._webgl.shader.texcoord&&e.deleteBuffer(t._webgl.buffers[2]),t._webgl={}}t._dirty=!1;var n=t.getTexUrl(),s=0,a=1,l=1;if(n.length>0&&n[0].length>0)if(n.length>=6&&n[1].length>0&&n[2].length>0&&n[3].length>0&&n[4].length>0&&n[5].length>0)i=new x3dom.nodeTypes.Sphere,t._webgl={positions:i._mesh._positions[0],indexes:i._mesh._indices[0],buffers:[{},{}]},t._webgl.primType=e.TRIANGLES,t._webgl.shader=this.getShaderProgram(e,["vs-x3d-bg-textureCube","fs-x3d-bg-textureCube"]),t._webgl.texture=this.loadCubeMap(e,n,t._nameSpace.doc,!0);else{r=e.createTexture();var d=new Image;d.onload=function(){t._nameSpace.doc.needRender=!0,t._nameSpace.doc.downloadCount-=1,t._webgl.texture=r,e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!0),e.bindTexture(e.TEXTURE_2D,r),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,d),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.bindTexture(e.TEXTURE_2D,null),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!1)},d.onerror=function(){t._nameSpace.doc.downloadCount-=1,x3dom.debug.logError("Can't load tex url: "+n[0])},d.src=t._nameSpace.getURL(n[0]),t._nameSpace.doc.downloadCount+=1,t._webgl={positions:[-a,-l,0,-a,l,0,a,-l,0,a,l,0],indexes:[0,1,2,3],buffers:[{},{}]},t._webgl.primType=e.TRIANGLE_STRIP,t._webgl.shader=this.getShaderProgram(e,["vs-x3d-bg-texture","fs-x3d-bg-texture"])}else if(t.getSkyColor().length>1||t.getGroundColor().length){i=new x3dom.nodeTypes.Sphere,t._webgl={positions:i._mesh._positions[0],texcoords:i._mesh._texCoords[0],indexes:i._mesh._indices[0],buffers:[{},{},{}],texture:{}},t._webgl.primType=e.TRIANGLES,t._webgl.shader=this.getShaderProgram(e,["vs-x3d-bg-texture-bgnd","fs-x3d-bg-texture"]);var h=o(t.getSkyColor().length+t.getGroundColor().length+2);h=512>h?512:h;var u=t._vf.groundAngle.length,c=[],f=[],m=[],p=[0];for(s=0;s<t._vf.skyColor.length;s++)m[s]=t._vf.skyColor[s];for(s=0;s<t._vf.skyAngle.length;s++)p[s+1]=t._vf.skyAngle[s];if(u>0){for(p[p.length-1]<Math.PI/2&&(p[p.length]=Math.PI/2-x3dom.fields.Eps,m[m.length]=m[m.length-1]),s=u-1;s>=0;s--)s==u-1&&Math.PI-t._vf.groundAngle[s]<=Math.PI/2&&(p[p.length]=Math.PI/2,m[m.length]=t._vf.groundColor[t._vf.groundColor.length-1]),p[p.length]=Math.PI-t._vf.groundAngle[s],m[m.length]=t._vf.groundColor[s+1];p[p.length]=Math.PI,m[m.length]=t._vf.groundColor[0]}else p[p.length-1]<Math.PI&&(p[p.length]=Math.PI,m[m.length]=m[m.length-1]);for(s=0;s<p.length;s++)p[s]/=Math.PI;x3dom.debug.assert(p.length==m.length);var _=new x3dom.nodeTypes.ColorInterpolator;for(_._vf.key=new x3dom.fields.MFFloat(p),_._vf.keyValue=new x3dom.fields.MFColor(m),s=0;h>s;s++){var g=s/(h-1);_._fieldWatchers.set_fraction[0].call(_,g),c[s]=_._vf.value_changed}for(c.reverse(),s=0;s<c.length;s++)f[3*s+0]=Math.floor(255*c[s].r),f[3*s+1]=Math.floor(255*c[s].g),f[3*s+2]=Math.floor(255*c[s].b);var v=new Uint8Array(f),y=e.RGB;h=v.length/3,r=e.createTexture(),t._webgl.texture=r,e.bindTexture(e.TEXTURE_2D,r),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.pixelStorei(e.UNPACK_ALIGNMENT,1),e.texImage2D(e.TEXTURE_2D,0,y,1,h,0,y,e.UNSIGNED_BYTE,v)}else t._webgl={};if(t._webgl.shader){var b=t._webgl.shader,x=e.createBuffer();t._webgl.buffers[1]=x,e.bindBuffer(e.ARRAY_BUFFER,x);
var w=new Float32Array(t._webgl.positions);e.bufferData(e.ARRAY_BUFFER,w,e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,x),e.vertexAttribPointer(b.position,3,e.FLOAT,!1,0,0),e.enableVertexAttribArray(b.position);var T=e.createBuffer();t._webgl.buffers[0]=T;var E=new Uint16Array(t._webgl.indexes);if(e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,T),e.bufferData(e.ELEMENT_ARRAY_BUFFER,E,e.STATIC_DRAW),w=null,E=null,void 0!==b.texcoord){var C=e.createBuffer();t._webgl.buffers[2]=C;var S=new Float32Array(t._webgl.texcoords);e.bindBuffer(e.ARRAY_BUFFER,C),e.bufferData(e.ARRAY_BUFFER,S,e.STATIC_DRAW),e.vertexAttribPointer(b.texcoord,2,e.FLOAT,!1,0,0),e.enableVertexAttribArray(b.texcoord),S=null}}t._webgl.render=function(e,i){var r=t._webgl.shader;if(r&&r.texcoord&&t._webgl.texture){e.clearDepth(1),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT|e.STENCIL_BUFFER_BIT),e.frontFace(e.CCW),e.disable(e.CULL_FACE),e.disable(e.DEPTH_TEST),e.disable(e.BLEND),r.bind(),r.tex||(r.tex=0),r.alpha=1,r.modelViewProjectionMatrix=i.toGL(),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,t._webgl.texture),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t._webgl.buffers[0]),e.bindBuffer(e.ARRAY_BUFFER,t._webgl.buffers[1]),e.vertexAttribPointer(r.position,3,e.FLOAT,!1,0,0),e.enableVertexAttribArray(r.position),e.bindBuffer(e.ARRAY_BUFFER,t._webgl.buffers[2]),e.vertexAttribPointer(r.texcoord,2,e.FLOAT,!1,0,0),e.enableVertexAttribArray(r.texcoord);try{e.drawElements(t._webgl.primType,t._webgl.indexes.length,e.UNSIGNED_SHORT,0)}catch(n){x3dom.debug.logException("Render background: "+n)}e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,null),e.disableVertexAttribArray(r.position),e.disableVertexAttribArray(r.texcoord),e.clear(e.DEPTH_BUFFER_BIT|e.STENCIL_BUFFER_BIT)}else if(!r||!t._webgl.texture||void 0!==t._webgl.texture.textureCubeReady&&t._webgl.texture.textureCubeReady!==!0){var o=t.getSkyColor().toGL();o[3]=1-t.getTransparency(),e.clearColor(o[0],o[1],o[2],o[3]),e.clearDepth(1),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT|e.STENCIL_BUFFER_BIT)}else{e.clearDepth(1),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT|e.STENCIL_BUFFER_BIT),e.frontFace(e.CCW),e.disable(e.CULL_FACE),e.disable(e.DEPTH_TEST),e.disable(e.BLEND),r.bind(),r.tex||(r.tex=0),t._webgl.texture.textureCubeReady?(r.modelViewProjectionMatrix=i.toGL(),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_CUBE_MAP,t._webgl.texture),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MAG_FILTER,e.LINEAR)):(e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,t._webgl.texture),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t._webgl.buffers[0]),e.bindBuffer(e.ARRAY_BUFFER,t._webgl.buffers[1]),e.vertexAttribPointer(r.position,3,e.FLOAT,!1,0,0),e.enableVertexAttribArray(r.position);try{e.drawElements(t._webgl.primType,t._webgl.indexes.length,e.UNSIGNED_SHORT,0)}catch(n){x3dom.debug.logException("Render background: "+n)}e.disableVertexAttribArray(r.position),t._webgl.texture.textureCubeReady?(e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_CUBE_MAP,null)):(e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,null)),e.clear(e.DEPTH_BUFFER_BIT|e.STENCIL_BUFFER_BIT)}}},e.prototype.setupFgnds=function(e,t){if(void 0===t._fgnd){var i=1,r=1;t._fgnd={},t._fgnd._webgl={positions:[-i,-r,0,-i,r,0,i,-r,0,i,r,0],indexes:[0,1,2,3],buffers:[{},{}]},t._fgnd._webgl.primType=e.TRIANGLE_STRIP,t._fgnd._webgl.shader=this.getShaderProgram(e,["vs-x3d-bg-texture","fs-x3d-bg-texture"]);var n=t._fgnd._webgl.shader,o=e.createBuffer();t._fgnd._webgl.buffers[1]=o,e.bindBuffer(e.ARRAY_BUFFER,o);var s=new Float32Array(t._fgnd._webgl.positions);e.bufferData(e.ARRAY_BUFFER,s,e.STATIC_DRAW),e.bindBuffer(e.ARRAY_BUFFER,o),e.vertexAttribPointer(n.position,3,e.FLOAT,!1,0,0);var a=e.createBuffer();t._fgnd._webgl.buffers[0]=a;var l=new Uint16Array(t._fgnd._webgl.indexes);e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,a),e.bufferData(e.ELEMENT_ARRAY_BUFFER,l,e.STATIC_DRAW),s=null,l=null,t._fgnd._webgl.render=function(e,i){t._fgnd._webgl.texture=i,e.frontFace(e.CCW),e.disable(e.CULL_FACE),e.disable(e.DEPTH_TEST),n.bind(),n.tex||(n.tex=0),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,t._fgnd._webgl.texture),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t._fgnd._webgl.buffers[0]),e.bindBuffer(e.ARRAY_BUFFER,t._fgnd._webgl.buffers[1]),e.vertexAttribPointer(n.position,3,e.FLOAT,!1,0,0),e.enableVertexAttribArray(n.position);try{e.drawElements(t._fgnd._webgl.primType,t._fgnd._webgl.indexes.length,e.UNSIGNED_SHORT,0)}catch(r){x3dom.debug.logException("Render background: "+r)}e.disableVertexAttribArray(n.position),e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,null)}}},e.prototype.renderShadowPass=function(e,t,i,r){e.bindFramebuffer(e.FRAMEBUFFER,t._webgl.fboShadow.fbo),e.viewport(0,0,t._webgl.fboShadow.width,t._webgl.fboShadow.height),e.clearColor(1,1,1,1),e.clearDepth(1),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT),e.depthFunc(e.LEQUAL),e.enable(e.DEPTH_TEST),e.enable(e.CULL_FACE),e.disable(e.BLEND);var n=t._webgl.shadowShader;n.bind();var o,s=t.drawableObjects.length;for(o=0;s>o;o++){var a=t.drawableObjects[o][0],l=t.drawableObjects[o][1];n.modelViewMatrix=i.mult(a).toGL(),n.modelViewProjectionMatrix=r.mult(a).toGL();for(var d=0;d<l._webgl.positions.length;d++){void 0!==n.position&&(e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,l._webgl.buffers[5*d+0]),e.bindBuffer(e.ARRAY_BUFFER,l._webgl.buffers[5*d+1]),e.vertexAttribPointer(n.position,3,e.FLOAT,!1,0,0),e.enableVertexAttribArray(n.position));try{if(l._webgl.indexes&&l._webgl.indexes[d])if(l._webgl.imageGeometry)for(var h=0,u=0;h<l._cf.geometry.node._vf.vertexCount.length;h++)e.drawArrays(l._webgl.primType[h],u,l._cf.geometry.node._vf.vertexCount[h]),u+=l._cf.geometry.node._vf.vertexCount[h];else e.drawElements(l._webgl.primType,l._webgl.indexes[d].length,e.UNSIGNED_SHORT,0)}catch(c){x3dom.debug.logException(l._DEF+" renderShadowPass(): "+c)}void 0!==n.position&&e.disableVertexAttribArray(n.position)}}e.flush(),e.bindFramebuffer(e.FRAMEBUFFER,null)},e.prototype.renderPickingPass=function(e,t,i,r,n,o,s,a,l){e.bindFramebuffer(e.FRAMEBUFFER,t._webgl.fboPick.fbo),e.viewport(0,0,t._webgl.fboPick.width,t._webgl.fboPick.height),e.clearColor(0,0,0,1),e.clearDepth(1),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT),e.depthFunc(e.LEQUAL),e.enable(e.DEPTH_TEST),e.enable(e.CULL_FACE),e.disable(e.BLEND);var d;0===s?d=t._webgl.imageGeometry?t._webgl.pickShaderIG:t._webgl.pickShader:1===s?d=t._webgl.pickColorShader:2===s&&(d=t._webgl.pickTexCoordShader),d.bind();for(var h=0;h<t.drawableObjects.length;h++){var u=t.drawableObjects[h][0],c=t.drawableObjects[h][1];if(!(c._objectID<1||void 0===c._webgl)){if(d.modelMatrix=u.toGL(),d.modelViewProjectionMatrix=r.mult(u).toGL(),d.wcMin=n.toGL(),d.wcMax=o.toGL(),d.alpha=1-c._objectID/255,d.imageGeometry=0,c._webgl.imageGeometry){d.imageGeometry=1,d.IG_bboxMin=c._cf.geometry.node.getMin().toGL(),d.IG_bboxMax=c._cf.geometry.node.getMax().toGL(),d.IG_coordTextureWidth=c._webgl.coordTextureWidth,d.IG_coordTextureHeight=c._webgl.coordTextureHeight,c._webgl.indexedImageGeometry?(d.indexed=1,d.IG_indexTextureWidth=c._webgl.indexTextureWidth,d.IG_indexTextureHeight=c._webgl.indexTextureHeight,e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,c._webgl.texture[1]),e.activeTexture(e.TEXTURE1),e.bindTexture(e.TEXTURE_2D,c._webgl.texture[2])):(d.indexed=0,e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,c._webgl.texture[1])),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST);var f=0;c._cf.geometry.node.getIndexTexture()&&(d.IG_indexTexture||(d.IG_indexTexture=f++)),c._cf.geometry.node.getCoordinateTexture(0)&&(d.IG_coordinateTexture||(d.IG_coordinateTexture=f++))}for(var m=0;m<c._webgl.positions.length;m++){void 0!==d.position&&(e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,c._webgl.buffers[5*m+0]),e.bindBuffer(e.ARRAY_BUFFER,c._webgl.buffers[5*m+1]),e.vertexAttribPointer(d.position,3,e.FLOAT,!1,0,0),e.enableVertexAttribArray(d.position)),void 0!==d.color&&(e.bindBuffer(e.ARRAY_BUFFER,c._webgl.buffers[5*m+4]),e.vertexAttribPointer(d.color,c._cf.geometry.node._mesh._numColComponents,e.FLOAT,!1,0,0),e.enableVertexAttribArray(d.color)),void 0!==d.texcoord&&(e.bindBuffer(e.ARRAY_BUFFER,c._webgl.buffers[5*m+3]),e.vertexAttribPointer(d.texcoord,c._cf.geometry.node._mesh._numTexComponents,e.FLOAT,!1,0,0),e.enableVertexAttribArray(d.texcoord)),c.isSolid()?(e.enable(e.CULL_FACE),e.frontFace(c.isCCW()?e.CCW:e.CW)):e.disable(e.CULL_FACE);try{if(c._webgl.indexes&&c._webgl.indexes[m])if(c._webgl.imageGeometry)for(var p=0,_=0;p<c._cf.geometry.node._vf.vertexCount.length;p++)e.drawArrays(c._webgl.primType[p],_,c._cf.geometry.node._vf.vertexCount[p]),_+=c._cf.geometry.node._vf.vertexCount[p];else e.drawElements(c._webgl.primType,c._webgl.indexes[m].length,e.UNSIGNED_SHORT,0)}catch(g){x3dom.debug.logException(c._DEF+" renderPickingPass(): "+g)}void 0!==d.position&&e.disableVertexAttribArray(d.position),void 0!==d.color&&e.disableVertexAttribArray(d.color),void 0!==d.texcoord&&e.disableVertexAttribArray(d.texcoord)}}}e.flush();try{var v=a*t._webgl.pickScale,y=t._webgl.fboPick.height-1-l*t._webgl.pickScale,b=new Uint8Array(4);e.readPixels(v,y,1,1,e.RGBA,e.UNSIGNED_BYTE,b),t._webgl.fboPick.pixelData=b}catch(x){t._webgl.fboPick.pixelData=[],x3dom.debug.logException(x+" (cannot pick)")}e.bindFramebuffer(e.FRAMEBUFFER,null)},e.prototype.renderShape=function(e,t,r,n,o,s,a,l,d,h,u){if(void 0!==t._webgl){var c=null,f=r._scene,m=t._webgl.shader;m||(t._webgl.shader=i(d,"default"),m=t._webgl.shader),m.bind(),m.useText=x3dom.isa(t._cf.geometry.node,x3dom.nodeTypes.Text)?1:0,t._webgl.imageGeometry&&(m.IG_bboxMin=t._cf.geometry.node.getMin().toGL(),m.IG_bboxMax=t._cf.geometry.node.getMax().toGL(),m.IG_coordTextureWidth=t._webgl.coordTextureWidth,m.IG_coordTextureHeight=t._webgl.coordTextureHeight,t._webgl.indexedImageGeometry&&(m.IG_indexTextureWidth=t._webgl.indexTextureWidth,m.IG_indexTextureHeight=t._webgl.indexTextureHeight));var p=f.getFog();p&&(x3dom.caps.MOBILE?(m.fogColor=p._vf.color.toGL(),m.fogRange=p._vf.visibilityRange,m.fogType="LINEAR"==p._vf.fogType?0:1):(m["fog.color"]=p._vf.color.toGL(),m["fog.visibilityRange"]=p._vf.visibilityRange,m["fog.fogType"]="LINEAR"==p._vf.fogType?0:1));var _=t._cf.appearance.node._cf.material.node,g=t._cf.appearance.node._shader;if(null!==g&&x3dom.isa(g,x3dom.nodeTypes.CommonSurfaceShader)?(m["material.diffuseColor"]=g._vf.diffuseFactor.toGL(),m["material.specularColor"]=g._vf.specularFactor.toGL(),m["material.emissiveColor"]=g._vf.emissiveFactor.toGL(),m["material.shininess"]=g._vf.shininessFactor,m["material.ambientIntensity"]=(g._vf.ambientFactor.x+g._vf.ambientFactor.y+g._vf.ambientFactor.z)/3,m["material.transparency"]=1-g._vf.alphaFactor):(g=null,x3dom.caps.MOBILE?(m.diffuseColor=_._vf.diffuseColor.toGL(),m.specularColor=_._vf.specularColor.toGL(),m.emissiveColor=_._vf.emissiveColor.toGL(),m.shininess=_._vf.shininess,m.ambientIntensity=_._vf.ambientIntensity,m.transparency=_._vf.transparency):(m["material.diffuseColor"]=_._vf.diffuseColor.toGL(),m["material.specularColor"]=_._vf.specularColor.toGL(),m["material.emissiveColor"]=_._vf.emissiveColor.toGL(),m["material.shininess"]=_._vf.shininess,m["material.ambientIntensity"]=_._vf.ambientIntensity,m["material.transparency"]=_._vf.transparency)),m.alpha=1-_._vf.transparency,o>0){o>8&&(x3dom.debug.logWarning("Too many lights! Only 8 lights supported!"),o=8);for(var v=0;o>v;v++)x3dom.isa(n[v],x3dom.nodeTypes.DirectionalLight)?x3dom.caps.MOBILE?(m["Light"+v+"_Type"]=0,m["Light"+v+"_On"]=n[v]._vf.on?1:0,m["Light"+v+"_Color"]=n[v]._vf.color.toGL(),m["Light"+v+"_Intensity"]=n[v]._vf.intensity,m["Light"+v+"_AmbientIntensity"]=n[v]._vf.ambientIntensity,m["Light"+v+"_Direction"]=s.multMatrixVec(n[v]._vf.direction).toGL(),m["Light"+v+"_Attenuation"]=[1,1,1],m["Light"+v+"_Location"]=[1,1,1],m["Light"+v+"_Radius"]=0,m["Light"+v+"_BeamWidth"]=0,m["Light"+v+"_CutOffAngle"]=0,m["Light"+v+"_shadowIntensity"]=n[v]._vf.shadowIntensity):(m["light["+v+"].type"]=0,m["light["+v+"].on"]=n[v]._vf.on?1:0,m["light["+v+"].color"]=n[v]._vf.color.toGL(),m["light["+v+"].intensity"]=n[v]._vf.intensity,m["light["+v+"].ambientIntensity"]=n[v]._vf.ambientIntensity,m["light["+v+"].direction"]=s.multMatrixVec(n[v]._vf.direction).toGL(),m["light["+v+"].attenuation"]=[1,1,1],m["light["+v+"].location"]=[1,1,1],m["light["+v+"].radius"]=0,m["light["+v+"].beamWidth"]=0,m["light["+v+"].cutOffAngle"]=0,m["light["+v+"].shadowIntensity"]=n[v]._vf.shadowIntensity):x3dom.isa(n[v],x3dom.nodeTypes.PointLight)?x3dom.caps.MOBILE?(m["Light"+v+"_Type"]=1,m["Light"+v+"_On"]=n[v]._vf.on?1:0,m["Light"+v+"_Color"]=n[v]._vf.color.toGL(),m["Light"+v+"_Intensity"]=n[v]._vf.intensity,m["Light"+v+"_AmbientIntensity"]=n[v]._vf.ambientIntensity,m["Light"+v+"_Direction"]=[1,1,1],m["Light"+v+"_Attenuation"]=n[v]._vf.attenuation.toGL(),m["Light"+v+"_Location"]=s.multMatrixPnt(n[v]._vf.location).toGL(),m["Light"+v+"_Radius"]=n[v]._vf.radius,m["Light"+v+"_BeamWidth"]=0,m["Light"+v+"_CutOffAngle"]=0,m["Light"+v+"_shadowIntensity"]=n[v]._vf.shadowIntensity):(m["light["+v+"].type"]=1,m["light["+v+"].on"]=n[v]._vf.on?1:0,m["light["+v+"].color"]=n[v]._vf.color.toGL(),m["light["+v+"].intensity"]=n[v]._vf.intensity,m["light["+v+"].ambientIntensity"]=n[v]._vf.ambientIntensity,m["light["+v+"].direction"]=[1,1,1],m["light["+v+"].attenuation"]=n[v]._vf.attenuation.toGL(),m["light["+v+"].location"]=s.multMatrixPnt(n[v]._vf.location).toGL(),m["light["+v+"].radius"]=n[v]._vf.radius,m["light["+v+"].beamWidth"]=0,m["light["+v+"].cutOffAngle"]=0,m["light["+v+"].shadowIntensity"]=n[v]._vf.shadowIntensity):x3dom.isa(n[v],x3dom.nodeTypes.SpotLight)&&(x3dom.caps.MOBILE?(m["Light"+v+"_Type"]=2,m["Light"+v+"_On"]=n[v]._vf.on?1:0,m["Light"+v+"_Color"]=n[v]._vf.color.toGL(),m["Light"+v+"_Intensity"]=n[v]._vf.intensity,m["Light"+v+"_AmbientIntensity"]=n[v]._vf.ambientIntensity,m["Light"+v+"_Direction"]=s.multMatrixVec(n[v]._vf.direction).toGL(),m["Light"+v+"_Attenuation"]=n[v]._vf.attenuation.toGL(),m["Light"+v+"_Location"]=s.multMatrixPnt(n[v]._vf.location).toGL(),m["Light"+v+"_Radius"]=n[v]._vf.radius,m["Light"+v+"_BeamWidth"]=n[v]._vf.beamWidth,m["Light"+v+"_CutOffAngle"]=n[v]._vf.cutOffAngle,m["Light"+v+"_shadowIntensity"]=n[v]._vf.shadowIntensity):(m["light["+v+"].type"]=2,m["light["+v+"].on"]=n[v]._vf.on?1:0,m["light["+v+"].color"]=n[v]._vf.color.toGL(),m["light["+v+"].intensity"]=n[v]._vf.intensity,m["light["+v+"].ambientIntensity"]=n[v]._vf.ambientIntensity,m["light["+v+"].direction"]=s.multMatrixVec(n[v]._vf.direction).toGL(),m["light["+v+"].attenuation"]=n[v]._vf.attenuation.toGL(),m["light["+v+"].location"]=s.multMatrixPnt(n[v]._vf.location).toGL(),m["light["+v+"].radius"]=n[v]._vf.radius,m["light["+v+"].beamWidth"]=n[v]._vf.beamWidth,m["light["+v+"].cutOffAngle"]=n[v]._vf.cutOffAngle,m["light["+v+"].shadowIntensity"]=n[v]._vf.shadowIntensity))}var y=f.getNavigationInfo();y._vf.headlight&&(o=o?o:0,x3dom.caps.MOBILE?(m["Light"+o+"_Type"]=0,m["Light"+o+"_On"]=1,m["Light"+o+"_Color"]=[1,1,1],m["Light"+o+"_Intensity"]=1,m["Light"+o+"_AmbientIntensity"]=0,m["Light"+o+"_Direction"]=[0,0,-1],m["Light"+o+"_Attenuation"]=[1,1,1],m["Light"+o+"_Location"]=[1,1,1],m["Light"+o+"_Radius"]=0,m["Light"+o+"_BeamWidth"]=0,m["Light"+o+"_CutOffAngle"]=0):(m["light["+o+"].type"]=0,m["light["+o+"].on"]=1,m["light["+o+"].color"]=[1,1,1],m["light["+o+"].intensity"]=1,m["light["+o+"].ambientIntensity"]=0,m["light["+o+"].direction"]=[0,0,-1],m["light["+o+"].attenuation"]=[1,1,1],m["light["+o+"].location"]=[1,1,1],m["light["+o+"].radius"]=0,m["light["+o+"].beamWidth"]=0,m["light["+o+"].cutOffAngle"]=0));var b=t._cf.appearance.node._shader;if(b)for(var x in b._vf)if(b._vf.hasOwnProperty(x)&&"language"!==x){var w=b._vf[x];try{m[x]=w.toGL()}catch(T){m[x]=w}}var E=s.mult(e);m.modelViewMatrix=E.toGL(),m.normalMatrix=E.inverse().transpose().toGL(),m.viewMatrix=s.toGL(),m.modelViewMatrixInverse=E.inverse().toGL(),m.modelViewProjectionMatrix=a.mult(e).toGL();for(var C=0;void 0!==t._webgl.texture&&C<t._webgl.texture.length;C++)if(t._webgl.texture[C]){t._cf.appearance.node._cf.texture.node&&(c=t._cf.appearance.node._cf.texture.node.getTexture(C)),c&&(m.origChannelCount=c._vf.origChannelCount);var S=d.REPEAT,F=d.REPEAT,M=d.LINEAR,A=d.LINEAR,N=!1;if(t._webgl.textureFilter&&(M=t._webgl.textureFilter[C],A=t._webgl.textureFilter[C]),c&&null!==c._cf.textureProperties.node){var R=c._cf.textureProperties.node;S=t._webgl._boundaryModesDic[R._vf.boundaryModeS.toUpperCase()],F=t._webgl._boundaryModesDic[R._vf.boundaryModeT.toUpperCase()],M=t._webgl._minFilterDic[R._vf.minificationFilter.toUpperCase()],A=t._webgl._magFilterDic[R._vf.magnificationFilter.toUpperCase()],R._vf.generateMipMaps===!0?(M==d.NEAREST&&(M=d.NEAREST_MIPMAP_NEAREST),M==d.LINEAR&&(M=d.LINEAR_MIPMAP_LINEAR),N=!0):((M==d.LINEAR_MIPMAP_LINEAR||M==d.LINEAR_MIPMAP_NEAREST)&&(M=d.LINEAR),(M==d.NEAREST_MIPMAP_LINEAR||M==d.NEAREST_MIPMAP_NEAREST)&&(M=d.NEAREST))}else c&&c._vf.repeatS===!1&&(S=d.CLAMP_TO_EDGE),c&&c._vf.repeatT===!1&&(F=d.CLAMP_TO_EDGE);if(t._webgl.texture[C].textureCubeReady&&c&&x3dom.isa(c,x3dom.nodeTypes.X3DEnvironmentTextureNode)?(d.activeTexture(h[C]),d.bindTexture(d.TEXTURE_CUBE_MAP,t._webgl.texture[C]),d.texParameteri(d.TEXTURE_CUBE_MAP,d.TEXTURE_WRAP_S,S),d.texParameteri(d.TEXTURE_CUBE_MAP,d.TEXTURE_WRAP_T,F),d.texParameteri(d.TEXTURE_CUBE_MAP,d.TEXTURE_MAG_FILTER,A),d.texParameteri(d.TEXTURE_CUBE_MAP,d.TEXTURE_MIN_FILTER,M),N&&d.generateMipmap(d.TEXTURE_CUBE_MAP)):(d.activeTexture(h[C]),d.bindTexture(d.TEXTURE_2D,t._webgl.texture[C]),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,S),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,F),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,A),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,M),N&&d.generateMipmap(d.TEXTURE_2D)),null!==t._cf.appearance.node._cf.textureTransform.node){var D=t._cf.appearance.node.texTransformMatrix();m.texTrafoMatrix=D.toGL()}if(t._webgl.imageGeometry){var I=1;t._cf.geometry.node.getIndexTexture()&&(m.IG_indexTexture||(m.IG_indexTexture=I++));for(var P=0;P<t._webgl.imageGeometry;P++)t._cf.geometry.node.getCoordinateTexture(P)&&(m["IG_coordinateTexture"+P]||(m["IG_coordinateTexture"+P]=I++));t._cf.geometry.node.getNormalTexture(0)&&(m.IG_normalTexture||(m.IG_normalTexture=I++)),t._cf.geometry.node.getTexCoordTexture()&&(m.IG_texCoordTexture||(m.IG_texCoordTexture=I++)),t._cf.geometry.node.getColorTexture()&&(m.IG_colorTexture||(m.IG_colorTexture=I++))}if(g){var k=0;g.getDiffuseMap()&&(m.tex||(m.tex=k++)),g.getNormalMap()&&(m.bump||(m.bump=k++)),g.getSpecularMap()&&(m.spec||(m.spec=k++))}else m.tex||(m.tex=0)}u&&(m.sh_tex||(m.sh_tex=C),d.activeTexture(h[C]),d.bindTexture(d.TEXTURE_2D,f._webgl.fboShadow.tex),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MAG_FILTER,d.LINEAR),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_MIN_FILTER,d.LINEAR),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_S,d.CLAMP_TO_EDGE),d.texParameteri(d.TEXTURE_2D,d.TEXTURE_WRAP_T,d.CLAMP_TO_EDGE),m.matPV=l.mult(e).toGL());for(var V,O=0;O<t._webgl.dynamicFields.length;O++)V=t._webgl.dynamicFields[O],void 0!==m[V.name]&&(d.bindBuffer(d.ARRAY_BUFFER,V.buf),d.vertexAttribPointer(m[V.name],V.numComponents,d.FLOAT,!1,0,0),d.enableVertexAttribArray(m[V.name]));t.isSolid()?(d.enable(d.CULL_FACE),d.frontFace(t.isCCW()?d.CCW:d.CW)):d.disable(d.CULL_FACE),m.solid=t.isSolid()?1:0;for(var L=0;L<t._webgl.positions.length;L++){void 0!==m.position&&(d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,t._webgl.buffers[5*L+0]),d.bindBuffer(d.ARRAY_BUFFER,t._webgl.buffers[5*L+1]),d.vertexAttribPointer(m.position,3,d.FLOAT,!1,0,0),d.enableVertexAttribArray(m.position)),void 0!==m.normal&&(d.bindBuffer(d.ARRAY_BUFFER,t._webgl.buffers[5*L+2]),d.vertexAttribPointer(m.normal,3,d.FLOAT,!1,0,0),d.enableVertexAttribArray(m.normal)),void 0!==m.texcoord&&(d.bindBuffer(d.ARRAY_BUFFER,t._webgl.buffers[5*L+3]),d.vertexAttribPointer(m.texcoord,t._cf.geometry.node._mesh._numTexComponents,d.FLOAT,!1,0,0),d.enableVertexAttribArray(m.texcoord)),void 0!==m.color&&(d.bindBuffer(d.ARRAY_BUFFER,t._webgl.buffers[5*L+4]),d.vertexAttribPointer(m.color,t._cf.geometry.node._mesh._numColComponents,d.FLOAT,!1,0,0),d.enableVertexAttribArray(m.color));try{if(void 0!==r._points&&r._points)t._webgl.imageGeometry?d.drawElements(d.POINTS,t._cf.geometry.node._vf.vertexCount[0],d.UNSIGNED_SHORT,0):d.drawElements(d.POINTS,t._webgl.indexes[L].length,d.UNSIGNED_SHORT,0);else if(t._webgl.primType==d.POINTS)t._webgl.imageGeometry?d.drawArrays(d.POINTS,0,t._cf.geometry.node._vf.vertexCount[0]):d.drawArrays(d.POINTS,0,t._webgl.positions[L].length/3);else if(t._webgl.indexes&&t._webgl.indexes[L])if(t._webgl.imageGeometry)for(var P=0,B=0;P<t._cf.geometry.node._vf.vertexCount.length;P++)d.drawArrays(t._webgl.primType[P],B,t._cf.geometry.node._vf.vertexCount[P]),B+=t._cf.geometry.node._vf.vertexCount[P];else d.drawElements(t._webgl.primType,t._webgl.indexes[L].length,d.UNSIGNED_SHORT,0)}catch(U){x3dom.debug.logException(t._DEF+" renderScene(): "+U)}void 0!==m.position&&d.disableVertexAttribArray(m.position),void 0!==m.normal&&d.disableVertexAttribArray(m.normal),void 0!==m.texcoord&&d.disableVertexAttribArray(m.texcoord),void 0!==m.color&&d.disableVertexAttribArray(m.color)}if(t._webgl.indexes&&t._webgl.indexes[0])if(t._webgl.imageGeometry)for(var P=0;P<t._cf.geometry.node._vf.vertexCount.length;P++)this.numFaces+=t._cf.geometry.node._vf.vertexCount[P]/3;else this.numFaces+=t._cf.geometry.node._mesh._numFaces;if(t._webgl.imageGeometry)for(var P=0;P<t._cf.geometry.node._vf.vertexCount.length;P++)this.numCoords+=t._cf.geometry.node._vf.vertexCount[P];else this.numCoords+=t._cf.geometry.node._mesh._numCoords;for(C=0;void 0!==t._webgl.texture&&C<t._webgl.texture.length;C++)t._webgl.texture[C]&&(c=null,t._cf.appearance.node._cf.texture.node&&(c=t._cf.appearance.node._cf.texture.node.getTexture(C)),t._webgl.texture[C].textureCubeReady&&c&&x3dom.isa(c,x3dom.nodeTypes.X3DEnvironmentTextureNode)?(d.activeTexture(h[C]),d.bindTexture(d.TEXTURE_CUBE_MAP,null)):(d.activeTexture(h[C]),d.bindTexture(d.TEXTURE_2D,null)));for(u&&(d.activeTexture(h[C]),d.bindTexture(d.TEXTURE_2D,null)),O=0;O<t._webgl.dynamicFields.length;O++)V=t._webgl.dynamicFields[O],void 0!==m[V.name]&&d.disableVertexAttribArray(m[V.name])}},e.prototype.pickValue=function(e,t,i,r,n){var o=this.ctx3d,s=e._scene;if(null===o||null===s||!s._webgl||void 0===s.drawableObjects||!s.drawableObjects||"box"===s._vf.pickMode.toLowerCase())return!1;var a,l;arguments.length>4?(a=r,l=n):(a=e._last_mat_view,l=e._last_mat_scene);var d="color"===s._vf.pickMode.toLowerCase()?1:"texcoord"===s._vf.pickMode.toLowerCase()?2:0,h=s._lastMin,u=s._lastMax;this.renderPickingPass(o,s,a,l,h,u,d,t,i);var c=0;if(c>=0&&c<s._webgl.fboPick.pixelData.length){var f=new x3dom.fields.SFVec3f(0,0,0),m=d>0?1:255;f.x=s._webgl.fboPick.pixelData[c+0]/m,f.y=s._webgl.fboPick.pixelData[c+1]/m,f.z=s._webgl.fboPick.pixelData[c+2]/m,0===d&&(f=f.multComponents(u.subtract(h)).add(h));var p=255-s._webgl.fboPick.pixelData[c+3];p>0?(e._pickingInfo.pickPos=f,e._pickingInfo.pickObj=x3dom.nodeTypes.Shape.idMap.nodeID[p]):(e._pickingInfo.pickObj=null,e._pickingInfo.lastClickObj=null)}return!0},e.prototype.renderScene=function(e){var t=this.ctx3d,r=e._scene;if(null!==t&&null!==r){var n,o,s=e._doc._nodeBag.renderTextures,a=s.length;if(r._webgl){var l=Math.round(this.canvas.width*r._webgl.pickScale),d=Math.round(this.canvas.height*r._webgl.pickScale);(r._webgl._currFboWidth!==l||r._webgl._currFboHeight!==d)&&(r._webgl._currFboWidth=l,r._webgl._currFboHeight=d,r._webgl.fboPick=this.initFbo(t,l,d,!0),r._webgl.fboPick.pixelData=null,x3dom.debug.logInfo("Refreshed picking FBO to size ("+l+", "+d+")"))}else{for(r._webgl={},this.setupFgnds(t,r),r._webgl.pickScale=.5,r._webgl._currFboWidth=Math.round(this.canvas.width*r._webgl.pickScale),r._webgl._currFboHeight=Math.round(this.canvas.height*r._webgl.pickScale),r._webgl.fboPick=this.initFbo(t,r._webgl._currFboWidth,r._webgl._currFboHeight,!0),r._webgl.fboPick.pixelData=null,r._webgl.pickShader=i(t,"pick"),r._webgl.pickShaderIG=this.getShaderProgram(t,["vs-x3d-pickIG","fs-x3d-pick"]),r._webgl.pickColorShader=i(t,"vertexcolorUnlit"),r._webgl.pickTexCoordShader=i(t,"texcoordUnlit"),r._webgl.fboShadow=this.initFbo(t,1024,1024,!1),r._webgl.shadowShader=i(t,"shadow"),o=0;a>o;o++)n=s[o],n._webgl={},n._webgl.fbo=this.initFbo(t,n._vf.dimensions[0],n._vf.dimensions[1],!1);var h=x3dom.fields.SFVec3f.MAX(),u=x3dom.fields.SFVec3f.MIN();r.getVolume(h,u,!0),r._lastMin=h,r._lastMax=u}var c=r.getBackground();this.setupScene(t,c);var f,m;this.numFaces=0,this.numCoords=0,r.drawableObjects=null,r.drawableObjects=[],r.drawableObjects.LODs=[],r.drawableObjects.Billboards=[],f=(new Date).getTime(),r.collectDrawableObjects(x3dom.fields.SFMatrix4f.identity(),r.drawableObjects),m=(new Date).getTime()-f,this.canvas.parent.statDiv&&(this.canvas.parent.statDiv.appendChild(document.createElement("br")),this.canvas.parent.statDiv.appendChild(document.createTextNode("traverse: "+m)));var p=e.getViewMatrix();e._last_mat_view=p;var _=e.getWCtoCCMatrix();e._last_mat_scene=_,f=(new Date).getTime();var g,v,y,b,x,w=[],T=r.drawableObjects.length;for(g=0;T>g;g++)b=r.drawableObjects[g][0],x=r.drawableObjects[g][1],this.setupShape(t,x,e),y=x.getCenter(),y=b.multMatrixPnt(y),y=p.multMatrixPnt(y),w[g]=[g,y.z];for(w.sort(function(e,t){return e[1]-t[1]}),v=r.drawableObjects.Billboards.length,T=r.drawableObjects.LODs.length,(v||T)&&(y=new x3dom.fields.SFVec3f(0,0,0),y=p.inverse().multMatrixPnt(y)),g=0;T>g;g++)b=r.drawableObjects.LODs[g][0],x=r.drawableObjects.LODs[g][1],x&&(x._eye=b.inverse().multMatrixPnt(y));for(g=0;v>g;g++)if(b=r.drawableObjects.Billboards[g][0],x=r.drawableObjects.Billboards[g][1]){var E=p.mult(b);x._eye=b.inverse().multMatrixPnt(y),x._eyeViewUp=new x3dom.fields.SFVec3f(E._10,E._11,E._12),x._eyeLook=new x3dom.fields.SFVec3f(E._20,E._21,E._22)}m=(new Date).getTime()-f,this.canvas.parent.statDiv&&(this.canvas.parent.statDiv.appendChild(document.createElement("br")),this.canvas.parent.statDiv.appendChild(document.createTextNode("sort: "+m)));for(var C,S=e.getLights(),F=S.length,M=!1,A=0;F>A;A++)if(S[A]._vf.shadowIntensity>0&&!M){M=!0,f=(new Date).getTime();var N=e.getLightMatrix()[0];C=e.getWCtoLCMatrix(N),this.renderShadowPass(t,r,N,C),m=(new Date).getTime()-f,this.canvas.parent.statDiv&&(this.canvas.parent.statDiv.appendChild(document.createElement("br")),this.canvas.parent.statDiv.appendChild(document.createTextNode("shadow: "+m)))}for(o=0;a>o;o++)this.renderRTPass(t,e,s[o]);f=(new Date).getTime(),t.viewport(0,0,this.canvas.width,this.canvas.height),c._webgl.render(t,_),t.depthFunc(t.LEQUAL),t.enable(t.DEPTH_TEST),t.enable(t.CULL_FACE),t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE),t.enable(t.BLEND);var R=[t.TEXTURE0,t.TEXTURE1,t.TEXTURE2,t.TEXTURE3,t.TEXTURE4,t.TEXTURE5,t.TEXTURE6,t.TEXTURE7];for(g=0,T=w.length;T>g;g++){var D=r.drawableObjects[w[g][0]],I=!1;D[1]._cf.appearance.node._cf.blendMode.node&&"none"===D[1]._cf.appearance.node._cf.blendMode.node._vf.srcFactor.toLowerCase()&&"none"===D[1]._cf.appearance.node._cf.blendMode.node._vf.destFactor.toLowerCase()&&(I=!0,t.disable(t.BLEND)),this.renderShape(D[0],D[1],e,S,F,p,_,C,t,R,M),I&&t.enable(t.BLEND)}t.disable(t.BLEND),t.disable(t.DEPTH_TEST),void 0!==e._visDbgBuf&&e._visDbgBuf&&(("idbuf"===r._vf.pickMode.toLowerCase()||"color"===r._vf.pickMode.toLowerCase()||"texcoord"===r._vf.pickMode.toLowerCase())&&(t.viewport(0,3*this.canvas.height/4,this.canvas.width/4,this.canvas.height/4),r._fgnd._webgl.render(t,r._webgl.fboPick.tex)),M&&(t.viewport(this.canvas.width/4,3*this.canvas.height/4,this.canvas.width/4,this.canvas.height/4),r._fgnd._webgl.render(t,r._webgl.fboShadow.tex))),t.flush(),m=(new Date).getTime()-f,this.canvas.parent.statDiv&&(this.canvas.parent.statDiv.appendChild(document.createElement("br")),this.canvas.parent.statDiv.appendChild(document.createTextNode("render: "+m)),this.canvas.parent.statDiv.appendChild(document.createElement("br")),this.canvas.parent.statDiv.appendChild(document.createTextNode("#Tris: "+this.numFaces)),this.canvas.parent.statDiv.appendChild(document.createElement("br")),this.canvas.parent.statDiv.appendChild(document.createTextNode("#Pnts: "+this.numCoords)))}},e.prototype.renderRTPass=function(e,t,i){var r,n,o=t._scene,s=null,a=i.getViewMatrix(),l=i.getWCtoCCMatrix(),d=t.getLightMatrix()[0],h=t.getWCtoLCMatrix(d),u=i._cf.excludeNodes.nodes.length,c=new Array(u);for(r=0;u>r;r++){var f=i._cf.excludeNodes.nodes[r]._vf.render;c[r]=void 0===f?-1:f===!0?1:0,i._cf.excludeNodes.nodes[r]._vf.render=!1}e.bindFramebuffer(e.FRAMEBUFFER,i._webgl.fbo.fbo),e.viewport(0,0,i._webgl.fbo.width,i._webgl.fbo.height),null===i._cf.background.node?(e.clearColor(0,0,0,1),e.clearDepth(1),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT|e.STENCIL_BUFFER_BIT)):i._cf.background.node===o.getBackground()?(s=o.getBackground(),s._webgl.render(e,l)):(s=i._cf.background.node,this.setupScene(e,s),s._webgl.render(e,l)),e.depthFunc(e.LEQUAL),e.enable(e.DEPTH_TEST),e.enable(e.CULL_FACE),e.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE),e.enable(e.BLEND);var m,p,_=t.getLights(),g=_.length,v=!1,y=[e.TEXTURE0,e.TEXTURE1,e.TEXTURE2,e.TEXTURE3,e.TEXTURE4,e.TEXTURE5,e.TEXTURE6,e.TEXTURE7],b=i._cf.scene.node;if(b&&b!==o)for(b.drawableObjects=[],b.collectDrawableObjects(x3dom.fields.SFMatrix4f.identity(),b.drawableObjects),n=b.drawableObjects.length,r=0;n>r;r++)m=b.drawableObjects[r][0],p=b.drawableObjects[r][1],(void 0===p._vf.render||p._vf.render!==!1)&&(this.setupShape(e,p,t),this.renderShape(m,p,t,_,g,a,l,h,e,y,v));else for(n=o.drawableObjects.length,r=0;n>r;r++)m=o.drawableObjects[r][0],p=o.drawableObjects[r][1],(void 0===p._vf.render||p._vf.render!==!1)&&this.renderShape(m,p,t,_,g,a,l,h,e,y,v);for(e.disable(e.BLEND),e.disable(e.DEPTH_TEST),e.flush(),e.bindFramebuffer(e.FRAMEBUFFER,null),r=0;u>r;r++)0!==c[r]&&(i._cf.excludeNodes.nodes[r]._vf.render=!0)},e.prototype.shutdown=function(e){var t,i,r=this.ctx3d;if(null!==r&&null!==i&&i&&null!==i.drawableObjects){i=e._scene,i.collectDrawableObjects(x3dom.fields.SFMatrix4f.identity(),i.drawableObjects);var n=i.getBackground();void 0!==n._webgl.texture&&n._webgl.texture&&r.deleteTexture(n._webgl.texture),void 0!==n._webgl.shader.position&&(r.deleteBuffer(n._webgl.buffers[1]),r.deleteBuffer(n._webgl.buffers[0]));for(var o=0,s=i.drawableObjects.length;s>o;o++){for(var a=i.drawableObjects[o][1],l=a._webgl.shader,d=0;void 0!==a._webgl.texture&&d<a._webgl.texture.length;d++)a._webgl.texture[d]&&r.deleteTexture(a._webgl.texture[d]);for(var h=0;h<a._webgl.positions.length;h++)void 0!==l.position&&(r.deleteBuffer(a._webgl.buffers[5*h+1]),r.deleteBuffer(a._webgl.buffers[5*h+0])),void 0!==l.normal&&r.deleteBuffer(a._webgl.buffers[5*h+2]),void 0!==l.texcoord&&r.deleteBuffer(a._webgl.buffers[5*h+3]),void 0!==l.color&&r.deleteBuffer(a._webgl.buffers[5*h+4]);for(var u=0;u<a._webgl.dynamicFields.length;u++)t=a._webgl.dynamicFields[u],void 0!==l[t.name]&&r.deleteBuffer(t.buf);
a._webgl=null}}},e.prototype.loadCubeMap=function(e,t,i,r){var n=e.createTexture();e.bindTexture(e.TEXTURE_CUBE_MAP,n),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MAG_FILTER,e.LINEAR),e.bindTexture(e.TEXTURE_CUBE_MAP,null);var o;o=r?[e.TEXTURE_CUBE_MAP_POSITIVE_Z,e.TEXTURE_CUBE_MAP_NEGATIVE_Z,e.TEXTURE_CUBE_MAP_POSITIVE_Y,e.TEXTURE_CUBE_MAP_NEGATIVE_Y,e.TEXTURE_CUBE_MAP_POSITIVE_X,e.TEXTURE_CUBE_MAP_NEGATIVE_X]:[e.TEXTURE_CUBE_MAP_NEGATIVE_Z,e.TEXTURE_CUBE_MAP_POSITIVE_Z,e.TEXTURE_CUBE_MAP_NEGATIVE_Y,e.TEXTURE_CUBE_MAP_POSITIVE_Y,e.TEXTURE_CUBE_MAP_NEGATIVE_X,e.TEXTURE_CUBE_MAP_POSITIVE_X],n.pendingTextureLoads=-1,n.textureCubeReady=!1;for(var s=0;s<o.length;s++){var a=o[s],l=new Image;n.pendingTextureLoads++,i.downloadCount+=1,l.onload=function(t,r,n,o){return function(){e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,o),e.bindTexture(e.TEXTURE_CUBE_MAP,t),e.texImage2D(r,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n),e.bindTexture(e.TEXTURE_CUBE_MAP,null),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,!1),t.pendingTextureLoads--,i.downloadCount-=1,t.pendingTextureLoads<0&&(t.textureCubeReady=!0,x3dom.debug.logInfo("Loading CubeMap finished..."),i.needRender=!0)}}(n,a,l,r&&(1>=s||s>=4)),l.onerror=function(){i.downloadCount-=1,x3dom.debug.logError("Can't load CubeMap!")},l.src=t[s]}return n},e.prototype.emptyTexImage2D=function(e,t,i,r,n,o){try{e.texImage2D(e.TEXTURE_2D,0,t,i,r,0,n,o,null)}catch(s){var a=3;switch(t){case e.DEPTH_COMPONENT:a=3;break;case e.ALPHA:a=1;break;case e.RGB:a=3;break;case e.RGBA:a=4;break;case e.LUMINANCE:a=1;break;case e.LUMINANCE_ALPHA:a=2}var l=new Uint8Array(i*r*a);e.texImage2D(e.TEXTURE_2D,0,t,i,r,0,n,o,l)}},e.prototype.initTex=function(e,t,i,r){var n=e.createTexture();return e.bindTexture(e.TEXTURE_2D,n),this.emptyTexImage2D(e,e.RGBA,t,i,e.RGBA,e.UNSIGNED_BYTE),r?(e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.NEAREST),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.NEAREST)):(e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR)),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE),e.bindTexture(e.TEXTURE_2D,null),n.width=t,n.height=i,n},e.prototype.initFbo=function(e,t,i,r){var n=0,o=e.createFramebuffer(),s=e.createRenderbuffer(),a=this.initTex(e,t,i,r);e.bindFramebuffer(e.FRAMEBUFFER,o),e.bindRenderbuffer(e.RENDERBUFFER,s),e.renderbufferStorage(e.RENDERBUFFER,e.DEPTH_COMPONENT16,t,i),e.bindRenderbuffer(e.RENDERBUFFER,null),e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,a,0),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.RENDERBUFFER,s),e.bindFramebuffer(e.FRAMEBUFFER,null),n=e.checkFramebufferStatus(e.FRAMEBUFFER),x3dom.debug.logInfo("FBO-Status: "+n);var l={};return l.fbo=o,l.rbo=s,l.tex=a,l.width=t,l.height=i,l},t}(),x3dom.bridge={setFlashReady:function(e,t){var i=x3dom.canvases[t];i.isFlashReady=!0,x3dom.debug.logInfo("Flash is ready for rendering ("+e+")")},onMouseDown:function(e,t,i,r){var n=x3dom.canvases[r];n.doc.onMousePress(n.gl,e,t,i),n.doc.needRender=!0},onMouseUp:function(e,t,i,r){var n=x3dom.canvases[r];n.doc.onMouseRelease(n.gl,e,t,i),n.doc.needRender=!0},onMouseOver:function(e,t,i,r){var n=x3dom.canvases[r];n.doc.onMouseOver(n.gl,e,t,i),n.doc.needRender=!0},onMouseOut:function(e,t,i,r){var n=x3dom.canvases[r];n.doc.onMouseOut(n.gl,e,t,i),n.doc.needRender=!0},onDoubleClick:function(e,t,i){var r=x3dom.canvases[i];r.doc.onDoubleClick(r.gl,e,t),r.doc.needRender=!0,x3dom.debug.logInfo("dblClick")},onMouseDrag:function(e,t,i,r){var n=x3dom.canvases[r];n.doc.onDrag(n.gl,e,t,i),n.doc.needRender=!0},onMouseMove:function(e,t,i,r){var n=x3dom.canvases[r];n.doc.onMove(n.gl,e,t,i),n.doc.needRender=!0},onMouseWheel:function(e,t,i,r){var n=x3dom.canvases[r];n.doc.onDrag(n.gl,e,t,i),n.doc.needRender=!0},onKeyDown:function(e,t){var i=x3dom.canvases[t],r=i.x3dElem.getAttribute("keysEnabled");r&&"true"!==r.toLowerCase()||i.doc.onKeyPress(e),i.doc.needRender=!0}},x3dom.gfx_flash=function(){function e(e,t){this.object=e,this.name=t}function t(t){return new e(t,"flash")}return e.prototype.getName=function(){return this.name},e.prototype.renderScene=function(e){var t=e._scene;this.setupScene(t,e);var i=t.getBackground();this.setupBackground(i),t.drawableObjects=null,t.drawableObjects=[],t.drawableObjects.LODs=[],t.drawableObjects.Billboards=[],t.collectDrawableObjects(x3dom.fields.SFMatrix4f.identity(),t.drawableObjects);var r=t.drawableObjects.length;if(r>0)for(var n=[],o=0;r>o;o++){var s=t.drawableObjects[o][0],a=t.drawableObjects[o][1];void 0!=n[a._objectID]?n[a._objectID]++:n[a._objectID]=0,this.setupShape(a,s,n[a._objectID])}this.object.renderScene()},e.prototype.setupScene=function(e,t){var i=t.getViewMatrix();this.object.setViewMatrix({viewMatrix:i.toGL()});var r=t.getProjectionMatrix();this.object.setProjectionMatrix({projectionMatrix:r.toGL()});var n=e.getNavigationInfo();n._vf.headlight&&this.object.setLights({idx:0,type:0,on:1,color:[1,1,1],intensity:1,ambientIntensity:0,direction:[0,0,1],attenuation:[1,1,1],location:[1,1,1],radius:0,beamWidth:0,cutOffAngle:0});for(var o=t.getLights(),s=0;s<o.length;s++)o[s]._dirty&&(x3dom.isa(o[s],x3dom.nodeTypes.DirectionalLight)?x3dom.debug.logInfo(o[s]._lightID):x3dom.isa(o[s],x3dom.nodeTypes.PointLight)||x3dom.isa(o[s],x3dom.nodeTypes.SpotLight),o[s]._dirty=!1)},e.prototype.setupBackground=function(e){e._dirty&&(this.object.setBackground({texURLs:e.getTexUrl(),skyAngle:e._vf.skyAngle,skyColor:e.getSkyColor().toGL(),groundAngle:e._vf.groundAngle,groundColor:e.getGroundColor().toGL(),transparency:e.getTransparency()}),e._dirty=!1)},e.prototype.setupShape=function(e,t,i){return x3dom.isa(e._cf.geometry.node,x3dom.nodeTypes.PointSet)?void x3dom.debug.logError("Flash backend don't support PointSets yet"):x3dom.isa(e._cf.geometry.node,x3dom.nodeTypes.IndexedLineSet)?void x3dom.debug.logError("Flash backend don't support LineSets yet"):void(x3dom.isa(e._cf.geometry.node,x3dom.nodeTypes.Text)?this.setupText(e,t,i):this.setupIndexedFaceSet(e,t,i))},e.prototype.setupIndexedFaceSet=function(e,t,i){if(this.object.setMeshTransform({id:e._objectID,refID:i,transform:t.toGL()}),0==i){var r=x3dom.isa(e._cf.geometry.node,x3dom.nodeTypes.ImageGeometry);if(e._dirty.indexes===!0){if(!r)for(var n=0;n<e._cf.geometry.node._mesh._indices.length;n++)this.object.setMeshIndices({id:e._objectID,idx:n,indices:e._cf.geometry.node._mesh._indices[n]});e._dirty.indexes=!1}if(e._dirty.positions===!0){if(r)this.object.setMeshVerticesTexture({id:e._objectID,idx:0,bboxMin:e._cf.geometry.node.getMin().toGL(),bboxMax:e._cf.geometry.node.getMax().toGL(),bboxCenter:e._cf.geometry.node.getCenter(),primType:e._cf.geometry.node._vf.primType,vertexCount:e._cf.geometry.node._vf.vertexCount,coordinateTexture0:e._cf.geometry.node.getCoordinateTextureURL(0),coordinateTexture1:e._cf.geometry.node.getCoordinateTextureURL(1)});else for(var n=0;n<e._cf.geometry.node._mesh._positions.length;n++)this.object.setMeshVertices({id:e._objectID,idx:n,vertices:e._cf.geometry.node._mesh._positions[n]});e._dirty.positions=!1}if(e._dirty.normals===!0){if(r)this.object.setMeshNormalsTexture({id:e._objectID,idx:0,normalTexture:e._cf.geometry.node.getNormalTextureURL(0)});else if(e._cf.geometry.node._mesh._normals[0].length)for(var n=0;n<e._cf.geometry.node._mesh._normals.length;n++)this.object.setMeshNormals({id:e._objectID,idx:n,normals:e._cf.geometry.node._mesh._normals[n]});e._dirty.normals=!1}if(e._dirty.colors===!0){if(!r&&e._cf.geometry.node._mesh._colors[0].length)for(var n=0;n<e._cf.geometry.node._mesh._colors.length;n++)this.object.setMeshColors({id:e._objectID,idx:n,colors:e._cf.geometry.node._mesh._colors[n],components:e._cf.geometry.node._mesh._numColComponents});e._dirty.colors=!1}if(e._dirty.texcoords===!0){if(r)this.object.setMeshTexCoordsTexture({id:e._objectID,idx:0,texCoordTexture:e._cf.geometry.node.getTexCoordTextureURL()});else if(e._cf.geometry.node._mesh._texCoords[0].length)for(var n=0;n<e._cf.geometry.node._mesh._texCoords.length;n++)this.object.setMeshTexCoords({id:e._objectID,idx:n,texCoords:e._cf.geometry.node._mesh._texCoords[n]});e._dirty.texcoords=!1}if(e._dirty.material===!0){var o=e._cf.appearance.node._cf.material.node;this.object.setMeshMaterial({id:e._objectID,ambientIntensity:o._vf.ambientIntensity,diffuseColor:o._vf.diffuseColor.toGL(),emissiveColor:o._vf.emissiveColor.toGL(),shininess:o._vf.shininess,specularColor:o._vf.specularColor.toGL(),transparency:o._vf.transparency}),e._dirty.material=!1}if(e._dirty.texture===!0){var s=e._cf.appearance.node._cf.texture.node;if(s){var a=void 0!==s._video&&null!==s._video&&void 0!==s._needPerFrameUpdate&&s._needPerFrameUpdate===!0;x3dom.isa(s,x3dom.nodeTypes.PixelTexture)?this.object.setPixelTexture({id:e._objectID,width:s._vf.image.width,height:s._vf.image.height,comp:s._vf.image.comp,pixels:s._vf.image.toGL()}):s._isCanvas&&s._canvas||(x3dom.isa(s,x3dom.nodeTypes.ComposedCubeMapTexture)?this.object.setCubeTexture({id:e._objectID,texURLs:s.getTexUrl()}):x3dom.isa(s,x3dom.nodeTypes.MultiTexture)?x3dom.debug.logError("Flash backend don't support MultiTextures yet"):x3dom.isa(s,x3dom.nodeTypes.MovieTexture)||a?x3dom.debug.logError("Flash backend don't support MovieTextures yet"):this.object.setMeshTexture({id:e._objectID,origChannelCount:s._vf.origChannelCount,repeatS:s._vf.repeatS,repeatT:s._vf.repeatT,url:s._vf.url[0]}))}e._dirty.texture=!1}if(this.object.setMeshSolid({id:e._objectID,solid:e.isSolid()}),void 0!==e._cf.geometry.node._cf.texCoord&&null!==e._cf.geometry.node._cf.texCoord.node&&!x3dom.isa(e._cf.geometry.node._cf.texCoord.node,x3dom.nodeTypes.X3DTextureNode)&&e._cf.geometry.node._cf.texCoord.node._vf.mode){var l=e._cf.geometry.node._cf.texCoord.node._vf.mode;this.object.setSphereMapping("sphere"==l.toLowerCase()?{id:e._objectID,sphereMapping:1}:{id:e._objectID,sphereMapping:0})}else this.object.setSphereMapping({id:e._objectID,sphereMapping:0})}},e.prototype.setupText=function(e,t,i){if(this.object.setMeshTransform({id:e._objectID,refID:i,transform:t.toGL()}),0==i){if(e._dirty.text===!0){var r=e._cf.geometry.node._cf.fontStyle.node;this.object.setText(null===r?{id:e._objectID,text:e._cf.geometry.node._vf.string,fontFamily:["SERIF"],fontStyle:"PLAIN",fontAlign:"BEGIN",fontSize:32,fontSpacing:1,fontHorizontal:!0,fontLanguage:"",fontLeftToRight:!0,fontTopToBottom:!0}:{id:e._objectID,text:e._cf.geometry.node._vf.string,fontFamily:r._vf.family.toString(),fontStyle:r._vf.style.toString(),fontAlign:r._vf.justify.toString(),fontSize:r._vf.size,fontSpacing:r._vf.spacing,fontHorizontal:r._vf.horizontal,fontLanguage:r._vf.language,fontLeftToRight:r._vf.leftToRight,fontTopToBottom:r._vf.topToBottom}),e._dirty.text=!1}if(e._dirty.material===!0){var n=e._cf.appearance.node._cf.material.node;this.object.setMeshMaterial({id:e._objectID,ambientIntensity:n._vf.ambientIntensity,diffuseColor:n._vf.diffuseColor.toGL(),emissiveColor:n._vf.emissiveColor.toGL(),shininess:n._vf.shininess,specularColor:n._vf.specularColor.toGL(),transparency:n._vf.transparency}),e._dirty.material=!1}this.object.setMeshSolid({id:e._objectID,solid:e.isSolid()})}},e.prototype.pickValue=function(e){var t=e._scene;if(null===this.object||null===t||void 0===t.drawableObjects||!t.drawableObjects||"box"===t._vf.pickMode.toLowerCase())return!1;var i="color"===t._vf.pickMode.toLowerCase()?1:"texcoord"===t._vf.pickMode.toLowerCase()?2:0,r=this.object.pickValue({pickMode:i});return r.objID>0?(e._pickingInfo.pickPos=new x3dom.fields.SFVec3f(r.pickPosX,r.pickPosY,r.pickPosZ),e._pickingInfo.pickObj=x3dom.nodeTypes.Shape.idMap.nodeID[r.objID]):(e._pickingInfo.pickObj=null,e._pickingInfo.lastClickObj=null),!0},e.prototype.shutdown=function(){},t}(),x3dom.X3DDocument=function(e,t,i){this.properties=i,this.canvas=e,this.ctx=t,this.needRender=!0,this._scene=null,this._viewarea=null,this._nodeBag={timer:[],lights:[],clipPlanes:[],followers:[],trans:[],renderTextures:[],viewarea:[]},this.downloadCount=0,this.onload=function(){},this.onerror=function(){}},x3dom.X3DDocument.prototype.load=function(e,t){function i(){if(0===n.length)return o._setup(r[e],r,t),void o.onload();var s=n.shift();!x3dom.isX3DElement(s)||"x3d"!==s.localName.toLowerCase()&&"websg"!==s.localName.toLowerCase()||(r[s]=s,i())}var r={},n=[e],o=this;i()},x3dom.findScene=function(e){for(var t=[],i=0;i<e.childNodes.length;i++){var r=e.childNodes[i];r&&r.localName&&"scene"===r.localName.toLowerCase()&&t.push(r)}return t.length>1?(x3dom.debug.logError("X3D element has more than one Scene child (has "+e.childNodes.length+")."),null):t[0]},x3dom.X3DDocument.prototype._setup=function(e){var t=this,i={onAttrModified:function(e){if("_x3domNode"in e.target){e.target._x3domNode.updateField(e.attrName,e.newValue),t.needRender=!0}},onNodeRemoved:function(e){if("_x3domNode"in e.target.parentNode&&"_x3domNode"in e.target){var i=e.target.parentNode._x3domNode,r=e.target._x3domNode;i&&(i.removeChild(r),t.needRender=!0)}},onNodeInserted:function(e){if("_x3domNode"in e.target.parentNode){if("Inline"==e.target.parentNode.tagName||"INLINE"==e.target.parentNode.tagName||"inline"==e.target.parentNode.tagName)return;var i=e.target.parentNode._x3domNode,r=e.target;if(i._nameSpace){var n=i._nameSpace.setupTree(r);i.addChild(n,r.getAttribute("containerField")),t.needRender=!0}else x3dom.debug.logWarning("No _nameSpace in onNodeInserted")}}};e.addEventListener("DOMNodeRemoved",i.onNodeRemoved,!0),e.addEventListener("DOMNodeInserted",i.onNodeInserted,!0),x3dom.userAgentFeature.supportsDOMAttrModified===!0&&e.addEventListener("DOMAttrModified",i.onAttrModified,!0);var r=x3dom.findScene(e);this._bindableBag=new x3dom.BindableBag(this);var n=new x3dom.NodeNameSpace("scene",t),o=n.setupTree(r);this._scene=o,this._bindableBag.setRefNode(o),this._viewarea=new x3dom.Viewarea(this,o),this._viewarea._width=this.canvas.width,this._viewarea._height=this.canvas.height},x3dom.X3DDocument.prototype.advanceTime=function(e){var t,i;if(this._nodeBag.timer.length)for(this.needRender=!0,i=0;i<this._nodeBag.timer.length;i++)this._nodeBag.timer[i].onframe(e);if(this._nodeBag.followers.length)for(t=this,i=0;i<this._nodeBag.followers.length;i++)this.needRender|=this._nodeBag.followers[i].tick(e);if(this._nodeBag.trans.length)for(t=this,i=0;i<this._nodeBag.trans.length;i++)this.needRender|=this._nodeBag.trans[i].tick(e);if(this._nodeBag.viewarea.length)for(t=this,i=0;i<this._nodeBag.viewarea.length;i++)this.needRender|=this._nodeBag.viewarea[i].tick(e)},x3dom.X3DDocument.prototype.render=function(e){e&&this._viewarea&&e.renderScene(this._viewarea)},x3dom.X3DDocument.prototype.onMove=function(e,t,i,r){e&&this._viewarea&&(e.pickValue(this._viewarea,t,i),this._viewarea.onMove(t,i,r))},x3dom.X3DDocument.prototype.onMoveView=function(e,t,i){e&&this._viewarea&&this._viewarea.onMoveView(t,i)},x3dom.X3DDocument.prototype.onDrag=function(e,t,i,r){e&&this._viewarea&&(e.pickValue(this._viewarea,t,i),this._viewarea.onDrag(t,i,r))},x3dom.X3DDocument.prototype.onMousePress=function(e,t,i,r){if(e&&this._viewarea){var n=x3dom.fields.SFVec3f.MAX(),o=x3dom.fields.SFVec3f.MIN();this._viewarea._scene.getVolume(n,o,!0),this._viewarea._scene._lastMin=n,this._viewarea._scene._lastMax=o,e.pickValue(this._viewarea,t,i),this._viewarea.onMousePress(t,i,r)}},x3dom.X3DDocument.prototype.onMouseRelease=function(e,t,i,r){e&&this._viewarea&&(e.pickValue(this._viewarea,t,i),this._viewarea.onMouseRelease(t,i,r))},x3dom.X3DDocument.prototype.onMouseOver=function(e,t,i,r){e&&this._viewarea&&(e.pickValue(this._viewarea,t,i),this._viewarea.onMouseOver(t,i,r))},x3dom.X3DDocument.prototype.onMouseOut=function(e,t,i,r){e&&this._viewarea&&(e.pickValue(this._viewarea,t,i),this._viewarea.onMouseOut(t,i,r))},x3dom.X3DDocument.prototype.onDoubleClick=function(e,t,i){e&&this._viewarea&&this._viewarea.onDoubleClick(t,i)},x3dom.X3DDocument.prototype.onTouchMove=function(e){e&&this._viewarea&&x3dom.debug.logWarning("onTouchMove not implemented")},x3dom.X3DDocument.prototype.onKeyDown=function(e){switch(e){case 37:this._viewarea.strafeLeft();break;case 38:this._viewarea.moveFwd();break;case 39:this._viewarea.strafeRight();break;case 40:this._viewarea.moveBwd()}},x3dom.X3DDocument.prototype.onKeyUp=function(e){var t=null;switch(e){case 27:window.history.back();break;case 33:t=this._scene.getViewpoint()._stack,t?t.switchTo("next"):x3dom.debug.logError("No valid ViewBindable stack.");break;case 34:t=this._scene.getViewpoint()._stack,t?t.switchTo("prev"):x3dom.debug.logError("No valid ViewBindable stack.");break;case 37:break;case 38:break;case 39:break;case 40:}},x3dom.X3DDocument.prototype.onKeyPress=function(e){var t=this._scene.getNavigationInfo();switch(e){case 32:var i=this.canvas.parent.statDiv;i&&(i.style.display="none"==i.style.display?"inline":"none"),x3dom.debug.logInfo("a: show all | d: show helper buffers | s: light view | m: toggle render mode | p: intersect type | r: reset view | e: examine mode | f: fly mode | w: walk mode | l: lookAt mode | g: game mode | u: upright position");break;case 43:t._vf.speed=2*t._vf.speed,x3dom.debug.logInfo("Changed navigation speed to "+t._vf.speed);break;case 45:t._vf.speed=.5*t._vf.speed,x3dom.debug.logInfo("Changed navigation speed to "+t._vf.speed);break;case 97:this._viewarea.showAll();break;case 100:this._viewarea._visDbgBuf=void 0===this._viewarea._visDbgBuf?!0:!this._viewarea._visDbgBuf,x3dom.debug.logContainer.style.display=this._viewarea._visDbgBuf===!0?"block":"none";break;case 101:t.setType("examine",this._viewarea);break;case 102:t.setType("fly",this._viewarea);break;case 103:t.setType("game",this._viewarea);break;case 108:t.setType("lookat",this._viewarea);break;case 109:this._viewarea._points=void 0===this._viewarea._points?!0:!this._viewarea._points;break;case 111:t.setType("lookaround",this._viewarea);break;case 112:switch(this._scene._vf.pickMode.toLowerCase()){case"idbuf":this._scene._vf.pickMode="color";break;case"color":this._scene._vf.pickMode="texCoord";break;case"texcoord":this._scene._vf.pickMode="box";break;default:this._scene._vf.pickMode="idBuf"}x3dom.debug.logInfo("Switch pickMode to '"+this._scene._vf.pickMode+"'.");break;case 114:this._viewarea.resetView();break;case 115:this._nodeBag.lights.length>0&&this._viewarea.animateTo(this._viewarea.getLightMatrix()[0],this._scene.getViewpoint());break;case 117:this._viewarea.uprightView();break;case 119:t.setType("walk",this._viewarea)}},x3dom.X3DDocument.prototype.shutdown=function(e){e&&e.shutdown(this._viewarea)},x3dom.MatrixMixer=function(e,t){0===arguments.length?(this._beginTime=0,this._endTime=0):(this._beginTime=e,this._endTime=t),this._beginMat=x3dom.fields.SFMatrix4f.identity(),this._beginInvMat=x3dom.fields.SFMatrix4f.identity(),this._beginLogMat=x3dom.fields.SFMatrix4f.identity(),this._endMat=x3dom.fields.SFMatrix4f.identity(),this._endLogMat=x3dom.fields.SFMatrix4f.identity()},x3dom.MatrixMixer.prototype.calcFraction=function(e){var t=(e-this._beginTime)/(this._endTime-this._beginTime);return(Math.sin(t*Math.PI-Math.PI/2)+1)/2},x3dom.MatrixMixer.prototype.setBeginMatrix=function(e){this._beginMat.setValues(e),this._beginInvMat=e.inverse(),this._beginLogMat=x3dom.fields.SFMatrix4f.zeroMatrix()},x3dom.MatrixMixer.prototype.setEndMatrix=function(e){this._endMat.setValues(e),this._endLogMat=e.mult(this._beginInvMat).log()},x3dom.MatrixMixer.prototype.mix=function(e){var t=x3dom.fields.SFMatrix4f.zeroMatrix();if(e<=this._beginTime)t.setValues(this._beginLogMat);else if(e>=this._endTime)t.setValues(this._endLogMat);else{var i=this.calcFraction(e);t=this._endLogMat.addScaled(this._beginLogMat,-1),t=t.multiply(i).add(this._beginLogMat)}return t=t.exp().mult(this._beginMat)},x3dom.Viewarea=function(e,t){this._doc=e,this._scene=t,e._nodeBag.viewarea.push(this),this._pickingInfo={pickPos:{},pickObj:null,lastObj:null,lastClickObj:null},this._rotMat=x3dom.fields.SFMatrix4f.identity(),this._transMat=x3dom.fields.SFMatrix4f.identity(),this._movement=new x3dom.fields.SFVec3f(0,0,0),this._needNavigationMatrixUpdate=!0,this._deltaT=0,this._pitch=0,this._yaw=0,this._eyePos=new x3dom.fields.SFVec3f(0,0,0),this._width=400,this._height=300,this._dx=0,this._dy=0,this._lastX=-1,this._lastY=-1,this._pressX=-1,this._pressY=-1,this._lastButton=0,this._pick=new x3dom.fields.SFVec3f(0,0,0),this._lastTS=0,this._mixer=new x3dom.MatrixMixer,this._geoCache=[]},x3dom.Viewarea.prototype.tick=function(e){var t=!1;if(this._mixer._beginTime>0)if(t=!0,e>=this._mixer._beginTime)if(e<=this._mixer._endTime){var i=this._mixer.mix(e);this._scene.getViewpoint().setView(i)}else this._mixer._beginTime=0,this._mixer._endTime=0,this._scene.getViewpoint().setView(this._mixer._endMat);else this._scene.getViewpoint().setView(this._mixer._beginMat);var r=this.navigateTo(e);return this._lastTS=e,t||r},x3dom.Viewarea.prototype.navigateTo=function(e){var t=this._scene.getNavigationInfo(),i="game"===t._vf.type[0].toLowerCase()||this._lastButton>0&&("fly"===t._vf.type[0].toLowerCase()||"walk"===t._vf.type[0].toLowerCase()||"looka"===t._vf.type[0].toLowerCase().substr(0,5));if(this._deltaT=e-this._lastTS,i){var r=.25,n=1.6,o=.75;t._vf.avatarSize.length>2&&(r=t._vf.avatarSize[0],n=t._vf.avatarSize[1],o=t._vf.avatarSize[2]);var s=this.getViewMatrix(),a=0,l=2&this._lastButton?-1:1;l*=this._deltaT*t._vf.speed;var d=Math.PI*this._deltaT*(this._pressX-this._lastX)/this._width,h=Math.PI*this._deltaT*(this._pressY-this._lastY)/this._height;if(this._needNavigationMatrixUpdate===!0){this._needNavigationMatrixUpdate=!1,this._rotMat=x3dom.fields.SFMatrix4f.identity(),this._transMat=x3dom.fields.SFMatrix4f.identity(),this._movement=new x3dom.fields.SFVec3f(0,0,0);var u=0,c=Math.asin(s._02),f=Math.cos(c);Math.abs(f)>1e-4&&(u=Math.atan2(-s._12/f,s._22/f)),this._flyMat=s.inverse(),this._from=this._flyMat.e3(),this._at=this._from.subtract(this._flyMat.e2()),this._up=new x3dom.fields.SFVec3f(0,1,0),this._pitch=180*u/Math.PI,this._yaw=180*c/Math.PI,this._eyePos=this._from.negate()}var m=null,p=null,_=null;if("game"===t._vf.type[0].toLowerCase()){this._pitch+=this._dy,this._yaw+=this._dx,this._pitch>=89&&(this._pitch=89),this._pitch<=-89&&(this._pitch=-89),this._yaw>=360&&(this._yaw-=360),this._yaw<0&&(this._yaw=360+this._yaw),this._dx=0,this._dy=0;var g=x3dom.fields.SFMatrix4f.rotationX(this._pitch/180*Math.PI),v=x3dom.fields.SFMatrix4f.rotationY(this._yaw/180*Math.PI),y=x3dom.fields.SFMatrix4f.translation(this._eyePos);this._flyMat=g.mult(v).mult(y);var b=this._flyMat.inverse(),x=b.e3();return p=new x3dom.fields.SFVec3f(0,-1,0),m=x.add(p),p=b.e0().cross(p).normalize(),_=x3dom.fields.SFMatrix4f.lookAt(x,m,p),_=_.inverse(),this._scene._nameSpace.doc.ctx.pickValue(this,this._width/2,this._height/2,_,this.getProjectionMatrix().mult(_)),this._pickingInfo.pickObj&&(a=this._pickingInfo.pickPos.subtract(x).length(),x.y+=n-a,b.setTranslate(x),this._eyePos=b.e3().negate(),this._flyMat=b.inverse(),this._pickingInfo.pickObj=null),this._scene.getViewpoint().setView(this._flyMat),i}var w=x3dom.fields.Quaternion.axisAngle(this._up,d),T=w.toMatrix(),E=x3dom.fields.SFMatrix4f.translation(this._from);E=E.mult(T),T=x3dom.fields.SFMatrix4f.translation(this._from.negate()),E=E.mult(T),this._at=E.multMatrixPnt(this._at);var C=this._at.subtract(this._from).normalize(),S=C.cross(this._up).normalize(),F=S.cross(C).normalize();w=x3dom.fields.Quaternion.axisAngle(S,h),T=w.toMatrix(),E=x3dom.fields.SFMatrix4f.translation(this._from),E=E.mult(T),T=x3dom.fields.SFMatrix4f.translation(this._from.negate()),E=E.mult(T),this._at=E.multMatrixPnt(this._at),"looka"!==t._vf.type[0].toLowerCase().substr(0,5)&&(this._scene._nameSpace.doc.ctx.pickValue(this,this._width/2,this._height/2),this._pickingInfo.pickObj&&(a=this._pickingInfo.pickPos.subtract(this._from).length(),l>0&&r>=a&&(l=0)),C=this._at.subtract(this._from).normalize().multiply(l),this._at=this._at.add(C),this._from=this._from.add(C),"walk"===t._vf.type[0].toLowerCase()&&(m=this._from.addScaled(F,-1),p=S.cross(F.negate()).normalize(),_=x3dom.fields.SFMatrix4f.lookAt(this._from,m,p),_=_.inverse(),this._scene._nameSpace.doc.ctx.pickValue(this,this._width/2,this._height/2,_,this.getProjectionMatrix().mult(_)),this._pickingInfo.pickObj&&(a=this._pickingInfo.pickPos.subtract(this._from).length(),this._at=this._at.add(F.multiply(n-a)),this._from=this._from.add(F.multiply(n-a)))),this._pickingInfo.pickObj=null),this._flyMat=x3dom.fields.SFMatrix4f.lookAt(this._from,this._at,F),this._scene.getViewpoint().setView(this._flyMat.inverse())}return i},x3dom.Viewarea.prototype.moveFwd=function(){var e=this._scene.getNavigationInfo();if("game"===e._vf.type[0].toLowerCase()){var t=.25,i=1.6;e._vf.avatarSize.length>2&&(t=e._vf.avatarSize[0],i=e._vf.avatarSize[1]);var r=5*this._deltaT*e._vf.speed,n=this._yaw/180*Math.PI,o=this._pitch/180*Math.PI,s=0,a=this._flyMat.inverse();this._scene._nameSpace.doc.ctx.pickValue(this,this._width/2,this._height/2),this._pickingInfo.pickObj&&(s=this._pickingInfo.pickPos.subtract(a.e3()).length(),2*t>=s||(this._eyePos.x-=Math.sin(n)*r,this._eyePos.z+=Math.cos(n)*r,this._eyePos.y+=Math.sin(o)*r))}},x3dom.Viewarea.prototype.moveBwd=function(){var e=this._scene.getNavigationInfo();if("game"===e._vf.type[0].toLowerCase()){var t=5*this._deltaT*e._vf.speed,i=this._yaw/180*Math.PI,r=this._pitch/180*Math.PI;this._eyePos.x+=Math.sin(i)*t,this._eyePos.z-=Math.cos(i)*t,this._eyePos.y-=Math.sin(r)*t}},x3dom.Viewarea.prototype.strafeRight=function(){var e=this._scene.getNavigationInfo();if("game"===e._vf.type[0].toLowerCase()){var t=5*this._deltaT*e._vf.speed,i=this._yaw/180*Math.PI;this._eyePos.x-=Math.cos(i)*t,this._eyePos.z-=Math.sin(i)*t}},x3dom.Viewarea.prototype.strafeLeft=function(){var e=this._scene.getNavigationInfo();if("game"===e._vf.type[0].toLowerCase()){var t=5*this._deltaT*e._vf.speed,i=this._yaw/180*Math.PI;this._eyePos.x+=Math.cos(i)*t,this._eyePos.z+=Math.sin(i)*t}},x3dom.Viewarea.prototype.animateTo=function(e,t,i){var r=this._scene.getNavigationInfo();if(x3dom.isa(e,x3dom.nodeTypes.Viewpoint)&&(e=e.getViewMatrix()),"teleport"!==r._vf.transitionType[0].toLowerCase()&&"game"!==r.getType()){if(!t||!x3dom.isa(t,x3dom.nodeTypes.Viewpoint))return;t=t.getCurrentTransform().mult(t.getViewMatrix()).mult(this._transMat).mult(this._rotMat),this._mixer._beginTime=this._lastTS,this._mixer._endTime=arguments.length>=3?this._lastTS+i:this._lastTS+r._vf.transitionTime,this._mixer.setBeginMatrix(t),this._mixer.setEndMatrix(e)}else this._scene.getViewpoint().setView(e);this._rotMat=x3dom.fields.SFMatrix4f.identity(),this._transMat=x3dom.fields.SFMatrix4f.identity(),this._movement=new x3dom.fields.SFVec3f(0,0,0),this._needNavigationMatrixUpdate=!0},x3dom.Viewarea.prototype.getLights=function(){return this._doc._nodeBag.lights},x3dom.Viewarea.prototype.getLightsShadow=function(){for(var e=this._doc._nodeBag.lights,t=0;t<e.length;t++)if(e[t]._vf.shadowIntensity>0)return!0},x3dom.Viewarea.prototype.getViewpointMatrix=function(){var e=this._scene.getViewpoint(),t=e.getCurrentTransform();return e.getViewMatrix().mult(t.inverse())},x3dom.Viewarea.prototype.getViewMatrix=function(){return this.getViewpointMatrix().mult(this._transMat).mult(this._rotMat)},x3dom.Viewarea.prototype.getLightMatrix=function(){var e,t=this._doc._nodeBag.lights,i=t.length;if(i>0){var r=x3dom.fields.SFVec3f.MAX(),n=x3dom.fields.SFVec3f.MIN(),o=this._scene.getVolume(r,n,!0);if(o){var s=[],a=this._scene.getViewpoint(),l=a.getFieldOfView(),d=n.subtract(r),h=d.y/2/Math.tan(l/2)+d.z/2,u=d.x/2/Math.tan(l/2)+d.z/2;for(d=r.add(d.multiply(.5)),e=0;i>e;e++){if(x3dom.isa(t[e],x3dom.nodeTypes.PointLight))d=d.subtract(t[e]._vf.location).normalize();else{var c=t[e]._vf.direction.normalize().negate();d=d.add(c.multiply(1.2*(h>u?h:u)))}s[e]=t[e].getViewMatrix(d)}return s}}return[this.getViewMatrix()]},x3dom.Viewarea.prototype.getWCtoLCMatrix=function(e){var t,i=this.getProjectionMatrix();return t=0===arguments.length?this.getLightMatrix()[0]:e,i.mult(t)},x3dom.Viewarea.prototype.getProjectionMatrix=function(){var e=this._scene.getViewpoint();return e.getProjectionMatrix(this._width/this._height)},x3dom.Viewarea.prototype.getWCtoCCMatrix=function(){var e=this.getViewMatrix(),t=this.getProjectionMatrix();return t.mult(e)},x3dom.Viewarea.prototype.getCCtoWCMatrix=function(){var e=this.getWCtoCCMatrix();return e.inverse()},x3dom.Viewarea.prototype.calcViewRay=function(e,t){var i=this.getCCtoWCMatrix(),r=e/(this._width-1)*2-1,n=(this._height-1-t)/(this._height-1)*2-1,o=i.multFullMatrixPnt(new x3dom.fields.SFVec3f(r,n,-1)),s=i.multFullMatrixPnt(new x3dom.fields.SFVec3f(r,n,1)),a=s.subtract(o);return new x3dom.fields.Line(o,a)},x3dom.Viewarea.prototype.showAll=function(){var e=x3dom.fields.SFVec3f.MAX(),t=x3dom.fields.SFVec3f.MIN(),i=this._scene.getVolume(e,t,!0);if(i){var r=this._scene.getViewpoint(),n=r.getFieldOfView(),o=t.subtract(e),s=o.y/2/Math.tan(n/2)+o.z/2,a=o.x/2/Math.tan(n/2)+o.z/2;o=e.add(o.multiply(.5)),o.z+=s>a?s:a,this.animateTo(x3dom.fields.SFMatrix4f.translation(o.multiply(-1)),r)}},x3dom.Viewarea.prototype.resetView=function(){var e=this._scene.getNavigationInfo();"teleport"!==e._vf.transitionType[0].toLowerCase()&&"game"!==e.getType()?(this._mixer._beginTime=this._lastTS,this._mixer._endTime=this._lastTS+e._vf.transitionTime,this._mixer.setBeginMatrix(this.getViewMatrix()),this._scene.getViewpoint().resetView(),this._mixer.setEndMatrix(this._scene.getViewpoint().getViewMatrix())):this._scene.getViewpoint().resetView(),this._rotMat=x3dom.fields.SFMatrix4f.identity(),this._transMat=x3dom.fields.SFMatrix4f.identity(),this._movement=new x3dom.fields.SFVec3f(0,0,0),this._needNavigationMatrixUpdate=!0},x3dom.Viewarea.prototype.uprightView=function(){var e=this.getViewMatrix().inverse(),t=e.e3(),i=t.subtract(e.e2()),r=new x3dom.fields.SFVec3f(0,1,0),n=e.e2().cross(r).normalize(),o=n.cross(r).normalize();i=t.add(o),e=x3dom.fields.SFMatrix4f.lookAt(t,i,r),e=e.inverse(),this.animateTo(e,this._scene.getViewpoint())},x3dom.Viewarea.prototype.callEvtHandler=function(e,t,i){i.target=e._xmlNode;var r=e._xmlNode[t];try{if("function"==typeof r)r.call(e._xmlNode,i);else{var n=e._xmlNode.getAttribute(t),o=new Function("event",n);o.call(e._xmlNode,i)}var s=e._listeners[i.type];if(s)for(var a=0;a<s.length;a++)s[a].call(e._xmlNode,i)}catch(l){x3dom.debug.logException(l)}return i.cancelBubble},x3dom.Viewarea.prototype.checkEvents=function(e,t,i,r,n){var o=this,s=!0,a={target:{},type:n.substr(2,n.length-2),button:r,layerX:t,layerY:i,worldX:o._pick.x,worldY:o._pick.y,worldZ:o._pick.z,hitPnt:o._pick.toGL(),hitObject:e._xmlNode?e._xmlNode:null,cancelBubble:!1,stopPropagation:function(){this.cancelBubble=!0}};try{var l=e;l._xmlNode[n]||l._xmlNode.hasAttribute(n)||l._listeners[a.type]||(l=l._cf.geometry.node),o.callEvtHandler(l,n,a)===!0&&(s=!1)}catch(d){x3dom.debug.logException(d)}var h=function(e){Array.forEach(e._parentNodes,function(e){e._xmlNode&&(e._xmlNode[n]||e._xmlNode.hasAttribute(n)||e._listeners[a.type])&&o.callEvtHandler(e,n,a)===!0&&(s=!1),x3dom.isa(e,x3dom.nodeTypes.Anchor)&&"onclick"===n?(e.handleTouch(),s=!1):s&&h(e)})};s&&h(e)},x3dom.Viewarea.prototype.initMouseState=function(){this._deltaT=0,this._dx=0,this._dy=0,this._lastX=-1,this._lastY=-1,this._pressX=-1,this._pressY=-1,this._lastButton=0,this._needNavigationMatrixUpdate=!0},x3dom.Viewarea.prototype.onMousePress=function(e,t,i){this._needNavigationMatrixUpdate=!0,this.prepareEvents(e,t,i,"onmousedown"),this._pickingInfo.lastClickObj=this._pickingInfo.pickObj,this._dx=0,this._dy=0,this._lastX=e,this._lastY=t,this._pressX=e,this._pressY=t,this._lastButton=i},x3dom.Viewarea.prototype.onMouseRelease=function(e,t,i){var r,n=3,o=this._scene.getNavigationInfo();if("box"!==this._scene._vf.pickMode.toLowerCase())this.prepareEvents(e,t,i,"onmouseup"),this._pickingInfo.pickObj&&this._pickingInfo.pickObj===this._pickingInfo.lastClickObj&&this.prepareEvents(e,t,i,"onclick");
else{var s=(new Date).getTime(),a=this.calcViewRay(e,t),l=this._scene.doIntersect(a),d=a.hitObject;l&&d&&(this._pick.setValues(a.hitPoint),this.checkEvents(d,e,t,i,"onclick"),x3dom.debug.logInfo("Hit '"+d._xmlNode.localName+"/ "+d._DEF+"' at dist="+a.dist.toFixed(4)),x3dom.debug.logInfo("Ray hit at position "+this._pick));var h=(new Date).getTime()-s;if(x3dom.debug.logInfo("Picking time (box): "+h+"ms"),!l){r=this.getViewMatrix().e2().negate();var u=r.dot(a.pos.negate())/r.dot(a.dir);this._pick=a.pos.add(a.dir.multiply(u))}}if(this._pickingInfo.pickObj&&"lookat"===o._vf.type[0].toLowerCase()&&this._pressX===e&&this._pressY===t){var c=2&this._lastButton?-1:1,f=this._pickingInfo.pickPos.subtract(this._from).length()/n,m=new x3dom.fields.SFMatrix4f;m.setValues(this.getViewMatrix()),m=m.inverse();{var p=m.e3();p.subtract(m.e2()),m.e1()}r=this._pickingInfo.pickPos.subtract(p);var _=r.length();r=r.normalize();var g=new x3dom.fields.SFVec3f(0,1,0),v=p.addScaled(r,_),y=r.cross(g).normalize();r=y.cross(g).normalize(),0>c&&(f=2*(.5+_+f));var b=v.addScaled(r,f);m=x3dom.fields.SFMatrix4f.lookAt(b,v,g),m=m.inverse(),f=b.subtract(p).length();var x=Math.log(f/o._vf.speed);this.animateTo(m,this._scene.getViewpoint(),x)}this._dx=0,this._dy=0,this._lastX=e,this._lastY=t,this._lastButton=i},x3dom.Viewarea.prototype.onMouseOver=function(e,t){this._dx=0,this._dy=0,this._lastButton=0,this._lastX=e,this._lastY=t,this._deltaT=0},x3dom.Viewarea.prototype.onMouseOut=function(e,t){this._dx=0,this._dy=0,this._lastButton=0,this._lastX=e,this._lastY=t,this._deltaT=0},x3dom.Viewarea.prototype.onDoubleClick=function(){if("true"!==this._doc.properties.getProperty("disableDoubleClick","false")){var e=this._scene.getNavigationInfo();if(!(e._vf.type[0].length<=1||"none"==e._vf.type[0].toLowerCase())&&"color"!==this._scene._vf.pickMode.toLowerCase()&&"texcoord"!==this._scene._vf.pickMode.toLowerCase()){var t=this._scene.getViewpoint();t._vf.centerOfRotation.setValues(this._pick),x3dom.debug.logInfo("New center of Rotation:  "+this._pick);var i=this.getViewMatrix().inverse(),r=i.e3(),n=this._pick,o=i.e1(),s=i.e0().cross(o).normalize(),a=s.dot(this._pick.subtract(r));r=n.addScaled(s,-a),i=x3dom.fields.SFMatrix4f.lookAt(r,n,o),x3dom.debug.logInfo("New camera position:  "+r),this.animateTo(i.inverse(),t)}}},x3dom.Viewarea.prototype.handleMoveEvt=function(e,t,i){if(this.prepareEvents(e,t,i,"onmousemove"),this._pickingInfo.pickObj!==this._pickingInfo.lastObj){if(this._pickingInfo.lastObj){var r=this._pickingInfo.pickObj;this._pickingInfo.pickObj=this._pickingInfo.lastObj,this.prepareEvents(e,t,i,"onmouseout"),this._pickingInfo.pickObj=r}this._pickingInfo.pickObj&&this.prepareEvents(e,t,i,"onmouseover"),this._pickingInfo.lastObj=this._pickingInfo.pickObj}},x3dom.Viewarea.prototype.onMove=function(e,t,i){this.handleMoveEvt(e,t,i),(this._lastX<0||this._lastY<0)&&(this._lastX=e,this._lastY=t),this._dx=e-this._lastX,this._dy=t-this._lastY,this._lastX=e,this._lastY=t},x3dom.Viewarea.prototype.onMoveView=function(e,t){var i=this._scene.getNavigationInfo(),r=this._scene.getViewpoint();if("examine"===i._vf.type[0].toLowerCase()){if(e){var n=1+Math.abs(this._movement.z);e=e.multiply(n),this._movement=this._movement.add(e),this._transMat=r.getViewMatrix().inverse().mult(x3dom.fields.SFMatrix4f.translation(this._movement)).mult(r.getViewMatrix())}t&&(this._rotMat=t.mult(this._rotMat))}},x3dom.Viewarea.prototype.onDrag=function(e,t,i){this.handleMoveEvt(e,t,i);var r=this._scene.getNavigationInfo();if(!(r._vf.type[0].length<=1||"none"===r._vf.type[0].toLowerCase())){var n,o,s,a,l,d=e-this._lastX,h=t-this._lastY,u=this._scene.getViewpoint();if("examine"===r._vf.type[0].toLowerCase()){if(1&i){var c=2*h*Math.PI/this._width,f=2*d*Math.PI/this._height,m=this.getViewMatrix(),p=x3dom.fields.SFMatrix4f.rotationX(c),_=x3dom.fields.SFMatrix4f.rotationY(f),g=u.getCenterOfRotation();m.setTranslate(new x3dom.fields.SFVec3f(0,0,0)),this._rotMat=this._rotMat.mult(x3dom.fields.SFMatrix4f.translation(g)).mult(m.inverse()).mult(p).mult(_).mult(m).mult(x3dom.fields.SFMatrix4f.translation(g.negate()))}if(4&i&&(n=x3dom.fields.SFVec3f.MAX(),o=x3dom.fields.SFVec3f.MIN(),s=this._scene.getVolume(n,o,!0),a=s?o.subtract(n).length():10,a=a<x3dom.fields.Eps?1:a,l=new x3dom.fields.SFVec3f(a*d/this._width,a*-h/this._height,0),this._movement=this._movement.add(l),this._transMat=u.getViewMatrix().inverse().mult(x3dom.fields.SFMatrix4f.translation(this._movement)).mult(u.getViewMatrix())),2&i){if("true"===this._doc.properties.getProperty("disableRightDrag","false"))return;n=x3dom.fields.SFVec3f.MAX(),o=x3dom.fields.SFVec3f.MIN(),s=this._scene.getVolume(n,o,!0),a=s?o.subtract(n).length():10,a=a<x3dom.fields.Eps?1:a,l=new x3dom.fields.SFVec3f(0,0,a*(d+h)/this._height),this._movement=this._movement.add(l),this._transMat=u.getViewMatrix().inverse().mult(x3dom.fields.SFMatrix4f.translation(this._movement)).mult(u.getViewMatrix())}}this._dx=d,this._dy=h,this._lastX=e,this._lastY=t}},x3dom.Viewarea.prototype.prepareEvents=function(e,t,i,r){var n="idbuf"===this._scene._vf.pickMode.toLowerCase()||"color"===this._scene._vf.pickMode.toLowerCase()||"texcoord"===this._scene._vf.pickMode.toLowerCase();if(n){var o=this._pickingInfo.pickObj;o&&(this._pick.setValues(this._pickingInfo.pickPos),this.checkEvents(o,e,t,i,r),"onclick"===r&&(x3dom.debug.logInfo('Hit "'+o._xmlNode.localName+"/ "+o._DEF+'"'),x3dom.debug.logInfo("Ray hit at position "+this._pick)))}},x3dom.Mesh=function(e){this._parent=e,this._min=new x3dom.fields.SFVec3f(0,0,0),this._max=new x3dom.fields.SFVec3f(0,0,0),this._invalidate=!0,this._numFaces=0,this._numCoords=0,this._positions=[],this._normals=[],this._texCoords=[],this._colors=[],this._indices=[],this._positions[0]=[],this._normals[0]=[],this._texCoords[0]=[],this._colors[0]=[],this._indices[0]=[]},x3dom.Mesh.prototype._dynamicFields={},x3dom.Mesh.prototype._numTexComponents=2,x3dom.Mesh.prototype._numColComponents=3,x3dom.Mesh.prototype._lit=!0,x3dom.Mesh.prototype._min={},x3dom.Mesh.prototype._max={},x3dom.Mesh.prototype._invalidate=!0,x3dom.Mesh.prototype._numFaces=0,x3dom.Mesh.prototype._numCoords=0,x3dom.Mesh.prototype.setMeshData=function(e,t,i,r,n){this._positions[0]=e,this._normals[0]=t,this._texCoords[0]=i,this._colors[0]=r,this._indices[0]=n,this._invalidate=!0,this._numFaces=this._indices[0].length/3,this._numCoords=this._positions[0].length/3},x3dom.Mesh.prototype.getBBox=function(e,t,i){if(this._invalidate===!0&&i===!0){var r=this._positions[0],n=r.length;n>3?(this._min=new x3dom.fields.SFVec3f(r[0],r[1],r[2]),this._max=new x3dom.fields.SFVec3f(r[0],r[1],r[2])):(this._min=new x3dom.fields.SFVec3f(0,0,0),this._max=new x3dom.fields.SFVec3f(0,0,0));for(var o=3;n>o;o+=3)this._min.x>r[o+0]&&(this._min.x=r[o+0]),this._min.y>r[o+1]&&(this._min.y=r[o+1]),this._min.z>r[o+2]&&(this._min.z=r[o+2]),this._max.x<r[o+0]&&(this._max.x=r[o+0]),this._max.y<r[o+1]&&(this._max.y=r[o+1]),this._max.z<r[o+2]&&(this._max.z=r[o+2]);this._invalidate=!1}e.setValues(this._min),t.setValues(this._max)},x3dom.Mesh.prototype.getCenter=function(){var e=new x3dom.fields.SFVec3f(0,0,0),t=new x3dom.fields.SFVec3f(0,0,0);this.getBBox(e,t,!0);var i=e.add(t).multiply(.5);return i},x3dom.Mesh.prototype.doIntersect=function(e){var t=new x3dom.fields.SFVec3f(0,0,0),i=new x3dom.fields.SFVec3f(0,0,0);this.getBBox(t,i,!0);var r=e.intersect(t,i);return r&&e.enter<e.dist&&(e.dist=e.enter,e.hitObject=this._parent,e.hitPoint=e.pos.add(e.dir.multiply(e.enter))),r},x3dom.Mesh.prototype.calcNormals=function(e){var t,i,r=0,n=0,o=0,s=void 0!==this._multiIndIndices&&this._multiIndIndices.length,a=this._positions[0],l=s?this._multiIndIndices:this._indices[0],d=[],h=[],u=null;for(o=void 0!==this._posSize&&this._posSize>a.length?this._posSize/3:a.length/3,o=3*(o-Math.floor(o)>0?Math.floor(o+1):o),r=0;o>r;++r)h[r]=[];for(o=l.length,r=0;o>r;r+=3)s?(t=new x3dom.fields.SFVec3f(a[3*r],a[3*r+1],a[3*r+2]).subtract(new x3dom.fields.SFVec3f(a[3*(r+1)],a[3*(r+1)+1],a[3*(r+1)+2])),i=new x3dom.fields.SFVec3f(a[3*(r+1)],a[3*(r+1)+1],a[3*(r+1)+2]).subtract(new x3dom.fields.SFVec3f(a[3*(r+2)],a[3*(r+2)+1],a[3*(r+2)+2]))):(t=new x3dom.fields.SFVec3f(a[3*l[r]],a[3*l[r]+1],a[3*l[r]+2]).subtract(new x3dom.fields.SFVec3f(a[3*l[r+1]],a[3*l[r+1]+1],a[3*l[r+1]+2])),i=new x3dom.fields.SFVec3f(a[3*l[r+1]],a[3*l[r+1]+1],a[3*l[r+1]+2]).subtract(new x3dom.fields.SFVec3f(a[3*l[r+2]],a[3*l[r+2]+1],a[3*l[r+2]+2]))),u=t.cross(i).normalize(),e<=x3dom.fields.Eps?(d[3*r]=d[3*(r+1)]=d[3*(r+2)]=u.x,d[3*r+1]=d[3*(r+1)+1]=d[3*(r+2)+1]=u.y,d[3*r+2]=d[3*(r+1)+2]=d[3*(r+2)+2]=u.z):(h[l[r]].push(u),h[l[r+1]].push(u),h[l[r+2]].push(u));if(e>x3dom.fields.Eps)for(r=0;r<a.length;r+=3){if(u=new x3dom.fields.SFVec3f(0,0,0),s)for(o=h[l[r/3]].length,n=0;o>n;++n)u=u.add(h[l[r/3]][n]);else for(o=h[r/3].length,n=0;o>n;++n)u=u.add(h[r/3][n]);u=u.normalize(),d[r]=u.x,d[r+1]=u.y,d[r+2]=u.z}s&&(this._multiIndIndices=[]),this._normals[0]=d},x3dom.Mesh.prototype.splitMesh=function(){var e=65535;if(!(this._positions[0].length/3<=e)){var t=this._positions[0],i=this._normals[0],r=this._texCoords[0],n=this._colors[0],o=this._indices[0],s=0;do{this._positions[s]=[],this._normals[s]=[],this._texCoords[s]=[],this._colors[s]=[],this._indices[s]=[];var a=o.length-(s+1)*e<0?!1:!0;if(this._indices[s]=a?o.slice(s*e,(s+1)*e):o.slice(s*e),s)for(var l=s*e,d=0,h=this._indices[s].length;h>d;d++)this._indices[s][d]-=l;this._positions[s]=a?t.slice(s*e*3,3*(s+1)*e):t.slice(s*e*3),i.length&&(this._normals[s]=a?i.slice(s*e*3,3*(s+1)*e):i.slice(s*e*3)),r.length&&(this._texCoords[s]=a?r.slice(s*e*this._numTexComponents,this._numTexComponents*(s+1)*e):r.slice(s*e*this._numTexComponents)),n.length&&(this._colors[s]=a?n.slice(s*e*this._numColComponents,this._numColComponents*(s+1)*e):n.slice(s*e*this._numColComponents))}while(t.length>++s*e*3)}},x3dom.Mesh.prototype.calcTexCoords=function(e){if(this._texCoords[0]=[],"sphere-local"===e.toLowerCase())for(var t=0,i=0,r=this._normals[0].length;r>t;t+=3)this._texCoords[0][i++]=.5+this._normals[0][t]/2,this._texCoords[0][i++]=.5+this._normals[0][t+1]/2;else{var n=new x3dom.fields.SFVec3f(0,0,0),o=new x3dom.fields.SFVec3f(0,0,0);this.getBBox(n,o,!0);var s=o.subtract(n),a=0,l=1;s.x>=s.y?s.x>=s.z?(a=0,l=s.y>=s.z?1:2):(a=2,l=0):s.y>=s.z?(a=1,l=s.x>=s.z?0:2):(a=2,l=1);var d=1,h=1,u=0,c=0;switch(a){case 0:d=s.x,u=n.x;break;case 1:d=s.y,u=n.y;break;case 2:d=s.z,u=n.z}switch(l){case 0:h=s.x,c=n.x;break;case 1:h=s.y,c=n.y;break;case 2:h=s.z,c=n.z}for(var f=0,m=0,p=this._positions[0].length;p>f;f+=3)this._texCoords[0][m++]=(this._positions[0][f+a]-u)/d,this._texCoords[0][m++]=(this._positions[0][f+l]-c)/h}},x3dom.fields={},x3dom.fields.Eps=1e-6,x3dom.fields.SFMatrix4f=function(e,t,i,r,n,o,s,a,l,d,h,u,c,f,m,p){0===arguments.length?(this._00=1,this._01=0,this._02=0,this._03=0,this._10=0,this._11=1,this._12=0,this._13=0,this._20=0,this._21=0,this._22=1,this._23=0,this._30=0,this._31=0,this._32=0,this._33=1):(this._00=e,this._01=t,this._02=i,this._03=r,this._10=n,this._11=o,this._12=s,this._13=a,this._20=l,this._21=d,this._22=h,this._23=u,this._30=c,this._31=f,this._32=m,this._33=p)},x3dom.fields.SFMatrix4f.prototype.e0=function(){var e=new x3dom.fields.SFVec3f(this._00,this._10,this._20);return e.normalize()},x3dom.fields.SFMatrix4f.prototype.e1=function(){var e=new x3dom.fields.SFVec3f(this._01,this._11,this._21);return e.normalize()},x3dom.fields.SFMatrix4f.prototype.e2=function(){var e=new x3dom.fields.SFVec3f(this._02,this._12,this._22);return e.normalize()},x3dom.fields.SFMatrix4f.prototype.e3=function(){return new x3dom.fields.SFVec3f(this._03,this._13,this._23)},x3dom.fields.SFMatrix4f.identity=function(){return new x3dom.fields.SFMatrix4f(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1)},x3dom.fields.SFMatrix4f.zeroMatrix=function(){return new x3dom.fields.SFMatrix4f(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)},x3dom.fields.SFMatrix4f.translation=function(e){return new x3dom.fields.SFMatrix4f(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1)},x3dom.fields.SFMatrix4f.rotationX=function(e){var t=Math.cos(e),i=Math.sin(e);return new x3dom.fields.SFMatrix4f(1,0,0,0,0,t,-i,0,0,i,t,0,0,0,0,1)},x3dom.fields.SFMatrix4f.rotationY=function(e){var t=Math.cos(e),i=Math.sin(e);return new x3dom.fields.SFMatrix4f(t,0,i,0,0,1,0,0,-i,0,t,0,0,0,0,1)},x3dom.fields.SFMatrix4f.rotationZ=function(e){var t=Math.cos(e),i=Math.sin(e);return new x3dom.fields.SFMatrix4f(t,-i,0,0,i,t,0,0,0,0,1,0,0,0,0,1)},x3dom.fields.SFMatrix4f.scale=function(e){return new x3dom.fields.SFMatrix4f(e.x,0,0,0,0,e.y,0,0,0,0,e.z,0,0,0,0,1)},x3dom.fields.SFMatrix4f.lookAt=function(e,t,i){var r=e.subtract(t).normalize(),n=i.normalize().cross(r);if(n.dot(n)<x3dom.fields.Eps)return x3dom.debug.logWarning("View matrix is linearly dependent."),x3dom.fields.SFMatrix4f.translation(e);var o=r.cross(n.normalize()).normalize(),s=x3dom.fields.SFMatrix4f.identity();return s.setValue(n,o,r,e),s},x3dom.fields.SFMatrix4f.prototype.setTranslate=function(e){this._03=e.x,this._13=e.y,this._23=e.z},x3dom.fields.SFMatrix4f.prototype.setScale=function(e){this._00=e.x,this._11=e.y,this._22=e.z},x3dom.fields.SFMatrix4f.parseRotation=function(e){var t=/^([+\-]?\d*\.*\d*[eE]?[+\-]?\d*?)\s*,?\s*([+\-]?\d*\.*\d*[eE]?[+\-]?\d*?)\s*,?\s*([+\-]?\d*\.*\d*[eE]?[+\-]?\d*?)\s*,?\s*([+\-]?\d*\.*\d*[eE]?[+\-]?\d*?)$/.exec(e),i=+t[1],r=+t[2],n=+t[3],o=+t[4],s=Math.sqrt(i*i+r*r+n*n);0===s?(i=1,r=n=0):(i/=s,r/=s,n/=s);var a=Math.cos(o),l=Math.sin(o),d=1-a;return new x3dom.fields.SFMatrix4f(d*i*i+a,d*i*r+l*n,d*i*n-l*r,0,d*i*r-l*n,d*r*r+a,d*r*n+l*i,0,d*i*n+l*r,d*r*n-l*i,d*n*n+a,0,0,0,0,1).transpose()},x3dom.fields.SFMatrix4f.parse=function(e){var t=!1,i=/matrix.*\((.+)\)/;i.exec(e)&&(e=RegExp.$1,t=!0);var r=Array.map(e.split(/[,\s]+/),function(e){return+e});return r.length>=16?t?new x3dom.fields.SFMatrix4f(r[0],r[4],r[8],r[12],r[1],r[5],r[9],r[13],r[2],r[6],r[10],r[14],r[3],r[7],r[11],r[15]):new x3dom.fields.SFMatrix4f(r[0],r[1],r[2],r[3],r[4],r[5],r[6],r[7],r[8],r[9],r[10],r[11],r[12],r[13],r[14],r[15]):6===r.length?new x3dom.fields.SFMatrix4f(r[0],r[1],0,r[4],r[2],r[3],0,r[5],0,0,1,0,0,0,0,1):(x3dom.debug.logWarning("SFMatrix4f - can't parse string: "+e),x3dom.fields.SFMatrix4f.identity())},x3dom.fields.SFMatrix4f.prototype.mult=function(e){return new x3dom.fields.SFMatrix4f(this._00*e._00+this._01*e._10+this._02*e._20+this._03*e._30,this._00*e._01+this._01*e._11+this._02*e._21+this._03*e._31,this._00*e._02+this._01*e._12+this._02*e._22+this._03*e._32,this._00*e._03+this._01*e._13+this._02*e._23+this._03*e._33,this._10*e._00+this._11*e._10+this._12*e._20+this._13*e._30,this._10*e._01+this._11*e._11+this._12*e._21+this._13*e._31,this._10*e._02+this._11*e._12+this._12*e._22+this._13*e._32,this._10*e._03+this._11*e._13+this._12*e._23+this._13*e._33,this._20*e._00+this._21*e._10+this._22*e._20+this._23*e._30,this._20*e._01+this._21*e._11+this._22*e._21+this._23*e._31,this._20*e._02+this._21*e._12+this._22*e._22+this._23*e._32,this._20*e._03+this._21*e._13+this._22*e._23+this._23*e._33,this._30*e._00+this._31*e._10+this._32*e._20+this._33*e._30,this._30*e._01+this._31*e._11+this._32*e._21+this._33*e._31,this._30*e._02+this._31*e._12+this._32*e._22+this._33*e._32,this._30*e._03+this._31*e._13+this._32*e._23+this._33*e._33)},x3dom.fields.SFMatrix4f.prototype.multMatrixPnt=function(e){return new x3dom.fields.SFVec3f(this._00*e.x+this._01*e.y+this._02*e.z+this._03,this._10*e.x+this._11*e.y+this._12*e.z+this._13,this._20*e.x+this._21*e.y+this._22*e.z+this._23)},x3dom.fields.SFMatrix4f.prototype.multMatrixVec=function(e){return new x3dom.fields.SFVec3f(this._00*e.x+this._01*e.y+this._02*e.z,this._10*e.x+this._11*e.y+this._12*e.z,this._20*e.x+this._21*e.y+this._22*e.z)},x3dom.fields.SFMatrix4f.prototype.multFullMatrixPnt=function(e){var t=this._30*e.x+this._31*e.y+this._32*e.z+this._33;return t&&(t=1/t),new x3dom.fields.SFVec3f((this._00*e.x+this._01*e.y+this._02*e.z+this._03)*t,(this._10*e.x+this._11*e.y+this._12*e.z+this._13)*t,(this._20*e.x+this._21*e.y+this._22*e.z+this._23)*t)},x3dom.fields.SFMatrix4f.prototype.transpose=function(){return new x3dom.fields.SFMatrix4f(this._00,this._10,this._20,this._30,this._01,this._11,this._21,this._31,this._02,this._12,this._22,this._32,this._03,this._13,this._23,this._33)},x3dom.fields.SFMatrix4f.prototype.negate=function(){return new x3dom.fields.SFMatrix4f(-this._00,-this._01,-this._02,-this._03,-this._10,-this._11,-this._12,-this._13,-this._20,-this._21,-this._22,-this._23,-this._30,-this._31,-this._32,-this._33)},x3dom.fields.SFMatrix4f.prototype.multiply=function(e){return new x3dom.fields.SFMatrix4f(e*this._00,e*this._01,e*this._02,e*this._03,e*this._10,e*this._11,e*this._12,e*this._13,e*this._20,e*this._21,e*this._22,e*this._23,e*this._30,e*this._31,e*this._32,e*this._33)},x3dom.fields.SFMatrix4f.prototype.add=function(e){return new x3dom.fields.SFMatrix4f(this._00+e._00,this._01+e._01,this._02+e._02,this._03+e._03,this._10+e._10,this._11+e._11,this._12+e._12,this._13+e._13,this._20+e._20,this._21+e._21,this._22+e._22,this._23+e._23,this._30+e._30,this._31+e._31,this._32+e._32,this._33+e._33)},x3dom.fields.SFMatrix4f.prototype.addScaled=function(e,t){return new x3dom.fields.SFMatrix4f(this._00+t*e._00,this._01+t*e._01,this._02+t*e._02,this._03+t*e._03,this._10+t*e._10,this._11+t*e._11,this._12+t*e._12,this._13+t*e._13,this._20+t*e._20,this._21+t*e._21,this._22+t*e._22,this._23+t*e._23,this._30+t*e._30,this._31+t*e._31,this._32+t*e._32,this._33+t*e._33)},x3dom.fields.SFMatrix4f.prototype.setValues=function(e){this._00=e._00,this._01=e._01,this._02=e._02,this._03=e._03,this._10=e._10,this._11=e._11,this._12=e._12,this._13=e._13,this._20=e._20,this._21=e._21,this._22=e._22,this._23=e._23,this._30=e._30,this._31=e._31,this._32=e._32,this._33=e._33},x3dom.fields.SFMatrix4f.prototype.setValue=function(e,t,i,r){this._00=e.x,this._01=t.x,this._02=i.x,this._10=e.y,this._11=t.y,this._12=i.y,this._20=e.z,this._21=t.z,this._22=i.z,this._30=0,this._31=0,this._32=0,arguments.length>3&&(this._03=r.x,this._13=r.y,this._23=r.z,this._33=1)},x3dom.fields.SFMatrix4f.prototype.toGL=function(){return[this._00,this._10,this._20,this._30,this._01,this._11,this._21,this._31,this._02,this._12,this._22,this._32,this._03,this._13,this._23,this._33]},x3dom.fields.SFMatrix4f.prototype.sqrt=function(){var e,t,i,r=x3dom.fields.SFMatrix4f.identity(),n=x3dom.fields.SFMatrix4f.identity(),o=x3dom.fields.SFMatrix4f.identity(),s=x3dom.fields.SFMatrix4f.identity();for(s.setValues(this),e=0;6>e;e++)r=s.inverse(),o=n.inverse(),t=Math.abs(Math.pow(s.det()*n.det(),-.125)),i=1/t,s=s.multiply(t),s=s.addScaled(o,i),s=s.multiply(.5),n=n.multiply(t),n=n.addScaled(r,i),n=n.multiply(.5);return s},x3dom.fields.SFMatrix4f.prototype.normInfinity=function(){var e=0,t=0;return(e=Math.abs(this._00))>t&&(t=e),(e=Math.abs(this._01))>t&&(t=e),(e=Math.abs(this._02))>t&&(t=e),(e=Math.abs(this._03))>t&&(t=e),(e=Math.abs(this._10))>t&&(t=e),(e=Math.abs(this._11))>t&&(t=e),(e=Math.abs(this._12))>t&&(t=e),(e=Math.abs(this._13))>t&&(t=e),(e=Math.abs(this._20))>t&&(t=e),(e=Math.abs(this._21))>t&&(t=e),(e=Math.abs(this._22))>t&&(t=e),(e=Math.abs(this._23))>t&&(t=e),(e=Math.abs(this._30))>t&&(t=e),(e=Math.abs(this._31))>t&&(t=e),(e=Math.abs(this._32))>t&&(t=e),(e=Math.abs(this._33))>t&&(t=e),t},x3dom.fields.SFMatrix4f.prototype.equals=function(e){var t=1e-12;return Math.abs(this._00-e._00)<t&&Math.abs(this._01-e._01)<t&&Math.abs(this._02-e._02)<t&&Math.abs(this._03-e._03)<t&&Math.abs(this._10-e._10)<t&&Math.abs(this._11-e._11)<t&&Math.abs(this._12-e._12)<t&&Math.abs(this._13-e._13)<t&&Math.abs(this._20-e._20)<t&&Math.abs(this._21-e._21)<t&&Math.abs(this._22-e._22)<t&&Math.abs(this._23-e._23)<t&&Math.abs(this._30-e._30)<t&&Math.abs(this._31-e._31)<t&&Math.abs(this._32-e._32)<t&&Math.abs(this._33-e._33)<t},x3dom.fields.SFMatrix4f.prototype.getTransform=function(e,t,i){var r,n,o,s,a,l,d=new x3dom.fields.SFVec3f(this._03,this._13,this._23),h=new x3dom.fields.SFVec3f(1,1,1);n=Math.asin(this._02),l=Math.cos(n),Math.abs(l)>1e-4?(s=this._22/l,a=-this._12/l,r=Math.atan2(a,s),s=this._00/l,a=-this._01/l,o=Math.atan2(a,s)):(r=0,s=this._11,a=this._10,o=Math.atan2(a,s));var u=new x3dom.fields.Quaternion(-Math.cos((r-o)/2)*Math.sin(n/2),Math.sin((r-o)/2)*Math.sin(n/2),-Math.sin((r+o)/2)*Math.cos(n/2),Math.cos((r+o)/2)*Math.cos(n/2));e.x=d.x,e.y=d.y,e.z=d.z,t.x=u.x,t.y=u.y,t.z=u.z,t.w=u.w,i.x=h.x,i.y=h.y,i.z=h.z},x3dom.fields.SFMatrix4f.prototype.log=function(){var e=12,t=0,i=0,r=1e-12,n=x3dom.fields.SFMatrix4f.identity(),o=x3dom.fields.SFMatrix4f.identity(),s=x3dom.fields.SFMatrix4f.identity();for(n.setValues(this),o.setValues(this),o._00-=1,o._11-=1,o._22-=1,o._33-=1;o.normInfinity()>.5;)n=n.sqrt(),o.setValues(n),o._00-=1,o._11-=1,o._22-=1,o._33-=1,t++;for(n._00-=1,n._11-=1,n._22-=1,n._33-=1,n=n.negate(),s.setValues(n),o.setValues(n),i=1;o.normInfinity()>r&&e>i;)o=o.mult(n),i++,s=s.addScaled(o,1/i);return s=s.multiply(-1*(1<<t))},x3dom.fields.SFMatrix4f.prototype.exp=function(){var e=6,t=x3dom.fields.SFMatrix4f.identity(),i=x3dom.fields.SFMatrix4f.identity(),r=x3dom.fields.SFMatrix4f.identity(),n=x3dom.fields.SFMatrix4f.identity(),o=1,s=0,a=1;for(t.setValues(this),o+=Math.floor(Math.log(t.normInfinity()/.693)),0>o&&(o=0),t=t.multiply(1/(1<<o)),s=1;e>=s;s++)a*=(e-s+1)/(s*(2*e-s+1)),n=t.mult(n),r=r.addScaled(n,a),i=s%2?i.addScaled(n,-a):i.addScaled(n,a);for(n=i.inverse().mult(r),s=0;o>s;s++)n=n.mult(n);return n},x3dom.fields.SFMatrix4f.prototype.det3=function(e,t,i,r,n,o,s,a,l){var d=e*n*l+t*o*s+i*r*a-e*o*a-t*r*l-i*n*s;return d},x3dom.fields.SFMatrix4f.prototype.det=function(){var e,t,i,r,n,o,s,a,l,d,h,u,c,f,m,p;e=this._00,n=this._10,l=this._20,c=this._30,t=this._01,o=this._11,d=this._21,f=this._31,i=this._02,s=this._12,h=this._22,m=this._32,r=this._03,a=this._13,u=this._23,p=this._33;var _=+e*this.det3(o,s,a,d,h,u,f,m,p)-n*this.det3(t,i,r,d,h,u,f,m,p)+l*this.det3(t,i,r,o,s,a,f,m,p)-c*this.det3(t,i,r,o,s,a,d,h,u);return _},x3dom.fields.SFMatrix4f.prototype.inverse=function(){var e,t,i,r,n,o,s,a,l,d,h,u,c,f,m,p;e=this._00,n=this._10,l=this._20,c=this._30,t=this._01,o=this._11,d=this._21,f=this._31,i=this._02,s=this._12,h=this._22,m=this._32,r=this._03,a=this._13,u=this._23,p=this._33;var _=this.det();return 0===Math.abs(_)?(x3dom.debug.logWarning("Invert matrix: singular matrix, no inverse!"),x3dom.fields.SFMatrix4f.identity()):(_=1/_,new x3dom.fields.SFMatrix4f(+this.det3(o,s,a,d,h,u,f,m,p)*_,-this.det3(t,i,r,d,h,u,f,m,p)*_,+this.det3(t,i,r,o,s,a,f,m,p)*_,-this.det3(t,i,r,o,s,a,d,h,u)*_,-this.det3(n,s,a,l,h,u,c,m,p)*_,+this.det3(e,i,r,l,h,u,c,m,p)*_,-this.det3(e,i,r,n,s,a,c,m,p)*_,+this.det3(e,i,r,n,s,a,l,h,u)*_,+this.det3(n,o,a,l,d,u,c,f,p)*_,-this.det3(e,t,r,l,d,u,c,f,p)*_,+this.det3(e,t,r,n,o,a,c,f,p)*_,-this.det3(e,t,r,n,o,a,l,d,u)*_,-this.det3(n,o,s,l,d,h,c,f,m)*_,+this.det3(e,t,i,l,d,h,c,f,m)*_,-this.det3(e,t,i,n,o,s,c,f,m)*_,+this.det3(e,t,i,n,o,s,l,d,h)*_))},x3dom.fields.SFMatrix4f.prototype.toString=function(){return"[SFMatrix4f "+this._00+", "+this._01+", "+this._02+", "+this._03+"; "+this._10+", "+this._11+", "+this._12+", "+this._13+"; "+this._20+", "+this._21+", "+this._22+", "+this._23+"; "+this._30+", "+this._31+", "+this._32+", "+this._33+"]"},x3dom.fields.SFMatrix4f.prototype.setValueByStr=function(e){var t=!1,i=/matrix.*\((.+)\)/;i.exec(e)&&(e=RegExp.$1,t=!0);var r=Array.map(e.split(/[,\s]+/),function(e){return+e});return r.length>=16?t?(this._00=r[0],this._01=r[4],this._02=r[8],this._03=r[12],this._10=r[1],this._11=r[5],this._12=r[9],this._13=r[13],this._20=r[2],this._21=r[6],this._22=r[10],this._23=r[14],this._30=r[3],this._31=r[7],this._32=r[11],this._33=r[15]):(this._00=r[0],this._01=r[1],this._02=r[2],this._03=r[3],this._10=r[4],this._11=r[5],this._12=r[6],this._13=r[7],this._20=r[8],this._21=r[9],this._22=r[10],this._23=r[11],this._30=r[12],this._31=r[13],this._32=r[14],this._33=r[15]):6===r.length?(this._00=r[0],this._01=r[1],this._02=0,this._03=r[4],this._10=r[2],this._11=r[3],this._12=0,this._13=r[5],this._20=0,this._21=0,this._22=1,this._23=0,this._30=0,this._31=0,this._32=0,this._33=1):x3dom.debug.logWarning("SFMatrix4f - can't parse string: "+e),this},x3dom.fields.SFVec2f=function(e,t){0===arguments.length?this.x=this.y=0:(this.x=e,this.y=t)},x3dom.fields.SFVec2f.parse=function(e){var t=/^([+\-]?\d*\.*\d*[eE]?[+\-]?\d*?)\s*,?\s*([+\-]?\d*\.*\d*[eE]?[+\-]?\d*?)$/.exec(e);return new x3dom.fields.SFVec2f(+t[1],+t[2])},x3dom.fields.SFVec2f.prototype.setValues=function(e){this.x=e.x,this.y=e.y},x3dom.fields.SFVec2f.prototype.add=function(e){return new x3dom.fields.SFVec2f(this.x+e.x,this.y+e.y)},x3dom.fields.SFVec2f.prototype.subtract=function(e){return new x3dom.fields.SFVec2f(this.x-e.x,this.y-e.y)},x3dom.fields.SFVec2f.prototype.negate=function(){return new x3dom.fields.SFVec2f(-this.x,-this.y)},x3dom.fields.SFVec2f.prototype.dot=function(e){return this.x*e.x+this.y*e.y},x3dom.fields.SFVec2f.prototype.reflect=function(e){var t=2*this.dot(e);return new x3dom.fields.SFVec2f(this.x-t*e.x,this.y-t*e.y)},x3dom.fields.SFVec2f.prototype.normalize=function(){var e=this.length();return e&&(e=1/e),new x3dom.fields.SFVec2f(this.x*e,this.y*e)},x3dom.fields.SFVec2f.prototype.multComponents=function(e){return new x3dom.fields.SFVec2f(this.x*e.x,this.y*e.y)},x3dom.fields.SFVec2f.prototype.multiply=function(e){return new x3dom.fields.SFVec2f(this.x*e,this.y*e)},x3dom.fields.SFVec2f.prototype.divide=function(e){var t=e?1/e:1;return new x3dom.fields.SFVec2f(this.x*t,this.y*t)},x3dom.fields.SFVec2f.prototype.equals=function(e,t){return Math.abs(this.x-e.x)<t&&Math.abs(this.y-e.y)<t},x3dom.fields.SFVec2f.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},x3dom.fields.SFVec2f.prototype.toGL=function(){return[this.x,this.y]},x3dom.fields.SFVec2f.prototype.toString=function(){return"{ x "+this.x+" y "+this.y+" }"},x3dom.fields.SFVec2f.prototype.setValueByStr=function(e){var t=/^([+\-]?\d*\.*\d*[eE]?[+\-]?\d*?)\s*,?\s*([+\-]?\d*\.*\d*[eE]?[+\-]?\d*?)$/.exec(e);return this.x=+t[1],this.y=+t[2],this},x3dom.fields.SFVec3f=function(e,t,i){0===arguments.length?this.x=this.y=this.z=0:(this.x=e,this.y=t,this.z=i)},x3dom.fields.SFVec3f.copy=function(e){return new x3dom.fields.SFVec3f(e.x,e.y,e.z)},x3dom.fields.SFVec3f.MIN=function(){return new x3dom.fields.SFVec3f(Number.MIN_VALUE,Number.MIN_VALUE,Number.MIN_VALUE)},x3dom.fields.SFVec3f.MAX=function(){return new x3dom.fields.SFVec3f(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE)},x3dom.fields.SFVec3f.parse=function(e){try{var t=/^([+\-]?\d*\.*\d*[eE]?[+\-]?\d*?)\s*,?\s*([+\-]?\d*\.*\d*[eE]?[+\-]?\d*?)\s*,?\s*([+\-]?\d*\.*\d*[eE]?[+\-]?\d*?)$/.exec(e);return new x3dom.fields.SFVec3f(+t[1],+t[2],+t[3])}catch(i){var r=x3dom.fields.SFColor.colorParse(e);return new x3dom.fields.SFVec3f(r.r,r.g,r.b)}},x3dom.fields.SFVec3f.prototype.setValues=function(e){this.x=e.x,this.y=e.y,this.z=e.z},x3dom.fields.SFVec3f.prototype.add=function(e){return new x3dom.fields.SFVec3f(this.x+e.x,this.y+e.y,this.z+e.z)},x3dom.fields.SFVec3f.prototype.addScaled=function(e,t){return new x3dom.fields.SFVec3f(this.x+t*e.x,this.y+t*e.y,this.z+t*e.z)},x3dom.fields.SFVec3f.prototype.subtract=function(e){return new x3dom.fields.SFVec3f(this.x-e.x,this.y-e.y,this.z-e.z)},x3dom.fields.SFVec3f.prototype.negate=function(){return new x3dom.fields.SFVec3f(-this.x,-this.y,-this.z)},x3dom.fields.SFVec3f.prototype.dot=function(e){return this.x*e.x+this.y*e.y+this.z*e.z},x3dom.fields.SFVec3f.prototype.cross=function(e){return new x3dom.fields.SFVec3f(this.y*e.z-this.z*e.y,this.z*e.x-this.x*e.z,this.x*e.y-this.y*e.x)},x3dom.fields.SFVec3f.prototype.reflect=function(e){var t=2*this.dot(e);return new x3dom.fields.SFVec3f(this.x-t*e.x,this.y-t*e.y,this.z-t*e.z)},x3dom.fields.SFVec3f.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},x3dom.fields.SFVec3f.prototype.normalize=function(){var e=this.length();return e&&(e=1/e),new x3dom.fields.SFVec3f(this.x*e,this.y*e,this.z*e)},x3dom.fields.SFVec3f.prototype.multComponents=function(e){return new x3dom.fields.SFVec3f(this.x*e.x,this.y*e.y,this.z*e.z)},x3dom.fields.SFVec3f.prototype.multiply=function(e){return new x3dom.fields.SFVec3f(this.x*e,this.y*e,this.z*e)},x3dom.fields.SFVec3f.prototype.divide=function(e){var t=e?1/e:1;return new x3dom.fields.SFVec3f(this.x*t,this.y*t,this.z*t)},x3dom.fields.SFVec3f.prototype.equals=function(e,t){return Math.abs(this.x-e.x)<t&&Math.abs(this.y-e.y)<t&&Math.abs(this.z-e.z)<t},x3dom.fields.SFVec3f.prototype.toGL=function(){return[this.x,this.y,this.z]},x3dom.fields.SFVec3f.prototype.toString=function(){return"{ x "+this.x+" y "+this.y+" z "+this.z+" }"},x3dom.fields.SFVec3f.prototype.setValueByStr=function(e){try{var t=/^([+\-]?\d*\.*\d*[eE]?[+\-]?\d*?)\s*,?\s*([+\-]?\d*\.*\d*[eE]?[+\-]?\d*?)\s*,?\s*([+\-]?\d*\.*\d*[eE]?[+\-]?\d*?)$/.exec(e);this.x=+t[1],this.y=+t[2],this.z=+t[3]}catch(i){var r=x3dom.fields.SFColor.colorParse(e);this.x=r.r,this.y=r.g,this.z=r.b}return this},x3dom.fields.Quaternion=function(e,t,i,r){this.x=e,this.y=t,this.z=i,this.w=r},x3dom.fields.Quaternion.prototype.multiply=function(e){return new x3dom.fields.Quaternion(this.w*e.x+this.x*e.w+this.y*e.z-this.z*e.y,this.w*e.y+this.y*e.w+this.z*e.x-this.x*e.z,this.w*e.z+this.z*e.w+this.x*e.y-this.y*e.x,this.w*e.w-this.x*e.x-this.y*e.y-this.z*e.z)},x3dom.fields.Quaternion.parseAxisAngle=function(e){var t=/^([+\-]?\d*\.*\d*[eE]?[+\-]?\d*?)\s*,?\s*([+\-]?\d*\.*\d*[eE]?[+\-]?\d*?)\s*,?\s*([+\-]?\d*\.*\d*[eE]?[+\-]?\d*?)\s*,?\s*([+\-]?\d*\.*\d*[eE]?[+\-]?\d*?)$/.exec(e);return x3dom.fields.Quaternion.axisAngle(new x3dom.fields.SFVec3f(+t[1],+t[2],+t[3]),+t[4])},x3dom.fields.Quaternion.axisAngle=function(e,t){var i=e.length();if(i>x3dom.fields.Eps){var r=Math.sin(t/2)/i,n=Math.cos(t/2);return new x3dom.fields.Quaternion(e.x*r,e.y*r,e.z*r,n)}return new x3dom.fields.Quaternion(0,0,0,1)},x3dom.fields.Quaternion.prototype.toMatrix=function(){var e=this.x*this.x,t=this.x*this.y,i=this.x*this.z,r=this.y*this.y,n=this.y*this.z,o=this.z*this.z,s=this.w*this.x,a=this.w*this.y,l=this.w*this.z;return new x3dom.fields.SFMatrix4f(1-2*(r+o),2*(t-l),2*(i+a),0,2*(t+l),1-2*(e+o),2*(n-s),0,2*(i-a),2*(n+s),1-2*(e+r),0,0,0,0,1)},x3dom.fields.Quaternion.prototype.toAxisAngle=function(){var e=0,t=0,i=0,r=0,n=0,o=this;return this.w>1&&(o=x3dom.fields.Quaternion.normalize(this)),n=2*Math.acos(o.w),r=Math.sqrt(1-o.w*o.w),r<x3dom.fields.Eps?(e=o.x,t=o.y,i=o.z):(e=o.x/r,t=o.y/r,i=o.z/r),[new x3dom.fields.SFVec3f(e,t,i),n]},x3dom.fields.Quaternion.prototype.angle=function(){return 2*Math.acos(this.w)},x3dom.fields.Quaternion.prototype.dot=function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w},x3dom.fields.Quaternion.prototype.add=function(e){return new x3dom.fields.Quaternion(this.x+e.x,this.y+e.y,this.z+e.z,this.w+e.w)},x3dom.fields.Quaternion.prototype.subtract=function(e){return new x3dom.fields.Quaternion(this.x-e.x,this.y-e.y,this.z-e.z,this.w-e.w)},x3dom.fields.Quaternion.prototype.setValues=function(e){this.x=e.x,this.y=e.y,this.z=e.z,this.w=e.w},x3dom.fields.Quaternion.prototype.equals=function(e,t){return Math.abs(this.x-e.x)<t&&Math.abs(this.y-e.y)<t&&Math.abs(this.z-e.z)<t&&Math.abs(this.w-e.w)<t},x3dom.fields.Quaternion.prototype.multScalar=function(e){return new x3dom.fields.Quaternion(this.x*e,this.y*e,this.z*e,this.w*e)},x3dom.fields.Quaternion.prototype.normalize=function(e){var t=this.dot(e),i=1;return t&&(i=1/Math.sqrt(t)),new x3dom.fields.Quaternion(this.x*i,this.y*i,this.z*i,this.w*i)},x3dom.fields.Quaternion.prototype.negate=function(){return new x3dom.fields.Quaternion(-this.x,-this.y,-this.z,-this.w)},x3dom.fields.Quaternion.prototype.inverse=function(){return new x3dom.fields.Quaternion(-this.x,-this.y,-this.z,this.w)},x3dom.fields.Quaternion.prototype.slerp=function(e,t){var i,r=this.dot(e);0>r?(r=-r,i=e.negate()):i=new x3dom.fields.Quaternion(e.x,e.y,e.z,e.w);var n,o;if(1-r>1e-5){var s=Math.acos(r),a=Math.sin(s);n=Math.sin((1-t)*s)/a,o=Math.sin(t*s)/a}else n=1-t,o=t;return this.multScalar(n).add(i.multScalar(o))},x3dom.fields.Quaternion.rotateFromTo=function(e,t){var i=e.normalize(),r=t.normalize(),n=i.dot(r);
if(n>.99999)return new x3dom.fields.Quaternion(0,0,0,1);if(-.99999>n){var o=new x3dom.fields.SFVec3f(1,0,0),s=i.cross(o);return s.length()<1e-5&&(o.x=0,o.y=1,o.z=0,s=i.cross(o)),s=s.normalize(),x3dom.fields.Quaternion.axisAngle(s,Math.PI)}var a=e.cross(t);a=a.normalize();var l=Math.sqrt(.5*(1-n));return a=a.multiply(l),l=Math.sqrt(.5*(1+n)),new x3dom.fields.Quaternion(a.x,a.y,a.z,l)},x3dom.fields.Quaternion.prototype.toString=function(){return"(("+this.x+", "+this.y+", "+this.z+"), "+this.w+")"},x3dom.fields.Quaternion.prototype.setValueByStr=function(e){var t=/^([+\-]?\d*\.*\d*[eE]?[+\-]?\d*?)\s*,?\s*([+\-]?\d*\.*\d*[eE]?[+\-]?\d*?)\s*,?\s*([+\-]?\d*\.*\d*[eE]?[+\-]?\d*?)\s*,?\s*([+\-]?\d*\.*\d*[eE]?[+\-]?\d*?)$/.exec(e),i=x3dom.fields.Quaternion.axisAngle(new x3dom.fields.SFVec3f(+t[1],+t[2],+t[3]),+t[4]);return this.x=i.x,this.y=i.y,this.z=i.z,this.w=i.w,this},x3dom.fields.SFColor=function(e,t,i){0===arguments.length?this.r=this.g=this.b=0:(this.r=e,this.g=t,this.b=i)},x3dom.fields.SFColor.parse=function(e){try{var t=/^([+\-]?\d*\.*\d*[eE]?[+\-]?\d*?)\s*,?\s*([+\-]?\d*\.*\d*[eE]?[+\-]?\d*?)\s*,?\s*([+\-]?\d*\.*\d*[eE]?[+\-]?\d*?)$/.exec(e);return new x3dom.fields.SFColor(+t[1],+t[2],+t[3])}catch(i){return x3dom.fields.SFColor.colorParse(e)}},x3dom.fields.SFColor.prototype.setHSV=function(){x3dom.debug.logWarning("SFColor.setHSV() NYI")},x3dom.fields.SFColor.prototype.getHSV=function(){var e=0,t=0,i=0;return x3dom.debug.logWarning("SFColor.getHSV() NYI"),[e,t,i]},x3dom.fields.SFColor.prototype.setValues=function(e){this.r=e.r,this.g=e.g,this.b=e.b},x3dom.fields.SFColor.prototype.equals=function(e,t){return Math.abs(this.r-e.r)<t&&Math.abs(this.g-e.g)<t&&Math.abs(this.b-e.b)<t},x3dom.fields.SFColor.prototype.add=function(e){return new x3dom.fields.SFColor(this.r+e.r,this.g+e.g,this.b+e.b)},x3dom.fields.SFColor.prototype.subtract=function(e){return new x3dom.fields.SFColor(this.r-e.r,this.g-e.g,this.b-e.b)},x3dom.fields.SFColor.prototype.multiply=function(e){return new x3dom.fields.SFColor(this.r*e,this.g*e,this.b*e)},x3dom.fields.SFColor.prototype.toGL=function(){return[this.r,this.g,this.b]},x3dom.fields.SFColor.prototype.toString=function(){return"{ r "+this.r+" g "+this.g+" b "+this.b+" }"},x3dom.fields.SFColor.prototype.setValueByStr=function(e){try{var t=/^([+\-]?\d*\.*\d*[eE]?[+\-]?\d*?)\s*,?\s*([+\-]?\d*\.*\d*[eE]?[+\-]?\d*?)\s*,?\s*([+\-]?\d*\.*\d*[eE]?[+\-]?\d*?)$/.exec(e);this.r=+t[1],this.g=+t[2],this.b=+t[3]}catch(i){var r=x3dom.fields.SFColor.colorParse(e);this.r=r.r,this.g=r.g,this.b=r.b}return this},x3dom.fields.SFColor.colorParse=function(e){var t=0,i=0,r=0,n={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"};if(n[e]&&(e="#"+n[e]),e.substr&&"#"===e.substr(0,1)){e=e.substr(1);var o=e.length;6===o?(t=parseInt("0x"+e.substr(0,2),16)/255,i=parseInt("0x"+e.substr(2,2),16)/255,r=parseInt("0x"+e.substr(4,2),16)/255):3===o&&(t=parseInt("0x"+e.substr(0,1),16)/15,i=parseInt("0x"+e.substr(1,1),16)/15,r=parseInt("0x"+e.substr(2,1),16)/15)}return new x3dom.fields.SFColor(t,i,r)},x3dom.fields.SFImage=function(e,t,i,r){0===arguments.length?(this.width=this.height=this.comp=0,this.array=[]):(this.width=e,this.height=t,this.comp=i,r.map(function(e){this.array.push(e)},this.array))},x3dom.fields.SFImage.parse=function(e){var t=new x3dom.fields.SFImage;return t.setValueByStr(e),t},x3dom.fields.SFImage.prototype.setValueByStr=function(e){var t=e.match(/(\w+)/g),i=t.length,r=0,n="0123456789ABCDEF";if(this.array=[],!(i>2))return this.width=0,this.height=0,void(this.comp=0);this.width=+t[0],this.height=+t[1],this.comp=+t[2],r=2*this.comp;for(var o,s=3;i>s;s++)if(t[s].substr){if("x"!==t[s].substr(1,1).toLowerCase()){for(var a="",l=parseInt(t[s],10);0!==l;)a=n.charAt(l%16)+a,l>>=4;for(o=a.length;a.length<r;)a="0"+a;t[s]="0x"+a}if("x"===t[s].substr(1,1).toLowerCase()){t[s]=t[s].substr(2),o=t[s].length;var d,h,u,c;o===r&&(1===this.comp?(d=parseInt("0x"+t[s].substr(0,2),16),this.array.push(d)):2===this.comp?(d=parseInt("0x"+t[s].substr(0,2),16),h=parseInt("0x"+t[s].substr(2,2),16),this.array.push(d,h)):3===this.comp?(d=parseInt("0x"+t[s].substr(0,2),16),h=parseInt("0x"+t[s].substr(2,2),16),u=parseInt("0x"+t[s].substr(4,2),16),this.array.push(d,h,u)):4===this.comp&&(d=parseInt("0x"+t[s].substr(0,2),16),h=parseInt("0x"+t[s].substr(2,2),16),u=parseInt("0x"+t[s].substr(4,2),16),c=parseInt("0x"+t[s].substr(6,2),16),this.array.push(d,h,u,c)))}}},x3dom.fields.SFImage.prototype.toGL=function(){var e=[];return Array.map(this.array,function(t){e.push(t)}),e},x3dom.fields.MFColor=function(e){if(0===arguments.length);else{var t=this;e.map(function(e){t.push(e)},this)}},x3dom.fields.MFColor.prototype=x3dom.extend([]),x3dom.fields.MFColor.parse=function(e){for(var t=e.match(/([+\-0-9eE\.]+)/g),i=[],r=0,n=t.length;n>r;r+=3)i.push(new x3dom.fields.SFColor(+t[r+0],+t[r+1],+t[r+2]));return new x3dom.fields.MFColor(i)},x3dom.fields.MFColor.prototype.setValueByStr=function(e){for(;this.length;)this.pop();for(var t=e.match(/([+\-0-9eE\.]+)/g),i=0,r=t.length;r>i;i+=3)this.push(new x3dom.fields.SFColor(+t[i+0],+t[i+1],+t[i+2]))},x3dom.fields.MFColor.prototype.toGL=function(){var e=[];return Array.map(this,function(t){e.push(t.r),e.push(t.g),e.push(t.b)}),e},x3dom.fields.SFColorRGBA=function(e,t,i,r){0===arguments.length?this.r=this.g=this.b=this.a=0:(this.r=e,this.g=t,this.b=i,this.a=r)},x3dom.fields.SFColorRGBA.parse=function(e){try{var t=/^([+\-]?\d*\.*\d*[eE]?[+\-]?\d*?)\s*,?\s*([+\-]?\d*\.*\d*[eE]?[+\-]?\d*?)\s*,?\s*([+\-]?\d*\.*\d*[eE]?[+\-]?\d*?)\s*,?\s*([+\-]?\d*\.*\d*[eE]?[+\-]?\d*?)$/.exec(e);return new x3dom.fields.SFColorRGBA(+t[1],+t[2],+t[3],+t[4])}catch(i){return x3dom.fields.SFColorRGBA.colorParse(e)}},x3dom.fields.SFColorRGBA.prototype.setValues=function(e){this.r=e.r,this.g=e.g,this.b=e.b,this.a=e.a},x3dom.fields.SFColorRGBA.prototype.equals=function(e,t){return Math.abs(this.r-e.r)<t&&Math.abs(this.g-e.g)<t&&Math.abs(this.b-e.b)<t&&Math.abs(this.a-e.a)<t},x3dom.fields.SFColorRGBA.prototype.toGL=function(){return[this.r,this.g,this.b,this.a]},x3dom.fields.SFColorRGBA.prototype.toString=function(){return"{ r "+this.r+" g "+this.g+" b "+this.b+" a "+this.a+" }"},x3dom.fields.SFColorRGBA.prototype.setValueByStr=function(e){try{var t=/^([+\-]?\d*\.*\d*[eE]?[+\-]?\d*?)\s*,?\s*([+\-]?\d*\.*\d*[eE]?[+\-]?\d*?)\s*,?\s*([+\-]?\d*\.*\d*[eE]?[+\-]?\d*?)\s*,?\s*([+\-]?\d*\.*\d*[eE]?[+\-]?\d*?)$/.exec(e);this.r=+t[1],this.g=+t[2],this.b=+t[3],this.a=+t[4]}catch(i){var r=x3dom.fields.SFColorRGBA.colorParse(e);this.r=r.r,this.g=r.g,this.b=r.b,this.a=r.a}return this},x3dom.fields.MFColorRGBA=function(e){if(0===arguments.length);else{var t=this;e.map(function(e){t.push(e)},this)}},x3dom.fields.MFColorRGBA.prototype=x3dom.extend([]),x3dom.fields.MFColorRGBA.parse=function(e){for(var t=e.match(/([+\-0-9eE\.]+)/g),i=[],r=0,n=t.length;n>r;r+=4)i.push(new x3dom.fields.SFColorRGBA(+t[r+0],+t[r+1],+t[r+2],+t[r+3]));return new x3dom.fields.MFColorRGBA(i)},x3dom.fields.MFColorRGBA.prototype.setValueByStr=function(e){for(;this.length;)this.pop();for(var t=e.match(/([+\-0-9eE\.]+)/g),i=0,r=t.length;r>i;i+=4)this.push(new x3dom.fields.SFColor(+t[i+0],+t[i+1],+t[i+2],+t[i+3]))},x3dom.fields.MFColorRGBA.prototype.toGL=function(){var e=[];return Array.map(this,function(t){e.push(t.r),e.push(t.g),e.push(t.b),e.push(t.a)}),e},x3dom.fields.MFRotation=function(e){if(0===arguments.length);else{var t=this;e.map(function(e){t.push(e)},this)}},x3dom.fields.MFRotation.prototype=x3dom.extend([]),x3dom.fields.MFRotation.parse=function(e){for(var t=e.match(/([+\-0-9eE\.]+)/g),i=[],r=0,n=t.length;n>r;r+=4)i.push(x3dom.fields.Quaternion.axisAngle(new x3dom.fields.SFVec3f(+t[r+0],+t[r+1],+t[r+2]),+t[r+3]));return new x3dom.fields.MFRotation(i)},x3dom.fields.MFRotation.prototype.setValueByStr=function(e){for(;this.length;)this.pop();for(var t=e.match(/([+\-0-9eE\.]+)/g),i=0,r=t.length;r>i;i+=4)this.push(x3dom.fields.Quaternion.axisAngle(new x3dom.fields.SFVec3f(+t[i+0],+t[i+1],+t[i+2]),+t[i+3]))},x3dom.fields.MFRotation.prototype.toGL=function(){var e=[];return e},x3dom.fields.MFVec3f=function(e){if(0===arguments.length);else{var t=this;e.map(function(e){t.push(e)},this)}},x3dom.fields.MFVec3f.copy=function(e){var t=new x3dom.fields.MFVec3f;return e.map(function(e){t.push(x3dom.fields.SFVec3f.copy(e))},this),t},x3dom.fields.MFVec3f.prototype=x3dom.extend([]),x3dom.fields.MFVec3f.parse=function(e){for(var t=e.match(/([+\-0-9eE\.]+)/g),i=[],r=0,n=t.length;n>r;r+=3)i.push(new x3dom.fields.SFVec3f(+t[r+0],+t[r+1],+t[r+2]));return new x3dom.fields.MFVec3f(i)},x3dom.fields.MFVec3f.prototype.setValueByStr=function(e){for(;this.length;)this.pop();for(var t=e.match(/([+\-0-9eE\.]+)/g),i=0,r=t.length;r>i;i+=3)this.push(new x3dom.fields.SFVec3f(+t[i+0],+t[i+1],+t[i+2]))},x3dom.fields.MFVec3f.prototype.toGL=function(){var e=[];return Array.map(this,function(t){e.push(t.x),e.push(t.y),e.push(t.z)}),e},x3dom.fields.MFVec2f=function(e){if(0===arguments.length);else{var t=this;e.map(function(e){t.push(e)},this)}},x3dom.fields.MFVec2f.prototype=x3dom.extend([]),x3dom.fields.MFVec2f.parse=function(e){for(var t=e.match(/([+\-0-9eE\.]+)/g),i=[],r=0,n=t.length;n>r;r+=2)i.push(new x3dom.fields.SFVec2f(+t[r+0],+t[r+1]));return new x3dom.fields.MFVec2f(i)},x3dom.fields.MFVec2f.prototype.setValueByStr=function(e){for(;this.length;)this.pop();for(var t=e.match(/([+\-0-9eE\.]+)/g),i=0,r=t.length;r>i;i+=2)this.push(new x3dom.fields.SFVec2f(+t[i+0],+t[i+1]))},x3dom.fields.MFVec2f.prototype.toGL=function(){var e=[];return Array.map(this,function(t){e.push(t.x),e.push(t.y)}),e},x3dom.fields.MFInt32=function(e){if(0===arguments.length);else{var t=this;e.map(function(e){t.push(e)},this)}},x3dom.fields.MFInt32.prototype=x3dom.extend([]),x3dom.fields.MFInt32.parse=function(e){for(var t=e.match(/([+\-]?\d+\s*){1},?\s*/g),i=[],r=0,n=t.length;n>r;++r)i.push(parseInt(t[r],10));return new x3dom.fields.MFInt32(i)},x3dom.fields.MFInt32.prototype.setValueByStr=function(e){for(;this.length;)this.pop();for(var t=e.match(/([+\-]?\d+\s*){1},?\s*/g),i=0,r=t.length;r>i;++i)this.push(parseInt(t[i],10))},x3dom.fields.MFInt32.prototype.toGL=function(){var e=[];return Array.map(this,function(t){e.push(t)}),e},x3dom.fields.MFFloat=function(e){if(0===arguments.length);else{var t=this;e.map(function(e){t.push(e)},this)}},x3dom.fields.MFFloat.prototype=x3dom.extend([]),x3dom.fields.MFFloat.parse=function(e){for(var t=e.match(/([+\-0-9eE\.]+)/g),i=[],r=0,n=t.length;n>r;r++)i.push(+t[r]);return new x3dom.fields.MFFloat(i)},x3dom.fields.MFFloat.prototype.setValueByStr=function(e){for(;this.length;)this.pop();for(var t=e.match(/([+\-0-9eE\.]+)/g),i=0,r=t.length;r>i;i++)this.push(+t[i])},x3dom.fields.MFFloat.prototype.toGL=function(){var e=[];return Array.map(this,function(t){e.push(t)}),e},x3dom.fields.MFString=function(e){if(0===arguments.length);else{var t=this;e.map(function(e){t.push(e)},this)}},x3dom.fields.MFString.parse=function(e){var t=[];if(e.length&&'"'==e[0])for(var i,r=/"((?:[^\\"]|\\\\|\\")*)"/g;i=r.exec(e);){var n=i[1].replace(/\\([\\"])/,"$1");void 0!==n&&t.push(n)}else t.push(e);return new x3dom.fields.MFString(t)},x3dom.fields.MFString.prototype=x3dom.extend([]),x3dom.fields.MFString.prototype.setValueByStr=function(e){for(var t=this;t.length;)t.pop();if(e.length&&'"'==e[0])for(var i,r=/"((?:[^\\"]|\\\\|\\")*)"/g;i=r.exec(e);){var n=i[1].replace(/\\([\\"])/,"$1");void 0!==n&&t.push(n)}else t.push(e);return this},x3dom.fields.MFString.prototype.toString=function(){for(var e="",t=0;t<this.length;t++)e=e+this[t]+" ";return e},x3dom.fields.SFNode=function(e){this.type=e,this.node=null},x3dom.fields.SFNode.prototype.hasLink=function(e){return e?this.node===e:this.node},x3dom.fields.SFNode.prototype.addLink=function(e){return this.node=e,!0},x3dom.fields.SFNode.prototype.rmLink=function(e){return this.node===e?(this.node=null,!0):!1},x3dom.fields.MFNode=function(e){this.type=e,this.nodes=[]},x3dom.fields.MFNode.prototype.hasLink=function(e){if(!e)return this.length>0;for(var t=0,i=this.nodes.length;i>t;t++)if(this.nodes[t]===e)return!0;return!1},x3dom.fields.MFNode.prototype.addLink=function(e){return this.nodes.push(e),!0},x3dom.fields.MFNode.prototype.rmLink=function(e){for(var t=0,i=this.nodes.length;i>t;t++)if(this.nodes[t]===e)return this.nodes.splice(t,1),!0;return!1},x3dom.fields.MFNode.prototype.length=function(){return this.nodes.length},x3dom.fields.Line=function(e,t){if(0===arguments.length)this.pos=new x3dom.fields.SFVec3f(0,0,0),this.dir=new x3dom.fields.SFVec3f(0,0,1);else{this.pos=new x3dom.fields.SFVec3f(e.x,e.y,e.z);var i=t.length();i&&(i=1/i),this.dir=new x3dom.fields.SFVec3f(t.x*i,t.y*i,t.z*i)}this.enter=0,this.exit=0,this.hitObject=null,this.hitPoint={},this.dist=Number.MAX_VALUE},x3dom.fields.Line.prototype.toString=function(){var e="Line: ["+this.pos.toString()+"; "+this.dir.toString()+"]";return e},x3dom.fields.Line.prototype.intersect=function(e,t){var i,r,n,o=0,s=Number.MAX_VALUE;if(this.dir.x>x3dom.fields.Eps)i=1/this.dir.x,r=(e.x-this.pos.x)*i,n=(t.x-this.pos.x)*i,s>n&&(s=n),r>o&&(o=r);else if(this.dir.x<-x3dom.fields.Eps)i=1/this.dir.x,r=(t.x-this.pos.x)*i,n=(e.x-this.pos.x)*i,s>n&&(s=n),r>o&&(o=r);else if(this.pos.x<e.x||this.pos.x>t.x)return!1;if(this.dir.y>x3dom.fields.Eps){if(i=1/this.dir.y,r=(e.y-this.pos.y)*i,n=(t.y-this.pos.y)*i,s>n&&(s=n),r>o&&(o=r),o-s>=x3dom.fields.Eps)return!1}else if(this.dir.y<-x3dom.fields.Eps){if(i=1/this.dir.y,r=(t.y-this.pos.y)*i,n=(e.y-this.pos.y)*i,s>n&&(s=n),r>o&&(o=r),o-s>=x3dom.fields.Eps)return!1}else if(this.pos.y<e.y||this.pos.y>t.y)return!1;if(this.dir.z>x3dom.fields.Eps)i=1/this.dir.z,r=(e.z-this.pos.z)*i,n=(t.z-this.pos.z)*i,s>n&&(s=n),r>o&&(o=r);else if(this.dir.z<-x3dom.fields.Eps)i=1/this.dir.z,r=(t.z-this.pos.z)*i,n=(e.z-this.pos.z)*i,s>n&&(s=n),r>o&&(o=r);else if(this.pos.z<e.z||this.pos.z>t.z)return!1;return this.enter=o,this.exit=s,o-s<x3dom.fields.Eps},x3dom.NodeNameSpace=function(e,t){this.name=e,this.doc=t,this.baseURL="",this.defMap={},this.parent=null,this.childSpaces=[]},x3dom.NodeNameSpace.prototype.addNode=function(e,t){this.defMap[t]=e,e._nameSpace=this},x3dom.NodeNameSpace.prototype.removeNode=function(){var e=this.defMap.name;delete this.defMap.name,e&&(e._nameSpace=null)},x3dom.NodeNameSpace.prototype.getNamedNode=function(e){return this.defMap[e]},x3dom.NodeNameSpace.prototype.getNamedElement=function(e){var t=this.defMap[e];return t?t._xmlNode:null},x3dom.NodeNameSpace.prototype.addSpace=function(e){this.childSpaces.push(e),e.parent=this},x3dom.NodeNameSpace.prototype.removeSpace=function(e){this.childSpaces.push(e),e.parent=null},x3dom.NodeNameSpace.prototype.setBaseURL=function(e){var t=e.lastIndexOf("/");this.baseURL=t>=0?e.substr(0,t+1):"",x3dom.debug.logInfo("setBaseURL: "+this.baseURL)},x3dom.NodeNameSpace.prototype.getURL=function(e){return void 0!==e&&e.length?"/"===e[0]||e.indexOf(":")>=0?e:this.baseURL+e:""},x3dom.setElementAttribute=function(e,t){this.getAttribute(e);this.__setAttribute(e,t),this._x3domNode.updateField(e,t),this._x3domNode._nameSpace.doc.needRender=!0},x3dom.NodeNameSpace.prototype.setupTree=function(e){var t;if(x3dom.isX3DElement(e)){if(e._x3domNode)return void x3dom.debug.logWarning("Tree is already initialized");if(x3dom.userAgentFeature.supportsDOMAttrModified!==!1||void 0===e.tagName||e.__setAttribute||(e.__setAttribute=e.setAttribute,e.setAttribute=x3dom.setElementAttribute),void 0===e.tagName||e.__addEventListener||e.__removeEventListener||(e.__addEventListener=e.addEventListener,e.addEventListener=function(e,t,i){this._x3domNode._listeners[e]||(this._x3domNode._listeners[e]=[]),this._x3domNode._listeners[e].push(t),x3dom.debug.logInfo("addEventListener for "+this.tagName+".on"+e),this.__addEventListener(e,t,i)},e.__removeEventListener=e.removeEventListener,e.removeEventListener=function(e,t,i){var r=this._x3domNode._listeners[e];if(r)for(var n=0;n<r.length;n++)r[n]==t&&(r.splice(n,1),x3dom.debug.logInfo("removeEventListener for "+this.tagName+".on"+e));this.__removeEventListener(e,t,i)}),e.hasAttribute("USE"))return t=this.defMap[e.getAttribute("USE")],null===t&&x3dom.debug.logWarning("Could not USE: "+e.getAttribute("USE")),t;if("route"===e.localName.toLowerCase()){var i=e,r=this.defMap[i.getAttribute("fromNode")],n=this.defMap[i.getAttribute("toNode")];return r&&n?(r.setupRoute(i.getAttribute("fromField"),n,i.getAttribute("toField")),null):(x3dom.debug.logWarning("Broken route - can't find all DEFs for "+i.getAttribute("fromNode")+" -> "+i.getAttribute("toNode")),null)}var o=x3dom.nodeTypesLC[e.localName.toLowerCase()];if(void 0!==o){var s={doc:this.doc,xmlNode:e};t=new o(s),t._nameSpace=this,e.hasAttribute("DEF")?(t._DEF=e.getAttribute("DEF"),this.defMap[t._DEF]=t):e.hasAttribute("id")&&(t._DEF=e.getAttribute("id"),this.defMap[t._DEF]=t),t._xmlNode=e,e._x3domNode=t;var a=this;return Array.forEach(e.childNodes,function(e){var i=a.setupTree(e);i&&t.addChild(i,e.getAttribute("containerField"))}),t.nodeChanged(),t}x3dom.debug.logInfo("Unrecognised X3D element &lt;"+e.localName+"&gt;.")}else e.localName&&(x3dom.debug.logInfo("Unrecognised X3D element &lt;"+e.localName+"&gt;."),t=null);return t},x3dom.registerNodeType("X3DNode","Core",defineClass(null,function(){this._DEF=null,this._nameSpace=null,this._vf={},this._cf={},this._fieldWatchers={},this._parentNodes=[],this._listeners={},this._childNodes=[],this.addField_SFNode("metadata",x3dom.nodeTypes.X3DMetadataObject)},{type:function(){return this.constructor},typeName:function(){return this.constructor._typeName},addChild:function(e,t){if(e){var i=null;if(t)i=this._cf[t];else for(var r in this._cf)if(this._cf.hasOwnProperty(r)){var n=this._cf[r];if(x3dom.isa(e,n.type)){i=n;break}}if(i&&i.addLink(e))return e._parentNodes.push(this),this._childNodes.push(e),e.parentAdded(this),!0}return!1},removeChild:function(e){if(e)for(var t in this._cf)if(this._cf.hasOwnProperty(t)){var i=this._cf[t];if(i.rmLink(e)){for(var r=0,n=e._parentNodes.length;n>r;r++)e._parentNodes[r]===this&&(e._parentNodes.splice(r,1),e.parentRemoved(this));for(var o=0,s=this._childNodes.length;s>o;o++)if(this._childNodes[o]===e)return this._childNodes.splice(o,1),!0}}return!1},parentAdded:function(){},parentRemoved:function(){for(var e=0,t=this._childNodes.length;t>e;e++)this._childNodes[e]&&this._childNodes[e].parentRemoved(this)},getCurrentTransform:function(){return this._parentNodes.length>=1?this.transformMatrix(this._parentNodes[0].getCurrentTransform()):x3dom.fields.SFMatrix4f.identity()},transformMatrix:function(e){return e},getVolume:function(e,t,i){for(var r=!1,n=0,o=this._childNodes.length;o>n;n++)if(this._childNodes[n]){var s=x3dom.fields.SFVec3f.MAX(),a=x3dom.fields.SFVec3f.MIN();r=this._childNodes[n].getVolume(s,a,i)||r,r&&(e.x>s.x&&(e.x=s.x),e.y>s.y&&(e.y=s.y),e.z>s.z&&(e.z=s.z),t.x<a.x&&(t.x=a.x),t.y<a.y&&(t.y=a.y),t.z<a.z&&(t.z=a.z))}return r},find:function(e){for(var t=0;t<this._childNodes.length;t++)if(this._childNodes[t]){if(this._childNodes[t].constructor==e)return this._childNodes[t];var i=this._childNodes[t].find(e);if(i)return i}return null},findAll:function(e){for(var t=[],i=0;i<this._childNodes.length;i++)this._childNodes[i]&&(this._childNodes[i].constructor==e&&t.push(this._childNodes[i]),t=t.concat(this._childNodes[i].findAll(e)));return t},findParentProperty:function(e,t){var i=this[e];if(!i&&t&&this._xmlNode&&(i=this._xmlNode[e]),!i)for(var r=0,n=this._parentNodes.length;n>r&&!(i=this._parentNodes[r].findParentProperty(e,t));r++);return i},findX3DDoc:function(){return this._nameSpace.doc},collectDrawableObjects:function(e,t){for(var i=0;i<this._childNodes.length;i++)if(this._childNodes[i]){var r=this._childNodes[i].transformMatrix(e);this._childNodes[i].collectDrawableObjects(r,t)}},doIntersect:function(e){for(var t=!1,i=0;i<this._childNodes.length;i++)this._childNodes[i]&&(t=this._childNodes[i].doIntersect(e)||t);return t},postMessage:function(e,t){this._vf[e]=t;var i=this._fieldWatchers[e],r=this;i&&Array.forEach(i,function(e){e.call(r,t)})},updateField:function(e,t){var i=this._vf[e];if(void 0===i&&(i={},this._vf[e]=i),null!==i){try{this._vf[e].setValueByStr(t)}catch(r){try{switch((typeof this._vf[e]).toString()){case"number":this._vf[e]=+t;break;case"boolean":this._vf[e]="true"===t.toLowerCase();break;case"string":this._vf[e]=t}}catch(n){x3dom.debug.logError("updateField: setValueByStr() NYI for "+typeof i)}}this.fieldChanged(e)}},setupRoute:function(e,t,i){var r,n,o="set_",s="_changed";this._vf[e]||(r=e.indexOf(o),0===r?(n=e.substr(o.length,e.length-1),this._vf[n]&&(e=n)):(r=e.indexOf(s),r>0&&(n=e.substr(0,e.length-s.length),this._vf[n]&&(e=n)))),t._vf[i]||(r=i.indexOf(o),0===r?(n=i.substr(o.length,i.length-1),t._vf[n]&&(i=n)):(r=i.indexOf(s),r>0&&(n=i.substr(0,i.length-s.length),t._vf[n]&&(i=n)))),this._fieldWatchers[e]||(this._fieldWatchers[e]=[]),this._fieldWatchers[e].push(function(e){t.postMessage(i,e)}),t._fieldWatchers[i]||(t._fieldWatchers[i]=[]),t._fieldWatchers[i].push(function(e){t._vf[i]=e,t.fieldChanged(i)})},fieldChanged:function(){},nodeChanged:function(){},addField_SFInt32:function(e,t,i){this._vf[t]=e&&e.xmlNode.hasAttribute(t)?parseInt(e.xmlNode.getAttribute(t),10):i},addField_SFFloat:function(e,t,i){this._vf[t]=e&&e.xmlNode&&e.xmlNode.hasAttribute(t)?+e.xmlNode.getAttribute(t):i},addField_SFDouble:function(e,t,i){this._vf[t]=e&&e.xmlNode&&e.xmlNode.hasAttribute(t)?+e.xmlNode.getAttribute(t):i},addField_SFTime:function(e,t,i){this._vf[t]=e&&e.xmlNode&&e.xmlNode.hasAttribute(t)?+e.xmlNode.getAttribute(t):i},addField_SFBool:function(e,t,i){this._vf[t]=e&&e.xmlNode&&e.xmlNode.hasAttribute(t)?"true"===e.xmlNode.getAttribute(t).toLowerCase():i},addField_SFString:function(e,t,i){this._vf[t]=e&&e.xmlNode&&e.xmlNode.hasAttribute(t)?e.xmlNode.getAttribute(t):i},addField_SFColor:function(e,t,i,r,n){this._vf[t]=e&&e.xmlNode&&e.xmlNode.hasAttribute(t)?x3dom.fields.SFColor.parse(e.xmlNode.getAttribute(t)):new x3dom.fields.SFColor(i,r,n)},addField_SFColorRGBA:function(e,t,i,r,n,o){this._vf[t]=e&&e.xmlNode&&e.xmlNode.hasAttribute(t)?x3dom.fields.SFColorRGBA.parse(e.xmlNode.getAttribute(t)):new x3dom.fields.SFColorRGBA(i,r,n,o)},addField_SFVec2f:function(e,t,i,r){this._vf[t]=e&&e.xmlNode&&e.xmlNode.hasAttribute(t)?x3dom.fields.SFVec2f.parse(e.xmlNode.getAttribute(t)):new x3dom.fields.SFVec2f(i,r)},addField_SFVec3f:function(e,t,i,r,n){this._vf[t]=e&&e.xmlNode&&e.xmlNode.hasAttribute(t)?x3dom.fields.SFVec3f.parse(e.xmlNode.getAttribute(t)):new x3dom.fields.SFVec3f(i,r,n)},addField_SFVec3d:function(e,t,i,r,n){this.addField_SFVec3f(e,t,i,r,n)},addField_SFRotation:function(e,t,i,r,n,o){this._vf[t]=e&&e.xmlNode&&e.xmlNode.hasAttribute(t)?x3dom.fields.Quaternion.parseAxisAngle(e.xmlNode.getAttribute(t)):x3dom.fields.Quaternion.axisAngle(new x3dom.fields.SFVec3f(i,r,n),o)},addField_SFMatrix4f:function(e,t,i,r,n,o,s,a,l,d,h,u,c,f,m,p,_,g){this._vf[t]=e&&e.xmlNode&&e.xmlNode.hasAttribute(t)?x3dom.fields.SFMatrix4f.parse(e.xmlNode.getAttribute(t)):new x3dom.fields.SFMatrix4f(i,r,n,o,s,a,l,d,h,u,c,f,m,p,_,g)},addField_SFImage:function(e,t,i){this._vf[t]=e&&e.xmlNode&&e.xmlNode.hasAttribute(t)?x3dom.fields.SFImage.parse(e.xmlNode.getAttribute(t)):new x3dom.fields.SFImage(i)},addField_MFString:function(e,t,i){this._vf[t]=e&&e.xmlNode&&e.xmlNode.hasAttribute(t)?x3dom.fields.MFString.parse(e.xmlNode.getAttribute(t)):new x3dom.fields.MFString(i)},addField_MFInt32:function(e,t,i){this._vf[t]=e&&e.xmlNode&&e.xmlNode.hasAttribute(t)?x3dom.fields.MFInt32.parse(e.xmlNode.getAttribute(t)):new x3dom.fields.MFInt32(i)},addField_MFFloat:function(e,t,i){this._vf[t]=e&&e.xmlNode&&e.xmlNode.hasAttribute(t)?x3dom.fields.MFFloat.parse(e.xmlNode.getAttribute(t)):new x3dom.fields.MFFloat(i)},addField_MFDouble:function(e,t,i){this._vf[t]=e&&e.xmlNode&&e.xmlNode.hasAttribute(t)?x3dom.fields.MFFloat.parse(e.xmlNode.getAttribute(t)):new x3dom.fields.MFFloat(i)},addField_MFColor:function(e,t,i){this._vf[t]=e&&e.xmlNode&&e.xmlNode.hasAttribute(t)?x3dom.fields.MFColor.parse(e.xmlNode.getAttribute(t)):new x3dom.fields.MFColor(i)},addField_MFColorRGBA:function(e,t,i){this._vf[t]=e&&e.xmlNode&&e.xmlNode.hasAttribute(t)?x3dom.fields.MFColorRGBA.parse(e.xmlNode.getAttribute(t)):new x3dom.fields.MFColorRGBA(i)},addField_MFVec2f:function(e,t,i){this._vf[t]=e&&e.xmlNode&&e.xmlNode.hasAttribute(t)?x3dom.fields.MFVec2f.parse(e.xmlNode.getAttribute(t)):new x3dom.fields.MFVec2f(i)},addField_MFVec3f:function(e,t,i){this._vf[t]=e&&e.xmlNode&&e.xmlNode.hasAttribute(t)?x3dom.fields.MFVec3f.parse(e.xmlNode.getAttribute(t)):new x3dom.fields.MFVec3f(i)},addField_MFVec3d:function(e,t,i){this.addField_MFVec3f(e,t,i)},addField_MFRotation:function(e,t,i){this._vf[t]=e&&e.xmlNode&&e.xmlNode.hasAttribute(t)?x3dom.fields.MFRotation.parse(e.xmlNode.getAttribute(t)):new x3dom.fields.MFRotation(i)},addField_SFNode:function(e,t){this._cf[e]=new x3dom.fields.SFNode(t)},addField_MFNode:function(e,t){this._cf[e]=new x3dom.fields.MFNode(t)}})),x3dom.registerNodeType("X3DMetadataObject","Core",defineClass(x3dom.nodeTypes.X3DNode,function(e){x3dom.nodeTypes.X3DMetadataObject.superClass.call(this,e),this.addField_SFString(e,"name",""),this.addField_SFString(e,"reference","")})),x3dom.registerNodeType("MetadataDouble","Core",defineClass(x3dom.nodeTypes.X3DMetadataObject,function(e){x3dom.nodeTypes.MetadataDouble.superClass.call(this,e),this.addField_MFDouble(e,"value",[])})),x3dom.registerNodeType("MetadataFloat","Core",defineClass(x3dom.nodeTypes.X3DMetadataObject,function(e){x3dom.nodeTypes.MetadataFloat.superClass.call(this,e),this.addField_MFFloat(e,"value",[])})),x3dom.registerNodeType("MetadataInteger","Core",defineClass(x3dom.nodeTypes.X3DMetadataObject,function(e){x3dom.nodeTypes.MetadataInteger.superClass.call(this,e),this.addField_MFInt32(e,"value",[])})),x3dom.registerNodeType("MetadataSet","Core",defineClass(x3dom.nodeTypes.X3DMetadataObject,function(e){x3dom.nodeTypes.MetadataSet.superClass.call(this,e),this.addField_MFNode("value",x3dom.nodeTypes.X3DMetadataObject)})),x3dom.registerNodeType("MetadataString","Core",defineClass(x3dom.nodeTypes.X3DMetadataObject,function(e){x3dom.nodeTypes.MetadataString.superClass.call(this,e),this.addField_MFString(e,"value",[])})),x3dom.registerNodeType("Field","Core",defineClass(x3dom.nodeTypes.X3DNode,function(e){x3dom.nodeTypes.Field.superClass.call(this,e),this.addField_SFString(e,"name",""),this.addField_SFString(e,"type",""),this.addField_SFString(e,"value","")},{fieldChanged:function(e){var t=this;"value"===e&&Array.forEach(this._parentNodes,function(e){e.fieldChanged(t._vf.name)})}})),x3dom.registerNodeType("X3DChildNode","Core",defineClass(x3dom.nodeTypes.X3DNode,function(e){x3dom.nodeTypes.X3DChildNode.superClass.call(this,e)})),x3dom.registerNodeType("X3DBindableNode","Core",defineClass(x3dom.nodeTypes.X3DChildNode,function(e){x3dom.nodeTypes.X3DBindableNode.superClass.call(this,e),this.addField_SFBool(e,"set_bind",!1),this.addField_SFString(e,"description",""),this.addField_SFBool(e,"isActive",!1),this._autoGen=e.autoGen?!0:!1,e&&e.doc._bindableBag?this._stack=e.doc._bindableBag.addBindable(this):(this._stack=null,x3dom.debug.logError("Could not find bindableBag for registration "+this.typeName()))},{initDefault:function(){},bind:function(e){this._stack?e?this._stack.push(this):this._stack.pop(this):x3dom.debug.logError("No BindStack in Bindable\n")},activate:function(){x3dom.debug.logInfo("activate Bindable "+this._DEF),this.postMessage("isActive",!0)},deactivate:function(){x3dom.debug.logInfo("deactivate Bindable "+this._DEF),this.postMessage("isActive",!1)},fieldChanged:function(e){"set_bind"===e&&this.bind(this._vf.set_bind)},nodeChanged:function(){}})),x3dom.registerNodeType("WorldInfo","Core",defineClass(x3dom.nodeTypes.X3DChildNode,function(e){x3dom.nodeTypes.WorldInfo.superClass.call(this,e),this.addField_MFString(e,"info",[]),this.addField_SFString(e,"title",""),x3dom.debug.logInfo(this._vf.info),x3dom.debug.logInfo(this._vf.title)},{})),x3dom.registerNodeType("X3DSensorNode","Core",defineClass(x3dom.nodeTypes.X3DChildNode,function(e){x3dom.nodeTypes.X3DSensorNode.superClass.call(this,e)})),x3dom.registerNodeType("Param","Core",defineClass(x3dom.nodeTypes.X3DNode,function(e){x3dom.nodeTypes.Param.superClass.call(this,e)},{nodeChanged:function(){x3dom.debug.logWarning('DEPRECATED 1.3: Param element needs to be child of X3D element [<a href="http://x3dom.org/docs/latest/configuration.html">DOCS</a>]')}})),x3dom.registerNodeType("X3DGroupingNode","Grouping",defineClass(x3dom.nodeTypes.X3DChildNode,function(e){x3dom.nodeTypes.X3DGroupingNode.superClass.call(this,e),this.addField_SFBool(e,"render",!0),this.addField_MFNode("children",x3dom.nodeTypes.X3DChildNode)},{collectDrawableObjects:function(e,t){if(this._vf.render)for(var i=0;i<this._childNodes.length;i++)if(this._childNodes[i]){var r=this._childNodes[i].transformMatrix(e);this._childNodes[i].collectDrawableObjects(r,t)}}})),x3dom.registerNodeType("Switch","Grouping",defineClass(x3dom.nodeTypes.X3DGroupingNode,function(e){x3dom.nodeTypes.Switch.superClass.call(this,e),this.addField_SFInt32(e,"whichChoice",-1)},{getVolume:function(e,t,i){return this._vf.whichChoice<0||this._vf.whichChoice>=this._childNodes.length?!1:this._childNodes[this._vf.whichChoice]?this._childNodes[this._vf.whichChoice].getVolume(e,t,i):!1},find:function(e){if(this._vf.whichChoice<0||this._vf.whichChoice>=this._childNodes.length)return null;
if(this._childNodes[this._vf.whichChoice]){if(this._childNodes[this._vf.whichChoice].constructor==e)return this._childNodes[this._vf.whichChoice];var t=this._childNodes[this._vf.whichChoice].find(e);if(t)return t}return null},findAll:function(e){if(this._vf.whichChoice<0||this._vf.whichChoice>=this._childNodes.length)return[];var t=[];return this._childNodes[this._vf.whichChoice]&&(this._childNodes[this._vf.whichChoice].constructor==e&&t.push(this._childNodes[this._vf.whichChoice]),t=t.concat(this._childNodes[this._vf.whichChoice].findAll(e))),t},collectDrawableObjects:function(e,t){if(!(this._vf.whichChoice<0||this._vf.whichChoice>=this._childNodes.length)&&this._childNodes[this._vf.whichChoice]){var i=this._childNodes[this._vf.whichChoice].transformMatrix(e);this._childNodes[this._vf.whichChoice].collectDrawableObjects(i,t)}},doIntersect:function(e){return this._vf.whichChoice<0||this._vf.whichChoice>=this._childNodes.length?!1:this._childNodes[this._vf.whichChoice]?this._childNodes[this._vf.whichChoice].doIntersect(e):!1}})),x3dom.registerNodeType("X3DTransformNode","Grouping",defineClass(x3dom.nodeTypes.X3DGroupingNode,function(e){x3dom.nodeTypes.X3DTransformNode.superClass.call(this,e),e.doc._nodeBag.trans.push(this),this._trafo=null},{tick:function(){if(this._xmlNode&&(this._xmlNode.transform||this._xmlNode.hasAttribute("transform")||this._listeners.transform)){var e=this.getCurrentTransform(),t={target:{},type:"transform",worldX:e._03,worldY:e._13,worldZ:e._23,stopPropagation:function(){this.cancelBubble=!0}},i=this._xmlNode[t.type];if("function"==typeof i)i.call(this._xmlNode,t);else{var r=this._xmlNode.getAttribute(t.type),n=new Function("event",r);n.call(this._xmlNode,t)}var o=this._listeners[t.type];if(o)for(var s=0;s<o.length;s++)o[s].call(this._xmlNode,t)}var a=x3dom.getStyle(this._xmlNode,"-webkit-transform");return a&&"none"!=a?(this._trafo.setValueByStr(a),!0):!1},transformMatrix:function(e){return e.mult(this._trafo)},getVolume:function(e,t,i){for(var r=x3dom.fields.SFVec3f.MAX(),n=x3dom.fields.SFVec3f.MIN(),o=!1,s=0,a=this._childNodes.length;a>s;s++)if(this._childNodes[s]){var l=x3dom.fields.SFVec3f.MAX(),d=x3dom.fields.SFVec3f.MIN();o=this._childNodes[s].getVolume(l,d,i)||o,o&&(r.x>l.x&&(r.x=l.x),r.y>l.y&&(r.y=l.y),r.z>l.z&&(r.z=l.z),n.x<d.x&&(n.x=d.x),n.y<d.y&&(n.y=d.y),n.z<d.z&&(n.z=d.z))}return o&&(r=this._trafo.multMatrixPnt(r),n=this._trafo.multMatrixPnt(n),e.x=r.x<n.x?r.x:n.x,e.y=r.y<n.y?r.y:n.y,e.z=r.z<n.z?r.z:n.z,t.x=n.x>r.x?n.x:r.x,t.y=n.y>r.y?n.y:r.y,t.z=n.z>r.z?n.z:r.z),o},doIntersect:function(e){var t=!1,i=this._trafo.inverse(),r=new x3dom.fields.SFVec3f(e.pos.x,e.pos.y,e.pos.z),n=new x3dom.fields.SFVec3f(e.dir.x,e.dir.y,e.dir.z);e.pos=i.multMatrixPnt(e.pos),e.dir=i.multMatrixVec(e.dir),e.hitObject&&(e.dist*=e.dir.length());for(var o=0;o<this._childNodes.length;o++)this._childNodes[o]&&(t=this._childNodes[o].doIntersect(e)||t);return e.pos.setValues(r),e.dir.setValues(n),t&&(e.hitPoint=this._trafo.multMatrixPnt(e.hitPoint),e.dist*=e.dir.length()),t},parentRemoved:function(){var e,t;if(0===this._parentNodes.length){var i=this.findX3DDoc();for(e=0,t=i._nodeBag.trans.length;t>e;e++)i._nodeBag.trans[e]===this&&i._nodeBag.trans.splice(e,1)}for(e=0,t=this._childNodes.length;t>e;e++)this._childNodes[e]&&this._childNodes[e].parentRemoved(this)}})),x3dom.registerNodeType("Transform","Grouping",defineClass(x3dom.nodeTypes.X3DTransformNode,function(e){x3dom.nodeTypes.Transform.superClass.call(this,e),this.addField_SFVec3f(e,"center",0,0,0),this.addField_SFVec3f(e,"translation",0,0,0),this.addField_SFRotation(e,"rotation",0,0,1,0),this.addField_SFVec3f(e,"scale",1,1,1),this.addField_SFRotation(e,"scaleOrientation",0,0,1,0),this._trafo=x3dom.fields.SFMatrix4f.translation(this._vf.translation.add(this._vf.center)).mult(this._vf.rotation.toMatrix()).mult(this._vf.scaleOrientation.toMatrix()).mult(x3dom.fields.SFMatrix4f.scale(this._vf.scale)).mult(this._vf.scaleOrientation.toMatrix().inverse()).mult(x3dom.fields.SFMatrix4f.translation(this._vf.center.negate()))},{fieldChanged:function(){this._trafo=x3dom.fields.SFMatrix4f.translation(this._vf.translation.add(this._vf.center)).mult(this._vf.rotation.toMatrix()).mult(this._vf.scaleOrientation.toMatrix()).mult(x3dom.fields.SFMatrix4f.scale(this._vf.scale)).mult(this._vf.scaleOrientation.toMatrix().inverse()).mult(x3dom.fields.SFMatrix4f.translation(this._vf.center.negate()))}})),x3dom.registerNodeType("MatrixTransform","Grouping",defineClass(x3dom.nodeTypes.X3DTransformNode,function(e){x3dom.nodeTypes.MatrixTransform.superClass.call(this,e),this.addField_SFMatrix4f(e,"matrix",1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this._trafo=this._vf.matrix},{})),x3dom.registerNodeType("Group","Grouping",defineClass(x3dom.nodeTypes.X3DGroupingNode,function(e){x3dom.nodeTypes.Group.superClass.call(this,e)},{})),x3dom.registerNodeType("StaticGroup","Grouping",defineClass(x3dom.nodeTypes.X3DGroupingNode,function(e){x3dom.nodeTypes.StaticGroup.superClass.call(this,e),x3dom.debug.logWarning("StaticGroup NYI")})),x3dom.registerNodeType("Scene","Core",defineClass(x3dom.nodeTypes.X3DGroupingNode,function(e){x3dom.nodeTypes.Scene.superClass.call(this,e),this.addField_SFString(e,"pickMode","idBuf")},{})),x3dom.BindableStack=function(e,t,i,r){this._doc=e,this._type=t,this._defaultType=i,this._defaultRoot=0,this._getter=r,this._bindBag=[],this._bindStack=[]},x3dom.BindableStack.prototype.top=function(){return this._bindStack.length>=0?this._bindStack[this._bindStack.length-1]:null},x3dom.BindableStack.prototype.push=function(e){var t=this.top();t!==e&&(t&&t.deactivate(),this._bindStack.push(e),e.activate(t))},x3dom.BindableStack.prototype.replaceTop=function(e){var t=this.top();t!==e&&t&&(t.deactivate(),this._bindStack[this._bindStack.length-1]=e,e.activate(t))},x3dom.BindableStack.prototype.pop=function(e){var t;return e&&(t=this.top(),e!==t)?null:(t=this._bindStack.pop(),t&&t.deactivate(),t)},x3dom.BindableStack.prototype.switchTo=function(e){var t=this.getActive(),i=this._bindBag.length,r=0,n=0,o=-1;if(!(1>=i)){switch(e){case"first":r=this._bindBag[0];break;case"last":r=this._bindBag[i-1];break;default:for(n=0;i>n;n++)if(this._bindBag[n]==t){o=n;break}if(o>=0)for(n=o;!r&&(n="next"==e?i-1>n?n+1:0:n>0?n-1:i-1,n!=o);)this._bindBag[n]._vf.description.length>=0&&(r=this._bindBag[n])}r?this.replaceTop(r):x3dom.debug.logWarning("Cannot switch bindable; no other bindable with description found.")}},x3dom.BindableStack.prototype.getActive=function(){if(0===this._bindStack.length){if(0===this._bindBag.length){x3dom.debug.logInfo("create new "+this._defaultType._typeName+" for "+this._type._typeName+"-stack");var e=new this._defaultType({doc:this._doc,autoGen:!0});e&&(this._defaultRoot?(this._defaultRoot.addChild(e),e._nameSpace=this._defaultRoot._nameSpace):x3dom.debug.logError("stack without defaultRoot"),e.initDefault(),this._bindBag.push(e))}else x3dom.debug.logInfo("activate first "+this._type._typeName+" for "+this._type._typeName+"-stack");this._bindStack.push(this._bindBag[0]),this._bindBag[0].activate()}return this._bindStack[this._bindStack.length-1]},x3dom.BindableBag=function(e){this._stacks=[],this.addType("X3DViewpointNode","Viewpoint","getViewpoint",e),this.addType("X3DNavigationInfoNode","NavigationInfo","getNavigationInfo",e),this.addType("X3DBackgroundNode","Background","getBackground",e),this.addType("X3DFogNode","Fog","getFog",e)},x3dom.BindableBag.prototype.addType=function(e,t,i,r){var n,o=x3dom.nodeTypes[e],s=x3dom.nodeTypes[t];o&&s?(n=new x3dom.BindableStack(r,o,s,i),this._stacks.push(n)):x3dom.debug.logWarning("Invalid Bindable type/defaultType:"+e+"/"+s)},x3dom.BindableBag.prototype.setRefNode=function(e){Array.forEach(this._stacks,function(t){t._defaultRoot=e,e[t._getter]=function(){return t.getActive()}})},x3dom.BindableBag.prototype.addBindable=function(e){for(var t=0,i=this._stacks.length;i>t;t++)if(x3dom.isa(e,this._stacks[t]._type))return x3dom.debug.logInfo("register bindable "+e.typeName()),this._stacks[t]._bindBag.push(e),this._stacks[t];return x3dom.debug.logError(e.typeName()+" is not a valid bindable"),null},x3dom.registerNodeType("X3DGeometryNode","Rendering",defineClass(x3dom.nodeTypes.X3DNode,function(e){x3dom.nodeTypes.X3DGeometryNode.superClass.call(this,e),this.addField_SFBool(e,"solid",!0),this.addField_SFBool(e,"ccw",!0),this._mesh=new x3dom.Mesh(this),this._pickable=!0},{getVolume:function(e,t,i){return this._mesh.getBBox(e,t,i),!0},getCenter:function(){return this._mesh.getCenter()},doIntersect:function(e){return this._pickable?this._mesh.doIntersect(e):!1},getColorTexture:function(){return null},getColorTextureURL:function(){return null}})),x3dom.registerNodeType("Mesh","Rendering",defineClass(x3dom.nodeTypes.X3DGeometryNode,function(e){x3dom.nodeTypes.Mesh.superClass.call(this,e),this.addField_SFString(e,"primType","triangle"),this.addField_MFInt32(e,"index",[]),this.addField_MFNode("vertexAttributes",x3dom.nodeTypes.X3DVertexAttributeNode)},{nodeChanged:function(){var e,t=(new Date).getTime(),i=this._cf.vertexAttributes.nodes.length;for(e=0;i>e;e++){var r=this._cf.vertexAttributes.nodes[e]._vf.name;switch(r.toLowerCase()){case"position":this._mesh._positions[0]=this._cf.vertexAttributes.nodes[e]._vf.value.toGL();break;case"normal":this._mesh._normals[0]=this._cf.vertexAttributes.nodes[e]._vf.value.toGL();break;case"texcoord":this._mesh._texCoords[0]=this._cf.vertexAttributes.nodes[e]._vf.value.toGL();break;case"color":this._mesh._colors[0]=this._cf.vertexAttributes.nodes[e]._vf.value.toGL();break;default:this._mesh._dynamicFields[r]={},this._mesh._dynamicFields[r].numComponents=this._cf.vertexAttributes.nodes[e]._vf.numComponents,this._mesh._dynamicFields[r].value=this._cf.vertexAttributes.nodes[e]._vf.value.toGL()}}this._mesh._indices[0]=this._vf.index.toGL(),this._mesh._invalidate=!0,this._mesh._numFaces=this._mesh._indices[0].length/3,this._mesh._numCoords=this._mesh._positions[0].length/3;var n=(new Date).getTime()-t;x3dom.debug.logWarning("Mesh load time: "+n+" ms")}})),x3dom.registerNodeType("PointSet","Rendering",defineClass(x3dom.nodeTypes.X3DGeometryNode,function(e){x3dom.nodeTypes.PointSet.superClass.call(this,e),this.addField_SFNode("coord",x3dom.nodeTypes.Coordinate),this.addField_SFNode("color",x3dom.nodeTypes.X3DColorNode),this._pickable=!1},{nodeChanged:function(){var e=(new Date).getTime(),t=this._cf.coord.node;x3dom.debug.assert(t);var i=t._vf.point,r=3,n=this._cf.color.node,o=new x3dom.fields.MFColor;if(n)o=n._vf.color,x3dom.debug.assert(i.length==o.length),x3dom.isa(n,x3dom.nodeTypes.ColorRGBA)&&(r=4);else for(var s=0,a=i.length;a>s;s++)o.push(1);this._mesh._numColComponents=r,this._mesh._indices[0]=[],this._mesh._positions[0]=i.toGL(),this._mesh._colors[0]=o.toGL(),this._mesh._normals[0]=[],this._mesh._texCoords[0]=[],this._mesh._lit=!1,this._mesh._invalidate=!0,this._mesh._numCoords=this._mesh._positions[0].length/3;(new Date).getTime()-e},fieldChanged:function(e){var t,i,r;if("coord"==e){for(t=this._cf.coord.node._vf.point,r=t.length,this._mesh._positions[0]=[],i=0;r>i;i++)this._mesh._positions[0].push(t[i].x),this._mesh._positions[0].push(t[i].y),this._mesh._positions[0].push(t[i].z);this._mesh._invalidate=!0,Array.forEach(this._parentNodes,function(e){e._dirty.positions=!0})}else if("color"==e){for(t=this._cf.color.node._vf.color,r=t.length,this._mesh._colors[0]=[],i=0;r>i;i++)this._mesh._colors[0].push(t[i].r),this._mesh._colors[0].push(t[i].g),this._mesh._colors[0].push(t[i].b);Array.forEach(this._parentNodes,function(e){e._dirty.colors=!0})}}})),x3dom.registerNodeType("X3DComposedGeometryNode","Rendering",defineClass(x3dom.nodeTypes.X3DGeometryNode,function(e){x3dom.nodeTypes.X3DComposedGeometryNode.superClass.call(this,e),this.addField_SFBool(e,"colorPerVertex",!0),this.addField_SFBool(e,"normalPerVertex",!0),this.addField_MFNode("attrib",x3dom.nodeTypes.X3DVertexAttributeNode),this.addField_SFNode("coord",x3dom.nodeTypes.X3DCoordinateNode),this.addField_SFNode("normal",x3dom.nodeTypes.Normal),this.addField_SFNode("color",x3dom.nodeTypes.X3DColorNode),this.addField_SFNode("texCoord",x3dom.nodeTypes.X3DTextureCoordinateNode)},{handleAttribs:function(){var e,t=this._cf.attrib.nodes.length;for(e=0;t>e;e++){var i=this._cf.attrib.nodes[e]._vf.name;switch(i.toLowerCase()){case"position":this._mesh._positions[0]=this._cf.attrib.nodes[e]._vf.value.toGL();break;case"normal":this._mesh._normals[0]=this._cf.attrib.nodes[e]._vf.value.toGL();break;case"texcoord":this._mesh._texCoords[0]=this._cf.attrib.nodes[e]._vf.value.toGL();break;case"color":this._mesh._colors[0]=this._cf.attrib.nodes[e]._vf.value.toGL();break;default:this._mesh._dynamicFields[i]={},this._mesh._dynamicFields[i].numComponents=this._cf.attrib.nodes[e]._vf.numComponents,this._mesh._dynamicFields[i].value=this._cf.attrib.nodes[e]._vf.value.toGL()}}}})),x3dom.registerNodeType("IndexedLineSet","Rendering",defineClass(x3dom.nodeTypes.X3DGeometryNode,function(e){x3dom.nodeTypes.IndexedLineSet.superClass.call(this,e),this.addField_SFBool(e,"colorPerVertex",!0),this.addField_MFNode("attrib",x3dom.nodeTypes.X3DVertexAttributeNode),this.addField_SFNode("coord",x3dom.nodeTypes.X3DCoordinateNode),this.addField_SFNode("color",x3dom.nodeTypes.X3DColorNode),this.addField_MFInt32(e,"coordIndex",[]),this.addField_MFInt32(e,"colorIndex",[]),this._pickable=!1},{nodeChanged:function(){var e=(new Date).getTime(),t=this._vf.coordIndex,i=this._vf.colorIndex,r=!1,n=!1,o=this._vf.colorPerVertex;i.length>0&&(n=!0);var s,a,l=this._cf.coord.node;x3dom.debug.assert(l),s=l.getPoints();var d=3,h=this._cf.color.node;h?(r=!0,a=h._vf.color,x3dom.isa(h,x3dom.nodeTypes.ColorRGBA)&&(d=4)):r=!1,this._mesh._indices[0]=[],this._mesh._positions[0]=[],this._mesh._colors[0]=[];var u,c,f,m,p,_,g,v;if(r&&n)for(c=0,f=0,m=0,u=0;u<t.length;++u)if(-1!==t[u])switch(n&&x3dom.debug.assert(-1!=i[u]),c){case 0:p=+t[u],g=n&&o?+i[u]:p,c=1;break;case 1:_=+t[u],v=n&&o?+i[u]:n&&!o?+i[m]:_,this._mesh._indices[0].push(f++,f++),this._mesh._positions[0].push(s[p].x),this._mesh._positions[0].push(s[p].y),this._mesh._positions[0].push(s[p].z),this._mesh._positions[0].push(s[_].x),this._mesh._positions[0].push(s[_].y),this._mesh._positions[0].push(s[_].z),r&&(o||(g=v),this._mesh._colors[0].push(a[g].r),this._mesh._colors[0].push(a[g].g),this._mesh._colors[0].push(a[g].b),this._mesh._colors[0].push(a[v].r),this._mesh._colors[0].push(a[v].g),this._mesh._colors[0].push(a[v].b)),c=2,m++;break;case 3:p=_,g=v,_=+t[u],v=n&&o?+i[u]:n&&!o?+i[m]:_,this._mesh._indices[0].push(f++,f++),this._mesh._positions[0].push(s[p].x),this._mesh._positions[0].push(s[p].y),this._mesh._positions[0].push(s[p].z),this._mesh._positions[0].push(s[_].x),this._mesh._positions[0].push(s[_].y),this._mesh._positions[0].push(s[_].z),r&&(o||(g=v),this._mesh._colors[0].push(a[g].r),this._mesh._colors[0].push(a[g].g),this._mesh._colors[0].push(a[g].b),this._mesh._colors[0].push(a[v].r),this._mesh._colors[0].push(a[v].g),this._mesh._colors[0].push(a[v].b)),m++}else c=0;else{for(c=0,u=0;u<t.length;++u)if(-1!==t[u])switch(c){case 0:p=+t[u],c=1;break;case 1:_=+t[u],c=2,this._mesh._indices[0].push(p,_);break;case 2:p=_,_=+t[u],this._mesh._indices[0].push(p,_)}else c=0;this._mesh._positions[0]=s.toGL(),r&&(this._mesh._colors[0]=a.toGL(),this._mesh._numColComponents=d)}this._mesh._invalidate=!0,this._mesh._numCoords=this._mesh._positions[0].length/3;(new Date).getTime()-e},fieldChanged:function(e){var t,i,r;if("coord"==e){for(t=this._cf.coord.node._vf.point,r=t.length,this._mesh._positions[0]=[],i=0;r>i;i++)this._mesh._positions[0].push(t[i].x),this._mesh._positions[0].push(t[i].y),this._mesh._positions[0].push(t[i].z);this._mesh._invalidate=!0,Array.forEach(this._parentNodes,function(e){e._dirty.positions=!0})}else if("color"==e){for(t=this._cf.color.node._vf.color,r=t.length,this._mesh._colors[0]=[],i=0;r>i;i++)this._mesh._colors[0].push(t[i].r),this._mesh._colors[0].push(t[i].g),this._mesh._colors[0].push(t[i].b);Array.forEach(this._parentNodes,function(e){e._dirty.colors=!0})}}})),x3dom.registerNodeType("IndexedTriangleSet","Rendering",defineClass(x3dom.nodeTypes.X3DComposedGeometryNode,function(e){x3dom.nodeTypes.IndexedTriangleSet.superClass.call(this,e),this.addField_MFInt32(e,"index",[])},{nodeChanged:function(){var e=(new Date).getTime();this.handleAttribs();var t,i,r,n,o=(this._vf.normalPerVertex,this._vf.index),s=!1,a=!1,l=!1,d=this._cf.coord.node;x3dom.debug.assert(d),t=d._vf.point;var h=this._cf.normal.node;h?(s=!0,i=h._vf.vector):s=!1;var u="",c=2,f=this._cf.texCoord.node;f?f._vf.point?(a=!0,r=f._vf.point,x3dom.isa(f,x3dom.nodeTypes.TextureCoordinate3D)&&(c=3)):f._vf.mode&&(u=f._vf.mode):a=!1;var m=3,p=this._cf.color.node;p?(l=!0,n=p._vf.color,x3dom.isa(p,x3dom.nodeTypes.ColorRGBA)&&(m=4)):l=!1,this._mesh._indices[0]=[],this._mesh._positions[0]=[],this._mesh._normals[0]=[],this._mesh._texCoords[0]=[],this._mesh._colors[0]=[];for(var _,g,v,y,b,x,w,T,E,C,S,F,M,A,N,R,D;t.length%3>0;)t.push(t.length-1);if(b=t.length,t.length>65535){for(g=0,v=0,y=0,this._mesh._multiIndIndices=[],this._mesh._posSize=t.length,_=0;_<o.length;++_)switch(_>0&&_%3===0&&(g=0,y++),g){case 0:x=+o[_],E=x,F=x,N=x,g=1;break;case 1:w=+o[_],C=w,M=w,R=w,g=2;break;case 2:T=+o[_],S=T,A=T,D=T,g=3,this._mesh._indices[0].push(v++,v++,v++),this._mesh._positions[0].push(t[x].x),this._mesh._positions[0].push(t[x].y),this._mesh._positions[0].push(t[x].z),this._mesh._positions[0].push(t[w].x),this._mesh._positions[0].push(t[w].y),this._mesh._positions[0].push(t[w].z),this._mesh._positions[0].push(t[T].x),this._mesh._positions[0].push(t[T].y),this._mesh._positions[0].push(t[T].z),s?(this._mesh._normals[0].push(i[E].x),this._mesh._normals[0].push(i[E].y),this._mesh._normals[0].push(i[E].z),this._mesh._normals[0].push(i[C].x),this._mesh._normals[0].push(i[C].y),this._mesh._normals[0].push(i[C].z),this._mesh._normals[0].push(i[S].x),this._mesh._normals[0].push(i[S].y),this._mesh._normals[0].push(i[S].z)):this._mesh._multiIndIndices.push(x,w,T),l&&(this._mesh._colors[0].push(n[N].r),this._mesh._colors[0].push(n[N].g),this._mesh._colors[0].push(n[N].b),4===m&&this._mesh._colors[0].push(n[N].a),this._mesh._colors[0].push(n[R].r),this._mesh._colors[0].push(n[R].g),this._mesh._colors[0].push(n[R].b),4===m&&this._mesh._colors[0].push(n[R].a),this._mesh._colors[0].push(n[D].r),this._mesh._colors[0].push(n[D].g),this._mesh._colors[0].push(n[D].b),4===m&&this._mesh._colors[0].push(n[D].a)),a&&(this._mesh._texCoords[0].push(r[F].x),this._mesh._texCoords[0].push(r[F].y),3===c&&this._mesh._texCoords[0].push(r[F].z),this._mesh._texCoords[0].push(r[M].x),this._mesh._texCoords[0].push(r[M].y),3===c&&this._mesh._texCoords[0].push(r[M].z),this._mesh._texCoords[0].push(r[A].x),this._mesh._texCoords[0].push(r[A].y),3===c&&this._mesh._texCoords[0].push(r[A].z))}s||this._mesh.calcNormals(Math.PI),a||this._mesh.calcTexCoords(u),this._mesh.splitMesh()}else this._mesh._indices[0]=o.toGL(),this._mesh._positions[0]=t.toGL(),s?this._mesh._normals[0]=i.toGL():this._mesh.calcNormals(Math.PI),a?(this._mesh._texCoords[0]=r.toGL(),this._mesh._numTexComponents=c):this._mesh.calcTexCoords(u),l&&(this._mesh._colors[0]=n.toGL(),this._mesh._numColComponents=m);for(this._mesh._invalidate=!0,this._mesh._numFaces=0,this._mesh._numCoords=0,_=0;_<this._mesh._indices.length;_++)this._mesh._numFaces+=this._mesh._indices[_].length/3,this._mesh._numCoords+=this._mesh._positions[_].length/3;(new Date).getTime()-e},fieldChanged:function(e){var t,i,r;if("coord"==e){for(t=this._cf.coord.node._vf.point,r=t.length,this._mesh._positions[0]=[],i=0;r>i;i++)this._mesh._positions[0].push(t[i].x),this._mesh._positions[0].push(t[i].y),this._mesh._positions[0].push(t[i].z);this._mesh._invalidate=!0,Array.forEach(this._parentNodes,function(e){e._dirty.positions=!0})}else if("color"==e){for(t=this._cf.color.node._vf.color,r=t.length,this._mesh._colors[0]=[],i=0;r>i;i++)this._mesh._colors[0].push(t[i].r),this._mesh._colors[0].push(t[i].g),this._mesh._colors[0].push(t[i].b);Array.forEach(this._parentNodes,function(e){e._dirty.colors=!0})}}})),x3dom.registerNodeType("IndexedTriangleStripSet","Rendering",defineClass(x3dom.nodeTypes.X3DComposedGeometryNode,function(e){x3dom.nodeTypes.IndexedTriangleStripSet.superClass.call(this,e),this.addField_MFInt32(e,"index",[])},{nodeChanged:function(){x3dom.debug.logError("========== IndexedTriangleStripSet is not implemented ==========")}})),x3dom.registerNodeType("X3DGeometricPropertyNode","Rendering",defineClass(x3dom.nodeTypes.X3DNode,function(e){x3dom.nodeTypes.X3DGeometricPropertyNode.superClass.call(this,e)})),x3dom.registerNodeType("X3DCoordinateNode","Rendering",defineClass(x3dom.nodeTypes.X3DGeometricPropertyNode,function(e){x3dom.nodeTypes.X3DCoordinateNode.superClass.call(this,e)},{fieldChanged:function(){Array.forEach(this._parentNodes,function(e){e.fieldChanged("coord")})},parentAdded:function(e){e._mesh&&e._cf.coord.node!==this&&e.fieldChanged("coord")}})),x3dom.registerNodeType("Coordinate","Rendering",defineClass(x3dom.nodeTypes.X3DCoordinateNode,function(e){x3dom.nodeTypes.Coordinate.superClass.call(this,e),this.addField_MFVec3f(e,"point",[])},{getPoints:function(){return this._vf.point}})),x3dom.registerNodeType("Normal","Rendering",defineClass(x3dom.nodeTypes.X3DGeometricPropertyNode,function(e){x3dom.nodeTypes.Normal.superClass.call(this,e),this.addField_MFVec3f(e,"vector",[])},{fieldChanged:function(){Array.forEach(this._parentNodes,function(e){e.fieldChanged("normal")})},parentAdded:function(e){e._mesh&&e._cf.normal.node!==this&&e.fieldChanged("normal")}})),x3dom.registerNodeType("X3DColorNode","Rendering",defineClass(x3dom.nodeTypes.X3DGeometricPropertyNode,function(e){x3dom.nodeTypes.X3DColorNode.superClass.call(this,e)},{fieldChanged:function(){Array.forEach(this._parentNodes,function(e){e.fieldChanged("color")})},parentAdded:function(e){e._mesh&&e._cf.color.node!==this&&e.fieldChanged("color")}})),x3dom.registerNodeType("Color","Rendering",defineClass(x3dom.nodeTypes.X3DColorNode,function(e){x3dom.nodeTypes.Color.superClass.call(this,e),this.addField_MFColor(e,"color",[])})),x3dom.registerNodeType("ColorRGBA","Rendering",defineClass(x3dom.nodeTypes.X3DColorNode,function(e){x3dom.nodeTypes.ColorRGBA.superClass.call(this,e),this.addField_MFColorRGBA(e,"color",[])})),x3dom.registerNodeType("X3DAppearanceNode","Shape",defineClass(x3dom.nodeTypes.X3DNode,function(e){x3dom.nodeTypes.X3DAppearanceNode.superClass.call(this,e)})),x3dom.registerNodeType("Appearance","Shape",defineClass(x3dom.nodeTypes.X3DAppearanceNode,function(e){x3dom.nodeTypes.Appearance.superClass.call(this,e),this.addField_SFNode("material",x3dom.nodeTypes.X3DMaterialNode),this.addField_SFNode("texture",x3dom.nodeTypes.X3DTextureNode),this.addField_SFNode("textureTransform",x3dom.nodeTypes.X3DTextureTransformNode),this.addField_SFNode("blendMode",x3dom.nodeTypes.BlendMode),this.addField_SFNode("depthMode",x3dom.nodeTypes.DepthMode),this.addField_MFNode("shaders",x3dom.nodeTypes.X3DShaderNode),this._shader=null},{nodeChanged:function(){this._cf.material.node||this.addChild(x3dom.nodeTypes.Material.defaultNode()),this._cf.shaders.nodes.length&&(this._shader=this._cf.shaders.nodes[0])},texTransformMatrix:function(){return null===this._cf.textureTransform.node?x3dom.fields.SFMatrix4f.identity():this._cf.textureTransform.node.texTransformMatrix()}})),x3dom.nodeTypes.Appearance.defaultNode=function(){return x3dom.nodeTypes.Appearance._defaultNode||(x3dom.nodeTypes.Appearance._defaultNode=new x3dom.nodeTypes.Appearance,x3dom.nodeTypes.Appearance._defaultNode.nodeChanged()),x3dom.nodeTypes.Appearance._defaultNode},x3dom.registerNodeType("X3DAppearanceChildNode","Shape",defineClass(x3dom.nodeTypes.X3DNode,function(e){x3dom.nodeTypes.X3DAppearanceChildNode.superClass.call(this,e)})),x3dom.registerNodeType("BlendMode","Shape",defineClass(x3dom.nodeTypes.X3DAppearanceChildNode,function(e){x3dom.nodeTypes.BlendMode.superClass.call(this,e),this.addField_SFString(e,"srcFactor","src_alpha"),this.addField_SFString(e,"destFactor","one_minus_src_alpha"),this.addField_SFColor(e,"color",1,1,1),this.addField_SFFloat(e,"colorTransparency",0),this.addField_SFString(e,"alphaFunc","none"),this.addField_SFFloat(e,"alphaFuncValue",0),this.addField_SFString(e,"equation","none")})),x3dom.registerNodeType("DepthMode","Shape",defineClass(x3dom.nodeTypes.X3DAppearanceChildNode,function(e){x3dom.nodeTypes.DepthMode.superClass.call(this,e),this.addField_SFBool(e,"enableDepthTest",!0),this.addField_SFString(e,"depthFunc","none"),this.addField_SFBool(e,"readOnly",!1),this.addField_SFFloat(e,"zNearRange",-1),this.addField_SFFloat(e,"zFarRange",-1)})),x3dom.registerNodeType("X3DMaterialNode","Shape",defineClass(x3dom.nodeTypes.X3DAppearanceChildNode,function(e){x3dom.nodeTypes.X3DMaterialNode.superClass.call(this,e)})),x3dom.registerNodeType("Material","Shape",defineClass(x3dom.nodeTypes.X3DMaterialNode,function(e){x3dom.nodeTypes.Material.superClass.call(this,e),this.addField_SFFloat(e,"ambientIntensity",.2),this.addField_SFColor(e,"diffuseColor",.8,.8,.8),this.addField_SFColor(e,"emissiveColor",0,0,0),this.addField_SFFloat(e,"shininess",.2),this.addField_SFColor(e,"specularColor",0,0,0),this.addField_SFFloat(e,"transparency",0)},{fieldChanged:function(e){("ambientIntensity"==e||"diffuseColor"==e||"emissiveColor"==e||"shininess"==e||"specularColor"==e||"transparency"==e)&&Array.forEach(this._parentNodes,function(e){Array.forEach(e._parentNodes,function(e){e._dirty.material=!0})})}})),x3dom.nodeTypes.Material.defaultNode=function(){return x3dom.nodeTypes.Material._defaultNode||(x3dom.nodeTypes.Material._defaultNode=new x3dom.nodeTypes.Material,x3dom.nodeTypes.Material._defaultNode.nodeChanged()),x3dom.nodeTypes.Material._defaultNode},x3dom.registerNodeType("X3DShapeNode","Shape",defineClass(x3dom.nodeTypes.X3DChildNode,function(e){x3dom.nodeTypes.X3DShapeNode.superClass.call(this,e),this.addField_SFNode("appearance",x3dom.nodeTypes.X3DAppearanceNode),this.addField_SFNode("geometry",x3dom.nodeTypes.X3DGeometryNode),this._objectID=0,this._dirty={positions:!0,normals:!0,texcoords:!0,colors:!0,indexes:!0,texture:!0,material:!0,text:!0,shader:!0}},{collectDrawableObjects:function(e,t){null!==t&&t.push([e,this])},getVolume:function(e,t,i){return this._cf.geometry.node?this._cf.geometry.node.getVolume(e,t,i):!1},getCenter:function(){return this._cf.geometry.node?this._cf.geometry.node.getCenter():new x3dom.fields.SFVec3f(0,0,0)},doIntersect:function(e){return this._cf.geometry.node.doIntersect(e)},isSolid:function(){return this._cf.geometry.node._vf.solid},isCCW:function(){return this._cf.geometry.node._vf.ccw},setAllDirty:function(){this._dirty.positions=!0,this._dirty.normals=!0,this._dirty.texcoords=!0,this._dirty.colors=!0,this._dirty.indexes=!0,this._dirty.texture=!0,this._dirty.material=!0,this._dirty.text=!0,this._dirty.shader=!0}})),x3dom.registerNodeType("Shape","Shape",defineClass(x3dom.nodeTypes.X3DShapeNode,function(e){x3dom.nodeTypes.Shape.superClass.call(this,e)},{nodeChanged:function(){this._cf.appearance.node||this.addChild(x3dom.nodeTypes.Appearance.defaultNode()),this._cf.geometry.node?!this._objectID&&this._cf.geometry.node._pickable&&(this._objectID=++x3dom.nodeTypes.Shape.objectID,x3dom.nodeTypes.Shape.idMap.nodeID[this._objectID]=this):x3dom.debug.logError("No geometry given in Shape/"+this._DEF)},parentRemoved:function(){if(0===this._parentNodes.length&&this._webgl){for(var e=this.findX3DDoc(),t=e.ctx.ctx3d,i=this._webgl.shader,r=0;void 0!==this._webgl.texture&&r<this._webgl.texture.length;r++)this._webgl.texture[r]&&t.deleteTexture(this._webgl.texture[r]);for(var n=0;n<this._webgl.positions.length;n++)void 0!==i.position&&(t.deleteBuffer(this._webgl.buffers[5*n+1]),t.deleteBuffer(this._webgl.buffers[5*n+0])),void 0!==i.normal&&t.deleteBuffer(this._webgl.buffers[5*n+2]),void 0!==i.texcoord&&t.deleteBuffer(this._webgl.buffers[5*n+3]),void 0!==i.color&&t.deleteBuffer(this._webgl.buffers[5*n+4]);for(var o=0;o<this._webgl.dynamicFields.length;o++){var s=this._webgl.dynamicFields[o];void 0!==i[s.name]&&t.deleteBuffer(s.buf)}this._webgl=null}}})),x3dom.nodeTypes.Shape.objectID=0,x3dom.nodeTypes.Shape.idMap={nodeID:{},remove:function(e){for(var t in this.nodeID)if(this.nodeID.hasOwnProperty(t)){var i=this.nodeID[t];i._objectID&&e._objectID&&i._objectID===e._objectID&&(delete this.nodeID[t],x3dom.debug.logInfo("Unreg "+i._objectID))}}},x3dom.registerNodeType("X3DLightNode","Lighting",defineClass(x3dom.nodeTypes.X3DChildNode,function(e){x3dom.nodeTypes.X3DLightNode.superClass.call(this,e),e.doc._nodeBag.lights.push(this),this._lightID=0,this._dirty=!0,this.addField_SFFloat(e,"ambientIntensity",0),this.addField_SFColor(e,"color",1,1,1),this.addField_SFFloat(e,"intensity",1),this.addField_SFBool(e,"global",!1),this.addField_SFBool(e,"on",!0),this.addField_SFFloat(e,"shadowIntensity",0)},{getViewMatrix:function(){return x3dom.fields.SFMatrix4f.identity},nodeChanged:function(){this._lightID||(this._lightID=++x3dom.nodeTypes.X3DLightNode.lightID)},fieldChanged:function(){this._dirty=!0},parentRemoved:function(){if(0===this._parentNodes.length)for(var e=this.findX3DDoc(),t=0,i=e._nodeBag.lights.length;i>t;t++)e._nodeBag.lights[t]===this&&e._nodeBag.lights.splice(t,1)}})),x3dom.nodeTypes.X3DLightNode.lightID=0,x3dom.registerNodeType("DirectionalLight","Lighting",defineClass(x3dom.nodeTypes.X3DLightNode,function(e){x3dom.nodeTypes.DirectionalLight.superClass.call(this,e),this.addField_SFVec3f(e,"direction",0,0,-1)},{getViewMatrix:function(e){var t=this._vf.direction.normalize(),i=x3dom.fields.Quaternion.rotateFromTo(new x3dom.fields.SFVec3f(0,0,-1),t);return i.toMatrix().transpose().mult(x3dom.fields.SFMatrix4f.translation(e.negate()))}})),x3dom.registerNodeType("PointLight","Lighting",defineClass(x3dom.nodeTypes.X3DLightNode,function(e){x3dom.nodeTypes.PointLight.superClass.call(this,e),this.addField_SFVec3f(e,"attenuation",1,0,0),this.addField_SFVec3f(e,"location",0,0,0),this.addField_SFFloat(e,"radius",100),this._vf.global=!0},{getViewMatrix:function(e){var t=this._vf.location,i=x3dom.fields.Quaternion.rotateFromTo(new x3dom.fields.SFVec3f(0,0,-1),e);return i.toMatrix().transpose().mult(x3dom.fields.SFMatrix4f.translation(t.negate()))}})),x3dom.registerNodeType("SpotLight","Lighting",defineClass(x3dom.nodeTypes.X3DLightNode,function(e){x3dom.nodeTypes.SpotLight.superClass.call(this,e),this.addField_SFVec3f(e,"direction",0,0,-1),this.addField_SFVec3f(e,"attenuation",1,0,0),this.addField_SFVec3f(e,"location",0,0,0),this.addField_SFFloat(e,"radius",100),this.addField_SFFloat(e,"beamWidth",1.5707963),this.addField_SFFloat(e,"cutOffAngle",1.5707963),this._vf.global=!0},{getViewMatrix:function(){var e=this._vf.location,t=this._vf.direction.normalize(),i=x3dom.fields.Quaternion.rotateFromTo(new x3dom.fields.SFVec3f(0,0,-1),t);return i.toMatrix().transpose().mult(x3dom.fields.SFMatrix4f.translation(e.negate()))}})),x3dom.registerNodeType("X3DFollowerNode","Followers",defineClass(x3dom.nodeTypes.X3DChildNode,function(e){x3dom.nodeTypes.X3DFollowerNode.superClass.call(this,e),e.doc._nodeBag.followers.push(this),this.addField_SFBool(e,"isActive",!1)},{nodeChanged:function(){},fieldChanged:function(){},parentRemoved:function(){if(0===this._parentNodes.length)for(var e=this.findX3DDoc(),t=0,i=e._nodeBag.followers.length;i>t;t++)e._nodeBag.followers[t]===this&&e._nodeBag.followers.splice(t,1)},tick:function(){return!1},stepResponse:function(e){return 0>=e?0:e>=this._vf.duration?1:this.stepResponseCore(e/this._vf.duration)},stepResponseCore:function(e){return.5-.5*Math.cos(e*Math.PI)}})),x3dom.registerNodeType("X3DChaserNode","Followers",defineClass(x3dom.nodeTypes.X3DFollowerNode,function(e){x3dom.nodeTypes.X3DChaserNode.superClass.call(this,e),this.addField_SFTime(e,"duration",0),this._initDone=!1,this._stepTime=0,this._currTime=0,this._bufferEndTime=0,this._numSupports=60},{nodeChanged:function(){},fieldChanged:function(){}})),x3dom.registerNodeType("X3DDamperNode","Followers",defineClass(x3dom.nodeTypes.X3DFollowerNode,function(e){x3dom.nodeTypes.X3DDamperNode.superClass.call(this,e),this.addField_SFTime(e,"tau",0),this.addField_SFFloat(e,"tolerance",-1),this.addField_SFInt32(e,"order",0),this._eps=this._vf.tolerance<0?.001:this._vf.tolerance,this._lastTick=0
},{nodeChanged:function(){},fieldChanged:function(e){"tolerance"===e&&(this._eps=this._vf.tolerance<0?.001:this._vf.tolerance)}})),x3dom.registerNodeType("ColorChaser","Followers",defineClass(x3dom.nodeTypes.X3DChaserNode,function(e){x3dom.nodeTypes.ColorChaser.superClass.call(this,e),this.addField_SFColor(e,"initialDestination",.8,.8,.8),this.addField_SFColor(e,"initialValue",.8,.8,.8),this.addField_SFColor(e,"set_value",0,0,0),this.addField_SFColor(e,"set_destination",0,0,0),this._buffer=new x3dom.fields.MFColor,this._previousValue=new x3dom.fields.SFColor(0,0,0),this._value=new x3dom.fields.SFColor(0,0,0)},{nodeChanged:function(){this.initialize()},fieldChanged:function(e){if(e.indexOf("set_destination")>=0)this.initialize(),this.updateBuffer(this._currTime),this._vf.isActive||this.postMessage("isActive",!0);else if(e.indexOf("set_value")>=0){this.initialize(),this._previousValue.setValues(this._vf.set_value);for(var t=1;t<this._buffer.length;t++)this._buffer[t].setValues(this._vf.set_value);this.postMessage("value_changed",this._vf.set_value),this._vf.isActive||this.postMessage("isActive",!0)}},initialize:function(){if(!this._initDone){this._initDone=!0,this._vf.set_destination=this._vf.initialDestination,this._buffer.length=this._numSupports,this._buffer[0]=this._vf.initialDestination;for(var e=1;e<this._buffer.length;e++)this._buffer[e]=this._vf.initialValue;this._previousValue=this._vf.initialValue,this._stepTime=this._vf.duration/this._numSupports;var t=!this._buffer[0].equals(this._buffer[1],x3dom.fields.Eps);this._vf.isActive!==t&&this.postMessage("isActive",t)}},tick:function(e){if(this.initialize(),this._currTime=e,!this._bufferEndTime)return this._bufferEndTime=e,this._value=this._vf.initialValue,this.postMessage("value_changed",this._value),!0;var t=this.updateBuffer(e),i=this._previousValue,r=this._buffer[this._buffer.length-1].subtract(this._previousValue),n=r.multiply(this.stepResponse((this._buffer.length-1+t)*this._stepTime));i=i.add(n);for(var o=this._buffer.length-2;o>=0;o--)r=this._buffer[o].subtract(this._buffer[o+1]),n=r.multiply(this.stepResponse((o+t)*this._stepTime)),i=i.add(n);return i.equals(this._value,x3dom.fields.Eps)?this.postMessage("isActive",!1):(this._value.setValues(i),this.postMessage("value_changed",this._value)),this._vf.isActive},updateBuffer:function(e){var t,i,r,n=(e-this._bufferEndTime)/this._stepTime;if(n>=1){if(i=Math.floor(n),n-=i,i<this._buffer.length){for(this._previousValue=this._buffer[this._buffer.length-i],t=this._buffer.length-1;t>=i;t--)this._buffer[t]=this._buffer[t-i];for(t=0;i>t;t++)r=t/i,this._buffer[t]=this._buffer[i].multiply(r).add(this._vf.set_destination.multiply(1-r))}else for(this._previousValue=i==this._buffer.length?this._buffer[0]:this._vf.set_destination,t=0;t<this._buffer.length;t++)this._buffer[t]=this._vf.set_destination;this._bufferEndTime+=i*this._stepTime}return n}})),x3dom.registerNodeType("ColorDamper","Followers",defineClass(x3dom.nodeTypes.X3DDamperNode,function(e){x3dom.nodeTypes.ColorDamper.superClass.call(this,e),this.addField_SFColor(e,"initialDestination",.8,.8,.8),this.addField_SFColor(e,"initialValue",.8,.8,.8),this.addField_SFColor(e,"set_value",0,0,0),this.addField_SFColor(e,"set_destination",0,0,0),this._value0=new x3dom.fields.SFColor(0,0,0),this._value1=new x3dom.fields.SFColor(0,0,0),this._value2=new x3dom.fields.SFColor(0,0,0),this._value3=new x3dom.fields.SFColor(0,0,0),this._value4=new x3dom.fields.SFColor(0,0,0),this._value5=new x3dom.fields.SFColor(0,0,0),this.initialize()},{nodeChanged:function(){},fieldChanged:function(e){e.indexOf("set_destination")>=0?this._value0.equals(this._vf.set_destination,this._eps)||(this._value0=this._vf.set_destination,this._vf.isActive||this.postMessage("isActive",!0)):e.indexOf("set_value")>=0&&(this._value1.setValues(this._vf.set_value),this._value2.setValues(this._vf.set_value),this._value3.setValues(this._vf.set_value),this._value4.setValues(this._vf.set_value),this._value5.setValues(this._vf.set_value),this._lastTick=0,this.postMessage("value_changed",this._value5),this._vf.isActive||(this._lastTick=0,this.postMessage("isActive",!0)))},initialize:function(){this._value0.setValues(this._vf.initialDestination),this._value1.setValues(this._vf.initialValue),this._value2.setValues(this._vf.initialValue),this._value3.setValues(this._vf.initialValue),this._value4.setValues(this._vf.initialValue),this._value5.setValues(this._vf.initialValue),this._lastTick=0;var e=!this._value0.equals(this._value1,this._eps);this._vf.isActive!==e&&this.postMessage("isActive",e)},distance:function(e,t){var i=e.subtract(t);return Math.sqrt(i.r*i.r+i.g*i.g+i.b*i.b)},tick:function(e){if(!this._lastTick)return this._lastTick=e,!1;var t=e-this._lastTick,i=Math.exp(-t/this._vf.tau);this._value1=this._vf.order>0&&this._vf.tau?this._value0.add(this._value1.subtract(this._value0).multiply(i)):new x3dom.fields.SFColor(this._value0.r,this._value0.g,this._value0.b),this._value2=this._vf.order>1&&this._vf.tau?this._value1.add(this._value2.subtract(this._value1).multiply(i)):new x3dom.fields.SFColor(this._value1.r,this._value1.g,this._value1.b),this._value3=this._vf.order>2&&this._vf.tau?this._value2.add(this._value3.subtract(this._value2).multiply(i)):new x3dom.fields.SFColor(this._value2.r,this._value2.g,this._value2.b),this._value4=this._vf.order>3&&this._vf.tau?this._value3.add(this._value4.subtract(this._value3).multiply(i)):new x3dom.fields.SFColor(this._value3.r,this._value3.g,this._value3.b),this._value5=this._vf.order>4&&this._vf.tau?this._value4.add(this._value5.subtract(this._value4).multiply(i)):new x3dom.fields.SFColor(this._value4.r,this._value4.g,this._value4.b);var r=this.distance(this._value1,this._value0);if(this._vf.order>1){var n=this.distance(this._value2,this._value1);n>r&&(r=n)}if(this._vf.order>2){var o=this.distance(this._value3,this._value2);o>r&&(r=o)}if(this._vf.order>3){var s=this.distance(this._value4,this._value3);s>r&&(r=s)}if(this._vf.order>4){var a=this.distance(this._value5,this._value4);a>r&&(r=a)}return r<this._eps?(this._value1.setValues(this._value0),this._value2.setValues(this._value0),this._value3.setValues(this._value0),this._value4.setValues(this._value0),this._value5.setValues(this._value0),this.postMessage("value_changed",this._value0),this.postMessage("isActive",!1),this._lastTick=0,!1):(this.postMessage("value_changed",this._value5),this._lastTick=e,!0)}})),x3dom.registerNodeType("OrientationChaser","Followers",defineClass(x3dom.nodeTypes.X3DChaserNode,function(e){x3dom.nodeTypes.OrientationChaser.superClass.call(this,e),this.addField_SFRotation(e,"initialDestination",0,1,0,0),this.addField_SFRotation(e,"initialValue",0,1,0,0),this.addField_SFRotation(e,"set_value",0,1,0,0),this.addField_SFRotation(e,"set_destination",0,1,0,0),this._numSupports=30,this._buffer=new x3dom.fields.MFRotation,this._previousValue=new x3dom.fields.Quaternion(0,1,0,0),this._value=new x3dom.fields.Quaternion(0,1,0,0)},{nodeChanged:function(){this.initialize()},fieldChanged:function(e){if(e.indexOf("set_destination")>=0)this.initialize(),this.updateBuffer(this._currTime),this._vf.isActive||this.postMessage("isActive",!0);else if(e.indexOf("set_value")>=0){this.initialize(),this._previousValue.setValues(this._vf.set_value);for(var t=1;t<this._buffer.length;t++)this._buffer[t].setValues(this._vf.set_value);this.postMessage("value_changed",this._vf.set_value),this._vf.isActive||this.postMessage("isActive",!0)}},initialize:function(){if(!this._initDone){this._initDone=!0,this._vf.set_destination=this._vf.initialDestination,this._buffer.length=this._numSupports,this._buffer[0]=this._vf.initialDestination;for(var e=1;e<this._buffer.length;e++)this._buffer[e]=this._vf.initialValue;this._previousValue=this._vf.initialValue,this._stepTime=this._vf.duration/this._numSupports;var t=!this._buffer[0].equals(this._buffer[1],x3dom.fields.Eps);this._vf.isActive!==t&&this.postMessage("isActive",t)}},tick:function(e){if(this.initialize(),this._currTime=e,!this._bufferEndTime)return this._bufferEndTime=e,this._value=this._vf.initialValue,this.postMessage("value_changed",this._value),!0;var t=this.updateBuffer(e),i=this._previousValue,r=this._previousValue.inverse().multiply(this._buffer[this._buffer.length-1]);i=i.slerp(i.multiply(r),this.stepResponse((this._buffer.length-1+t)*this._stepTime));for(var n=this._buffer.length-2;n>=0;n--)r=this._buffer[n+1].inverse().multiply(this._buffer[n]),i=i.slerp(i.multiply(r),this.stepResponse((n+t)*this._stepTime));return i.equals(this._value,x3dom.fields.Eps)?this.postMessage("isActive",!1):(i=i.normalize(i),this._value.setValues(i),this.postMessage("value_changed",this._value)),this._vf.isActive},updateBuffer:function(e){var t,i,r,n=(e-this._bufferEndTime)/this._stepTime;if(n>=1){if(i=Math.floor(n),n-=i,i<this._buffer.length){for(this._previousValue=this._buffer[this._buffer.length-i],t=this._buffer.length-1;t>=i;t--)this._buffer[t]=this._buffer[t-i];for(t=0;i>t;t++)r=t/i,this._buffer[t]=this._vf.set_destination.slerp(this._buffer[i],r)}else for(this._previousValue=i==this._buffer.length?this._buffer[0]:this._vf.set_destination,t=0;t<this._buffer.length;t++)this._buffer[t]=this._vf.set_destination;this._bufferEndTime+=i*this._stepTime}return n}})),x3dom.registerNodeType("OrientationDamper","Followers",defineClass(x3dom.nodeTypes.X3DDamperNode,function(e){x3dom.nodeTypes.OrientationDamper.superClass.call(this,e),this.addField_SFRotation(e,"initialDestination",0,1,0,0),this.addField_SFRotation(e,"initialValue",0,1,0,0),this.addField_SFRotation(e,"set_value",0,1,0,0),this.addField_SFRotation(e,"set_destination",0,1,0,0),this._value0=new x3dom.fields.Quaternion(0,1,0,0),this._value1=new x3dom.fields.Quaternion(0,1,0,0),this._value2=new x3dom.fields.Quaternion(0,1,0,0),this._value3=new x3dom.fields.Quaternion(0,1,0,0),this._value4=new x3dom.fields.Quaternion(0,1,0,0),this._value5=new x3dom.fields.Quaternion(0,1,0,0),this.initialize()},{nodeChanged:function(){},fieldChanged:function(e){e.indexOf("set_destination")>=0?this._value0.equals(this._vf.set_destination,this._eps)||(this._value0=this._vf.set_destination,this._vf.isActive||this.postMessage("isActive",!0)):e.indexOf("set_value")>=0&&(this._value1.setValues(this._vf.set_value),this._value2.setValues(this._vf.set_value),this._value3.setValues(this._vf.set_value),this._value4.setValues(this._vf.set_value),this._value5.setValues(this._vf.set_value),this._lastTick=0,this.postMessage("value_changed",this._value5),this._vf.isActive||(this._lastTick=0,this.postMessage("isActive",!0)))},initialize:function(){this._value0.setValues(this._vf.initialDestination),this._value1.setValues(this._vf.initialValue),this._value2.setValues(this._vf.initialValue),this._value3.setValues(this._vf.initialValue),this._value4.setValues(this._vf.initialValue),this._value5.setValues(this._vf.initialValue),this._lastTick=0;var e=!this._value0.equals(this._value1,this._eps);this._vf.isActive!==e&&this.postMessage("isActive",e)},tick:function(e){if(!this._lastTick)return this._lastTick=e,!1;var t=e-this._lastTick,i=Math.exp(-t/this._vf.tau);this._value1=this._vf.order>0&&this._vf.tau?this._value0.slerp(this._value1,i):new x3dom.fields.Quaternion(this._value0.x,this._value0.y,this._value0.z,this._value0.w),this._value2=this._vf.order>1&&this._vf.tau?this._value1.slerp(this._value2,i):new x3dom.fields.Quaternion(this._value1.x,this._value1.y,this._value1.z,this._value1.w),this._value3=this._vf.order>2&&this._vf.tau?this._value2.slerp(this._value3,i):new x3dom.fields.Quaternion(this._value2.x,this._value2.y,this._value2.z,this._value2.w),this._value4=this._vf.order>3&&this._vf.tau?this._value3.slerp(this._value4,i):new x3dom.fields.Quaternion(this._value3.x,this._value3.y,this._value3.z,this._value3.w),this._value5=this._vf.order>4&&this._vf.tau?this._value4.slerp(this._value5,i):new x3dom.fields.Quaternion(this._value4.x,this._value4.y,this._value4.z,this._value4.w);var r=Math.abs(this._value1.inverse().multiply(this._value0).angle());if(this._vf.order>1){var n=Math.abs(this._value2.inverse().multiply(this._value1).angle());n>r&&(r=n)}if(this._vf.order>2){var o=Math.abs(this._value3.inverse().multiply(this._value2).angle());o>r&&(r=o)}if(this._vf.order>3){var s=Math.abs(this._value4.inverse().multiply(this._value3).angle());s>r&&(r=s)}if(this._vf.order>4){var a=Math.abs(this._value5.inverse().multiply(this._value4).angle());a>r&&(r=a)}return r<this._eps?(this._value1.setValues(this._value0),this._value2.setValues(this._value0),this._value3.setValues(this._value0),this._value4.setValues(this._value0),this._value5.setValues(this._value0),this.postMessage("value_changed",this._value0),this.postMessage("isActive",!1),this._lastTick=0,!1):(this.postMessage("value_changed",this._value5),this._lastTick=e,!0)}})),x3dom.registerNodeType("PositionChaser","Followers",defineClass(x3dom.nodeTypes.X3DChaserNode,function(e){x3dom.nodeTypes.PositionChaser.superClass.call(this,e),this.addField_SFVec3f(e,"initialDestination",0,0,0),this.addField_SFVec3f(e,"initialValue",0,0,0),this.addField_SFVec3f(e,"set_value",0,0,0),this.addField_SFVec3f(e,"set_destination",0,0,0),this._buffer=new x3dom.fields.MFVec3f,this._previousValue=new x3dom.fields.SFVec3f(0,0,0),this._value=new x3dom.fields.SFVec3f(0,0,0)},{nodeChanged:function(){this.initialize()},fieldChanged:function(e){if(e.indexOf("set_destination")>=0)this.initialize(),this.updateBuffer(this._currTime),this._vf.isActive||this.postMessage("isActive",!0);else if(e.indexOf("set_value")>=0){this.initialize(),this._previousValue.setValues(this._vf.set_value);for(var t=1;t<this._buffer.length;t++)this._buffer[t].setValues(this._vf.set_value);this.postMessage("value_changed",this._vf.set_value),this._vf.isActive||this.postMessage("isActive",!0)}},initialize:function(){if(!this._initDone){this._initDone=!0,this._vf.set_destination=this._vf.initialDestination,this._buffer.length=this._numSupports,this._buffer[0]=this._vf.initialDestination;for(var e=1;e<this._buffer.length;e++)this._buffer[e]=this._vf.initialValue;this._previousValue=this._vf.initialValue,this._stepTime=this._vf.duration/this._numSupports;var t=!this._buffer[0].equals(this._buffer[1],x3dom.fields.Eps);this._vf.isActive!==t&&this.postMessage("isActive",t)}},tick:function(e){if(this.initialize(),this._currTime=e,!this._bufferEndTime)return this._bufferEndTime=e,this._value=this._vf.initialValue,this.postMessage("value_changed",this._value),!0;var t=this.updateBuffer(e),i=this._previousValue,r=this._buffer[this._buffer.length-1].subtract(this._previousValue),n=r.multiply(this.stepResponse((this._buffer.length-1+t)*this._stepTime));i=i.add(n);for(var o=this._buffer.length-2;o>=0;o--)r=this._buffer[o].subtract(this._buffer[o+1]),n=r.multiply(this.stepResponse((o+t)*this._stepTime)),i=i.add(n);return i.equals(this._value,x3dom.fields.Eps)?this.postMessage("isActive",!1):(this._value.setValues(i),this.postMessage("value_changed",this._value)),this._vf.isActive},updateBuffer:function(e){var t,i,r,n=(e-this._bufferEndTime)/this._stepTime;if(n>=1){if(i=Math.floor(n),n-=i,i<this._buffer.length){for(this._previousValue=this._buffer[this._buffer.length-i],t=this._buffer.length-1;t>=i;t--)this._buffer[t]=this._buffer[t-i];for(t=0;i>t;t++)r=t/i,this._buffer[t]=this._buffer[i].multiply(r).add(this._vf.set_destination.multiply(1-r))}else for(this._previousValue=i==this._buffer.length?this._buffer[0]:this._vf.set_destination,t=0;t<this._buffer.length;t++)this._buffer[t]=this._vf.set_destination;this._bufferEndTime+=i*this._stepTime}return n}})),x3dom.registerNodeType("PositionChaser2D","Followers",defineClass(x3dom.nodeTypes.X3DChaserNode,function(e){x3dom.nodeTypes.PositionChaser2D.superClass.call(this,e),this.addField_SFVec2f(e,"initialDestination",0,0),this.addField_SFVec2f(e,"initialValue",0,0),this.addField_SFVec2f(e,"set_value",0,0),this.addField_SFVec2f(e,"set_destination",0,0),this._buffer=new x3dom.fields.MFVec2f,this._previousValue=new x3dom.fields.SFVec2f(0,0),this._value=new x3dom.fields.SFVec2f(0,0)},{nodeChanged:function(){this.initialize()},fieldChanged:function(e){if(e.indexOf("set_destination")>=0)this.initialize(),this.updateBuffer(this._currTime),this._vf.isActive||this.postMessage("isActive",!0);else if(e.indexOf("set_value")>=0){this.initialize(),this._previousValue.setValues(this._vf.set_value);for(var t=1;t<this._buffer.length;t++)this._buffer[t].setValues(this._vf.set_value);this.postMessage("value_changed",this._vf.set_value),this._vf.isActive||this.postMessage("isActive",!0)}},initialize:function(){if(!this._initDone){this._initDone=!0,this._vf.set_destination=this._vf.initialDestination,this._buffer.length=this._numSupports,this._buffer[0]=this._vf.initialDestination;for(var e=1;e<this._buffer.length;e++)this._buffer[e]=this._vf.initialValue;this._previousValue=this._vf.initialValue,this._stepTime=this._vf.duration/this._numSupports;var t=!this._buffer[0].equals(this._buffer[1],x3dom.fields.Eps);this._vf.isActive!==t&&this.postMessage("isActive",t)}},tick:function(e){if(this.initialize(),this._currTime=e,!this._bufferEndTime)return this._bufferEndTime=e,this._value=this._vf.initialValue,this.postMessage("value_changed",this._value),!0;var t=this.updateBuffer(e),i=this._previousValue,r=this._buffer[this._buffer.length-1].subtract(this._previousValue),n=r.multiply(this.stepResponse((this._buffer.length-1+t)*this._stepTime));i=i.add(n);for(var o=this._buffer.length-2;o>=0;o--)r=this._buffer[o].subtract(this._buffer[o+1]),n=r.multiply(this.stepResponse((o+t)*this._stepTime)),i=i.add(n);return i.equals(this._value,x3dom.fields.Eps)?this.postMessage("isActive",!1):(this._value.setValues(i),this.postMessage("value_changed",this._value)),this._vf.isActive},updateBuffer:function(e){var t,i,r,n=(e-this._bufferEndTime)/this._stepTime;if(n>=1){if(i=Math.floor(n),n-=i,i<this._buffer.length){for(this._previousValue=this._buffer[this._buffer.length-i],t=this._buffer.length-1;t>=i;t--)this._buffer[t]=this._buffer[t-i];for(t=0;i>t;t++)r=t/i,this._buffer[t]=this._buffer[i].multiply(r).add(this._vf.set_destination.multiply(1-r))}else for(this._previousValue=i==this._buffer.length?this._buffer[0]:this._vf.set_destination,t=0;t<this._buffer.length;t++)this._buffer[t]=this._vf.set_destination;this._bufferEndTime+=i*this._stepTime}return n}})),x3dom.registerNodeType("PositionDamper","Followers",defineClass(x3dom.nodeTypes.X3DDamperNode,function(e){x3dom.nodeTypes.PositionDamper.superClass.call(this,e),this.addField_SFVec3f(e,"initialDestination",0,0,0),this.addField_SFVec3f(e,"initialValue",0,0,0),this.addField_SFVec3f(e,"set_value",0,0,0),this.addField_SFVec3f(e,"set_destination",0,0,0),this._value0=new x3dom.fields.SFVec3f(0,0,0),this._value1=new x3dom.fields.SFVec3f(0,0,0),this._value2=new x3dom.fields.SFVec3f(0,0,0),this._value3=new x3dom.fields.SFVec3f(0,0,0),this._value4=new x3dom.fields.SFVec3f(0,0,0),this._value5=new x3dom.fields.SFVec3f(0,0,0),this.initialize()},{nodeChanged:function(){},fieldChanged:function(e){e.indexOf("set_destination")>=0?this._value0.equals(this._vf.set_destination,this._eps)||(this._value0=this._vf.set_destination,this._vf.isActive||this.postMessage("isActive",!0)):e.indexOf("set_value")>=0&&(this._value1.setValues(this._vf.set_value),this._value2.setValues(this._vf.set_value),this._value3.setValues(this._vf.set_value),this._value4.setValues(this._vf.set_value),this._value5.setValues(this._vf.set_value),this._lastTick=0,this.postMessage("value_changed",this._value5),this._vf.isActive||(this._lastTick=0,this.postMessage("isActive",!0)))},initialize:function(){this._value0.setValues(this._vf.initialDestination),this._value1.setValues(this._vf.initialValue),this._value2.setValues(this._vf.initialValue),this._value3.setValues(this._vf.initialValue),this._value4.setValues(this._vf.initialValue),this._value5.setValues(this._vf.initialValue),this._lastTick=0;var e=!this._value0.equals(this._value1,this._eps);this._vf.isActive!==e&&this.postMessage("isActive",e)},tick:function(e){if(!this._lastTick)return this._lastTick=e,!1;var t=e-this._lastTick,i=Math.exp(-t/this._vf.tau);this._value1=this._vf.order>0&&this._vf.tau?this._value0.add(this._value1.subtract(this._value0).multiply(i)):new x3dom.fields.SFVec3f(this._value0.x,this._value0.y,this._value0.z),this._value2=this._vf.order>1&&this._vf.tau?this._value1.add(this._value2.subtract(this._value1).multiply(i)):new x3dom.fields.SFVec3f(this._value1.x,this._value1.y,this._value1.z),this._value3=this._vf.order>2&&this._vf.tau?this._value2.add(this._value3.subtract(this._value2).multiply(i)):new x3dom.fields.SFVec3f(this._value2.x,this._value2.y,this._value2.z),this._value4=this._vf.order>3&&this._vf.tau?this._value3.add(this._value4.subtract(this._value3).multiply(i)):new x3dom.fields.SFVec3f(this._value3.x,this._value3.y,this._value3.z),this._value5=this._vf.order>4&&this._vf.tau?this._value4.add(this._value5.subtract(this._value4).multiply(i)):new x3dom.fields.SFVec3f(this._value4.x,this._value4.y,this._value4.z);var r=this._value1.subtract(this._value0).length();if(this._vf.order>1){var n=this._value2.subtract(this._value1).length();n>r&&(r=n)}if(this._vf.order>2){var o=this._value3.subtract(this._value2).length();o>r&&(r=o)}if(this._vf.order>3){var s=this._value4.subtract(this._value3).length();s>r&&(r=s)}if(this._vf.order>4){var a=this._value5.subtract(this._value4).length();a>r&&(r=a)}return r<this._eps?(this._value1.setValues(this._value0),this._value2.setValues(this._value0),this._value3.setValues(this._value0),this._value4.setValues(this._value0),this._value5.setValues(this._value0),this.postMessage("value_changed",this._value0),this.postMessage("isActive",!1),this._lastTick=0,!1):(this.postMessage("value_changed",this._value5),this._lastTick=e,!0)}})),x3dom.registerNodeType("PositionDamper2D","Followers",defineClass(x3dom.nodeTypes.X3DDamperNode,function(e){x3dom.nodeTypes.PositionDamper2D.superClass.call(this,e),this.addField_SFVec2f(e,"initialDestination",0,0),this.addField_SFVec2f(e,"initialValue",0,0),this.addField_SFVec2f(e,"set_value",0,0),this.addField_SFVec2f(e,"set_destination",0,0),this._value0=new x3dom.fields.SFVec2f(0,0),this._value1=new x3dom.fields.SFVec2f(0,0),this._value2=new x3dom.fields.SFVec2f(0,0),this._value3=new x3dom.fields.SFVec2f(0,0),this._value4=new x3dom.fields.SFVec2f(0,0),this._value5=new x3dom.fields.SFVec2f(0,0),this.initialize()},{nodeChanged:function(){},fieldChanged:function(e){e.indexOf("set_destination")>=0?this._value0.equals(this._vf.set_destination,this._eps)||(this._value0=this._vf.set_destination,this._vf.isActive||this.postMessage("isActive",!0)):e.indexOf("set_value")>=0&&(this._value1.setValues(this._vf.set_value),this._value2.setValues(this._vf.set_value),this._value3.setValues(this._vf.set_value),this._value4.setValues(this._vf.set_value),this._value5.setValues(this._vf.set_value),this._lastTick=0,this.postMessage("value_changed",this._value5),this._vf.isActive||(this._lastTick=0,this.postMessage("isActive",!0)))},initialize:function(){this._value0.setValues(this._vf.initialDestination),this._value1.setValues(this._vf.initialValue),this._value2.setValues(this._vf.initialValue),this._value3.setValues(this._vf.initialValue),this._value4.setValues(this._vf.initialValue),this._value5.setValues(this._vf.initialValue),this._lastTick=0;var e=!this._value0.equals(this._value1,this._eps);this._vf.isActive!==e&&this.postMessage("isActive",e)},tick:function(e){if(!this._lastTick)return this._lastTick=e,!1;var t=e-this._lastTick,i=Math.exp(-t/this._vf.tau);this._value1=this._vf.order>0&&this._vf.tau?this._value0.add(this._value1.subtract(this._value0).multiply(i)):new x3dom.fields.SFVec2f(this._value0.x,this._value0.y,this._value0.z),this._value2=this._vf.order>1&&this._vf.tau?this._value1.add(this._value2.subtract(this._value1).multiply(i)):new x3dom.fields.SFVec2f(this._value1.x,this._value1.y,this._value1.z),this._value3=this._vf.order>2&&this._vf.tau?this._value2.add(this._value3.subtract(this._value2).multiply(i)):new x3dom.fields.SFVec2f(this._value2.x,this._value2.y,this._value2.z),this._value4=this._vf.order>3&&this._vf.tau?this._value3.add(this._value4.subtract(this._value3).multiply(i)):new x3dom.fields.SFVec2f(this._value3.x,this._value3.y,this._value3.z),this._value5=this._vf.order>4&&this._vf.tau?this._value4.add(this._value5.subtract(this._value4).multiply(i)):new x3dom.fields.SFVec2f(this._value4.x,this._value4.y,this._value4.z);var r=this._value1.subtract(this._value0).length();if(this._vf.order>1){var n=this._value2.subtract(this._value1).length();n>r&&(r=n)}if(this._vf.order>2){var o=this._value3.subtract(this._value2).length();o>r&&(r=o)}if(this._vf.order>3){var s=this._value4.subtract(this._value3).length();s>r&&(r=s)}if(this._vf.order>4){var a=this._value5.subtract(this._value4).length();a>r&&(r=a)}return r<this._eps?(this._value1.setValues(this._value0),this._value2.setValues(this._value0),this._value3.setValues(this._value0),this._value4.setValues(this._value0),this._value5.setValues(this._value0),this.postMessage("value_changed",this._value0),this.postMessage("isActive",!1),this._lastTick=0,!1):(this.postMessage("value_changed",this._value5),this._lastTick=e,!0)}})),x3dom.registerNodeType("ScalarChaser","Followers",defineClass(x3dom.nodeTypes.X3DChaserNode,function(e){x3dom.nodeTypes.ScalarChaser.superClass.call(this,e),this.addField_SFFloat(e,"initialDestination",0),this.addField_SFFloat(e,"initialValue",0),this.addField_SFFloat(e,"set_value",0),this.addField_SFFloat(e,"set_destination",0),this._buffer=[],this._previousValue=0,this._value=0},{nodeChanged:function(){this.initialize()},fieldChanged:function(e){if(e.indexOf("set_destination")>=0)this.initialize(),this.updateBuffer(this._currTime),this._vf.isActive||this.postMessage("isActive",!0);else if(e.indexOf("set_value")>=0){this.initialize(),this._previousValue=this._vf.set_value;for(var t=1;t<this._buffer.length;t++)this._buffer[t]=this._vf.set_value;this.postMessage("value_changed",this._vf.set_value),this._vf.isActive||this.postMessage("isActive",!0)}},initialize:function(){if(!this._initDone){this._initDone=!0,this._vf.set_destination=this._vf.initialDestination,this._buffer.length=this._numSupports,this._buffer[0]=this._vf.initialDestination;for(var e=1;e<this._buffer.length;e++)this._buffer[e]=this._vf.initialValue;this._previousValue=this._vf.initialValue,this._stepTime=this._vf.duration/this._numSupports;var t=Math.abs(this._buffer[0]-this._buffer[1])>=x3dom.fields.Eps;this._vf.isActive!==t&&this.postMessage("isActive",t)}},tick:function(e){if(this.initialize(),this._currTime=e,!this._bufferEndTime)return this._bufferEndTime=e,this._value=this._vf.initialValue,this.postMessage("value_changed",this._value),!0;var t=this.updateBuffer(e),i=this._previousValue,r=this._buffer[this._buffer.length-1]-this._previousValue,n=r*this.stepResponse((this._buffer.length-1+t)*this._stepTime);i+=n;for(var o=this._buffer.length-2;o>=0;o--)r=this._buffer[o]-this._buffer[o+1],n=r*this.stepResponse((o+t)*this._stepTime),i+=n;return Math.abs(i-this._value)>=x3dom.fields.Eps?(this._value=i,this.postMessage("value_changed",this._value)):this.postMessage("isActive",!1),this._vf.isActive},updateBuffer:function(e){var t,i,r,n=(e-this._bufferEndTime)/this._stepTime;if(n>=1){if(i=Math.floor(n),n-=i,i<this._buffer.length){for(this._previousValue=this._buffer[this._buffer.length-i],t=this._buffer.length-1;t>=i;t--)this._buffer[t]=this._buffer[t-i];for(t=0;i>t;t++)r=t/i,this._buffer[t]=this._buffer[i]*r+this._vf.set_destination*(1-r)}else for(this._previousValue=i==this._buffer.length?this._buffer[0]:this._vf.set_destination,t=0;t<this._buffer.length;t++)this._buffer[t]=this._vf.set_destination;this._bufferEndTime+=i*this._stepTime}return n}})),x3dom.registerNodeType("ScalarDamper","Followers",defineClass(x3dom.nodeTypes.X3DDamperNode,function(e){x3dom.nodeTypes.ScalarDamper.superClass.call(this,e),this.addField_SFFloat(e,"initialDestination",0),this.addField_SFFloat(e,"initialValue",0),this.addField_SFFloat(e,"set_value",0),this.addField_SFFloat(e,"set_destination",0),this._value0=0,this._value1=0,this._value2=0,this._value3=0,this._value4=0,this._value5=0,this.initialize()},{nodeChanged:function(){},fieldChanged:function(e){e.indexOf("set_destination")>=0?Math.abs(this._value0-this._vf.set_destination)>=this._eps&&(this._value0=this._vf.set_destination,this._vf.isActive||this.postMessage("isActive",!0)):e.indexOf("set_value")>=0&&(this._value1=this._vf.set_value,this._value2=this._vf.set_value,this._value3=this._vf.set_value,this._value4=this._vf.set_value,this._value5=this._vf.set_value,this._lastTick=0,this.postMessage("value_changed",this._value5),this._vf.isActive||(this._lastTick=0,this.postMessage("isActive",!0)))},initialize:function(){this._value0=this._vf.initialDestination,this._value1=this._vf.initialValue,this._value2=this._vf.initialValue,this._value3=this._vf.initialValue,this._value4=this._vf.initialValue,this._value5=this._vf.initialValue,this._lastTick=0;var e=Math.abs(this._value0-this._value1)>=this._eps;this._vf.isActive!==e&&this.postMessage("isActive",e)},tick:function(e){if(!this._lastTick)return this._lastTick=e,!1;var t=e-this._lastTick,i=Math.exp(-t/this._vf.tau);this._value1=this._vf.order>0&&this._vf.tau?this._value0+i*(this._value1-this._value0):this._value0,this._value2=this._vf.order>1&&this._vf.tau?this._value1+i*(this._value2-this._value1):this._value1,this._value3=this._vf.order>2&&this._vf.tau?this._value2+i*(this._value3-this._value2):this._value2,this._value4=this._vf.order>3&&this._vf.tau?this._value3+i*(this._value4-this._value3):this._value3,this._value5=this._vf.order>4&&this._vf.tau?this._value4+i*(this._value5-this._value4):this._value4;var r=Math.abs(this._value1-this._value0);if(this._vf.order>1){var n=Math.abs(this._value2-this._value1);n>r&&(r=n)}if(this._vf.order>2){var o=Math.abs(this._value3-this._value2);o>r&&(r=o)}if(this._vf.order>3){var s=Math.abs(this._value4-this._value3);s>r&&(r=s)}if(this._vf.order>4){var a=Math.abs(this._value5-this._value4);a>r&&(r=a)}return r<this._eps?(this._value1=this._value0,this._value2=this._value0,this._value3=this._value0,this._value4=this._value0,this._value5=this._value0,this.postMessage("value_changed",this._value0),this.postMessage("isActive",!1),this._lastTick=0,!1):(this.postMessage("value_changed",this._value5),this._lastTick=e,!0)}})),x3dom.registerNodeType("CoordinateDamper","Followers",defineClass(x3dom.nodeTypes.X3DDamperNode,function(e){x3dom.nodeTypes.CoordinateDamper.superClass.call(this,e),this.addField_MFVec3f(e,"initialDestination",[]),this.addField_MFVec3f(e,"initialValue",[]),this.addField_MFVec3f(e,"set_value",[]),this.addField_MFVec3f(e,"set_destination",[]),x3dom.debug.logWarning("CoordinateDamper NYI")},{nodeChanged:function(){},fieldChanged:function(){}})),x3dom.registerNodeType("TexCoordDamper2D","Followers",defineClass(x3dom.nodeTypes.X3DDamperNode,function(e){x3dom.nodeTypes.TexCoordDamper2D.superClass.call(this,e),this.addField_MFVec2f(e,"initialDestination",[]),this.addField_MFVec2f(e,"initialValue",[]),this.addField_MFVec2f(e,"set_value",[]),this.addField_MFVec2f(e,"set_destination",[]),x3dom.debug.logWarning("TexCoordDamper2D NYI")},{nodeChanged:function(){},fieldChanged:function(){}})),x3dom.registerNodeType("X3DInterpolatorNode","Interpolation",defineClass(x3dom.nodeTypes.X3DChildNode,function(e){x3dom.nodeTypes.X3DInterpolatorNode.superClass.call(this,e),this.addField_MFFloat(e,"key",[]),this.addField_SFFloat(e,"set_fraction",0)},{linearInterp:function(e,t){if(e<=this._vf.key[0])return this._vf.keyValue[0];if(e>=this._vf.key[this._vf.key.length-1])return this._vf.keyValue[this._vf.key.length-1];for(var i=0;i<this._vf.key.length-1;++i)if(this._vf.key[i]<e&&e<=this._vf.key[i+1])return t(this._vf.keyValue[i],this._vf.keyValue[i+1],(e-this._vf.key[i])/(this._vf.key[i+1]-this._vf.key[i]));return this._vf.keyValue[0]}})),x3dom.registerNodeType("OrientationInterpolator","Interpolation",defineClass(x3dom.nodeTypes.X3DInterpolatorNode,function(e){x3dom.nodeTypes.OrientationInterpolator.superClass.call(this,e),this._vf.keyValue=e&&e.xmlNode.hasAttribute("keyValue")?x3dom.fields.MFRotation.parse(e.xmlNode.getAttribute("keyValue")):new x3dom.fields.MFRotation,this._fieldWatchers.fraction=this._fieldWatchers.set_fraction=[function(e){var t=this.linearInterp(e,function(e,t,i){return e.slerp(t,i)
});this.postMessage("value_changed",t)}]})),x3dom.registerNodeType("PositionInterpolator","Interpolation",defineClass(x3dom.nodeTypes.X3DInterpolatorNode,function(e){x3dom.nodeTypes.PositionInterpolator.superClass.call(this,e),this._vf.keyValue=e&&e.xmlNode.hasAttribute("keyValue")?x3dom.fields.MFVec3f.parse(e.xmlNode.getAttribute("keyValue")):new x3dom.fields.MFVec3f,this._fieldWatchers.fraction=this._fieldWatchers.set_fraction=[function(e){var t=this.linearInterp(e,function(e,t,i){return e.multiply(1-i).add(t.multiply(i))});this.postMessage("value_changed",t)}]})),x3dom.registerNodeType("NormalInterpolator","Interpolation",defineClass(x3dom.nodeTypes.X3DInterpolatorNode,function(e){x3dom.nodeTypes.NormalInterpolator.superClass.call(this,e),this._vf.keyValue=e&&e.xmlNode.hasAttribute("keyValue")?x3dom.fields.MFVec3f.parse(e.xmlNode.getAttribute("keyValue")):new x3dom.fields.MFVec3f,this._fieldWatchers.fraction=this._fieldWatchers.set_fraction=[function(e){var t=this.linearInterp(e,function(e,t,i){return e.multiply(1-i).add(t.multiply(i)).normalize()});this.postMessage("value_changed",t)}]})),x3dom.registerNodeType("ColorInterpolator","Interpolation",defineClass(x3dom.nodeTypes.X3DInterpolatorNode,function(e){x3dom.nodeTypes.ColorInterpolator.superClass.call(this,e),this._vf.keyValue=e&&e.xmlNode.hasAttribute("keyValue")?x3dom.fields.MFColor.parse(e.xmlNode.getAttribute("keyValue")):new x3dom.fields.MFColor,this._fieldWatchers.fraction=this._fieldWatchers.set_fraction=[function(e){var t=this.linearInterp(e,function(e,t,i){return e.multiply(1-i).add(t.multiply(i))});this.postMessage("value_changed",t)}]})),x3dom.registerNodeType("ScalarInterpolator","Interpolation",defineClass(x3dom.nodeTypes.X3DInterpolatorNode,function(e){x3dom.nodeTypes.ScalarInterpolator.superClass.call(this,e),this._vf.keyValue=e&&e.xmlNode.hasAttribute("keyValue")?Array.map(e.xmlNode.getAttribute("keyValue").split(/\s+/),function(e){return+e}):new x3dom.fields.MFFloat,this._fieldWatchers.fraction=this._fieldWatchers.set_fraction=[function(e){var t=this.linearInterp(e,function(e,t,i){return(1-i)*e+i*t});this.postMessage("value_changed",t)}]})),x3dom.registerNodeType("CoordinateInterpolator","Interpolation",defineClass(x3dom.nodeTypes.X3DInterpolatorNode,function(e){if(x3dom.nodeTypes.CoordinateInterpolator.superClass.call(this,e),this._vf.keyValue=[],e&&e.xmlNode.hasAttribute("keyValue"))for(var t=x3dom.fields.MFVec3f.parse(e.xmlNode.getAttribute("keyValue")),i=this._vf.key.length>0?this._vf.key.length:1,r=t.length/i,n=0;i>n;n++){for(var o=new x3dom.fields.MFVec3f,s=0;r>s;s++)o.push(t[n*r+s]);this._vf.keyValue.push(o)}this._fieldWatchers.fraction=this._fieldWatchers.set_fraction=[function(e){var t=this.linearInterp(e,function(e,t,i){for(var r=new x3dom.fields.MFVec3f,n=0;n<e.length;n++)r.push(e[n].multiply(1-i).add(t[n].multiply(i)));return r});this.postMessage("value_changed",t)}]})),x3dom.registerNodeType("TimeSensor","Time",defineClass(x3dom.nodeTypes.X3DSensorNode,function(e){x3dom.nodeTypes.TimeSensor.superClass.call(this,e),e.doc._nodeBag.timer.push(this),this.addField_SFTime(e,"cycleInterval",1),this.addField_SFBool(e,"enabled",!0),this.addField_SFBool(e,"loop",!1),this.addField_SFTime(e,"startTime",0),this.addField_SFTime(e,"stopTime",0),this.addField_SFTime(e,"pauseTime",0),this.addField_SFTime(e,"resumeTime",0),this.addField_SFTime(e,"cycleTime",0),this.addField_SFFloat(e,"fraction_changed",0),this.addField_SFBool(e,"isActive",!1),this.addField_SFTime(e,"time",0),this.addField_SFBool(e,"first",!0),this.addField_SFFloat(e,"firstCycle",0),this._prevCycle=-1},{onframe:function(e){if(this._vf.enabled){var t,i,r,n=(e>=this._vf.startTime,e>=this._vf.pauseTime&&this._vf.pauseTime>this._vf.resumeTime,e>=this._vf.startTime);return n&&this._vf.cycleInterval>0&&(t=(e-this._vf.startTime)/this._vf.cycleInterval,i=Math.floor(t),1==this._vf.first&&(firstCycle=i),this._vf.first=!1,i-firstCycle>0&&0==this._vf.loop?r=1:(r=t-i,r<x3dom.fields.Eps&&e>this._vf.startTime&&(r=1))),n&&(this._vf.isActive||this.postMessage("isActive",!0),this.postMessage("fraction_changed",r),this.postMessage("time",e),this._prevCycle!=i)?(this._prevCycle=i,this.postMessage("cycleTime",e),void(this._vf.loop||this.postMessage("isActive",!1))):void 0}},fieldChanged:function(e){"enabled"==e&&!this._vf.enabled&&this._vf.isActive&&this.postMessage("isActive",!1)},parentRemoved:function(){if(0===this._parentNodes.length)for(var e=this.findX3DDoc(),t=0,i=e._nodeBag.timer.length;i>t;t++)e._nodeBag.timer[t]===this&&e._nodeBag.timer.splice(t,1)}})),x3dom.registerNodeType("X3DTimeDependentNode","Time",defineClass(x3dom.nodeTypes.X3DChildNode,function(e){x3dom.nodeTypes.X3DTimeDependentNode.superClass.call(this,e),this.addField_SFBool(e,"loop",!1)})),x3dom.registerNodeType("Anchor","Networking",defineClass(x3dom.nodeTypes.X3DGroupingNode,function(e){x3dom.nodeTypes.Anchor.superClass.call(this,e),this.addField_MFString(e,"url",[])},{doIntersect:function(e){for(var t=!1,i=0;i<this._childNodes.length;i++)this._childNodes[i]&&(t=this._childNodes[i].doIntersect(e)||t);return t},handleTouch:function(){window.location=this._nameSpace.getURL(this._vf.url[0])}})),x3dom.registerNodeType("Inline","Networking",defineClass(x3dom.nodeTypes.X3DGroupingNode,function(e){x3dom.nodeTypes.Inline.superClass.call(this,e),this.addField_MFString(e,"url",[]),this.addField_SFBool(e,"load",!0),this.addField_MFString(e,"nameSpaceName",[]),this.addField_SFBool(e,"mapDEFToID",!1),this.currentInline=e.xmlNode},{fieldChanged:function(e){if("url"==e){var t=this.nodeChanged();t=null}},nodeChanged:function(){var e=this,t=new window.XMLHttpRequest;return t.overrideMimeType&&t.overrideMimeType("text/xml"),this._nameSpace.doc.downloadCount+=1,t.onreadystatechange=function(){if(4!=t.readyState)return t;if(delete t.onreadystatechange,"Microsoft Internet Explorer"!=navigator.appName&&"parsererror"==t.responseXML.documentElement.localName)return e._nameSpace.doc.downloadCount-=1,x3dom.debug.logError("XML parser failed on "+e._vf.url+":\n"+t.responseXML.documentElement.textContent),t;if(200!==t.status)return e._nameSpace.doc.downloadCount-=1,x3dom.debug.logError("XMLHttpRequest requires a web server running!"),t;if(x3dom.debug.logInfo("Inline: downloading "+e._vf.url+" done."),"Microsoft Internet Explorer"!=navigator.appName)var i=t.responseXML;else var i=(new DOMParser).parseFromString(t.responseText,"text/xml");var r,n,o=i.getElementsByTagName("Scene")[0]||i.getElementsByTagName("scene")[0];o?(n=new x3dom.NodeNameSpace("",e._nameSpace.doc),n.setBaseURL(e._vf.url[0]),r=n.setupTree(o),0!=e._vf.nameSpaceName.length&&Array.forEach(o.childNodes,function(t){t instanceof Element&&(setNamespace(e._vf.nameSpaceName,t,e._vf.mapDEFToID),e.currentInline.appendChild(t))})):x3dom.debug.logWarning("no Scene in "+i.localName);for(var s=x3dom.getGlobal();0!==e._childNodes.length;)s._remover=e.removeChild(e._childNodes[0]);delete s._remover,e.addChild(r),e._nameSpace.doc.downloadCount-=1,e._nameSpace.doc.needRender=!0,x3dom.debug.logInfo("Inline: added "+e._vf.url+" to scene."),r=null,n=null,i=null,o=null},t.open("GET",encodeURI(this._nameSpace.getURL(this._vf.url[0])),!0),t.send(null),t}})),x3dom.registerNodeType("X3DBackgroundNode","EnvironmentalEffects",defineClass(x3dom.nodeTypes.X3DBindableNode,function(e){x3dom.nodeTypes.X3DBackgroundNode.superClass.call(this,e),this._dirty=!0},{getSkyColor:function(){return new x3dom.fields.SFColor(0,0,0)},getTransparency:function(){return 0},getTexUrl:function(){return[]}})),x3dom.registerNodeType("X3DFogNode","EnvironmentalEffects",defineClass(x3dom.nodeTypes.X3DBindableNode,function(e){x3dom.nodeTypes.X3DFogNode.superClass.call(this,e)},{})),x3dom.registerNodeType("Fog","EnvironmentalEffects",defineClass(x3dom.nodeTypes.X3DFogNode,function(e){x3dom.nodeTypes.Fog.superClass.call(this,e),this.addField_SFColor(e,"color",1,1,1),this.addField_SFString(e,"fogType","LINEAR"),this.addField_SFFloat(e,"visibilityRange",0)},{})),x3dom.registerNodeType("Background","EnvironmentalEffects",defineClass(x3dom.nodeTypes.X3DBackgroundNode,function(e){x3dom.nodeTypes.Background.superClass.call(this,e);var t=e.autoGen?1:0;this.addField_MFColor(e,"skyColor",[new x3dom.fields.SFColor(0,0,0)]),this.addField_MFFloat(e,"skyAngle",[]),this.addField_MFColor(e,"groundColor",[]),this.addField_MFFloat(e,"groundAngle",[]),this.addField_SFFloat(e,"transparency",t),this.addField_MFString(e,"backUrl",[]),this.addField_MFString(e,"bottomUrl",[]),this.addField_MFString(e,"frontUrl",[]),this.addField_MFString(e,"leftUrl",[]),this.addField_MFString(e,"rightUrl",[]),this.addField_MFString(e,"topUrl",[])},{fieldChanged:function(e){e.indexOf("Url")>0?this._dirty=!0:"set_bind"===e&&this.bind(this._vf.set_bind)},getSkyColor:function(){return this._vf.skyColor},getGroundColor:function(){return this._vf.groundColor},getTransparency:function(){return this._vf.transparency},getTexUrl:function(){return[this._nameSpace.getURL(this._vf.backUrl[0]),this._nameSpace.getURL(this._vf.frontUrl[0]),this._nameSpace.getURL(this._vf.bottomUrl[0]),this._nameSpace.getURL(this._vf.topUrl[0]),this._nameSpace.getURL(this._vf.leftUrl[0]),this._nameSpace.getURL(this._vf.rightUrl[0])]}})),x3dom.registerNodeType("X3DViewpointNode","Navigation",defineClass(x3dom.nodeTypes.X3DBindableNode,function(e){x3dom.nodeTypes.X3DViewpointNode.superClass.call(this,e)},{})),x3dom.registerNodeType("X3DNavigationInfoNode","Navigation",defineClass(x3dom.nodeTypes.X3DBindableNode,function(e){x3dom.nodeTypes.X3DNavigationInfoNode.superClass.call(this,e)},{})),x3dom.registerNodeType("Viewpoint","Navigation",defineClass(x3dom.nodeTypes.X3DViewpointNode,function(e){x3dom.nodeTypes.Viewpoint.superClass.call(this,e),this.addField_SFFloat(e,"fieldOfView",.785398),this.addField_SFVec3f(e,"position",0,0,10),this.addField_SFRotation(e,"orientation",0,0,0,1),this.addField_SFVec3f(e,"centerOfRotation",0,0,0),this.addField_SFFloat(e,"zNear",.1),this.addField_SFFloat(e,"zFar",1e5),this._viewMatrix=x3dom.fields.SFMatrix4f.translation(this._vf.position).mult(this._vf.orientation.toMatrix()).inverse(),this._projMatrix=null,this._lastAspect=1},{fieldChanged:function(e){"position"==e||"orientation"==e?this._viewMatrix=this._vf.orientation.toMatrix().transpose().mult(x3dom.fields.SFMatrix4f.translation(this._vf.position.negate())):"fieldOfView"==e||"zNear"==e||"zFar"==e?this._projMatrix=null:"set_bind"===e&&this.bind(this._vf.set_bind)},activate:function(e){e&&this._nameSpace.doc._viewarea.animateTo(this,e),x3dom.nodeTypes.X3DViewpointNode.prototype.activate.call(this,e),this._nameSpace.doc._viewarea._needNavigationMatrixUpdate=!0},deactivate:function(e){x3dom.nodeTypes.X3DViewpointNode.prototype.deactivate.call(this,e)},getCenterOfRotation:function(){return this._vf.centerOfRotation},getViewMatrix:function(){return this._viewMatrix},getFieldOfView:function(){return this._vf.fieldOfView},setView:function(e){var t=this.getCurrentTransform();t=t.inverse(),this._viewMatrix=t.mult(e)},resetView:function(){this._viewMatrix=x3dom.fields.SFMatrix4f.translation(this._vf.position).mult(this._vf.orientation.toMatrix()).inverse()},getTransformation:function(){return this.getCurrentTransform()},getProjectionMatrix:function(e){if(null==this._projMatrix){var t=this._vf.fieldOfView,i=this._vf.zFar,r=this._vf.zNear,n=1/Math.tan(t/2);this._projMatrix=new x3dom.fields.SFMatrix4f(n/e,0,0,0,0,n,0,0,0,0,(r+i)/(r-i),2*r*i/(r-i),0,0,-1,0),this._lastAspect=e}else this._lastAspect!==e&&(this._projMatrix._00=1/Math.tan(this._vf.fieldOfView/2)/e,this._lastAspect=e);return this._projMatrix}})),x3dom.registerNodeType("NavigationInfo","Navigation",defineClass(x3dom.nodeTypes.X3DNavigationInfoNode,function(e){x3dom.nodeTypes.NavigationInfo.superClass.call(this,e),this.addField_SFBool(e,"headlight",!0),this.addField_MFString(e,"type",["EXAMINE","ANY"]),this.addField_MFFloat(e,"avatarSize",[.25,1.6,.75]),this.addField_SFFloat(e,"speed",1),this.addField_SFFloat(e,"visibilityLimit",0),this.addField_SFTime(e,"transitionTime",1),this.addField_MFString(e,"transitionType",["LINEAR"]),x3dom.debug.logInfo("NavType: "+this._vf.type[0].toLowerCase())},{fieldChanged:function(){},getType:function(){return this._vf.type[0].toLowerCase()},setType:function(e,t){var i=e.toLowerCase();switch(i){case"game":this._vf.type[0].toLowerCase()!==i&&(t?t.initMouseState():this._nameSpace.doc._viewarea.initMouseState())}this._vf.type[0]=i,x3dom.debug.logInfo("Switch to "+i+" mode.")}})),x3dom.registerNodeType("Billboard","Navigation",defineClass(x3dom.nodeTypes.X3DGroupingNode,function(e){x3dom.nodeTypes.Billboard.superClass.call(this,e),this.addField_SFVec3f(e,"axisOfRotation",0,1,0),this._eye=new x3dom.fields.SFVec3f(0,0,0),this._eyeViewUp=new x3dom.fields.SFVec3f(0,0,0),this._eyeLook=new x3dom.fields.SFVec3f(0,0,0),this._viewAlignedMat=x3dom.fields.SFMatrix4f.identity()},{collectDrawableObjects:function(e,t){if(this._vf.render){var i=x3dom.fields.SFVec3f.MAX(),r=x3dom.fields.SFVec3f.MIN(),n=(this.getVolume(i,r,!0),x3dom.fields.SFMatrix4f.identity()),o=r.add(i).multiply(.5).add(new x3dom.fields.SFVec3f(0,0,0)),s=this._eye.subtract(o);if(this._vf.axisOfRotation.equals(new x3dom.fields.SFVec3f(0,0,0),x3dom.fields.Eps)){var a=x3dom.fields.Quaternion.rotateFromTo(s,new x3dom.fields.SFVec3f(0,0,1));n=a.toMatrix().transpose();var l=n.multMatrixPnt(new x3dom.fields.SFVec3f(0,1,0)).normalize(),d=n.multMatrixPnt(new x3dom.fields.SFVec3f(0,0,1)).normalize();if(!this._eyeViewUp.equals(new x3dom.fields.SFVec3f(0,0,0),x3dom.fields.Eps)){var h=x3dom.fields.Quaternion.rotateFromTo(this._eyeLook,d),u=h.toMatrix().transpose().multMatrixVec(l),c=x3dom.fields.Quaternion.rotateFromTo(this._eyeViewUp,u);n=h.toMatrix().transpose().mult(n),n=c.toMatrix().transpose().mult(n)}}else{var f=this._vf.axisOfRotation.cross(s);f=f.normalize(),this._eye.z<0&&(f=f.multiply(-1));var m=Math.asin(f.dot(new x3dom.fields.SFVec3f(0,0,1)));this._eye.z<0&&(m+=Math.PI),n=x3dom.fields.SFMatrix4f.parseRotation(this._vf.axisOfRotation.x+", "+this._vf.axisOfRotation.y+", "+this._vf.axisOfRotation.z+", "+-1*m)}for(var p=0;p<this._childNodes.length;p++)if(this._childNodes[p]){var _=this._childNodes[p].transformMatrix(e.mult(n));this._childNodes[p].collectDrawableObjects(_,t)}null!==t&&t.Billboards.push([e,this])}}})),x3dom.registerNodeType("Collision","Navigation",defineClass(x3dom.nodeTypes.X3DGroupingNode,function(e){x3dom.nodeTypes.Collision.superClass.call(this,e),this.addField_SFBool(e,"enabled",!0),this.addField_SFNode("proxy",x3dom.nodeTypes.X3DGroupingNode)},{collectDrawableObjects:function(e,t){for(var i=0;i<this._childNodes.length;i++)if(this._childNodes[i]&&this._childNodes[i]!==this._cf.proxy.node){var r=this._childNodes[i].transformMatrix(e);this._childNodes[i].collectDrawableObjects(r,t)}}})),x3dom.registerNodeType("LOD","Navigation",defineClass(x3dom.nodeTypes.X3DGroupingNode,function(e){x3dom.nodeTypes.LOD.superClass.call(this,e),this.addField_SFBool(e,"forceTransitions",!1),this.addField_SFVec3f(e,"center",0,0,0),this.addField_MFFloat(e,"range",[]),this._eye=new x3dom.fields.SFVec3f(0,0,0)},{collectDrawableObjects:function(e,t){for(var i=0,r=this._childNodes.length,n=x3dom.fields.SFVec3f.MAX(),o=x3dom.fields.SFVec3f.MIN(),s=(this.getVolume(n,o,!0),o.add(n).multiply(.5).add(this._vf.center)),a=s.subtract(this._eye).length();i<this._vf.range.length&&a>this._vf.range[i];)i++;if(i&&i>=r&&(i=r-1),r&&this._childNodes[i]){var l=this._childNodes[i].transformMatrix(e);this._childNodes[i].collectDrawableObjects(l,t)}null!==t&&t.LODs.push([e,this])}})),x3dom.registerNodeType("Text","Text",defineClass(x3dom.nodeTypes.X3DGeometryNode,function(e){x3dom.nodeTypes.Text.superClass.call(this,e),this.addField_MFString(e,"string",[]),this.addField_MFFloat(e,"length",[]),this.addField_SFFloat(e,"maxExtent",0),this.addField_SFNode("fontStyle",x3dom.nodeTypes.X3DFontStyleNode)},{nodeChanged:function(){this._cf.fontStyle.node||this.addChild(x3dom.nodeTypes.FontStyle.defaultNode())},fieldChanged:function(e){("string"==e||"family"==e||"horizontal"==e||"justify"==e||"language"==e||"leftToRight"==e||"size"==e||"spacing"==e||"style"==e||"topToBottom"==e)&&Array.forEach(this._parentNodes,function(e){e._dirty.texture=!0,e._dirty.text=!0})}})),x3dom.registerNodeType("X3DFontStyleNode","Text",defineClass(x3dom.nodeTypes.X3DNode,function(e){x3dom.nodeTypes.X3DFontStyleNode.superClass.call(this,e)})),x3dom.registerNodeType("FontStyle","Text",defineClass(x3dom.nodeTypes.X3DFontStyleNode,function(e){x3dom.nodeTypes.FontStyle.superClass.call(this,e),this.addField_MFString(e,"family",["SERIF"]),this.addField_SFBool(e,"horizontal",!0),this.addField_MFString(e,"justify",["BEGIN"]),this.addField_SFString(e,"language",""),this.addField_SFBool(e,"leftToRight",!0),this.addField_SFFloat(e,"size",1),this.addField_SFFloat(e,"spacing",1),this.addField_SFString(e,"style","PLAIN"),this.addField_SFBool(e,"topToBottom",!0)},{nodeChanged:function(){},fieldChanged:function(e){("family"==e||"horizontal"==e||"justify"==e||"language"==e||"leftToRight"==e||"size"==e||"spacing"==e||"style"==e||"topToBottom"==e)&&Array.forEach(this._parentNodes,function(t){t.fieldChanged(e)})}})),x3dom.nodeTypes.FontStyle.defaultNode=function(){return x3dom.nodeTypes.FontStyle._defaultNode||(x3dom.nodeTypes.FontStyle._defaultNode=new x3dom.nodeTypes.FontStyle,x3dom.nodeTypes.FontStyle._defaultNode.nodeChanged()),x3dom.nodeTypes.FontStyle._defaultNode},x3dom.registerNodeType("X3DSoundNode","Sound",defineClass(x3dom.nodeTypes.X3DChildNode,function(e){x3dom.nodeTypes.X3DSoundNode.superClass.call(this,e)})),x3dom.registerNodeType("Sound","Sound",defineClass(x3dom.nodeTypes.X3DSoundNode,function(e){x3dom.nodeTypes.Sound.superClass.call(this,e),this.addField_SFNode("source",x3dom.nodeTypes.X3DSoundSourceNode)},{nodeChanged:function(){if(!this._cf.source.node&&this._xmlNode){x3dom.debug.logInfo("No AudioClip child node given, searching for &lt;audio&gt; elements...");try{Array.forEach(this._xmlNode.childNodes,function(e){if(1===e.nodeType&&(x3dom.debug.logInfo("### Found &lt;"+e.nodeName+"&gt; tag."),"audio"===e.localName.toLowerCase())){var t=e.getAttribute("loop");t=t?"loop"===t.toLowerCase():!1;var i=e.cloneNode(!1);e.parentNode.removeChild(e),e=null,"Microsoft Internet Explorer"!=navigator.appName&&document.body.appendChild(i);var r=function(){i.play()},n=function(){t&&i.play()};i.addEventListener("canplaythrough",r,!0),i.addEventListener("ended",n,!0)}})}catch(e){}}}})),x3dom.registerNodeType("X3DSoundSourceNode","Sound",defineClass(x3dom.nodeTypes.X3DTimeDependentNode,function(e){x3dom.nodeTypes.X3DSoundSourceNode.superClass.call(this,e)})),x3dom.registerNodeType("AudioClip","Sound",defineClass(x3dom.nodeTypes.X3DSoundSourceNode,function(e){x3dom.nodeTypes.AudioClip.superClass.call(this,e),this.addField_MFString(e,"url",[]),this.addField_SFBool(e,"enabled",!0),this.addField_SFBool(e,"loop",!1),this._audio=null},{nodeChanged:function(){this._audio=document.createElement("audio"),this._audio.setAttribute("autobuffer","true"),"Microsoft Internet Explorer"!=navigator.appName&&document.body.appendChild(this._audio);for(var e=0;e<this._vf.url.length;e++){var t=this._nameSpace.getURL(this._vf.url[e]);x3dom.debug.logInfo("Adding sound file: "+t);var i=document.createElement("source");i.setAttribute("src",t),this._audio.appendChild(i)}var r=this,n=function(){r._audio.play()},o=function(){r._vf.loop===!0&&r._audio.play()};this._audio.addEventListener("canplaythrough",n,!0),this._audio.addEventListener("ended",o,!0)},fieldChanged:function(e){if("enabled"===e)this._vf.enabled===!0?this._audio.play():this._audio.pause();else if("loop"===e)this._vf.loop===!0&&this._audio.play();else if("url"===e){for(this._audio.pause();this._audio.hasChildNodes();)this._audio.removeChild(this._audio.firstChild);for(var t=0;t<this._vf.url.length;t++){var i=this._nameSpace.getURL(this._vf.url[t]);x3dom.debug.logInfo("Adding sound file: "+i);var r=document.createElement("source");r.setAttribute("src",i),this._audio.appendChild(r)}}}})),x3dom.registerNodeType("X3DTextureTransformNode","Texturing",defineClass(x3dom.nodeTypes.X3DAppearanceChildNode,function(e){x3dom.nodeTypes.X3DTextureTransformNode.superClass.call(this,e)})),x3dom.registerNodeType("TextureTransform","Texturing",defineClass(x3dom.nodeTypes.X3DTextureTransformNode,function(e){x3dom.nodeTypes.TextureTransform.superClass.call(this,e),this.addField_SFVec2f(e,"center",0,0),this.addField_SFFloat(e,"rotation",0),this.addField_SFVec2f(e,"scale",1,1),this.addField_SFVec2f(e,"translation",0,0);var t=new x3dom.fields.SFVec3f(-this._vf.center.x,-this._vf.center.y,1),i=new x3dom.fields.SFVec3f(this._vf.center.x,this._vf.center.y,0),r=new x3dom.fields.SFVec3f(this._vf.translation.x,this._vf.translation.y,0),n=new x3dom.fields.SFVec3f(this._vf.scale.x,this._vf.scale.y,0);this._trafo=x3dom.fields.SFMatrix4f.translation(t).mult(x3dom.fields.SFMatrix4f.scale(n)).mult(x3dom.fields.SFMatrix4f.rotationZ(this._vf.rotation)).mult(x3dom.fields.SFMatrix4f.translation(i.add(r)))},{fieldChanged:function(){var e=new x3dom.fields.SFVec3f(-this._vf.center.x,-this._vf.center.y,1),t=new x3dom.fields.SFVec3f(this._vf.center.x,this._vf.center.y,0),i=new x3dom.fields.SFVec3f(this._vf.translation.x,this._vf.translation.y,0),r=new x3dom.fields.SFVec3f(this._vf.scale.x,this._vf.scale.y,0);this._trafo=x3dom.fields.SFMatrix4f.translation(e).mult(x3dom.fields.SFMatrix4f.scale(r)).mult(x3dom.fields.SFMatrix4f.rotationZ(this._vf.rotation)).mult(x3dom.fields.SFMatrix4f.translation(t.add(i)))},texTransformMatrix:function(){return this._trafo}})),x3dom.registerNodeType("TextureProperties","Texturing",defineClass(x3dom.nodeTypes.X3DNode,function(e){x3dom.nodeTypes.TextureProperties.superClass.call(this,e),this.addField_SFFloat(e,"anisotropicDegree",1),this.addField_SFColorRGBA(e,"borderColor",0,0,0,0),this.addField_SFInt32(e,"borderWidth",0),this.addField_SFString(e,"boundaryModeS","REPEAT"),this.addField_SFString(e,"boundaryModeT","REPEAT"),this.addField_SFString(e,"boundaryModeR","REPEAT"),this.addField_SFString(e,"magnificationFilter","FASTEST"),this.addField_SFString(e,"minificationFilter","FASTEST"),this.addField_SFString(e,"textureCompression","FASTEST"),this.addField_SFFloat(e,"texturePriority",0),this.addField_SFBool(e,"generateMipMaps",!1)})),x3dom.registerNodeType("X3DTextureNode","Texturing",defineClass(x3dom.nodeTypes.X3DAppearanceChildNode,function(e){x3dom.nodeTypes.X3DTextureNode.superClass.call(this,e),this.addField_SFInt32(e,"origChannelCount",0),this.addField_MFString(e,"url",[]),this.addField_SFBool(e,"repeatS",!0),this.addField_SFBool(e,"repeatT",!0),this.addField_SFNode("textureProperties",x3dom.nodeTypes.TextureProperties),this.addField_SFBool(e,"scale",!0),this.addField_SFInt32(e,"priority",10),this._needPerFrameUpdate=!1,this._isCanvas=!1},{invalidateGLObject:function(){Array.forEach(this._parentNodes,function(e){Array.forEach(e._parentNodes,function(e){e._dirty.texture=!0})}),this._nameSpace.doc.needRender=!0},parentAdded:function(e){Array.forEach(e._parentNodes,function(e){e._dirty.texture=!0})},parentRemoved:function(e){e._cf.texture.node=null,Array.forEach(e._parentNodes,function(e){e._dirty.texture=!0})},nodeChanged:function(){},fieldChanged:function(e){"url"==e&&(this._complete=!1,Array.forEach(this._parentNodes,function(e){e.nodeChanged(),Array.forEach(e._parentNodes,function(e){e._dirty.texture=!0})}))},getTexture:function(e){return 0===e?this:null},size:function(){return 1}})),x3dom.registerNodeType("MultiTexture","Texturing",defineClass(x3dom.nodeTypes.X3DTextureNode,function(e){x3dom.nodeTypes.MultiTexture.superClass.call(this,e),this.addField_MFNode("texture",x3dom.nodeTypes.X3DTextureNode)},{getTexture:function(e){return e>=0&&e<this._cf.texture.nodes.length?this._cf.texture.nodes[e]:null},size:function(){return this._cf.texture.nodes.length}})),x3dom.registerNodeType("Texture","Texturing",defineClass(x3dom.nodeTypes.X3DTextureNode,function(e){x3dom.nodeTypes.Texture.superClass.call(this,e),this.addField_SFBool(e,"hideChildren",!0),this._video=null,this._intervalID=0,this._canvas=null},{nodeChanged:function(){if(!this._vf.url.length&&this._xmlNode){x3dom.debug.logInfo("No Texture URL given, searching for &lt;img&gt; elements...");var e=this;try{Array.forEach(this._xmlNode.childNodes,function(t){if(1===t.nodeType){var i=t.getAttribute("src");if(i){if(e._vf.url.push(i),x3dom.debug.logInfo(e._vf.url[e._vf.url.length-1]),"video"===t.localName){e._needPerFrameUpdate=!0,e._video=document.createElement("video"),e._video.setAttribute("autobuffer","true");var r=document.getElementsByTagName("body")[0];r.appendChild(e._video),e._video.style.display="none"}}else"canvas"===t.localName.toLowerCase()&&(e._needPerFrameUpdate=!0,e._isCanvas=!0,e._canvas=t);e._vf.hideChildren&&(t.style.display="none",t.style.visibility="hidden"),x3dom.debug.logInfo("### Found &lt;"+t.nodeName+"&gt; tag.")}})}catch(t){}}}})),x3dom.registerNodeType("RenderedTexture","Texturing",defineClass(x3dom.nodeTypes.X3DTextureNode,function(e){x3dom.nodeTypes.RenderedTexture.superClass.call(this,e),e.doc._nodeBag.renderTextures.push(this),this.addField_SFNode("viewpoint",x3dom.nodeTypes.X3DViewpointNode),this.addField_SFNode("background",x3dom.nodeTypes.X3DBackgroundNode),this.addField_SFNode("fog",x3dom.nodeTypes.X3DFogNode),this.addField_SFNode("scene",x3dom.nodeTypes.X3DNode),this.addField_MFNode("excludeNodes",x3dom.nodeTypes.X3DNode),this.addField_MFInt32(e,"dimensions",[128,128,4]),this.addField_SFString(e,"update","NONE"),x3dom.debug.assert(this._vf.dimensions.length>=3),this._clearParents=!0},{nodeChanged:function(){this._clearParents=!0},fieldChanged:function(e){"excludeNodes"==e&&(this._clearParents=!0)},getViewMatrix:function(){if(this._clearParents&&this._cf.excludeNodes.nodes.length){var e=this;Array.forEach(this._cf.excludeNodes.nodes,function(t){for(var i=0,r=t._parentNodes.length;r>i;i++)t._parentNodes[i]===e&&(t._parentNodes.splice(i,1),t.parentRemoved(e))}),this._clearParents=!1}var t=this._nameSpace.doc._scene.getViewpoint(),i=this._cf.viewpoint.node;if(null===i||i===t)return this._nameSpace.doc._viewarea.getViewMatrix();var r=i.getCurrentTransform();return r.mult(i.getViewMatrix())},getProjectionMatrix:function(){var e=this._nameSpace.doc._scene.getViewpoint(),t=this._cf.viewpoint.node;if(null===t||t===e)return this._nameSpace.doc._viewarea.getProjectionMatrix();var i=this._vf.dimensions[0],r=this._vf.dimensions[1];return t.getProjectionMatrix(i/r)},getWCtoCCMatrix:function(){var e=this.getViewMatrix(),t=this.getProjectionMatrix();return t.mult(e)},parentRemoved:function(){if(0===this._parentNodes.length)for(var e=this.findX3DDoc(),t=0,i=e._nodeBag.renderTextures.length;i>t;t++)e._nodeBag.renderTextures[t]===this&&e._nodeBag.renderTextures.splice(t,1);this._cf.scene.node&&this._cf.scene.node.parentRemoved(this)}})),x3dom.registerNodeType("PixelTexture","Texturing",defineClass(x3dom.nodeTypes.X3DTextureNode,function(e){x3dom.nodeTypes.PixelTexture.superClass.call(this,e),this.addField_SFImage(e,"image",0,0,0)},{fieldChanged:function(e){"image"==e&&this.invalidateGLObject()}})),x3dom.registerNodeType("ImageTexture","Texturing",defineClass(x3dom.nodeTypes.Texture,function(e){x3dom.nodeTypes.ImageTexture.superClass.call(this,e)},{})),x3dom.registerNodeType("MovieTexture","Texturing",defineClass(x3dom.nodeTypes.Texture,function(e){x3dom.nodeTypes.MovieTexture.superClass.call(this,e),this.addField_SFBool(e,"loop",!1),this.addField_SFFloat(e,"speed",1)},{})),x3dom.registerNodeType("X3DEnvironmentTextureNode","CubeMapTexturing",defineClass(x3dom.nodeTypes.X3DTextureNode,function(e){x3dom.nodeTypes.X3DEnvironmentTextureNode.superClass.call(this,e)},{getTexUrl:function(){return[]},getTexSize:function(){return-1}})),x3dom.registerNodeType("ComposedCubeMapTexture","CubeMapTexturing",defineClass(x3dom.nodeTypes.X3DEnvironmentTextureNode,function(e){x3dom.nodeTypes.ComposedCubeMapTexture.superClass.call(this,e),this.addField_SFNode("back",x3dom.nodeTypes.Texture),this.addField_SFNode("front",x3dom.nodeTypes.Texture),this.addField_SFNode("bottom",x3dom.nodeTypes.Texture),this.addField_SFNode("top",x3dom.nodeTypes.Texture),this.addField_SFNode("left",x3dom.nodeTypes.Texture),this.addField_SFNode("right",x3dom.nodeTypes.Texture)},{getTexUrl:function(){return[this._nameSpace.getURL(this._cf.back.node._vf.url[0]),this._nameSpace.getURL(this._cf.front.node._vf.url[0]),this._nameSpace.getURL(this._cf.bottom.node._vf.url[0]),this._nameSpace.getURL(this._cf.top.node._vf.url[0]),this._nameSpace.getURL(this._cf.left.node._vf.url[0]),this._nameSpace.getURL(this._cf.right.node._vf.url[0])]}})),x3dom.registerNodeType("GeneratedCubeMapTexture","CubeMapTexturing",defineClass(x3dom.nodeTypes.X3DEnvironmentTextureNode,function(e){x3dom.nodeTypes.GeneratedCubeMapTexture.superClass.call(this,e),this.addField_SFInt32(e,"size",128),this.addField_SFString(e,"update","NONE"),x3dom.debug.logWarning("GeneratedCubeMapTexture NYI")},{getTexSize:function(){return this._vf.size}})),x3dom.registerNodeType("X3DTextureCoordinateNode","Texturing",defineClass(x3dom.nodeTypes.X3DGeometricPropertyNode,function(e){x3dom.nodeTypes.X3DTextureCoordinateNode.superClass.call(this,e)},{fieldChanged:function(){Array.forEach(this._parentNodes,function(e){e.fieldChanged("texCoord")})},parentAdded:function(e){e._mesh&&e._cf.texCoord.node!==this&&e.fieldChanged("texCoord")}})),x3dom.registerNodeType("TextureCoordinate3D","Texturing3D",defineClass(x3dom.nodeTypes.X3DTextureCoordinateNode,function(e){x3dom.nodeTypes.TextureCoordinate3D.superClass.call(this,e),this.addField_MFVec3f(e,"point",[])})),x3dom.registerNodeType("TextureCoordinate","Texturing",defineClass(x3dom.nodeTypes.X3DTextureCoordinateNode,function(e){x3dom.nodeTypes.TextureCoordinate.superClass.call(this,e),this.addField_MFVec2f(e,"point",[])})),x3dom.registerNodeType("TextureCoordinateGenerator","Texturing",defineClass(x3dom.nodeTypes.X3DTextureCoordinateNode,function(e){x3dom.nodeTypes.TextureCoordinateGenerator.superClass.call(this,e),this.addField_SFString(e,"mode","SPHERE"),this.addField_MFFloat(e,"parameter",[])})),x3dom.registerNodeType("Uniform","Shaders",defineClass(x3dom.nodeTypes.Field,function(e){x3dom.nodeTypes.Uniform.superClass.call(this,e)})),x3dom.registerNodeType("SurfaceShaderTexture","Shaders",defineClass(x3dom.nodeTypes.X3DTextureNode,function(e){x3dom.nodeTypes.SurfaceShaderTexture.superClass.call(this,e),this.addField_SFInt32(e,"textureCoordinatesId",0),this.addField_SFString(e,"channelMask","DEFAULT"),this.addField_SFBool(e,"isSRGB",!1),this.addField_SFNode("texture",x3dom.nodeTypes.X3DTextureNode),this.addField_SFNode("textureTransform",x3dom.nodeTypes.X3DTextureTransformNode)},{nodeChanged:function(){},fieldChanged:function(){}})),x3dom.registerNodeType("X3DShaderNode","Shaders",defineClass(x3dom.nodeTypes.X3DAppearanceChildNode,function(e){x3dom.nodeTypes.X3DShaderNode.superClass.call(this,e),this.addField_SFString(e,"language","")})),x3dom.registerNodeType("CommonSurfaceShader","Shaders",defineClass(x3dom.nodeTypes.X3DShaderNode,function(e){x3dom.nodeTypes.CommonSurfaceShader.superClass.call(this,e),this.addField_SFInt32(e,"tangentTextureCoordinatesId",-1),this.addField_SFInt32(e,"binormalTextureCoordinatesId",-1),this.addField_SFVec3f(e,"emissiveFactor",0,0,0),this.addField_SFInt32(e,"emissiveTextureId",-1),this.addField_SFInt32(e,"emissiveTextureCoordinatesId",0),this.addField_SFString(e,"emissiveTextureChannelMask","rgb"),this.addField_SFVec3f(e,"ambientFactor",.2,.2,.2),this.addField_SFInt32(e,"ambientTextureId",-1),this.addField_SFInt32(e,"ambientTextureCoordinatesId",0),this.addField_SFString(e,"ambientTextureChannelMask","rgb"),this.addField_SFVec3f(e,"diffuseFactor",.8,.8,.8),this.addField_SFInt32(e,"diffuseTextureId",-1),this.addField_SFInt32(e,"diffuseTextureCoordinatesId",0),this.addField_SFString(e,"diffuseTextureChannelMask","rgb"),this.addField_SFVec3f(e,"specularFactor",0,0,0),this.addField_SFInt32(e,"specularTextureId",-1),this.addField_SFInt32(e,"specularTextureCoordinatesId",0),this.addField_SFString(e,"specularTextureChannelMask","rgb"),this.addField_SFFloat(e,"shininessFactor",.2),this.addField_SFInt32(e,"shininessTextureId",-1),this.addField_SFInt32(e,"shininessTextureCoordinatesId",0),this.addField_SFString(e,"shininessTextureChannelMask","a"),this.addField_SFString(e,"normalFormat","UNORM"),this.addField_SFString(e,"normalSpace","TANGENT"),this.addField_SFInt32(e,"normalTextureId",-1),this.addField_SFInt32(e,"normalTextureCoordinatesId",0),this.addField_SFString(e,"normalTextureChannelMask","rgb"),this.addField_SFVec3f(e,"reflectionFactor",0,0,0),this.addField_SFInt32(e,"reflectionTextureId",-1),this.addField_SFInt32(e,"reflectionTextureCoordinatesId",0),this.addField_SFString(e,"reflectionTextureChannelMask","rgb"),this.addField_SFVec3f(e,"transmissionFactor",0,0,0),this.addField_SFInt32(e,"transmissionTextureId",-1),this.addField_SFInt32(e,"transmissionTextureCoordinatesId",0),this.addField_SFString(e,"transmissionTextureChannelMask","rgb"),this.addField_SFVec3f(e,"environmentFactor",1,1,1),this.addField_SFInt32(e,"environmentTextureId",-1),this.addField_SFInt32(e,"environmentTextureCoordinatesId",0),this.addField_SFString(e,"environmentTextureChannelMask","rgb"),this.addField_SFFloat(e,"relativeIndexOfRefraction",1),this.addField_SFFloat(e,"fresnelBlend",0),this.addField_SFNode("emissiveTexture",x3dom.nodeTypes.X3DTextureNode),this.addField_SFNode("ambientTexture",x3dom.nodeTypes.X3DTextureNode),this.addField_SFNode("diffuseTexture",x3dom.nodeTypes.X3DTextureNode),this.addField_SFNode("specularTexture",x3dom.nodeTypes.X3DTextureNode),this.addField_SFNode("shininessTexture",x3dom.nodeTypes.X3DTextureNode),this.addField_SFNode("normalTexture",x3dom.nodeTypes.X3DTextureNode),this.addField_SFNode("reflectionTexture",x3dom.nodeTypes.X3DTextureNode),this.addField_SFNode("transmissionTexture",x3dom.nodeTypes.X3DTextureNode),this.addField_SFNode("environmentTexture",x3dom.nodeTypes.X3DTextureNode),this.addField_SFVec3f(e,"normalScale",2,2,2),this.addField_SFVec3f(e,"normalBias",-1,-1,-1),this.addField_SFFloat(e,"alphaFactor",1),this.addField_SFBool(e,"invertAlphaTexture",!1),this.addField_SFInt32(e,"alphaTextureId",-1),this.addField_SFInt32(e,"alphaTextureCoordinatesId",0),this.addField_SFString(e,"alphaTextureChannelMask","a"),this.addField_SFNode("alphaTexture",x3dom.nodeTypes.X3DTextureNode),this._dirty={}
},{nodeChanged:function(){},fieldChanged:function(){},getDiffuseMap:function(){return this._cf.diffuseTexture.node?this._cf.diffuseTexture.node._cf.texture.node:null},getNormalMap:function(){return this._cf.normalTexture.node?this._cf.normalTexture.node._cf.texture.node:null},getAmbientMap:function(){return this._cf.ambientTexture.node?this._cf.ambientTexture.node._cf.texture.node:null},getSpecularMap:function(){return this._cf.specularTexture.node?this._cf.specularTexture.node._cf.texture.node:null},getShininessMap:function(){return this._cf.shininessTexture.node?this._cf.shininessTexture.node._cf.texture.node:null},getAlphaMap:function(){return this._cf.alphaTexture.node?this._cf.alphaTexture.node._cf.texture.node:null}})),x3dom.registerNodeType("ComposedShader","Shaders",defineClass(x3dom.nodeTypes.X3DShaderNode,function(e){x3dom.nodeTypes.ComposedShader.superClass.call(this,e),this.addField_MFNode("fields",x3dom.nodeTypes.Field),this.addField_MFNode("parts",x3dom.nodeTypes.ShaderPart),this._vertex=null,this._fragment=null,x3dom.debug.logInfo("Current ComposedShader node implementation limitations:\nVertex attributes (if given in the standard X3D fields 'coord', 'color', 'normal', 'texCoord'), matrices and texture are provided as follows...\n    attribute vec3 position;\n    attribute vec3 normal;\n    attribute vec2 texcoord;\n    attribute vec3 color;\n    uniform mat4 modelViewProjectionMatrix;\n    uniform mat4 modelViewMatrix;\n    uniform mat4 normalMatrix;\n    uniform mat4 viewMatrix;\n    uniform sampler2D tex;\n")},{nodeChanged:function(){var e,t=this._cf.parts.nodes.length;for(e=0;t>e;e++)"vertex"==this._cf.parts.nodes[e]._vf.type.toLowerCase()?this._vertex=this._cf.parts.nodes[e]:"fragment"==this._cf.parts.nodes[e]._vf.type.toLowerCase()&&(this._fragment=this._cf.parts.nodes[e]);var i={};for(t=this._cf.fields.nodes.length,e=0;t>e;e++){var r=this._cf.fields.nodes[e]._vf.name;i.xmlNode=this._cf.fields.nodes[e]._xmlNode,i.xmlNode.setAttribute(r,this._cf.fields.nodes[e]._vf.value);var n="this.addField_"+this._cf.fields.nodes[e]._vf.type+"(ctx, name);",o=new Function("ctx","name",n);o.call(this,i,r)}Array.forEach(this._parentNodes,function(e){Array.forEach(e._parentNodes,function(e){e._dirty.shader=!0})})},fieldChanged:function(e){var t,i=this._cf.fields.nodes.length;for(t=0;i>t;t++){var r=this._cf.fields.nodes[t]._vf.name;if(r===e){var n=this._cf.fields.nodes[t]._vf.value;try{this._vf[r].setValueByStr(n)}catch(o){try{switch((typeof this._vf[r]).toString()){case"number":this._vf[r]=+n;break;case"boolean":this._vf[r]="true"===n.toLowerCase();break;case"string":this._vf[r]=n}}catch(s){x3dom.debug.logError("setValueByStr() NYI for "+typeof this._vf[r])}}break}}},parentAdded:function(){this._parentNodes[0].nodeChanged()}})),x3dom.registerNodeType("ShaderPart","Shaders",defineClass(x3dom.nodeTypes.X3DNode,function(e){if(x3dom.nodeTypes.ShaderPart.superClass.call(this,e),this.addField_MFString(e,"url",[]),this.addField_SFString(e,"type","VERTEX"),x3dom.debug.assert("vertex"==this._vf.type.toLowerCase()||"fragment"==this._vf.type.toLowerCase()),!this._vf.url.length&&e.xmlNode){var t=this;try{t._vf.url.push(e.xmlNode.childNodes[1].nodeValue),e.xmlNode.removeChild(e.xmlNode.childNodes[1])}catch(i){Array.forEach(e.xmlNode.childNodes,function(e){4===e.nodeType&&t._vf.url.push(e.data),e.parentNode.removeChild(e)})}}},{nodeChanged:function(){},fieldChanged:function(){},parentAdded:function(){this._parentNodes[0].nodeChanged()}})),x3dom.registerNodeType("X3DVertexAttributeNode","Shaders",defineClass(x3dom.nodeTypes.X3DGeometricPropertyNode,function(e){x3dom.nodeTypes.X3DVertexAttributeNode.superClass.call(this,e),this.addField_SFString(e,"name","")})),x3dom.registerNodeType("FloatVertexAttribute","Shaders",defineClass(x3dom.nodeTypes.X3DVertexAttributeNode,function(e){x3dom.nodeTypes.FloatVertexAttribute.superClass.call(this,e),this.addField_SFInt32(e,"numComponents",4),this.addField_MFFloat(e,"value",[])},{fieldChanged:function(){}})),x3dom.registerNodeType("Plane","Geometry3D",defineClass(x3dom.nodeTypes.X3DGeometryNode,function(e){x3dom.nodeTypes.Plane.superClass.call(this,e),this.addField_SFVec2f(e,"size",2,2),this.addField_SFVec2f(e,"subdivision",1,1);var t=this._vf.size.x,i=this._vf.size.y,r=this._vf.subdivision.x,n=this._vf.subdivision.y,o="Plane_"+t+"-"+i+"-"+r+"-"+n;if(void 0!=x3dom.geoCache[o])x3dom.debug.logInfo("Using Plane from Cache"),this._mesh=x3dom.geoCache[o];else{var s=0,a=0,l=t/r,d=i/n;for(t/=2,i/=2,a=0;n>=a;a++)for(s=0;r>=s;s++)this._mesh._positions[0].push(s*l-t),this._mesh._positions[0].push(a*d-i),this._mesh._positions[0].push(0),this._mesh._normals[0].push(0),this._mesh._normals[0].push(0),this._mesh._normals[0].push(1),this._mesh._texCoords[0].push(s/r),this._mesh._texCoords[0].push(a/n);for(a=1;n>=a;a++)for(s=0;r>s;s++)this._mesh._indices[0].push((a-1)*(r+1)+s),this._mesh._indices[0].push((a-1)*(r+1)+s+1),this._mesh._indices[0].push(a*(r+1)+s),this._mesh._indices[0].push(a*(r+1)+s),this._mesh._indices[0].push((a-1)*(r+1)+s+1),this._mesh._indices[0].push(a*(r+1)+s+1);this._mesh._invalidate=!0,this._mesh._numFaces=this._mesh._indices[0].length/3,this._mesh._numCoords=this._mesh._positions[0].length/3,x3dom.geoCache[o]=this._mesh}},{nodeChanged:function(){},fieldChanged:function(e){if("size"===e){this._mesh._positions[0]=[];var t=this._vf.size.x,i=this._vf.size.y,r=this._vf.subdivision.x,n=this._vf.subdivision.y,o=0,s=0,a=t/r,l=i/n;for(t/=2,i/=2,s=0;n>=s;s++)for(o=0;r>=o;o++)this._mesh._positions[0].push(o*a-t),this._mesh._positions[0].push(s*l-i),this._mesh._positions[0].push(0);this._mesh._invalidate=!0,this._mesh._numCoords=this._mesh._positions[0].length/3,Array.forEach(this._parentNodes,function(e){e._dirty.positions=!0})}else if("subdivision"===e){this._mesh._positions[0]=[],this._mesh._indices[0]=[],this._mesh._normals[0]=[],this._mesh._texCoords[0]=[];var t=this._vf.size.x,i=this._vf.size.y,r=this._vf.subdivision.x,n=this._vf.subdivision.y,o=0,s=0,a=t/r,l=i/n;for(t/=2,i/=2,s=0;n>=s;s++)for(o=0;r>=o;o++)this._mesh._positions[0].push(o*a-t),this._mesh._positions[0].push(s*l-i),this._mesh._positions[0].push(0),this._mesh._normals[0].push(0),this._mesh._normals[0].push(0),this._mesh._normals[0].push(1),this._mesh._texCoords[0].push(o/r),this._mesh._texCoords[0].push(s/n);for(s=1;n>=s;s++)for(o=0;r>o;o++)this._mesh._indices[0].push((s-1)*(r+1)+o),this._mesh._indices[0].push((s-1)*(r+1)+o+1),this._mesh._indices[0].push(s*(r+1)+o),this._mesh._indices[0].push(s*(r+1)+o),this._mesh._indices[0].push((s-1)*(r+1)+o+1),this._mesh._indices[0].push(s*(r+1)+o+1);this._mesh._invalidate=!0,this._mesh._numFaces=this._mesh._indices[0].length/3,this._mesh._numCoords=this._mesh._positions[0].length/3,Array.forEach(this._parentNodes,function(e){e.setAllDirty()})}}})),x3dom.registerNodeType("ElevationGrid","Geometry3D",defineClass(x3dom.nodeTypes.X3DGeometryNode,function(e){x3dom.nodeTypes.ElevationGrid.superClass.call(this,e),this.addField_SFBool(e,"colorPerVertex",!0),this.addField_SFBool(e,"normalPerVertex",!0),this.addField_SFFloat(e,"creaseAngle",0),this.addField_MFNode("attrib",x3dom.nodeTypes.X3DVertexAttributeNode),this.addField_SFNode("normal",x3dom.nodeTypes.Normal),this.addField_SFNode("color",x3dom.nodeTypes.X3DColorNode),this.addField_SFNode("texCoord",x3dom.nodeTypes.X3DTextureCoordinateNode),this.addField_MFFloat(e,"height",[]),this.addField_SFInt32(e,"xDimension",0),this.addField_SFFloat(e,"xSpacing",1),this.addField_SFInt32(e,"zDimension",0),this.addField_SFFloat(e,"zSpacing",1)},{nodeChanged:function(){this._mesh._indices[0]=[],this._mesh._positions[0]=[],this._mesh._normals[0]=[],this._mesh._texCoords[0]=[],this._mesh._colors[0]=[];var e=0,t=0,i=this._vf.xDimension-1,r=this._vf.zDimension-1,n=this._vf.height;x3dom.debug.assert(n.length===this._vf.xDimension*this._vf.zDimension);var o=null,s=null,a=null;this._cf.normal.node&&(o=this._cf.normal.node._vf.vector);var l=2;this._cf.texCoord.node&&this._cf.texCoord.node._vf.point&&(s=this._cf.texCoord.node._vf.point,x3dom.isa(this._cf.texCoord.node,x3dom.nodeTypes.TextureCoordinate3D)&&(l=3));var d=3;this._cf.color.node&&(a=this._cf.color.node._vf.color,x3dom.isa(this._cf.color.node,x3dom.nodeTypes.ColorRGBA)&&(d=4));var h=0;for(t=0;r>=t;t++)for(e=0;i>=e;e++)this._mesh._positions[0].push(e*this._vf.xSpacing),this._mesh._positions[0].push(n[h]),this._mesh._positions[0].push(t*this._vf.zSpacing),o&&(this._mesh._normals[0].push(o[h].x),this._mesh._normals[0].push(o[h].y),this._mesh._normals[0].push(o[h].z)),s?(this._mesh._texCoords[0].push(s[h].x),this._mesh._texCoords[0].push(s[h].y),3===l&&this._mesh._texCoords[0].push(s[h].z)):(this._mesh._texCoords[0].push(e/i),this._mesh._texCoords[0].push(t/r)),a&&(this._mesh._colors[0].push(a[h].r),this._mesh._colors[0].push(a[h].g),this._mesh._colors[0].push(a[h].b),4===d&&this._mesh._colors[0].push(a[h].a)),h++;for(t=1;r>=t;t++)for(e=0;i>e;e++)this._mesh._indices[0].push((t-1)*(i+1)+e),this._mesh._indices[0].push(t*(i+1)+e),this._mesh._indices[0].push((t-1)*(i+1)+e+1),this._mesh._indices[0].push(t*(i+1)+e),this._mesh._indices[0].push(t*(i+1)+e+1),this._mesh._indices[0].push((t-1)*(i+1)+e+1);this._mesh.calcNormals(Math.PI),this._mesh._invalidate=!0,this._mesh._numTexComponents=l,this._mesh._numColComponents=d,this._mesh._numFaces=this._mesh._indices[0].length/3,this._mesh._numCoords=this._mesh._positions[0].length/3},fieldChanged:function(e){if("height"==e){var t,i=this._mesh._positions[0].length/3,r=this._vf.height;for(t=0;i>t;t++)this._mesh._positions[0][3*t+1]=r[t];this._mesh._invalidate=!0,Array.forEach(this._parentNodes,function(e){e._dirty.positions=!0})}}})),x3dom.registerNodeType("Box","Geometry3D",defineClass(x3dom.nodeTypes.X3DGeometryNode,function(e){x3dom.nodeTypes.Box.superClass.call(this,e),this.addField_SFVec3f(e,"size",2,2,2);var t=this._vf.size.x,i=this._vf.size.y,r=this._vf.size.z,n="Box_"+t+"-"+i+"-"+r;void 0!=x3dom.geoCache[n]?(x3dom.debug.logInfo("Using Box from Cache"),this._mesh=x3dom.geoCache[n]):(t/=2,i/=2,r/=2,this._mesh._positions[0]=[-t,-i,-r,-t,i,-r,t,i,-r,t,-i,-r,-t,-i,r,-t,i,r,t,i,r,t,-i,r,-t,-i,-r,-t,-i,r,-t,i,r,-t,i,-r,t,-i,-r,t,-i,r,t,i,r,t,i,-r,-t,i,-r,-t,i,r,t,i,r,t,i,-r,-t,-i,-r,-t,-i,r,t,-i,r,t,-i,-r],this._mesh._normals[0]=[0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,1,0,0,1,0,0,1,0,0,1,-1,0,0,-1,0,0,-1,0,0,-1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,0,1,0,0,1,0,0,1,0,0,1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0],this._mesh._texCoords[0]=[1,0,1,1,0,1,0,0,0,0,0,1,1,1,1,0,0,0,1,0,1,1,0,1,1,0,0,0,0,1,1,1,0,1,0,0,1,0,1,1,0,0,0,1,1,1,1,0],this._mesh._indices[0]=[0,1,2,2,3,0,4,7,5,5,7,6,8,9,10,10,11,8,12,14,13,14,12,15,16,17,18,18,19,16,20,22,21,22,20,23],this._mesh._invalidate=!0,this._mesh._numFaces=12,this._mesh._numCoords=24,x3dom.geoCache[n]=this._mesh)},{fieldChanged:function(e){if("size"===e){var t=this._vf.size.x/2,i=this._vf.size.y/2,r=this._vf.size.z/2;this._mesh._positions[0]=[-t,-i,-r,-t,i,-r,t,i,-r,t,-i,-r,-t,-i,r,-t,i,r,t,i,r,t,-i,r,-t,-i,-r,-t,-i,r,-t,i,r,-t,i,-r,t,-i,-r,t,-i,r,t,i,r,t,i,-r,-t,i,-r,-t,i,r,t,i,r,t,i,-r,-t,-i,-r,-t,-i,r,t,-i,r,t,-i,-r],Array.forEach(this._parentNodes,function(e){e._dirty.positions=!0})}}})),x3dom.registerNodeType("Sphere","Geometry3D",defineClass(x3dom.nodeTypes.X3DGeometryNode,function(e){x3dom.nodeTypes.Sphere.superClass.call(this,e),this.addField_SFFloat(e,"radius",e?1:1e4),this.addField_SFVec2f(e,"subdivision",24,24);var t=1,i=this._vf.radius,r=this._vf.subdivision.x,n=this._vf.subdivision.y,o="Sphere_"+i;if(void 0!=x3dom.geoCache[o])x3dom.debug.logInfo("Using Sphere from Cache"),this._mesh=x3dom.geoCache[o];else{if(e&&(t=e.doc.properties.getProperty("PrimitiveQuality","Medium")),x3dom.isNumber(t))t=parseFloat(t);else switch(t.toLowerCase()){case"low":t=.3;break;case"medium":t=.5;break;case"high":t=1}this._quality=t;var s,a,l,d,h,u,c,f,m,p,_,g,v,y=Math.floor(r*t),b=Math.floor(n*t);for(s=0;y>=s;s++)for(l=s*Math.PI/y,d=Math.sin(l),h=Math.cos(l),a=0;b>=a;a++)u=2*a*Math.PI/b,c=Math.sin(u),f=Math.cos(u),m=-f*d,p=-h,_=-c*d,g=.25-1*a/b,v=s/y,this._mesh._positions[0].push(i*m),this._mesh._positions[0].push(i*p),this._mesh._positions[0].push(i*_),this._mesh._normals[0].push(m),this._mesh._normals[0].push(p),this._mesh._normals[0].push(_),this._mesh._texCoords[0].push(g),this._mesh._texCoords[0].push(v);var x,w;for(s=0;y>s;s++)for(a=0;b>a;a++)x=s*(b+1)+a,w=x+b+1,this._mesh._indices[0].push(x),this._mesh._indices[0].push(w),this._mesh._indices[0].push(x+1),this._mesh._indices[0].push(w),this._mesh._indices[0].push(w+1),this._mesh._indices[0].push(x+1);this._mesh._invalidate=!0,this._mesh._numFaces=this._mesh._indices[0].length/3,this._mesh._numCoords=this._mesh._positions[0].length/3,x3dom.geoCache[o]=this._mesh}},{fieldChanged:function(e){if("radius"===e){this._mesh._positions[0]=[],this._mesh._normals[0]=[];var t,i,r,n,o,s,a,l,d,h,u,c=this._vf.radius,f=this._vf.subdivision.x,m=this._vf.subdivision.y,p=this._quality,_=Math.floor(f*p),g=Math.floor(m*p);for(t=0;_>=t;t++)for(r=t*Math.PI/_,n=Math.sin(r),o=Math.cos(r),i=0;g>=i;i++)s=2*i*Math.PI/g,a=Math.sin(s),l=Math.cos(s),d=-l*n,h=-o,u=-a*n,this._mesh._positions[0].push(c*d),this._mesh._positions[0].push(c*h),this._mesh._positions[0].push(c*u);this._mesh._invalidate=!0,this._mesh._numCoords=this._mesh._positions[0].length/3,Array.forEach(this._parentNodes,function(e){e._dirty.positions=!0})}else if("subdivision"===e){this._mesh._positions[0]=[],this._mesh._indices[0]=[],this._mesh._normals[0]=[],this._mesh._texCoords[0]=[];var t,i,r,n,o,s,a,l,d,h,u,v,y,c=this._vf.radius,f=this._vf.subdivision.x,m=this._vf.subdivision.y,p=this._quality,_=Math.floor(f*p),g=Math.floor(m*p);for(t=0;_>=t;t++)for(r=t*Math.PI/_,n=Math.sin(r),o=Math.cos(r),i=0;g>=i;i++)s=2*i*Math.PI/g,a=Math.sin(s),l=Math.cos(s),d=-l*n,h=-o,u=-a*n,v=.25-1*i/g,y=t/_,this._mesh._positions[0].push(c*d),this._mesh._positions[0].push(c*h),this._mesh._positions[0].push(c*u),this._mesh._normals[0].push(d),this._mesh._normals[0].push(h),this._mesh._normals[0].push(u),this._mesh._texCoords[0].push(v),this._mesh._texCoords[0].push(y);var b,x;for(t=0;_>t;t++)for(i=0;g>i;i++)b=t*(g+1)+i,x=b+g+1,this._mesh._indices[0].push(b),this._mesh._indices[0].push(x),this._mesh._indices[0].push(b+1),this._mesh._indices[0].push(x),this._mesh._indices[0].push(x+1),this._mesh._indices[0].push(b+1);this._mesh._invalidate=!0,this._mesh._numFaces=this._mesh._indices[0].length/3,this._mesh._numCoords=this._mesh._positions[0].length/3,Array.forEach(this._parentNodes,function(e){e.setAllDirty()})}}})),x3dom.registerNodeType("Torus","Geometry3D",defineClass(x3dom.nodeTypes.X3DGeometryNode,function(e){x3dom.nodeTypes.Torus.superClass.call(this,e),this.addField_SFFloat(e,"innerRadius",.5),this.addField_SFFloat(e,"outerRadius",1),this.addField_SFVec2f(e,"subdivision",24,24);var t=this._vf.innerRadius,i=this._vf.outerRadius,r=this._vf.subdivision.x,n=this._vf.subdivision.y,o="Torus_"+t+"_"+i;if(void 0!=x3dom.geoCache[o])x3dom.debug.logInfo("Using Torus from Cache"),this._mesh=x3dom.geoCache[o];else{var s,a,l,d,h=2*Math.PI/r,u=2*Math.PI/n;for(s=0,l=0;r>=s;s++,l+=h){var c=Math.cos(l),f=Math.sin(l);for(a=0,d=0;n>=a;a++,d+=u){var m=Math.cos(d),p=Math.sin(d),_=i+t*m;this._mesh._normals[0].push(c*m,-f*m,p),this._mesh._positions[0].push(c*_,-f*_,t*p),this._mesh._texCoords[0].push(-s/r,a/n)}}for(s=0;n>s;s++)for(a=0;r>a;a++)this._mesh._indices[0].push(a*(n+1)+s),this._mesh._indices[0].push(a*(n+1)+s+1),this._mesh._indices[0].push((a+1)*(n+1)+s),this._mesh._indices[0].push(a*(n+1)+s+1),this._mesh._indices[0].push((a+1)*(n+1)+s+1),this._mesh._indices[0].push((a+1)*(n+1)+s);this._mesh._invalidate=!0,this._mesh._numFaces=this._mesh._indices[0].length/3,this._mesh._numCoords=this._mesh._positions[0].length/3,x3dom.geoCache[o]=this._mesh}},{fieldChanged:function(e){if("innerRadius"===e||"outerRadius"===e){this._mesh._positions[0]=[];var t,i,r,n,o=this._vf.innerRadius,s=this._vf.outerRadius,a=this._vf.subdivision.x,l=this._vf.subdivision.y,d=2*Math.PI/a,h=2*Math.PI/l;for(t=0,r=0;a>=t;t++,r+=d){var u=Math.cos(r),c=Math.sin(r);for(i=0,n=0;l>=i;i++,n+=h){var f=Math.cos(n),m=Math.sin(n),p=s+o*f;this._mesh._positions[0].push(u*p,-c*p,o*m)}}this._mesh._invalidate=!0,this._mesh._numCoords=this._mesh._positions[0].length/3,Array.forEach(this._parentNodes,function(e){e._dirty.positions=!0})}else if("subdivision"===e){this._mesh._positions[0]=[],this._mesh._indices[0]=[],this._mesh._normals[0]=[],this._mesh._texCoords[0]=[];var t,i,r,n,o=this._vf.innerRadius,s=this._vf.outerRadius,a=this._vf.subdivision.x,l=this._vf.subdivision.y,d=2*Math.PI/a,h=2*Math.PI/l;for(t=0,r=0;a>=t;t++,r+=d){var u=Math.cos(r),c=Math.sin(r);for(i=0,n=0;l>=i;i++,n+=h){var f=Math.cos(n),m=Math.sin(n),p=s+o*f;this._mesh._normals[0].push(u*f,-c*f,m),this._mesh._positions[0].push(u*p,-c*p,o*m),this._mesh._texCoords[0].push(-t/a,i/l)}}for(t=0;l>t;t++)for(i=0;a>i;i++)this._mesh._indices[0].push(i*(l+1)+t),this._mesh._indices[0].push(i*(l+1)+t+1),this._mesh._indices[0].push((i+1)*(l+1)+t),this._mesh._indices[0].push(i*(l+1)+t+1),this._mesh._indices[0].push((i+1)*(l+1)+t+1),this._mesh._indices[0].push((i+1)*(l+1)+t);this._mesh._invalidate=!0,this._mesh._numFaces=this._mesh._indices[0].length/3,this._mesh._numCoords=this._mesh._positions[0].length/3,Array.forEach(this._parentNodes,function(e){e.setAllDirty()})}}})),x3dom.registerNodeType("Cone","Geometry3D",defineClass(x3dom.nodeTypes.X3DGeometryNode,function(e){x3dom.nodeTypes.Cone.superClass.call(this,e),this.addField_SFFloat(e,"bottomRadius",1),this.addField_SFFloat(e,"height",2),this.addField_SFBool(e,"bottom",!0),this.addField_SFFloat(e,"subdivision",32),this.addField_SFBool(e,"side",!0);var t=this._vf.subdivision,i="Cone_"+this._vf.bottomRadius+"_"+this._vf.height+"_"+this._vf.bottom+"_"+this._vf.side;if(void 0!=x3dom.geoCache[i])x3dom.debug.logInfo("Using Cone from Cache"),this._mesh=x3dom.geoCache[i];else{var r,n,o,s=this._vf.bottomRadius,a=this._vf.height,l=2*Math.PI/t,d=s/a,h=1/Math.sqrt(1+d*d),u=0,c=0;if(this._vf.side)for(u=0,c=0;t>=u;u++)r=u*l,n=Math.sin(r),o=-Math.cos(r),this._mesh._positions[0].push(0,a/2,0),this._mesh._normals[0].push(n/h,d/h,o/h),this._mesh._texCoords[0].push(1-u/t,1),this._mesh._positions[0].push(n*s,-a/2,o*s),this._mesh._normals[0].push(n/h,d/h,o/h),this._mesh._texCoords[0].push(1-u/t,0),u>0&&(this._mesh._indices[0].push(c+0),this._mesh._indices[0].push(c+2),this._mesh._indices[0].push(c+1),this._mesh._indices[0].push(c+1),this._mesh._indices[0].push(c+2),this._mesh._indices[0].push(c+3),c+=2);if(this._vf.bottom&&s>0){var f=this._mesh._positions[0].length/3;for(u=t-1;u>=0;u--)r=u*l,n=s*Math.sin(r),o=-s*Math.cos(r),this._mesh._positions[0].push(n,-a/2,o),this._mesh._normals[0].push(0,-1,0),this._mesh._texCoords[0].push(n/s/2+.5,o/s/2+.5);var m=f+1;for(u=2;t>u;u++)this._mesh._indices[0].push(m),this._mesh._indices[0].push(f),m=f+u,this._mesh._indices[0].push(m)}this._mesh._invalidate=!0,this._mesh._numFaces=this._mesh._indices[0].length/3,this._mesh._numCoords=this._mesh._positions[0].length/3,x3dom.geoCache[i]=this._mesh}},{fieldChanged:function(e){if("bottomRadius"===e||"height"===e){this._mesh._positions[0]=[];var t,i,r,n=this._vf.bottomRadius,o=this._vf.height,s=this._vf.subdivision,a=2*Math.PI/s,l=n/o,d=1/Math.sqrt(1+l*l);if(this._vf.side)for(var h=0;s>=h;h++)t=h*a,i=Math.sin(t),r=-Math.cos(t),this._mesh._positions[0].push(0,o/2,0),this._mesh._positions[0].push(i*n,-o/2,r*n);if(this._vf.bottom&&n>0)for(var u=this._mesh._positions[0].length/3,h=s-1;h>=0;h--)t=h*a,i=n*Math.sin(t),r=-n*Math.cos(t),this._mesh._positions[0].push(i,-o/2,r);this._mesh._invalidate=!0,this._mesh._numCoords=this._mesh._positions[0].length/3,Array.forEach(this._parentNodes,function(e){e._dirty.positions=!0})}else if("subdivision"===e||"bottom"===e){this._mesh._positions[0]=[],this._mesh._indices[0]=[],this._mesh._normals[0]=[],this._mesh._texCoords[0]=[];var t,i,r,n=this._vf.bottomRadius,o=this._vf.height,s=this._vf.subdivision,a=2*Math.PI/s,l=n/o,d=1/Math.sqrt(1+l*l),h=0,c=0;if(this._vf.side)for(h=0,c=0;s>=h;h++)t=h*a,i=Math.sin(t),r=-Math.cos(t),this._mesh._positions[0].push(0,o/2,0),this._mesh._normals[0].push(i/d,l/d,r/d),this._mesh._texCoords[0].push(1-h/s,1),this._mesh._positions[0].push(i*n,-o/2,r*n),this._mesh._normals[0].push(i/d,l/d,r/d),this._mesh._texCoords[0].push(1-h/s,0),h>0&&(this._mesh._indices[0].push(c+0),this._mesh._indices[0].push(c+2),this._mesh._indices[0].push(c+1),this._mesh._indices[0].push(c+1),this._mesh._indices[0].push(c+2),this._mesh._indices[0].push(c+3),c+=2);if(this._vf.bottom&&n>0){var u=this._mesh._positions[0].length/3;for(h=s-1;h>=0;h--)t=h*a,i=n*Math.sin(t),r=-n*Math.cos(t),this._mesh._positions[0].push(i,-o/2,r),this._mesh._normals[0].push(0,-1,0),this._mesh._texCoords[0].push(i/n/2+.5,r/n/2+.5);var f=u+1;for(h=2;s>h;h++)this._mesh._indices[0].push(f),this._mesh._indices[0].push(u),f=u+h,this._mesh._indices[0].push(f)}this._mesh._invalidate=!0,this._mesh._numFaces=this._mesh._indices[0].length/3,this._mesh._numCoords=this._mesh._positions[0].length/3,Array.forEach(this._parentNodes,function(e){e.setAllDirty()})}}})),x3dom.registerNodeType("Cylinder","Geometry3D",defineClass(x3dom.nodeTypes.X3DGeometryNode,function(e){x3dom.nodeTypes.Cylinder.superClass.call(this,e),this.addField_SFFloat(e,"radius",1),this.addField_SFFloat(e,"height",2),this.addField_SFBool(e,"bottom",!0),this.addField_SFBool(e,"top",!0),this.addField_SFFloat(e,"subdivision",32),this.addField_SFBool(e,"side",!0);var t=this._vf.subdivision,i="Cylinder_"+this._vf.radius+"_"+this._vf.height+"_"+this._vf.bottom+"_"+this._vf.top+"_"+this._vf.side;if(void 0!=x3dom.geoCache[i])x3dom.debug.logInfo("Using Cylinder from Cache"),this._mesh=x3dom.geoCache[i];else{var r,n,o,s=this._vf.radius,a=this._vf.height,l=2*Math.PI/t,d=0,h=0;if(this._vf.side)for(d=0,h=0;t>=d;d++)r=d*l,n=Math.sin(r),o=-Math.cos(r),this._mesh._positions[0].push(n*s,-a/2,o*s),this._mesh._normals[0].push(n,0,o),this._mesh._texCoords[0].push(1-d/t,0),this._mesh._positions[0].push(n*s,a/2,o*s),this._mesh._normals[0].push(n,0,o),this._mesh._texCoords[0].push(1-d/t,1),d>0&&(this._mesh._indices[0].push(h+0),this._mesh._indices[0].push(h+1),this._mesh._indices[0].push(h+2),this._mesh._indices[0].push(h+2),this._mesh._indices[0].push(h+1),this._mesh._indices[0].push(h+3),h+=2);if(s>0){var u,c=this._mesh._positions[0].length/3;if(this._vf.top){for(d=t-1;d>=0;d--)r=d*l,n=s*Math.sin(r),o=-s*Math.cos(r),this._mesh._positions[0].push(n,a/2,o),this._mesh._normals[0].push(0,1,0),this._mesh._texCoords[0].push(n/s/2+.5,-o/s/2+.5);for(u=c+1,d=2;t>d;d++)this._mesh._indices[0].push(c),this._mesh._indices[0].push(u),u=c+d,this._mesh._indices[0].push(u);c=this._mesh._positions[0].length/3}if(this._vf.bottom){for(d=t-1;d>=0;d--)r=d*l,n=s*Math.sin(r),o=-s*Math.cos(r),this._mesh._positions[0].push(n,-a/2,o),this._mesh._normals[0].push(0,-1,0),this._mesh._texCoords[0].push(n/s/2+.5,o/s/2+.5);for(u=c+1,d=2;t>d;d++)this._mesh._indices[0].push(u),this._mesh._indices[0].push(c),u=c+d,this._mesh._indices[0].push(u)}}this._mesh._invalidate=!0,this._mesh._numFaces=this._mesh._indices[0].length/3,this._mesh._numCoords=this._mesh._positions[0].length/3,x3dom.geoCache[i]=this._mesh}},{fieldChanged:function(e){if("radius"===e||"height"===e){this._mesh._positions[0]=[];var t,i,r,n=this._vf.radius,o=this._vf.height,s=this._vf.subdivision,a=2*Math.PI/s,l=0;if(this._vf.side)for(l=0;s>=l;l++)t=l*a,i=Math.sin(t),r=-Math.cos(t),this._mesh._positions[0].push(i*n,-o/2,r*n),this._mesh._positions[0].push(i*n,o/2,r*n);if(n>0){var d,h=this._mesh._positions[0].length/3;if(this._vf.top)for(l=s-1;l>=0;l--)t=l*a,i=n*Math.sin(t),r=-n*Math.cos(t),this._mesh._positions[0].push(i,o/2,r)}if(this._vf.bottom)for(l=s-1;l>=0;l--)t=l*a,i=n*Math.sin(t),r=-n*Math.cos(t),this._mesh._positions[0].push(i,-o/2,r);this._mesh._invalidate=!0,this._mesh._numCoords=this._mesh._positions[0].length/3,Array.forEach(this._parentNodes,function(e){e._dirty.positions=!0})}else if("subdivision"===e||"bottom"===e||"top"===e){this._mesh._positions[0]=[],this._mesh._indices[0]=[],this._mesh._normals[0]=[],this._mesh._texCoords[0]=[];var t,i,r,n=this._vf.radius,o=this._vf.height,s=this._vf.subdivision,a=2*Math.PI/s,l=0,u=0;if(this._vf.side)for(l=0,u=0;s>=l;l++)t=l*a,i=Math.sin(t),r=-Math.cos(t),this._mesh._positions[0].push(i*n,-o/2,r*n),this._mesh._normals[0].push(i,0,r),this._mesh._texCoords[0].push(1-l/s,0),this._mesh._positions[0].push(i*n,o/2,r*n),this._mesh._normals[0].push(i,0,r),this._mesh._texCoords[0].push(1-l/s,1),l>0&&(this._mesh._indices[0].push(u+0),this._mesh._indices[0].push(u+1),this._mesh._indices[0].push(u+2),this._mesh._indices[0].push(u+2),this._mesh._indices[0].push(u+1),this._mesh._indices[0].push(u+3),u+=2);if(n>0){var d,h=this._mesh._positions[0].length/3;if(this._vf.top){for(l=s-1;l>=0;l--)t=l*a,i=n*Math.sin(t),r=-n*Math.cos(t),this._mesh._positions[0].push(i,o/2,r),this._mesh._normals[0].push(0,1,0),this._mesh._texCoords[0].push(i/n/2+.5,-r/n/2+.5);for(d=h+1,l=2;s>l;l++)this._mesh._indices[0].push(h),this._mesh._indices[0].push(d),d=h+l,this._mesh._indices[0].push(d);h=this._mesh._positions[0].length/3}if(this._vf.bottom){for(l=s-1;l>=0;l--)t=l*a,i=n*Math.sin(t),r=-n*Math.cos(t),this._mesh._positions[0].push(i,-o/2,r),this._mesh._normals[0].push(0,-1,0),this._mesh._texCoords[0].push(i/n/2+.5,r/n/2+.5);for(d=h+1,l=2;s>l;l++)this._mesh._indices[0].push(d),this._mesh._indices[0].push(h),d=h+l,this._mesh._indices[0].push(d)}}this._mesh._invalidate=!0,this._mesh._numFaces=this._mesh._indices[0].length/3,this._mesh._numCoords=this._mesh._positions[0].length/3,Array.forEach(this._parentNodes,function(e){e.setAllDirty()})}}})),x3dom.registerNodeType("ImageGeometry","Geometry3D",defineClass(x3dom.nodeTypes.X3DGeometryNode,function(e){x3dom.nodeTypes.ImageGeometry.superClass.call(this,e);for(var t=-5,i=-4,r=0;r<e.xmlNode.childNodes.length;r++)"imagetexture"==e.xmlNode.childNodes[r].localName&&("coord"==e.xmlNode.childNodes[r].getAttribute("containerField")?(e.xmlNode.childNodes[r].setAttribute("priority",t),t+=10):"normal"==e.xmlNode.childNodes[r].getAttribute("containerField")?(e.xmlNode.childNodes[r].setAttribute("priority",i),i+=10):"texCoord"==e.xmlNode.childNodes[r].getAttribute("containerField")?e.xmlNode.childNodes[r].setAttribute("priority","-3"):"color"==e.xmlNode.childNodes[r].getAttribute("containerField")&&e.xmlNode.childNodes[r].setAttribute("priority","-2"));if(this.addField_SFVec3f(e,"position",0,0,0),this.addField_SFVec3f(e,"size",0,0,0),this.addField_MFFloat(e,"vertexCount",[0]),this.addField_MFString(e,"primType",["TRIANGLES"]),this.addField_SFFloat(e,"numColorComponents",3),this.addField_SFNode("index",x3dom.nodeTypes.X3DTextureNode),this.addField_MFNode("coord",x3dom.nodeTypes.X3DTextureNode),this.addField_MFNode("normal",x3dom.nodeTypes.X3DTextureNode),this.addField_SFNode("texCoord",x3dom.nodeTypes.X3DTextureNode),this.addField_SFNode("color",x3dom.nodeTypes.X3DTextureNode),this._mesh._numColComponents=this._vf.numColorComponents,"webgl"==x3dom.caps.BACKEND&&x3dom.caps.MAX_VERTEX_TEXTURE_IMAGE_UNITS>0){var n="ImageGeometry";if(void 0!=x3dom.geoCache[n])x3dom.debug.logInfo("Using ImageGeometry-Mesh from Cache"),this._mesh=x3dom.geoCache[n];else{for(var o=0;256>o;o++)for(var s=0;256>s;s++){var a=256*o+s;if(65535==a)break;this._mesh._positions[0].push(s/256,o/256,0),this._mesh._indices[0].push(256*o+s)}this._mesh._invalidate=!0,this._mesh._numFaces=this._mesh._indices[0].length/3,this._mesh._numCoords=this._mesh._positions[0].length/3,x3dom.geoCache[n]=this._mesh}}},{nodeChanged:function(){Array.forEach(this._parentNodes,function(e){e._dirty.positions=!0,e._dirty.normals=!0,e._dirty.texcoords=!0})},getMin:function(){return this._vf.position.subtract(this._vf.size.multiply(.5))},getMax:function(){return this._vf.position.add(this._vf.size.multiply(.5))},getVolume:function(e,t){return e.setValues(this.getMin()),t.setValues(this.getMax()),!0},getCenter:function(){return this._vf.position},numCoordinateTextures:function(){return this._cf.coord.nodes.length},getIndexTexture:function(){return this._cf.index.node?this._cf.index.node:null},getIndexTextureURL:function(){return this._cf.index.node?this._cf.index.node._vf.url:null},getCoordinateTexture:function(e){return this._cf.coord.nodes[e]?this._cf.coord.nodes[e]:null},getCoordinateTextureURL:function(e){return this._cf.coord.nodes[e]?this._cf.coord.nodes[e]._vf.url:null},getNormalTexture:function(e){return this._cf.normal.nodes[e]?this._cf.normal.nodes[e]:null},getNormalTextureURL:function(e){return this._cf.normal.nodes[e]?this._cf.normal.nodes[e]._vf.url:null},getTexCoordTexture:function(){return this._cf.texCoord.node?this._cf.texCoord.node:null},getTexCoordTextureURL:function(){return this._cf.texCoord.node?this._cf.texCoord.node._vf.url:null},getColorTexture:function(){return this._cf.color.node?this._cf.color.node:null},getColorTextureURL:function(){return this._cf.color.node?this._cf.color.node._vf.url:null}})),x3dom.registerNodeType("IndexedFaceSet","Geometry3D",defineClass(x3dom.nodeTypes.X3DComposedGeometryNode,function(e){x3dom.nodeTypes.IndexedFaceSet.superClass.call(this,e),this.addField_SFFloat(e,"creaseAngle",0),this.addField_MFInt32(e,"coordIndex",[]),this.addField_MFInt32(e,"normalIndex",[]),this.addField_MFInt32(e,"colorIndex",[]),this.addField_MFInt32(e,"texCoordIndex",[]),this.addField_SFBool(e,"convex",!0)},{nodeChanged:function(){var e=(new Date).getTime();this.handleAttribs();var t=this._vf.coordIndex,i=this._vf.normalIndex,r=this._vf.texCoordIndex,n=this._vf.colorIndex,o=!1,s=!1,a=!1,l=!1,d=!1,h=!1,u=this._vf.colorPerVertex,c=this._vf.normalPerVertex;i.length>0&&(s=!0),r.length>0&&(l=!0),n.length>0&&(h=!0);var f,m,p,_,g=this._cf.coord.node;x3dom.debug.assert(g),f=g.getPoints();var v=this._cf.normal.node;v?(o=!0,m=v._vf.vector):o=!1;var y="",b=2,x=this._cf.texCoord.node;x?x._vf.point?(a=!0,p=x._vf.point,x3dom.isa(x,x3dom.nodeTypes.TextureCoordinate3D)&&(b=3)):x._vf.mode&&(y=x._vf.mode):a=!1,this._mesh._numTexComponents=b;var w=3,T=this._cf.color.node;T?(d=!0,_=T._vf.color,x3dom.isa(T,x3dom.nodeTypes.ColorRGBA)&&(w=4)):d=!1,this._mesh._numColComponents=w,this._mesh._indices[0]=[],this._mesh._positions[0]=[],this._mesh._normals[0]=[],this._mesh._texCoords[0]=[],this._mesh._colors[0]=[];var E,C,S,F,M,A,N,R,D,I,P,k,V,O,L,B;if(this._vf.creaseAngle<=x3dom.fields.Eps||f.length/3>65535||o&&s||a&&l||d&&h){if(this._vf.convex)for(C=0,S=0,F=0,this._mesh._multiIndIndices=[],this._mesh._posSize=f.length,E=0;E<t.length;++E)if(-1!=t[E])switch(s&&x3dom.debug.assert(-1!=i[E]),l&&x3dom.debug.assert(-1!=r[E]),h&&x3dom.debug.assert(-1!=n[E]),C){case 0:M=+t[E],R=s&&c?+i[E]:s&&!c?+i[F]:M,P=l?+r[E]:M,O=h&&u?+n[E]:h&&!u?+n[F]:M,C=1;break;case 1:A=+t[E],D=s&&c?+i[E]:s&&!c?+i[F]:A,k=l?+r[E]:A,L=h&&u?+n[E]:h&&!u?+n[F]:A,C=2;break;case 2:N=+t[E],I=s&&c?+i[E]:s&&!c?+i[F]:N,V=l?+r[E]:N,B=h&&u?+n[E]:h&&!u?+n[F]:N,C=3,this._mesh._indices[0].push(S++,S++,S++),this._mesh._positions[0].push(f[M].x),this._mesh._positions[0].push(f[M].y),this._mesh._positions[0].push(f[M].z),this._mesh._positions[0].push(f[A].x),this._mesh._positions[0].push(f[A].y),this._mesh._positions[0].push(f[A].z),this._mesh._positions[0].push(f[N].x),this._mesh._positions[0].push(f[N].y),this._mesh._positions[0].push(f[N].z),o?(this._mesh._normals[0].push(m[R].x),this._mesh._normals[0].push(m[R].y),this._mesh._normals[0].push(m[R].z),this._mesh._normals[0].push(m[D].x),this._mesh._normals[0].push(m[D].y),this._mesh._normals[0].push(m[D].z),this._mesh._normals[0].push(m[I].x),this._mesh._normals[0].push(m[I].y),this._mesh._normals[0].push(m[I].z)):this._mesh._multiIndIndices.push(M,A,N),d&&(this._mesh._colors[0].push(_[O].r),this._mesh._colors[0].push(_[O].g),this._mesh._colors[0].push(_[O].b),4===w&&this._mesh._colors[0].push(_[O].a),this._mesh._colors[0].push(_[L].r),this._mesh._colors[0].push(_[L].g),this._mesh._colors[0].push(_[L].b),4===w&&this._mesh._colors[0].push(_[L].a),this._mesh._colors[0].push(_[B].r),this._mesh._colors[0].push(_[B].g),this._mesh._colors[0].push(_[B].b),4===w&&this._mesh._colors[0].push(_[B].a)),a&&(this._mesh._texCoords[0].push(p[P].x),this._mesh._texCoords[0].push(p[P].y),3===b&&this._mesh._texCoords[0].push(p[P].z),this._mesh._texCoords[0].push(p[k].x),this._mesh._texCoords[0].push(p[k].y),3===b&&this._mesh._texCoords[0].push(p[k].z),this._mesh._texCoords[0].push(p[V].x),this._mesh._texCoords[0].push(p[V].y),3===b&&this._mesh._texCoords[0].push(p[V].z));
break;case 3:A=N,k=V,c&&(D=I),u&&(L=B),N=+t[E],s&&c?I=+i[E]:s&&!c||(I=N),V=l?+r[E]:N,h&&u?B=+n[E]:h&&!u||(B=N),this._mesh._indices[0].push(S++,S++,S++),this._mesh._positions[0].push(f[M].x),this._mesh._positions[0].push(f[M].y),this._mesh._positions[0].push(f[M].z),this._mesh._positions[0].push(f[A].x),this._mesh._positions[0].push(f[A].y),this._mesh._positions[0].push(f[A].z),this._mesh._positions[0].push(f[N].x),this._mesh._positions[0].push(f[N].y),this._mesh._positions[0].push(f[N].z),o?(this._mesh._normals[0].push(m[R].x),this._mesh._normals[0].push(m[R].y),this._mesh._normals[0].push(m[R].z),this._mesh._normals[0].push(m[D].x),this._mesh._normals[0].push(m[D].y),this._mesh._normals[0].push(m[D].z),this._mesh._normals[0].push(m[I].x),this._mesh._normals[0].push(m[I].y),this._mesh._normals[0].push(m[I].z)):this._mesh._multiIndIndices.push(M,A,N),d&&(this._mesh._colors[0].push(_[O].r),this._mesh._colors[0].push(_[O].g),this._mesh._colors[0].push(_[O].b),4===w&&this._mesh._colors[0].push(_[O].a),this._mesh._colors[0].push(_[L].r),this._mesh._colors[0].push(_[L].g),this._mesh._colors[0].push(_[L].b),4===w&&this._mesh._colors[0].push(_[L].a),this._mesh._colors[0].push(_[B].r),this._mesh._colors[0].push(_[B].g),this._mesh._colors[0].push(_[B].b),4===w&&this._mesh._colors[0].push(_[B].a)),a&&(this._mesh._texCoords[0].push(p[P].x),this._mesh._texCoords[0].push(p[P].y),3===b&&this._mesh._texCoords[0].push(p[P].z),this._mesh._texCoords[0].push(p[k].x),this._mesh._texCoords[0].push(p[k].y),3===b&&this._mesh._texCoords[0].push(p[k].z),this._mesh._texCoords[0].push(p[V].x),this._mesh._texCoords[0].push(p[V].y),3===b&&this._mesh._texCoords[0].push(p[V].z))}else C=0,F++;else{var U=new x3dom.DoublyLinkedList,z=new Object;S=0;for(var E=0;E<t.length;++E)if(-1!=t[E])o&&(z.normals=s&&c?m[i[E]]:s&&!c?m[i[F]]:m[t[E]]),d&&(z.colors=h&&u?_[n[E]]:h&&!u?_[n[F]]:_[t[E]]),a&&(z.texCoords=l?p[r[E]]:p[t[E]]),U.appendNode(new x3dom.DoublyLinkedList.ListNode(f[t[E]],t[E],z.normals,z.colors,z.texCoords));else{for(var j=x3dom.EarClipping.getMultiIndexes(U),G=0;G<j.indices.length;G++)this._mesh._indices[0].push(S),S++,this._mesh._positions[0].push(j.point[G].x,j.point[G].y,j.point[G].z),o&&this._mesh._normals[0].push(j.normals[G].x,j.normals[G].y,j.normals[G].z),d&&(this._mesh._colors[0].push(j.colors[G].r,j.colors[G].g,j.colors[G].b),4===w&&this._mesh._colors[0].push(j.colors[G].a)),a&&(this._mesh._texCoords[0].push(j.texCoords[G].x,j.texCoords[G].y),3===b&&this._mesh._texCoords[0].push(j.texCoords[G].z));U=new x3dom.DoublyLinkedList,F++}}o||this._mesh.calcNormals(this._vf.creaseAngle),a||this._mesh.calcTexCoords(y),this._mesh.splitMesh()}else{if(C=0,this._vf.convex)for(E=0;E<t.length;++E)if(-1!=t[E])switch(C){case 0:R=+t[E],C=1;break;case 1:D=+t[E],C=2;break;case 2:I=+t[E],C=3,this._mesh._indices[0].push(R,D,I);break;case 3:D=I,I=+t[E],this._mesh._indices[0].push(R,D,I)}else C=0;else for(var U=new x3dom.DoublyLinkedList,E=0;E<t.length;++E)if(-1!=t[E])U.appendNode(new x3dom.DoublyLinkedList.ListNode(f[t[E]],t[E]));else{for(var X=x3dom.EarClipping.getIndexes(U),G=0;G<X.length;G++)this._mesh._indices[0].push(X[G]);U=new x3dom.DoublyLinkedList}this._mesh._positions[0]=f.toGL(),o?this._mesh._normals[0]=m.toGL():this._mesh.calcNormals(this._vf.creaseAngle),a?(this._mesh._texCoords[0]=p.toGL(),this._mesh._numTexComponents=b):this._mesh.calcTexCoords(y),d&&(this._mesh._colors[0]=_.toGL(),this._mesh._numColComponents=w)}for(this._mesh._invalidate=!0,this._mesh._numFaces=0,this._mesh._numCoords=0,E=0;E<this._mesh._indices.length;E++)this._mesh._numFaces+=this._mesh._indices[E].length/3,this._mesh._numCoords+=this._mesh._positions[E].length/3;(new Date).getTime()-e},fieldChanged:function(e){var t,i=this._cf.coord.node._vf.point,r=i.length;if(this._vf.creaseAngle<=x3dom.fields.Eps||r/3>65535)return x3dom.debug.logWarning("Ipol with creaseAngle == 0, too many coords, or multi-index!"),this.nodeChanged(),Array.forEach(this._parentNodes,function(e){e._dirty.positions=!0}),void Array.forEach(this._parentNodes,function(e){e._dirty.colors=!0});if("coord"==e){for(i=this._cf.coord.node._vf.point,r=i.length,this._mesh._positions[0]=[],t=0;r>t;t++)this._mesh._positions[0].push(i[t].x),this._mesh._positions[0].push(i[t].y),this._mesh._positions[0].push(i[t].z);this._mesh._invalidate=!0,Array.forEach(this._parentNodes,function(e){e._dirty.positions=!0})}else if("color"==e){for(i=this._cf.color.node._vf.color,r=i.length,this._mesh._colors[0]=[],t=0;r>t;t++)this._mesh._colors[0].push(i[t].r),this._mesh._colors[0].push(i[t].g),this._mesh._colors[0].push(i[t].b);Array.forEach(this._parentNodes,function(e){e._dirty.colors=!0})}else if("normal"==e){i=this._cf.normal.node._vf.vector,r=i.length,this._mesh._normals[0]=[];for(var t=0;r>t;t++)this._mesh._normals[0].push(i[t].x),this._mesh._normals[0].push(i[t].y),this._mesh._normals[0].push(i[t].z);this._mesh._invalidate=!0,Array.forEach(this._parentNodes,function(e){e.setAllDirty()})}else if("texCoord"==e){for(i=this._cf.texCoord.node._vf.point,r=i.length,this._mesh._texCoords[0]=[],t=0;r>t;t++)this._mesh._texCoords[0].push(i[t].x),this._mesh._texCoords[0].push(i[t].y);this._mesh._invalidate=!0,Array.forEach(this._parentNodes,function(e){e.setAllDirty()})}}})),x3dom.versionInfo={version:"1.3.0",revision:"e545d12e73c319f792958154e42219c7818ba1a4",date:"Fri Dec 23 15:53:12 2011 +0100"};